---
title: "The HJM Framework"
author: "Quasar"
date: "2025-01-29"
categories: [Rates Modelling]      
image: "image.jpg"
toc: true
toc-depth: 3
format:
    html:
        code-tools: true
        code-block-border-left: true
        code-annotations: below
        highlight-style: pygments
---

# The HJM Framework

## Introduction

Early interest rate modelling was based on specifying some dynamics for the instantaneous short rate process $r(t)$. Some classical short-rate models are : the Vasicek (1977) model, the Dothan (1978) model, the Cox, Ingersoll and Ross(1985) model and the Exponential-Vasicek model. These are all equilibrium, *endogenous term-structure models*, meaning that the current yield curve $P(t,T)$ is an output of the model rather than an input of the model. 

In a *no-arbitrage (exogenous)* model, today's term structure of interest rates is an input. This means that you always get your yield curve back from the model and is independent of the parameters, so this is extremely powerful. This means that we take the observed actual rates while constructing the model and estimate the unobserved rates. 

The HJM framework described a clear path from equilibrium towards term-structure models.

## Equilibrium versus Term-Structure Models

Historically, equilibrium models start with assumptions about economic variables and derive a process for the short rate, which means that the current term structure of interest rates is an output, rather than an input to the model. Such models are also called *endogenous* models. 

The Vasicek model has the short-rate dynamics:

$$
\begin{align*}
dr(t) = \lambda(\theta - r(t))dt + \eta dW(t)
\end{align*}
$${#eq-vasicek-model}

To simulate this model, we need to calibrate this model to the yield curve. Obviously, we need to choose the values of the parameters $\lambda$, $\theta$ $\eta$ such that the yield curve will be recovered. Very likely, there will be not enough flexibility with $3$ parameters to fit to the yield curve, which is built by tens or hundreds of market instruments. Here, we have only $3$ degrees of freedom. 

Of course, we can also consider models where the model parameters $\lambda$, $\theta$ and $\eta$ are time-dependent, and they have a term-structure to have more flexibility. But, that's an issue, because actually we need to perform calibration. Calibration means that we need to optimize a target function. We take the yield curve or zero-coupon bond quotes from the market and we calibrate using Levenberg-Marquardt or any other optimization routine and we find those time-dependent parameters. This can be very computationally expensive. 

However, in term-structure models, the model parameter e.g. $\theta$ is directly given in terms of market instruments. There is no need to perform any calibration to fit the yield curve. 

We can still use calibration to fit other model parameters e.g. mean reversion $\lambda$ or $\eta$ to market instruments such as swaptions. But, we don't need to do it for fitting to the yield curve.

Fitting to the yield curve is a necessary condition, when it comes to arbitrage. If we cannot fit to the yield curve, there is no point to fit to anything else. We are already generating arbitrage on $\Delta$. It means that, if we have an exotic derivative, our model may fit nicely to the exotic derivative prices, but we didn't calibrate the model to the yield curve. So, the sensitivity of the generated yield curve to simple instruments is completely off.

The Cox-Ingersoll and Ross(CIR) model has the short-rate dynamics:

$$
\begin{align*}
dr(t) = \lambda(\theta - r(t))dt + \gamma \sqrt{r(t)}dW(t)
\end{align*}
$${#eq-cox-ingersoll-ross-model}

```{python}
# | code-fold: true
# | code-summary: "Show the code"
from aleatory.processes import CIRProcess
process = CIRProcess(theta=1.0, mu=2.0, sigma=1.0, initial=10.0, T=3.0)
fig = process.draw(n=200, N=200, envelope=False, colormap="summer")
```

## The HJM Framework

The Heath-Jarrow-Morton framework is a global framework for describing all the interest rate models. It gives a whole different perspective on how to look at interest rate models. 

It represents a class of models that are derived by directly modeling the dynamics of *instantaneous forward rates*. The framework constitutes the foundation of interest rate models as it provides an explicit relation between the volatility of the forward-rates and arbitrage-free drift. 

Both the standard short-rate and LIBOR market models can be derived in the HJM framework, however, in general. The HJM models are non-Markovian, so only a number of models with a closed-form solution exist.


