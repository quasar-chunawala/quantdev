{
  "hash": "7279b220761fc64108530fe4d5fcc09c",
  "result": {
    "markdown": "---\ntitle: \"Multivariate Ito Calculus\"\nauthor: \"Quasar\"\ndate: \"2024-07-04\"\ncategories: [Stochastic Calculus]      \nimage: \"image.jpg\"\ntoc: true\ntoc-depth: 3\n---\n\n# Multivariate Ito Calculus.\n\nWe can generalize the theory to functions of several brownian motions. This unleashes the full power of Ito calculus.\n\n## Multidimensional Brownian motion.\n\n*Definition 1.*\n(Brownian motion in $\\mathbf{R}^{d})$. Take $d\\in\\mathbf{N}$. Let $B^{(1)},\\ldots,B^{(d)}$ be independent standard Brownian motions in $(\\Omega,\\mathcal{F},\\mathbb{P})$. The process $(B_{t}:t\\geq0)$ taking values in $\\mathbf{R}^{d}$ defined by :\n\n\\begin{aligned}\nB_{t} & =(B_{t}^{(1)},\\ldots,B_{t}^{(d)}),\\quad t\\geq0\n\\end{aligned}\n\nis called a $d-$dimensional Brownian motion or a Brownian motion in $\\mathbf{R}^{d}$.\n\nThe Brownian filtration $(\\mathcal{F}_{t}:t\\geq0)$ is now composed of the information of all Brownian motions. In other words, it is given by the sigma-fields:\n\n\\begin{aligned}\n\\mathcal{F}_{t} & =\\sigma(B_{s}^{(i)},1\\leq i\\leq d,s\\leq t)\n\\end{aligned}\n\nFor every outcome $\\omega$, the path of trajectory of a $d-$dimensional Brownian motion is a curve in space parametrized by the time $t$:\n\n\\begin{aligned}\nt\\mapsto B_{t}(\\omega) & =(B_{t}^{(1)}(\\omega),B_{t}^{(2)}(\\omega),\\ldots,B_{t}^{(d)}(\\omega))\n\\end{aligned}\n\nOf course, this curve is continuous, since each coordinate is. The below numerical project gives an example of one path of a two-dimensional brownian motion. This is a very rugged and intertwined curve! We might wonder, what it does as $t\\to\\infty$. Does it wander around $(0,0)$ ad infinitum or does it eventually escape to infinity? We will answer this question in a later section. For doing so, we shall need a version of Ito's formula for multi-dimensional Brownian motion. We finish this section by noticing that it is also easy to construct Brownian motions in higher dimensions for which the coordinates are correlated.\n\n### 2D Brownian Motion \n\nConsider a two-dimensional Brownian motion $(B_{t}^{(1)},B_{2}^{(2)})$ starting at $(0,0)$.\n\nLet's plot one path of this Brownian motion on the plane $\\mathbf{R}^{2}$ on the plane in $\\mathbf{R}^{2}$ on the time interval $[0,5]$ using a discretization of $0.001$.\n\nWe define `BrownianMotion2D` class.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nsns.set_style(\"whitegrid\")\n\nclass BrownianMotion2D:\n    \"\"\"\n    Generate sample paths for a 2d-brownian motion\n    \"\"\"\n    def __init__(\n        self,\n        endpoint : float = 1.0,\n        discretization : float = 0.01\n    ):\n        self.endpoint = endpoint\n        self.discretization = discretization\n\n    def generate_paths(self, num_paths : int):\n        steps = int(self.endpoint/self.discretization)\n        delta_z = np.sqrt(self.discretization) * np.random.randn(num_paths,2,steps)\n        \n        # paths has shape [num_paths,2,num_steps]\n        paths = np.cumsum(delta_z,axis=2)\n\n        # Brownian motion has position (0,0) at time t=0\n        # Append initial position \n        init_position = np.zeros((num_paths,2,1))\n        paths = np.append(init_position,paths,axis=2)\n\n        return paths\n```\n:::\n\n\nWe can then configure and use `BrownianMotion2D` objects as we please.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show the code\"}\nbm = BrownianMotion2D(endpoint=5.0,discretization=0.001)\npaths = bm.generate_paths(num_paths=1)\npath = paths[0]\n\n\nplt.xlabel(r'$x$')\nplt.ylabel(r'$y$')\nplt.title(r'2D-Brownian motion')\nplt.grid(True)\nplt.plot(path[0],path[1],linewidth=1,color='blue')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-1.png){width=594 height=447}\n:::\n:::\n\n\n### Brownian motion with correlated coordinates\n\n*Example 2.*\n(Example of Brownian motion with correlated coordinates) Let $(B_{t}:t\\geq0)$ be a two dimensional brownian motion. Let $-1<\\rho<1$. We construct the two dimensional process as follows: $W_{t}=(W_{t}^{(1)},W_{t}^{(2)})$ where:\n\n\\begin{aligned}\nW_{t}^{(1)} & =B_{t}^{(1)}\\\\\nW_{t}^{(2)} & =\\rho B_{t}^{(1)}+\\sqrt{1-\\rho^{2}}B_{t}^{(2)}\n\\end{aligned}\n\n$W_{t}^{(1)}=B_{t}^{(1)}$ is Gaussian with mean $0$ and variance $t$. Since, $B_{t}^{(1)}$ and $B_{t}^{(2)}$are independent gaussian random variables and the sum of IID Gaussians is Gaussian, $W_{t}^{(2)}$ is Gaussian with mean $0$ and variance $t$. The covariance between\n$W_{t}^{(1)}$ and $W_{t}^{(2)}$ is:\n\n\\begin{aligned}\n\\mathbf{E}[W_{t}^{(1)}W_{t}^{(2)}] & =\\mathbf{E}[B_{t}^{(1)}(\\rho B_{t}^{(1)}+\\sqrt{1-\\rho^{2}}B_{t}^{(2)})]\\\\\n & =\\mathbf{E}[\\rho(B_{t}^{(1)})^{2}+\\sqrt{1-\\rho^{2}}B_{t}^{(1)}B_{t}^{(2)}]\\\\\n & =\\rho t\n\\end{aligned}\n\nHence, the coordinates at time $t$ are not independent.\n\nConsider now the process $(W_{t}:t\\geq0)$ for $\\rho=1/2$ as in example 2. Let's plot one path of this process on the plane $\\mathbf{R}^{2}$ on the time-interval $[0,5]$ using a discretization of $0.001$.\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nclass BrownianMotion2DWithCorrelatedCoords(BrownianMotion2D):\n    \"\"\"\n    Generate sample paths for a 2d-brownian motion\n    have correlated coordiantes\n    \"\"\"\n\n    def __init__(\n        self, \n        endpoint: float = 1.0, \n        discretization: float = 0.01, \n        rho: float = 0.0\n    ):\n        self.endpoint = endpoint\n        self.discretization = discretization\n        self.rho = rho\n\n    def generate_paths(self, num_paths: int):\n\n        # Call the base class generate_paths() method to generate a pair of\n        # independent brownian motion paths. It returns a tensor of\n        # shape (num_paths, 2, num_steps)\n        paths = super().generate_paths(num_paths=num_paths)\n\n        # Extract the brownian motions B1(t) and B2(t)\n        # B1(t) and B2(t) have dimensions [num_paths,num_steps]\n        x_coord = paths[:, 0, :]\n        y_coord = paths[:, 1, :]\n\n        # Apply the transformation\n        # W1(t) = B1(t)\n        # W2(t) = rho * B1(t) + sqrt(1 - rho**2) B2(t)\n        x_coord = x_coord\n        y_coord = self.rho * x_coord + np.sqrt(1 - self.rho**2) * y_coord\n\n        # Assemble back the x- and y- coordinates\n        x_coord = np.expand_dims(x_coord, axis=1)\n        y_coord = np.expand_dims(y_coord, axis=1)\n\n        # Return a tensor of shape [num_paths,d=2,num_steps]\n        return np.concatenate([x_coord, y_coord], axis=1)\n```\n:::\n\n\nLet's configure the `BrownianMotion2DWithCorrelatedCoords` engine with the settings `endpoint=5.0`, `discretization=0.001` and `rho=0.5` and generate a sample path.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show the code\"}\nbm = BrownianMotion2DWithCorrelatedCoords(\n    endpoint=5.0,\n    discretization=0.001,\n    rho=0.50\n)\npaths = bm.generate_paths(num_paths=1)\npath = paths[0]\n\nplt.xlabel(r'$x$')\nplt.ylabel(r'$y$')\nplt.title(r'Correlated Brownian motion $W(t)=(W^{(1)}(t),W^{(2)}(t))$')\nplt.grid(True)\nplt.plot(path[0],path[1],linewidth=1,color='blue')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-1.png){width=595 height=452}\n:::\n:::\n\n\n::: {.cell execution_count=5}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show the code\"}\nplt.xlabel(r'$t$')\nplt.ylabel(r'$W_t$')\nplt.title(r'Correlated Brownian motion paths')\nplt.grid(True)\nt = np.linspace(0.0,stop=5.0,num=5001)\nplt.plot(t,path[0],linewidth=0.75)\nplt.plot(t,path[1],linewidth=0.75)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-6-output-1.png){width=595 height=447}\n:::\n:::\n\n\n## Ito's Formula.\n\n*Theorem 3.* (Ito's Formula). Let $(B_{t}:t\\geq0)$ be a $d-$dimensional brownian motion. Consider $f\\in\\mathcal{C}^{2}(\\mathbf{R}^{d})$. Then, we have with probability one that for all $t\\geq0$:\n\n\\begin{aligned}\nf(B_{t})-f(B_{0}) & =\\sum_{i=1}^{d}\\int_{0}^{t}\\partial_{x_{i}}f(B_{s})dB_{s}^{(i)}+\\frac{1}{2}\\int_{0}^{t}\\sum_{i=1}^{d}\\partial_{x_{i}}^{2}f(B_{s})ds\\label{eq:multidimensional-ito-formula}\n\\end{aligned}\n\n\n*Remark.* I stress that, as in the one-dimensional case, Ito's formula is an equality of processes (and not an equality in distribution). Thus, the processes on both sides must agree for each path. Interestingly, the mixed partials $\\partial_{x_{i}x_{j}}f(B_{s})$, $i\\neq j$ do not appear in the formula! We see from Ito's formula that the process $f(B_{t})$ can be represented as a sum of $d+1$ processes: $d$ Ito integrals and one Riemann integral (which is a process of finite variation). In vector notation, the formula takes the form:\n\n\\begin{aligned}\nf(B_{t})-f(B_{0}) & =\\int_{0}^{t}\\nabla f(B_{s})^{T}dB_{s}+\\frac{1}{2}\\int_{0}^{t}\\nabla^{2}f(B_{s})ds\n\\end{aligned}\n\nwhere it is understood that the first term is the sum of the $d$ Ito integrals in the equation. The symbol $\\nabla^{2}$ is the Laplacian of $f$:\n\n$\\sum_{i=1}^{d}\\frac{\\partial^{2}}{\\partial x_{i}^{2}}f(B_{s}^{(1)},\\ldots,B_{s}^{(d)})ds$\n\nIn differential form, Ito's formula becomes very neat:\n\n\\begin{aligned}\ndf(B_{t}) & =\\sum_{i=1}^{d}\\partial_{x_{i}}f(B_{s})dB_{t}^{(i)}+\\frac{1}{2}\\sum_{i=1}^{d}\\partial_{x_{i}}^{2}f(B_{s})dt=\\nabla f(B_{t})^{T}dB_{s}+\\frac{1}{2}\\nabla^{2}f(B_{t})dt\n\\end{aligned}\n\n\n*Example 4.* Consider the functions (1) $f(x_{1},x_{2})=x_{1}^{2}+x_{2}^{2}$ (2) $f(x_{1},x_{2})=e^{x_{1}}\\cos x_{2}$ and the processes $(X_{t}:t\\geq0)$ and $(Y_{t}:t\\geq0)$. If we apply Ito's formula to the first process, we have:\n\n\\begin{aligned}\nX_{t} & =\\int_{0}^{t}2B_{s}^{(1)}dB_{s}^{(1)}+\\int_{0}^{t}2B_{s}^{(2)}dB_{s}^{(2)}+\\frac{1}{2}\\int_{0}^{t}(4dt)\\\\\n & =\\int_{0}^{t}2B_{s}^{(1)}dB_{s}^{(1)}+\\int_{0}^{t}2B_{s}^{(2)}dB_{s}^{(2)}+2t\n\\end{aligned}\n\nThe second process gives:\n\n\\begin{aligned}\nY_{t} & =\\cos B_{s}^{(2)}\\int_{0}^{t}e^{B_{s}^{(1)}}dB_{s}^{(1)}-e^{B_{s}^{(1)}}\\int\\sin B_{s}^{(2)}dB_{s}^{(2)}+\\frac{1}{2}\\int_{0}^{t}\\left(e^{B_{s}^{(1)}}\\cos B_{s}^{(2)}-e^{B_{s}^{(1)}}\\cos B_{s}^{(2)}\\right)dt\\\\\n & =1+\\cos B_{s}^{(2)}\\int_{0}^{t}e^{B_{s}^{(1)}}dB_{s}^{(1)}-e^{B_{s}^{(1)}}\\int\\sin B_{s}^{(2)}dB_{s}^{(2)}\n\\end{aligned}\n\n\n*Exercise.* (Cross-Variation of $B_{t}^{(1)}$ and $B_{t}^{(2)}$). Let $(t_{j}:j\\leq n)$ be a sequence of partitions of $[0,t]$ such that $\\max_{j}|t_{j+1}-t_{j}|\\to0$ as $n\\to\\infty$. Prove that:\n\n\\begin{aligned}\n\\lim_{n\\to\\infty}\\sum_{j=0}^{n-1}(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)}) & =0\\quad\\text{in } L^{2}\n\\end{aligned}\n\nThis justifies the rule $dB_{t}^{(1)}\\cdot dB_{t}^{(2)}=0$.\n\n*Hint*: Just compute the second moment of the sum.\n\n*Solution.*\nWe have:\n\n\\begin{aligned}\n & \\mathbf{E}\\left[\\left(\\sum_{j=0}^{n-1}(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)})\\right)^{2}\\right]\\\\\n= & \\sum_{j=0}^{n-1}\\mathbf{E}[(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})^{2}(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)})^{2}]\\\\\n+ & 2\\sum_{j<k}\\mathbf{E}\\left[(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})(B_{t_{k+1}}^{(1)}-B_{t_{k}}^{(1)})(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)})(B_{t_{k+1}}^{(2)}-B_{t_{k}}^{(2)})\\right]\n\\end{aligned}\n\nBoth these expectations are zero, since the brownian motions are independent and non-overlapping increments are independent.\n\nConsequently,\n$\\sum_{j=0}^{n-1}(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)})\\to0$\nin the $L^{2}$ sense.\n\n\n*Proof.* The proof of the formula follows the usual recipe: Taylor's theorem together with the quadratic variation and the cross-variation. In this case, we do get a cross-variation between the different Brownian motions. More precisely, consider a partition $(t_{j}:j\\leq n)$ of $[0,t]$. Then we can write:\n\n\\begin{aligned}\nf(B_{t})-f(B_{0}) & =\\sum_{j=0}^{n-1}(f(B_{t_{j+1}})-f(B_{t_{j}}))\n\\end{aligned}\n\nWe can apply the Taylor's series expansion for each $j$ to get:\n\n\\begin{aligned}\nf(B_{t})-f(B_{0}) & =\\sum_{j=0}^{n-1}\\nabla f(B_{t_{j}})(B_{t_{j+1}}-B_{t_{j}})\\\\\n & +\\frac{1}{2}\\sum_{j=0}^{n-1}(B_{t_{j+1}}-B_{t_{j}})^{T}Hf(B_{t_{j}})(B_{t_{j+1}}-B_{t_{j}})+\\mathcal{E}\n\\end{aligned}\n\nwhere $Hf$ is the Hessian matrix of $f$. We wrote the expansion using the vector notation to be economical. Let's keep in mind that each term is a sum over the derivatives. The first term will converge to $d$ Ito integrals as in the one-dimensional case. Now, the summand in the second\nterm is:\n\n$$(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)},\\ldots,B_{t_{j+1}}^{(d)}-B_{t_{j}}^{(d)})\\left[\\begin{array}{ccc}\n\\partial_{x_{1}}^{2}f(B_{t_{j}}) & \\ldots & \\partial_{x_{1}x_{d}}^{2}f(B_{t_{j}})\\\\\n\\vdots & \\ddots\\\\\n\\partial_{x_{d}x_{1}}^{2}f(B_{t_{j}}) &  & \\partial_{x_{d}}^{2}f(B_{t_{j}})\n\\end{array}\\right]\\left[\\begin{array}{c}\nB_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)}\\\\\n\\vdots\\\\\nB_{t_{j+1}}^{(d)}-B_{t_{j}}^{(d)}\n\\end{array}\\right]$$\n\nSo, $(B_{t_{j+1}}^{(i)}-B_{t_{j}}^{(i)})$ is pre-multiplied with the term $\\partial_{x_{i}x_{k}}^{2}f(B_{t_{j}})$ and it is post-multiplied $(B_{t_{j+1}}^{(k)}-B_{t_{j}}^{(k)})$. Consequently, the second term in the Taylor's series expansion can be re-written as:\n\n$$\\sum_{j=0}^{n-1}\\left(\\sum_{i=1}^{d}\\partial_{x_{i}}^{2}f(B_{t_{j}})(B_{t_{j+1}}^{(i)}-B_{t_{j}}^{(i)})^{2}+\\sum_{1\\leq i<k\\leq d}\\partial_{x_{i}x_{k}}^{2}f(B_{t_{j}})(B_{t_{j+1}}^{(i)}-B_{t_{j}}^{(i)})(B_{t_{j+1}}^{(k)}-B_{t_{j}}^{(k)})\\right)$$\n\nThe second term on the right converges to $0$ in the $L^{2}$ sense when\n$i\\neq k$, from exercise. This explains why the mixed derivatives disappear in the multi-dimensional Ito's formula. As for the case $i=k$, it reduces to the quadratic variation as in the one-dimensional case. This is where the Riemann integral arises, after suitable conditioning on $\\mathcal{F}_{t_{j}}$, the sigma-field generated by $B_{s}$, $s\\leq t_{j}$. â—»\n\n\nAs in the one-dimensional case,it is not necessary to learn Ito's formula by heart. It suffices to write the differential of the function $f$ to second order. We can then apply the rules of multivariate Ito calculus:\n\n      $\\cdot$       $dt$   $dB_{t}^{(1)}$   $dB_{t}^{(2)}$   $\\ldots$\n  ---------------- ------ ---------------- ---------------- ----------\n        $dt$        $0$         $0$              $0$           $0$\n   $dB_{t}^{(1)}$   $0$         $dt$             $0$           $0$\n   $dB_{t}^{(2)}$   $0$         $0$              $dt$          $0$\n      $\\ldots$      $0$         $0$              $0$           $dt$\n\nNote that the rule $dB_{t}^{(i)}dB_{t}^{(j)}=0$ for $i\\neq j$ is being\nmotivated by the cross-variation result.\n\nHow can we construct martingales using the Ito's formula? Recall that an Ito integral $(\\int_{0}^{t}X_{s}dB_{s},t\\leq T)$ is a martingale whenever the integrand is in $\\mathcal{L}_{c}^{2}(T)$, the space of adapted processes with continuous paths and for which:\n\n\\begin{aligned}\n\\int_{0}^{T}\\mathbf{E}[X_{s}^{2}]ds & <\\infty\n\\end{aligned}\n\nThe only difference here is that the integrand is a function of many Brownian motions. However, the integrands involved in the Ito integrals of the multidimensional Ito's formula are clearly adapted to the filtration $(\\mathcal{F}_{t}:t\\geq0)$ of $(B_{t}:t\\geq0)$ as they are functions of the Brownian motion at the time. The arguments of Ito\nintegral in and apply verbatim, if we take the definition of $\\mathcal{L}_{c}^{2}(t)$ with the filtration $(\\mathcal{F}_{t}:t\\geq0)$ of $(B_{t}:t\\geq0)$. With this in mind, we have the following corollary.\n\n*Corollary.* (Brownian Martingales) Let $(B_{t}:t\\geq0)$ be a Brownian motion in $\\mathbf{R}^{d}$. Consider $f\\in\\mathcal{C}^{2}(\\mathbf{R}^{d})$ such that processes $(\\partial_{x {i}}f(B_{t}),t\\leq T)\\in\\mathcal{L}_{c}^{2}(T)$ for every $i\\leq d$. Then, the process :\n\n$$f(B_{t})-\\frac{1}{2}\\int_{0}^{t}\\nabla^{2}f(B_{s})ds,\\quad t\\leq T$$\n\nwhere $\\nabla^{2}=\\sum_{i=1}^{d}\\partial_{x_{i}}^{2}$ is the Laplacian, is a martingale for the Brownian filtration.\n\n\nFor example, consider the processes $X_{t}=(B_{t}^{(1)})^{2}+(B_{t}^{(2)})^{2}$ and $Y_{t}=\\exp(B_{t}^{(1)})\\cos(B_{t}^{(2)})$. Then, we have :\n\n$$\\frac{1}{2}\\int_{0}^{t}\\nabla^{2}X_{s}ds=\\frac{1}{2}\\int_{0}^{t}4ds=2t$$\n\nand\n\n\\begin{aligned}\n\\frac{1}{2}\\int_{0}^{t}\\nabla^{2}Y_{s}ds & =\\frac{1}{2}\\int_{0}^{t}0\\cdot ds=0\n\\end{aligned}\n\nThus, the processes $X_{t}-2t$ and $Y_{t}$ are martingales for the Brownian filtration. In one dimension, there are no interesting martingales constructed with functions of *space* only. Indeed, $(f(B_{t}):t\\geq0)$ is a martingale if and only if $f''(x)=0$ for all $x$. But, such functions are of the form $f(x)=ax+b$, $a,b\\in\\mathbf{R}$. In other words, in one dimension, Brownian martingales of the form $f(B_{t})$ are simply $aB_{t}+b$. Not very surprising! The situation is very different in higher dimensions. Indeed, corollary implies that $f(B_{t})$ is a martingale whenever $f$ is a harmonic function:\n\n*Definition.* A function $f:\\mathbf{R}^{d}\\to\\mathbf{R}$ is harmonic in $\\mathbf{R}^{d}$ if and only if $\\nabla^{2}f(x)\\equiv0$ for all $x\\in\\mathbf{R}^{d}$. More generally, a function $f:\\mathbf{R}^{d}\\to\\mathbf{R}$ is harmonic in the region $\\mathcal{O}\\subset\\mathbf{R}^{d}$ if and only if $\\nabla^{2}f(x)\\equiv0$ for all $x\\in\\mathcal{O}$.\n\nNote that the function $f(x)=e^{x_{1}}\\cos x_{2}$ is harmonic in $\\mathbf{R}^{d}$. This is why the process $Y_{t}=\\exp(B_{t}^{(1)})\\cos(B_{t}^{(2)})$ is a martingale. The distinction to a subset of $\\mathbf{R}^{d}$ in the above definition is important since it may happen that the function is harmonic only in a subset of the space; see for example equation. It is possible to define a Brownian martingale in such cases by considering the process until it exits the region. This will turn out to be important as we move ahead.\n\nThe multidimensional Ito's formula generalizes to functions of time and space as in proposition:\n\n*Definition.* A function $f:[0,\\infty)\\times\\mathbf{R}^{d}\\to\\mathbf{R}$ is in $\\mathcal{C}^{1,2}([0,T]\\times\\mathbf{R}^{d})$ if the partial derivative in *time* :\n\n$$\\frac{\\partial}{\\partial t}f(t,\\mathbf{x})$$\n\nexists and is continuous and the second order partial derivatives in space:\n\n$$\\frac{\\partial^{2}}{\\partial x_{i}^{2}}f(t,x_{1},x_{2},\\ldots,x_{i},\\ldots,x_{d}),\\quad1\\leq i\\leq d$$\n\nexist and are continuous.\n\n\n*Theorem.* (Ito's formula) Let $(B_{t}:t\\leq T)$ be a $d$-dimensional Brownian motion. Consider a function $f\\in\\mathcal{C}^{1,2}([0,T]\\times\\mathbf{R}^{d})$. Then, we have with\nprobability one for all $t\\leq T$:\n\n\\begin{aligned}\nf(t,B_{t})-f(0,B_{0}) & =\\sum_{i=1}^{d}\\int_{0}^{t}\\partial_{x_{i}}f(s,B_{s})dB_{s}^{(i)}+\\int_{0}^{t}\\left(\\partial_{t}f(s,B_{s})+\\sum_{i=1}^{d}\\partial_{x_{i}}^{2}f(s,B_{s})\\right)ds\n\\end{aligned}\n\n\nThe martingale condition is then similar to the ones in corollary ([\\[cor:brownian-martingales-in-Rd\\]](#cor:brownian-martingales-in-Rd){reference-type=\"ref\" reference=\"cor:brownian-martingales-in-Rd\"}): if the processes $(\\partial_{x_{i}}f(s,B_{s}),t\\leq T)\\in\\mathcal{L}_{c}^{2}(T)$ for every $1\\leq i\\leq d$, then the process\n\n$$f(t,B_{t})-\\int_{0}^{t}\\left\\{ \\partial_{t}f(s,B_{s})++\\sum_{i=1}^{d}\\partial_{x_{i}}^{2}f(s,B_{s})\\right\\} ds,\\quad t\\leq T$$\n\nis a martingale for the Brownian filtration. In particular, if $f$ satisfies the partial differential equation:\n\n\\begin{aligned}\n\\frac{\\partial f}{\\partial t}+\\frac{1}{2}\\nabla^{2}f & =0\n\\end{aligned}\n\nthen the process $(f(t,B_{t}):t\\leq T)$ itself is a martingale.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}