<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quasar">
<meta name="dcterms.date" content="2025-12-25">

<title>quantdev.blog - Hash Maps</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap')
</style>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9993009899870547" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../.././symbol.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quantdev.blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../newsletter.html" rel="" target="">
 <span class="menu-text">Newsletter</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../sell_side_quant_critical_path.html" rel="" target="">
 <span class="menu-text">Sell-side Quant</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../roadmap.html" rel="" target="">
 <span class="menu-text">C++ Roadmap</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://patreon.com/u59411143?utm_medium=unknown&amp;utm_source=join_link&amp;utm_campaign=creatorshare_creator&amp;utm_content=copyLink" rel="" target=""><i class="bi bi-patreon" role="img">
</i> 
 <span class="menu-text">Become a patreon</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/quasar-chunawala" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://linkedin.com/in/quasar-chunawala" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Hash Maps</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">C++</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Quasar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 25, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#construction" id="toc-construction" class="nav-link" data-scroll-target="#construction">Construction</a></li>
  <li><a href="#insertion" id="toc-insertion" class="nav-link" data-scroll-target="#insertion">Insertion</a></li>
  <li><a href="#search" id="toc-search" class="nav-link" data-scroll-target="#search">Search</a></li>
  <li><a href="#deletion" id="toc-deletion" class="nav-link" data-scroll-target="#deletion">Deletion</a></li>
  <li><a href="#how-to-choose-a-good-hash-function" id="toc-how-to-choose-a-good-hash-function" class="nav-link" data-scroll-target="#how-to-choose-a-good-hash-function">How to choose a good hash function?</a>
  <ul class="collapse">
  <li><a href="#how-do-you-implement-this-cleverness-function" id="toc-how-do-you-implement-this-cleverness-function" class="nav-link" data-scroll-target="#how-do-you-implement-this-cleverness-function">How do you implement this cleverness function?</a>
  <ul class="collapse">
  <li><a href="#fnv-1a" id="toc-fnv-1a" class="nav-link" data-scroll-target="#fnv-1a">FNV-1A</a></li>
  <li><a href="#murmur-hash" id="toc-murmur-hash" class="nav-link" data-scroll-target="#murmur-hash">Murmur Hash</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p><code>std::unordered_map</code> is C++â€™s hash table container, providing amortized <span class="math inline">\(O(1)\)</span> constant-time search, insertion and deletion operations with unique keys on average. In this blog post, I explore the basic API of <code>unordered_map</code>.</p>
</section>
<section id="construction" class="level1">
<h1>Construction</h1>
<p><code>std::unordered_map</code> is a class template in the header <code>&lt;unordered_map&gt;</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">namespace</span> pmr <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="kw">template</span><span class="op">&lt;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>        <span class="kw">class</span> Key<span class="op">,</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>        <span class="kw">class</span> T<span class="op">,</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>        <span class="kw">class</span> Hash <span class="op">=</span> <span class="bu">std::</span>hash<span class="op">&lt;</span>Key<span class="op">&gt;,</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>        <span class="kw">class</span> KeyEqual <span class="op">=</span> <span class="bu">std::</span>equal_to<span class="op">&lt;</span>Key<span class="op">&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="op">&gt;</span> <span class="kw">using</span> unordered_map <span class="op">=</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>          <span class="bu">std::</span>unordered_map<span class="op">&lt;</span>Key<span class="op">,</span> T<span class="op">,</span> Hash<span class="op">,</span> KeyEqual<span class="op">,</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>              <span class="bu">std::</span>pmr<span class="bu">::</span>polymorphic_allocator<span class="op">&lt;</span><span class="bu">std::</span>pair<span class="op">&lt;</span><span class="at">const</span> Key<span class="op">,</span> T<span class="op">&gt;&gt;&gt;;</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It allows you specify a custom hash function <code>hash</code>, <code>equal</code> function to compare keys and <code>alloc</code> as a custom allocator.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1"></a><span class="pp">#include </span><span class="im">&lt;unordered_map&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="pp">#include </span><span class="im">&lt;print&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="pp">#include </span><span class="im">&lt;cstddef&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>    <span class="co">// Default construction</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&gt;</span> word_count<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="co">// Initializer list construction</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;</span> symbol_to_price_levels_map </span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="op">{</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>        <span class="op">{</span><span class="st">"AAPL"</span><span class="op">,</span> <span class="op">{</span><span class="fl">100.0</span><span class="op">,</span> <span class="fl">101.0</span><span class="op">,</span> <span class="fl">102.0</span><span class="op">}},</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>        <span class="op">{</span><span class="st">"GOOG"</span><span class="op">,</span> <span class="op">{</span><span class="fl">1500.0</span><span class="op">,</span> <span class="fl">1505.0</span><span class="op">,</span> <span class="fl">1510.0</span><span class="op">}}</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>    <span class="op">};</span></span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a>    <span class="co">// with bucket count hint</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>    <span class="co">// atleast 100 buckets</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&gt;</span> map<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a>    <span class="co">// Range construction (accepts a pair of iterators)</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;</span> word_count_copy<span class="op">(</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>        word_count<span class="op">.</span>begin<span class="op">(),</span> word_count<span class="op">.</span>end<span class="op">()</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="op">);</span></span>
<span id="cb2-25"><a href="#cb2-25"></a></span>
<span id="cb2-26"><a href="#cb2-26"></a>    <span class="co">// copy construction</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>string<span class="op">&gt;</span> cache<span class="op">{</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>        <span class="op">{</span><span class="st">"Fedor Pikus"</span><span class="op">,</span> <span class="st">"Performance GOAT"</span><span class="op">},</span></span>
<span id="cb2-29"><a href="#cb2-29"></a>        <span class="op">{</span><span class="st">"Herb Sutter"</span><span class="op">,</span> <span class="st">"C++ Visionary"</span><span class="op">},</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>        <span class="op">{</span><span class="st">"John Carmack"</span><span class="op">,</span> <span class="st">"Legendary programmer"</span><span class="op">}</span></span>
<span id="cb2-31"><a href="#cb2-31"></a>    <span class="op">};</span></span>
<span id="cb2-32"><a href="#cb2-32"></a></span>
<span id="cb2-33"><a href="#cb2-33"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>string<span class="op">&gt;</span> cache_copy<span class="op">(</span>cache<span class="op">);</span></span>
<span id="cb2-34"><a href="#cb2-34"></a></span>
<span id="cb2-35"><a href="#cb2-35"></a>    <span class="co">// move construction</span></span>
<span id="cb2-36"><a href="#cb2-36"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&gt;</span> word_count2<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>word_count<span class="op">)};</span></span>
<span id="cb2-37"><a href="#cb2-37"></a></span>
<span id="cb2-38"><a href="#cb2-38"></a>    <span class="co">// with a custom hash function</span></span>
<span id="cb2-39"><a href="#cb2-39"></a>    <span class="co">// Knuth's multiplicative hash</span></span>
<span id="cb2-40"><a href="#cb2-40"></a>    <span class="kw">struct</span> CustomHash<span class="op">{</span></span>
<span id="cb2-41"><a href="#cb2-41"></a>        <span class="dt">size_t</span> <span class="kw">operator</span><span class="op">()(</span><span class="dt">int</span> key<span class="op">)</span> <span class="at">const</span><span class="op">{</span></span>
<span id="cb2-42"><a href="#cb2-42"></a>            <span class="cf">return</span> key <span class="op">*</span> <span class="dv">2654435761</span><span class="op">;</span></span>
<span id="cb2-43"><a href="#cb2-43"></a>        <span class="op">}</span></span>
<span id="cb2-44"><a href="#cb2-44"></a>    <span class="op">};</span></span>
<span id="cb2-45"><a href="#cb2-45"></a></span>
<span id="cb2-46"><a href="#cb2-46"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">uint32_t</span><span class="op">,</span> CustomHash<span class="op">&gt;</span> map_with_custom_hash<span class="op">;</span></span>
<span id="cb2-47"><a href="#cb2-47"></a></span>
<span id="cb2-48"><a href="#cb2-48"></a>    <span class="co">// with a custom hash and custom equality</span></span>
<span id="cb2-49"><a href="#cb2-49"></a>    <span class="kw">struct</span> Point<span class="op">{</span></span>
<span id="cb2-50"><a href="#cb2-50"></a>        <span class="dt">double</span> x<span class="op">;</span></span>
<span id="cb2-51"><a href="#cb2-51"></a>        <span class="dt">double</span> y<span class="op">;</span></span>
<span id="cb2-52"><a href="#cb2-52"></a></span>
<span id="cb2-53"><a href="#cb2-53"></a>        <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span><span class="at">const</span> Point<span class="op">&amp;</span> other<span class="op">)</span> <span class="at">const</span><span class="op">{</span></span>
<span id="cb2-54"><a href="#cb2-54"></a>            <span class="cf">return</span> x <span class="op">==</span> other<span class="op">.</span>x <span class="op">&amp;&amp;</span> y <span class="op">==</span> other<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb2-55"><a href="#cb2-55"></a>        <span class="op">}</span></span>
<span id="cb2-56"><a href="#cb2-56"></a>    <span class="op">};</span></span>
<span id="cb2-57"><a href="#cb2-57"></a></span>
<span id="cb2-58"><a href="#cb2-58"></a>    <span class="kw">auto</span> point_equal <span class="op">=</span> <span class="op">[](</span><span class="at">const</span> Point<span class="op">&amp;</span> a<span class="op">,</span> <span class="at">const</span> Point<span class="op">&amp;</span>b<span class="op">)</span> <span class="op">-&gt;</span> <span class="dt">bool</span><span class="op">{</span></span>
<span id="cb2-59"><a href="#cb2-59"></a>        <span class="cf">return</span> a<span class="op">.</span>x <span class="op">==</span> b<span class="op">.</span>x <span class="op">&amp;&amp;</span> a<span class="op">.</span>y <span class="op">==</span> b<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb2-60"><a href="#cb2-60"></a>    <span class="op">};</span></span>
<span id="cb2-61"><a href="#cb2-61"></a></span>
<span id="cb2-62"><a href="#cb2-62"></a>    <span class="kw">auto</span> point_hash <span class="op">=</span> <span class="op">[](</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">){</span></span>
<span id="cb2-63"><a href="#cb2-63"></a>        <span class="bu">std::</span>size_t<span class="op"> </span>h1 <span class="op">=</span> <span class="bu">std::</span>hash<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;{}(</span>x<span class="op">);</span></span>
<span id="cb2-64"><a href="#cb2-64"></a>        <span class="bu">std::</span>size_t<span class="op"> </span>h2 <span class="op">=</span> <span class="bu">std::</span>hash<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;{}(</span>y<span class="op">);</span></span>
<span id="cb2-65"><a href="#cb2-65"></a>        <span class="cf">return</span> h1 <span class="op">^</span> <span class="op">(</span>h2 <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb2-66"><a href="#cb2-66"></a>    <span class="op">};</span></span>
<span id="cb2-67"><a href="#cb2-67"></a></span>
<span id="cb2-68"><a href="#cb2-68"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span>Point<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op">,</span> </span>
<span id="cb2-69"><a href="#cb2-69"></a>        <span class="kw">decltype</span><span class="op">(</span>point_hash<span class="op">),</span> <span class="kw">decltype</span><span class="op">(</span>point_equal<span class="op">)&gt;</span> points_map<span class="op">;</span></span>
<span id="cb2-70"><a href="#cb2-70"></a></span>
<span id="cb2-71"><a href="#cb2-71"></a>    <span class="co">// from a vector of pairs</span></span>
<span id="cb2-72"><a href="#cb2-72"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-73"><a href="#cb2-73"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="https://compiler-explorer.com/z/Ys83asq47">Compiler Explorer</a></p>
</section>
<section id="insertion" class="level1">
<h1>Insertion</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1"></a><span class="pp">#include </span><span class="im">&lt;unordered_map&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="pp">#include </span><span class="im">&lt;print&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="pp">#include </span><span class="im">&lt;cstddef&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="pp">#include </span><span class="im">&lt;utility&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>string<span class="op">&gt;</span> map<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="co">// array index operator</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>    map<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Carl Gauss"</span><span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>    map<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Augustin Louis Cauchy"</span><span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="co">// insert(pair(k,v))</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="co">// returns pair&lt;iterator,bool&gt;. bool is true</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>    <span class="co">// if the insert succeeds, else false</span></span>
<span id="cb3-17"><a href="#cb3-17"></a>    <span class="kw">auto</span> <span class="op">[</span>it1<span class="op">,</span> success1<span class="op">]</span> <span class="op">=</span> map<span class="op">.</span>insert<span class="op">(</span><span class="bu">std::</span>make_pair<span class="op">(</span> <span class="dv">3</span><span class="op">,</span> <span class="st">"Joseph Fourier"</span> <span class="op">));</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="kw">auto</span> <span class="op">[</span>it2<span class="op">,</span> success2<span class="op">]</span> <span class="op">=</span> map<span class="op">.</span>insert<span class="op">(</span><span class="bu">std::</span>make_pair<span class="op">(</span> <span class="dv">4</span><span class="op">,</span> <span class="st">"Josepph Lagrange"</span><span class="op">));</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>    </span>
<span id="cb3-20"><a href="#cb3-20"></a>    <span class="co">// void insert(initializer_list)</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>    <span class="co">// insert from an initializer list</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>    map<span class="op">.</span>insert<span class="op">(</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>    <span class="op">{</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>        <span class="op">{</span><span class="dv">5</span><span class="op">,</span> <span class="st">"Riemann"</span><span class="op">},</span></span>
<span id="cb3-25"><a href="#cb3-25"></a>        <span class="op">{</span><span class="dv">6</span><span class="op">,</span> <span class="st">"Ada Lovelace"</span><span class="op">}</span></span>
<span id="cb3-26"><a href="#cb3-26"></a>    <span class="op">});</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>    </span>
<span id="cb3-28"><a href="#cb3-28"></a>    <span class="co">// emplace(Args&amp;&amp; ...)</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>    <span class="co">// inserts a new element into the container constructed</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>    <span class="co">// in-place with the given args, if there is no element</span></span>
<span id="cb3-31"><a href="#cb3-31"></a>    <span class="co">// with the key in the container</span></span>
<span id="cb3-32"><a href="#cb3-32"></a>    <span class="kw">auto</span> <span class="op">[</span>it3<span class="op">,</span> success3<span class="op">]</span> <span class="op">=</span> map<span class="op">.</span>emplace<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="st">"Leonard Euler"</span><span class="op">);</span></span>
<span id="cb3-33"><a href="#cb3-33"></a></span>
<span id="cb3-34"><a href="#cb3-34"></a>    <span class="co">// The new element may be constructed even if there already</span></span>
<span id="cb3-35"><a href="#cb3-35"></a>    <span class="co">// is an element with the key in the container, in which case</span></span>
<span id="cb3-36"><a href="#cb3-36"></a>    <span class="co">// the newly constructed element will be destroyed immediately</span></span>
<span id="cb3-37"><a href="#cb3-37"></a>    <span class="dt">int</span> k <span class="op">{</span><span class="dv">7</span><span class="op">};</span></span>
<span id="cb3-38"><a href="#cb3-38"></a>    <span class="bu">std::</span>string<span class="op"> </span>v <span class="op">{</span> <span class="st">"David Hilbert"</span> <span class="op">};</span></span>
<span id="cb3-39"><a href="#cb3-39"></a>    <span class="bu">std::</span>println<span class="op">(</span><span class="st">"emplace(</span><span class="sc">{}</span><span class="st">, </span><span class="sc">{}</span><span class="st">) called"</span><span class="op">,</span> k<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb3-40"><a href="#cb3-40"></a></span>
<span id="cb3-41"><a href="#cb3-41"></a>    <span class="kw">auto</span> <span class="op">[</span>it4<span class="op">,</span> success4<span class="op">]</span> <span class="op">=</span> map<span class="op">.</span>emplace<span class="op">(</span>k<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb3-42"><a href="#cb3-42"></a>    <span class="bu">std::</span>println<span class="op">(</span><span class="st">"success flag : </span><span class="sc">{}</span><span class="st">"</span><span class="op">,</span> success4<span class="op">);</span></span>
<span id="cb3-43"><a href="#cb3-43"></a></span>
<span id="cb3-44"><a href="#cb3-44"></a>    <span class="co">// try_emplace(Key&amp;&amp;, Args&amp;&amp;)</span></span>
<span id="cb3-45"><a href="#cb3-45"></a>    <span class="co">// if the key k already exists in the container, do nothing</span></span>
<span id="cb3-46"><a href="#cb3-46"></a>    <span class="co">// Otherwise, insert a new element into the container</span></span>
<span id="cb3-47"><a href="#cb3-47"></a>    <span class="co">// with key k and value constructed with args</span></span>
<span id="cb3-48"><a href="#cb3-48"></a>    <span class="kw">auto</span> <span class="op">[</span>it5<span class="op">,</span> success5<span class="op">]</span> <span class="op">=</span> map<span class="op">.</span>try_emplace<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="st">"David Hilbert"</span><span class="op">);</span></span>
<span id="cb3-49"><a href="#cb3-49"></a></span>
<span id="cb3-50"><a href="#cb3-50"></a>    <span class="co">// range insert - takes a pair of iterators</span></span>
<span id="cb3-51"><a href="#cb3-51"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>string<span class="op">&gt;&gt;</span> vec<span class="op">{</span></span>
<span id="cb3-52"><a href="#cb3-52"></a>        <span class="op">{</span><span class="dv">9</span><span class="op">,</span> <span class="st">"Andrew Kolmogorov"</span><span class="op">},</span></span>
<span id="cb3-53"><a href="#cb3-53"></a>        <span class="op">{</span><span class="dv">10</span><span class="op">,</span> <span class="st">"Emile Borel"</span><span class="op">}</span></span>
<span id="cb3-54"><a href="#cb3-54"></a>    <span class="op">};</span></span>
<span id="cb3-55"><a href="#cb3-55"></a></span>
<span id="cb3-56"><a href="#cb3-56"></a>    map<span class="op">.</span>insert<span class="op">(</span>vec<span class="op">.</span>begin<span class="op">(),</span> vec<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb3-57"><a href="#cb3-57"></a></span>
<span id="cb3-58"><a href="#cb3-58"></a>    <span class="co">// insert_range(R&amp;&amp; rg)</span></span>
<span id="cb3-59"><a href="#cb3-59"></a>    <span class="co">// Inserts a copyn of each element in the range rg </span></span>
<span id="cb3-60"><a href="#cb3-60"></a>    <span class="co">// if and only if each of the keys are not </span></span>
<span id="cb3-61"><a href="#cb3-61"></a>    <span class="co">// already present in the map</span></span>
<span id="cb3-62"><a href="#cb3-62"></a>    <span class="at">const</span> <span class="kw">auto</span> rg <span class="op">=</span> <span class="op">{</span><span class="bu">std::</span>pair<span class="op">{</span><span class="dv">11</span><span class="op">,</span> <span class="st">"Guido Cantelli"</span><span class="op">},</span> <span class="op">{</span><span class="dv">12</span><span class="op">,</span> <span class="st">"Terrence Tao"</span><span class="op">}};</span></span>
<span id="cb3-63"><a href="#cb3-63"></a>    map<span class="op">.</span>insert_range<span class="op">(</span>rg<span class="op">);</span></span>
<span id="cb3-64"><a href="#cb3-64"></a></span>
<span id="cb3-65"><a href="#cb3-65"></a>    <span class="co">// insert_or_assign(key, obj)</span></span>
<span id="cb3-66"><a href="#cb3-66"></a>    <span class="co">// If a key k already exists in the container, assigns</span></span>
<span id="cb3-67"><a href="#cb3-67"></a>    <span class="co">// obj to the key k. If the key k does not exist, </span></span>
<span id="cb3-68"><a href="#cb3-68"></a>    <span class="co">// it inserts the new value as if by insert.</span></span>
<span id="cb3-69"><a href="#cb3-69"></a>    <span class="kw">auto</span> <span class="op">[</span>it6<span class="op">,</span> success6<span class="op">]</span> <span class="op">=</span> map<span class="op">.</span>insert_or_assign<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="st">"William Feller"</span><span class="op">);</span></span>
<span id="cb3-70"><a href="#cb3-70"></a>    <span class="kw">auto</span> <span class="op">[</span>it7<span class="op">,</span> success7<span class="op">]</span> <span class="op">=</span> map<span class="op">.</span>insert_or_assign<span class="op">(</span><span class="dv">13</span><span class="op">,</span> <span class="st">"Andrew Wiles"</span><span class="op">);</span></span>
<span id="cb3-71"><a href="#cb3-71"></a>    </span>
<span id="cb3-72"><a href="#cb3-72"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-73"><a href="#cb3-73"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="https://compiler-explorer.com/z/bhW3rz653">Compiler Explorer</a></p>
</section>
<section id="search" class="level1">
<h1>Search</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1"></a><span class="pp">#include </span><span class="im">&lt;unordered_map&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="pp">#include </span><span class="im">&lt;print&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="pp">#include </span><span class="im">&lt;cstddef&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="pp">#include </span><span class="im">&lt;utility&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">struct</span> PhoneRecord<span class="op">{</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="bu">std::</span>string<span class="op"> </span>full_name<span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="bu">std::</span>string<span class="op"> </span>address<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>    <span class="bu">std::</span>string<span class="op"> </span>phone<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="bu">std::</span>string<span class="op"> </span>pin<span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="op">};</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> PhoneRecord<span class="op">&gt;</span> phone_book<span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>    phone_book<span class="op">.</span>insert<span class="op">({</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>        <span class="op">{</span><span class="st">"John Smith"</span><span class="op">,</span> <span class="op">{</span><span class="st">"John Smith"</span><span class="op">,</span> <span class="st">"123 Main Street, New York, NY 10001"</span><span class="op">,</span> <span class="st">"(212) 555-1234"</span><span class="op">,</span> <span class="st">"1234"</span><span class="op">}},</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>        <span class="op">{</span><span class="st">"Mary Johnson"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Mary Johnson"</span><span class="op">,</span> <span class="st">"456 Oak Avenue, Los Angeles, CA 90001"</span><span class="op">,</span> <span class="st">"(213) 555-2345"</span><span class="op">,</span> <span class="st">"2345"</span><span class="op">}},</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>        <span class="op">{</span><span class="st">"Robert Williams"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Robert Williams"</span><span class="op">,</span> <span class="st">"789 Pine Road, Chicago, IL 60601"</span><span class="op">,</span> <span class="st">"(312) 555-3456"</span><span class="op">,</span> <span class="st">"3456"</span><span class="op">}},</span></span>
<span id="cb4-19"><a href="#cb4-19"></a>        <span class="op">{</span><span class="st">"Patricia Brown"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Patricia Brown"</span><span class="op">,</span> <span class="st">"321 Maple Drive, Houston, TX 77001"</span><span class="op">,</span> <span class="st">"(713) 555-4567"</span><span class="op">,</span> <span class="st">"4567"</span><span class="op">}},</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>        <span class="op">{</span><span class="st">"Michael Jones"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Michael Jones"</span><span class="op">,</span> <span class="st">"654 Cedar Lane, Phoenix, AZ 85001"</span><span class="op">,</span> <span class="st">"(602) 555-5678"</span><span class="op">,</span> <span class="st">"5678"</span><span class="op">}},</span></span>
<span id="cb4-21"><a href="#cb4-21"></a>        <span class="op">{</span><span class="st">"Linda Garcia"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Linda Garcia"</span><span class="op">,</span> <span class="st">"987 Elm Court, Philadelphia, PA 19101"</span><span class="op">,</span> <span class="st">"(215) 555-6789"</span><span class="op">,</span> <span class="st">"6789"</span><span class="op">}},</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>        <span class="op">{</span><span class="st">"David Miller"</span><span class="op">,</span> <span class="op">{</span><span class="st">"David Miller"</span><span class="op">,</span> <span class="st">"147 Birch Place, San Antonio, TX 78201"</span><span class="op">,</span> <span class="st">"(210) 555-7890"</span><span class="op">,</span> <span class="st">"7890"</span><span class="op">}},</span></span>
<span id="cb4-23"><a href="#cb4-23"></a>        <span class="op">{</span><span class="st">"Barbara Davis"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Barbara Davis"</span><span class="op">,</span> <span class="st">"258 Walnut Boulevard, San Diego, CA 92101"</span><span class="op">,</span> <span class="st">"(619) 555-8901"</span><span class="op">,</span> <span class="st">"8901"</span><span class="op">}},</span></span>
<span id="cb4-24"><a href="#cb4-24"></a>        <span class="op">{</span><span class="st">"Richard Rodriguez"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Richard Rodriguez"</span><span class="op">,</span> <span class="st">"369 Cherry Way, Dallas, TX 75201"</span><span class="op">,</span> <span class="st">"(214) 555-9012"</span><span class="op">,</span> <span class="st">"9012"</span><span class="op">}},</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>        <span class="op">{</span><span class="st">"Susan Martinez"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Susan Martinez"</span><span class="op">,</span> <span class="st">"741 Hickory Circle, San Jose, CA 95101"</span><span class="op">,</span> <span class="st">"(408) 555-0123"</span><span class="op">,</span> <span class="st">"0123"</span><span class="op">}},</span></span>
<span id="cb4-26"><a href="#cb4-26"></a>        <span class="op">{</span><span class="st">"Joseph Hernandez"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Joseph Hernandez"</span><span class="op">,</span> <span class="st">"852 Willow Terrace, Austin, TX 78701"</span><span class="op">,</span> <span class="st">"(512) 555-1235"</span><span class="op">,</span> <span class="st">"1235"</span><span class="op">}},</span></span>
<span id="cb4-27"><a href="#cb4-27"></a>        <span class="op">{</span><span class="st">"Jessica Lopez"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Jessica Lopez"</span><span class="op">,</span> <span class="st">"963 Poplar Parkway, Jacksonville, FL 32099"</span><span class="op">,</span> <span class="st">"(904) 555-2346"</span><span class="op">,</span> <span class="st">"2346"</span><span class="op">}},</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>        <span class="op">{</span><span class="st">"Thomas Gonzalez"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Thomas Gonzalez"</span><span class="op">,</span> <span class="st">"159 Sycamore Trail, Fort Worth, TX 76101"</span><span class="op">,</span> <span class="st">"(817) 555-3457"</span><span class="op">,</span> <span class="st">"3457"</span><span class="op">}},</span></span>
<span id="cb4-29"><a href="#cb4-29"></a>        <span class="op">{</span><span class="st">"Sarah Wilson"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Sarah Wilson"</span><span class="op">,</span> <span class="st">"357 Ash Street, Columbus, OH 43085"</span><span class="op">,</span> <span class="st">"(614) 555-4568"</span><span class="op">,</span> <span class="st">"4568"</span><span class="op">}},</span></span>
<span id="cb4-30"><a href="#cb4-30"></a>        <span class="op">{</span><span class="st">"Charles Anderson"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Charles Anderson"</span><span class="op">,</span> <span class="st">"486 Magnolia Avenue, Charlotte, NC 28201"</span><span class="op">,</span> <span class="st">"(704) 555-5679"</span><span class="op">,</span> <span class="st">"5679"</span><span class="op">}},</span></span>
<span id="cb4-31"><a href="#cb4-31"></a>        <span class="op">{</span><span class="st">"Karen Thomas"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Karen Thomas"</span><span class="op">,</span> <span class="st">"753 Dogwood Road, San Francisco, CA 94101"</span><span class="op">,</span> <span class="st">"(415) 555-6780"</span><span class="op">,</span> <span class="st">"6780"</span><span class="op">}},</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>        <span class="op">{</span><span class="st">"Christopher Taylor"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Christopher Taylor"</span><span class="op">,</span> <span class="st">"951 Redwood Drive, Indianapolis, IN 46201"</span><span class="op">,</span> <span class="st">"(317) 555-7891"</span><span class="op">,</span> <span class="st">"7891"</span><span class="op">}},</span></span>
<span id="cb4-33"><a href="#cb4-33"></a>        <span class="op">{</span><span class="st">"Nancy Moore"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Nancy Moore"</span><span class="op">,</span> <span class="st">"246 Sequoia Lane, Seattle, WA 98101"</span><span class="op">,</span> <span class="st">"(206) 555-8902"</span><span class="op">,</span> <span class="st">"8902"</span><span class="op">}},</span></span>
<span id="cb4-34"><a href="#cb4-34"></a>        <span class="op">{</span><span class="st">"Daniel Jackson"</span><span class="op">,</span> <span class="op">{</span><span class="st">"Daniel Jackson"</span><span class="op">,</span> <span class="st">"135 Fir Court, Denver, CO 80201"</span><span class="op">,</span> <span class="st">"(303) 555-9013"</span><span class="op">,</span> <span class="st">"9013"</span><span class="op">}},</span>        </span>
<span id="cb4-35"><a href="#cb4-35"></a>    <span class="op">});</span></span>
<span id="cb4-36"><a href="#cb4-36"></a></span>
<span id="cb4-37"><a href="#cb4-37"></a>    <span class="co">// iter = find(const Key&amp; key);</span></span>
<span id="cb4-38"><a href="#cb4-38"></a>    <span class="kw">auto</span> it <span class="op">=</span> phone_book<span class="op">.</span>find<span class="op">(</span><span class="st">"Robert Williams"</span><span class="op">);</span></span>
<span id="cb4-39"><a href="#cb4-39"></a>    <span class="cf">if</span><span class="op">(</span>it <span class="op">!=</span> phone_book<span class="op">.</span>end<span class="op">()){</span></span>
<span id="cb4-40"><a href="#cb4-40"></a>        <span class="kw">auto</span> <span class="op">[</span>name<span class="op">,</span> record<span class="op">]</span> <span class="op">=</span> <span class="op">*</span>it<span class="op">;</span></span>
<span id="cb4-41"><a href="#cb4-41"></a>        <span class="bu">std::</span>println<span class="op">(</span><span class="st">"Key = </span><span class="sc">{}</span><span class="st">"</span><span class="op">,</span> name<span class="op">);</span></span>
<span id="cb4-42"><a href="#cb4-42"></a>        <span class="bu">std::</span>println<span class="op">(</span><span class="st">"Full name = </span><span class="sc">{}</span><span class="st">"</span><span class="op">,</span> record<span class="op">.</span>full_name<span class="op">);</span></span>
<span id="cb4-43"><a href="#cb4-43"></a>        <span class="bu">std::</span>println<span class="op">(</span><span class="st">"Address = </span><span class="sc">{}</span><span class="st">"</span><span class="op">,</span> record<span class="op">.</span>address<span class="op">);</span></span>
<span id="cb4-44"><a href="#cb4-44"></a>        <span class="bu">std::</span>println<span class="op">(</span><span class="st">"Phone = </span><span class="sc">{}</span><span class="st">"</span><span class="op">,</span> record<span class="op">.</span>phone<span class="op">);</span></span>
<span id="cb4-45"><a href="#cb4-45"></a>    <span class="op">}</span></span>
<span id="cb4-46"><a href="#cb4-46"></a></span>
<span id="cb4-47"><a href="#cb4-47"></a>    <span class="co">// contains(), at()</span></span>
<span id="cb4-48"><a href="#cb4-48"></a>    <span class="bu">std::</span>string<span class="op"> </span>key <span class="op">{</span><span class="st">"Robert Williams"</span><span class="op">};</span></span>
<span id="cb4-49"><a href="#cb4-49"></a>    <span class="cf">if</span><span class="op">(</span>phone_book<span class="op">.</span>contains<span class="op">(</span>key<span class="op">))</span></span>
<span id="cb4-50"><a href="#cb4-50"></a>    <span class="op">{</span></span>
<span id="cb4-51"><a href="#cb4-51"></a>        <span class="bu">std::</span>println<span class="op">(</span><span class="st">"Key exists: </span><span class="sc">{}</span><span class="st">"</span><span class="op">,</span> key<span class="op">);</span></span>
<span id="cb4-52"><a href="#cb4-52"></a>        <span class="kw">auto</span> record <span class="op">=</span> phone_book<span class="op">.</span>at<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb4-53"><a href="#cb4-53"></a>    <span class="op">}</span></span>
<span id="cb4-54"><a href="#cb4-54"></a></span>
<span id="cb4-55"><a href="#cb4-55"></a>    <span class="co">// Array index operator</span></span>
<span id="cb4-56"><a href="#cb4-56"></a>    <span class="co">// operator[]() returns a reference to the value that</span></span>
<span id="cb4-57"><a href="#cb4-57"></a>    <span class="co">// is mapped to the key k, performing an insertion if</span></span>
<span id="cb4-58"><a href="#cb4-58"></a>    <span class="co">// such a key does not exist.</span></span>
<span id="cb4-59"><a href="#cb4-59"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="dt">char</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> letter_counts<span class="op">{{</span><span class="ch">'a'</span><span class="op">,</span> <span class="dv">27</span><span class="op">},</span> <span class="op">{</span><span class="ch">'b'</span><span class="op">,</span> <span class="dv">3</span><span class="op">},</span> <span class="op">{</span><span class="ch">'c'</span><span class="op">,</span> <span class="dv">1</span><span class="op">}};</span></span>
<span id="cb4-60"><a href="#cb4-60"></a>    println<span class="op">(</span><span class="st">"letter_counts initially contains: </span><span class="sc">{}</span><span class="st">"</span><span class="op">,</span> letter_counts<span class="op">);</span></span>
<span id="cb4-61"><a href="#cb4-61"></a>    <span class="dt">int</span> result1 <span class="op">=</span> letter_counts<span class="op">[</span><span class="ch">'a'</span><span class="op">];</span>   <span class="co">// ok</span></span>
<span id="cb4-62"><a href="#cb4-62"></a>    <span class="dt">int</span> result2 <span class="op">=</span> letter_counts<span class="op">[</span><span class="ch">'d'</span><span class="op">];</span>   <span class="co">// just inserts the pair ('d', 0)</span></span>
<span id="cb4-63"><a href="#cb4-63"></a>    println<span class="op">(</span><span class="st">"letter_counts now contains: </span><span class="sc">{}</span><span class="st">"</span><span class="op">,</span> letter_counts<span class="op">);</span></span>
<span id="cb4-64"><a href="#cb4-64"></a></span>
<span id="cb4-65"><a href="#cb4-65"></a>    <span class="co">// at(Key&amp; key)</span></span>
<span id="cb4-66"><a href="#cb4-66"></a>    <span class="co">// Returns a reference to the mapped value of the element</span></span>
<span id="cb4-67"><a href="#cb4-67"></a>    <span class="co">// with specified key. If no such element exists, an</span></span>
<span id="cb4-68"><a href="#cb4-68"></a>    <span class="co">// exception of the type std::out_of_range is thrown.</span></span>
<span id="cb4-69"><a href="#cb4-69"></a>    <span class="dt">int</span> result3 <span class="op">=</span> letter_counts<span class="op">.</span>at<span class="op">(</span><span class="ch">'a'</span><span class="op">);</span>   </span>
<span id="cb4-70"><a href="#cb4-70"></a>    <span class="cf">try</span><span class="op">{</span></span>
<span id="cb4-71"><a href="#cb4-71"></a>        <span class="dt">int</span> result4 <span class="op">=</span> letter_counts<span class="op">.</span>at<span class="op">(</span><span class="ch">'e'</span><span class="op">);</span></span>
<span id="cb4-72"><a href="#cb4-72"></a>    <span class="op">}</span><span class="cf">catch</span><span class="op">(</span><span class="bu">std::</span>out_of_range<span class="op">&amp;</span> ex<span class="op">){</span></span>
<span id="cb4-73"><a href="#cb4-73"></a>        <span class="bu">std::</span>println<span class="op">(</span><span class="st">"Out of range exception occured!"</span><span class="op">);</span></span>
<span id="cb4-74"><a href="#cb4-74"></a>    <span class="op">}</span></span>
<span id="cb4-75"><a href="#cb4-75"></a>    </span>
<span id="cb4-76"><a href="#cb4-76"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-77"><a href="#cb4-77"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="https://compiler-explorer.com/z/9E4d78n4E">Compiler Explorer</a></p>
</section>
<section id="deletion" class="level1">
<h1>Deletion</h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1"></a><span class="pp">#include </span><span class="im">&lt;unordered_map&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="pp">#include </span><span class="im">&lt;print&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="pp">#include </span><span class="im">&lt;cstddef&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="pp">#include </span><span class="im">&lt;utility&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">struct</span> PhoneRecord<span class="op">{</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="bu">std::</span>string<span class="op"> </span>full_name<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>    <span class="bu">std::</span>string<span class="op"> </span>address<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="bu">std::</span>string<span class="op"> </span>phone<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="bu">std::</span>string<span class="op"> </span>pin<span class="op">;</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="op">};</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="bu">std::</span>unordered_map<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>string<span class="op">&gt;</span> map<span class="op">{</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>        <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="st">"one"</span><span class="op">},</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="st">"two"</span><span class="op">},</span> <span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="st">"three"</span><span class="op">},</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>        <span class="op">{</span><span class="dv">4</span><span class="op">,</span> <span class="st">"four"</span><span class="op">},</span> <span class="op">{</span><span class="dv">5</span><span class="op">,</span> <span class="st">"five"</span><span class="op">},</span> <span class="op">{</span><span class="dv">6</span><span class="op">,</span> <span class="st">"six"</span><span class="op">}</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="op">};</span></span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a>    <span class="co">// erase(pos) by iterator</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>    <span class="co">// It removes the specified element from the container</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>    <span class="co">// and returns an iterator following the last modified</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>    <span class="co">// element.</span></span>
<span id="cb5-23"><a href="#cb5-23"></a></span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="co">// The order of the remaining elements is preserved.</span></span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="co">// This makes it possible to erase individual elements</span></span>
<span id="cb5-26"><a href="#cb5-26"></a>    <span class="co">// while iterating the container.</span></span>
<span id="cb5-27"><a href="#cb5-27"></a></span>
<span id="cb5-28"><a href="#cb5-28"></a>    <span class="co">// pos is an iterator to the element to be removed.</span></span>
<span id="cb5-29"><a href="#cb5-29"></a>    <span class="co">// Any references and iterators to erased elements </span></span>
<span id="cb5-30"><a href="#cb5-30"></a>    <span class="co">// are invalidated. </span></span>
<span id="cb5-31"><a href="#cb5-31"></a>    <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> it<span class="op">{</span>map<span class="op">.</span>begin<span class="op">()};</span> it<span class="op">!=</span>map<span class="op">.</span>end<span class="op">();){</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>        <span class="cf">if</span><span class="op">(</span>it<span class="op">-&gt;</span>first <span class="op">%</span> <span class="dv">2</span> <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb5-33"><a href="#cb5-33"></a>            it <span class="op">=</span> map<span class="op">.</span>erase<span class="op">(</span>it<span class="op">);</span></span>
<span id="cb5-34"><a href="#cb5-34"></a>        <span class="cf">else</span></span>
<span id="cb5-35"><a href="#cb5-35"></a>            <span class="op">++</span>it<span class="op">;</span></span>
<span id="cb5-36"><a href="#cb5-36"></a>    <span class="op">}</span></span>
<span id="cb5-37"><a href="#cb5-37"></a></span>
<span id="cb5-38"><a href="#cb5-38"></a>    <span class="co">// erase(key) by key</span></span>
<span id="cb5-39"><a href="#cb5-39"></a>    <span class="co">// It removes the element (if one exists) with the key.</span></span>
<span id="cb5-40"><a href="#cb5-40"></a>    <span class="co">// It returns the number of elements removed (0 or 1).</span></span>
<span id="cb5-41"><a href="#cb5-41"></a>    <span class="bu">std::</span>size_t<span class="op"> </span>num_elements_removed <span class="op">=</span> map<span class="op">.</span>erase<span class="op">(</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb5-42"><a href="#cb5-42"></a></span>
<span id="cb5-43"><a href="#cb5-43"></a>    <span class="co">// clear</span></span>
<span id="cb5-44"><a href="#cb5-44"></a>    <span class="co">// clear() removes all elements</span></span>
<span id="cb5-45"><a href="#cb5-45"></a>    map<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb5-46"><a href="#cb5-46"></a></span>
<span id="cb5-47"><a href="#cb5-47"></a>    <span class="co">// node_type extract(pos)</span></span>
<span id="cb5-48"><a href="#cb5-48"></a>    <span class="co">// unlinks the node that contains the element pointed to </span></span>
<span id="cb5-49"><a href="#cb5-49"></a>    <span class="co">// by pos and returns a node handle that owns it.</span></span>
<span id="cb5-50"><a href="#cb5-50"></a>    </span>
<span id="cb5-51"><a href="#cb5-51"></a>    <span class="co">// node_type extract(key)</span></span>
<span id="cb5-52"><a href="#cb5-52"></a>    <span class="co">// unlinks the node corresponding to key and returns</span></span>
<span id="cb5-53"><a href="#cb5-53"></a>    <span class="co">// a node_handle to it, else returns an empty node_handle</span></span>
<span id="cb5-54"><a href="#cb5-54"></a>    </span>
<span id="cb5-55"><a href="#cb5-55"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="https://compiler-explorer.com/z/6TdzxM7Px">Compiler Explorer</a></p>
</section>
<section id="how-to-choose-a-good-hash-function" class="level1">
<h1>How to choose a good hash function?</h1>
<ul>
<li>Input data often has patterns and is <em>not random</em>. So, good hash functions should generate hash values that are uniformly distributed.</li>
<li>Avalanche effect. A small change in the hash function (e.g.&nbsp;flipping a single bit) should change the output significantly.</li>
<li>Hash functions should be fast. Cryptographic hash functions like SHA-1, SHA-256, SHA-512, MD-5 are extremely secure, and we use them everyday for encryption, checksumming etc. but they are slow to compute. They are designed such that it is maximally difficult to produce collisions.</li>
<li>Sometimes you are tracking large datasets e.g.&nbsp;a genetic dataset and you just want to know, if you have seen it before. You donâ€™t want to keep the whole thing in a <code>std::set</code>, because your memory usage is going to skyrocket. Instead, you want to just keep a number that represents it.</li>
</ul>
<p>At itâ€™s core, a hash function can simply be described as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">def</span> hash_function(data: <span class="bu">bytes</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb6-2"><a href="#cb6-2"></a>    <span class="cf">for</span> chunk <span class="kw">in</span> data:</span>
<span id="cb6-3"><a href="#cb6-3"></a>        <span class="bu">hash</span> <span class="op">=</span> cleverness(<span class="bu">hash</span>, chunk)</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="cf">return</span> <span class="bu">hash</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Basically, you have a rolling hash value, we can think of it as a context or a state, but its ultimately just a number and we have a block of input data <code>chunk</code> (perhaps <span class="math inline">\(1\)</span> byte or <span class="math inline">\(4\)</span> bytes), and you mix those and then you will generate another number. Now, you may have some pre- and post- processing depending on the function, but thatâ€™s pretty much how it works. The <code>cleverness</code> thing is actually whatâ€™s called a <em>mixing</em> function. If you ever see the word <em>mixing</em> function on the wikipedia page, this is what it refers to.</p>
<section id="how-do-you-implement-this-cleverness-function" class="level2">
<h2 class="anchored" data-anchor-id="how-do-you-implement-this-cleverness-function">How do you implement this cleverness function?</h2>
<p>In general you do it with unsigned, fixed length integers. You use:</p>
<ul>
<li>Bitwise operations (xor, rotation, unsigned bit shifts)</li>
<li>Multiplication</li>
<li>Usually, there is atleast one magic number e.g.&nbsp;a prime number.</li>
</ul>
<p>In hash table implementations, buckets are often a power of <span class="math inline">\(2\)</span> e.g.&nbsp;you might have <span class="math inline">\(128\)</span> buckets or <span class="math inline">\(256\)</span>. If you have the same factorization of the number of buckets as some of the constants to manipulate the state of the hash function, you can end up bucketing everything actually into the same thing.</p>
<section id="fnv-1a" class="level3">
<h3 class="anchored" data-anchor-id="fnv-1a">FNV-1A</h3>
<p>FNV1-A is venerable hash function created by Fowler, Knoll and Vo in 1991 and has been improved a couple of times since. Itâ€™s still in wide use today.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1"></a><span class="pp">#include </span><span class="im">&lt;cstddef&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="pp">#include </span><span class="im">&lt;cstdint&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="dt">uint32_t</span> fnv1a32<span class="op">(</span><span class="bu">std::</span>byte<span class="op">*</span> bytes<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op"> </span>num_bytes<span class="op">){</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="co">// This is actually the hash of the email </span></span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="co">// signatures of one of the creators of FNV.</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="dt">uint32_t</span> hash <span class="op">=</span> <span class="dv">2166136261</span><span class="op">;</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> i<span class="op">{</span><span class="dv">0</span><span class="bu">uz</span><span class="op">};</span> i<span class="op">&lt;</span>num_bytes<span class="op">;</span> <span class="op">++</span>i<span class="op">){</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>        hash <span class="op">^=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>bytes<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>        hash <span class="op">*=</span> <span class="dv">16777619</span><span class="op">;</span></span>
<span id="cb7-11"><a href="#cb7-11"></a></span>
<span id="cb7-12"><a href="#cb7-12"></a>    <span class="op">}</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="cf">return</span> hash<span class="op">;</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="https://compiler-explorer.com/z/z4a9nsPez">Compiler Explorer</a> Suppose that the input string is <code>"ab"</code>. We get the following hash code from the FNV algorithm:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource shell number-lines code-with-copy"><code class="sourceCode"><span id="cb8-1"><a href="#cb8-1"></a>hash(0) = 10000001000111001001110111000101</span>
<span id="cb8-2"><a href="#cb8-2"></a>byte[0] =                          1100001</span>
<span id="cb8-3"><a href="#cb8-3"></a>XOR     = 10000001000111001001110110100100</span>
<span id="cb8-4"><a href="#cb8-4"></a>hash(1) = 11100100000011000010100100101100</span>
<span id="cb8-5"><a href="#cb8-5"></a>byte[1] =                          1100010</span>
<span id="cb8-6"><a href="#cb8-6"></a>XOR     = 11100100000011000010100101001110</span>
<span id="cb8-7"><a href="#cb8-7"></a>hash(2) =  1001101001001010000010111001010</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The XOR changes only a few bits, so thatâ€™s why the multiplier is there. Actually, <span class="math inline">\(16777619\)</span> is the prime closest to <span class="math inline">\(2^24\)</span>. It gives you bit-shifting behavior as well. FNV1a kind of hides this bit-shifting, but every other algorithm uses bit shifts heavily to get this avalanche behavior. So, what this is doing is, itâ€™s going to shift everything and then its going add some noise to the lower end of the number.</p>
<p><code>16'777'619</code> in binary is <code>0b0000 0001 0000 0000 0000 0001 1001 0011</code>. When you multiply this number, you are essentially doing:</p>
<p><span class="math display">\[
hash \times 16777619 = hash \times (2^{24} + 2^8 + 2^7 + 2^4 + 2^1 + 2^0)
\]</span></p>
<p>To keep things simple, consider the value <code>5 = 0b0101</code>. Assume we multiply <span class="math inline">\(5 \times 8 = 5 \times 2^3\)</span>. Using the rules of binary multiplication, we get:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource shell number-lines code-with-copy"><code class="sourceCode"><span id="cb9-1"><a href="#cb9-1"></a> 0b0000 0101</span>
<span id="cb9-2"><a href="#cb9-2"></a>x0b0000 1000</span>
<span id="cb9-3"><a href="#cb9-3"></a>------------</span>
<span id="cb9-4"><a href="#cb9-4"></a>           0</span>
<span id="cb9-5"><a href="#cb9-5"></a>          00</span>
<span id="cb9-6"><a href="#cb9-6"></a>         000</span>
<span id="cb9-7"><a href="#cb9-7"></a> 0b 010 1000</span>
<span id="cb9-8"><a href="#cb9-8"></a>------------</span>
<span id="cb9-9"><a href="#cb9-9"></a> 0b 010 1000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Hence, <code>x * 2^3</code> is like <code>x &lt;&lt; 3</code>.</p>
<p>So, the first byte <code>a = 0b0110 0001</code> has a hash value of <code>0b1110 0100 0000 1100 0010 1001 0010 1100</code>. If we look at the next byte <code>b = 0b0110 0010</code>, it has just 2 bits different from the first byte, but the hash value is <code>0b0100 1101 0010 0101 0000 0101 1100 1010</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource shell number-lines code-with-copy"><code class="sourceCode"><span id="cb10-1"><a href="#cb10-1"></a>0b1110 0100 0000 1100 0010 1001 0010 1100</span>
<span id="cb10-2"><a href="#cb10-2"></a>0b0100 1101 0010 0101 0000 0101 1100 1010</span>
<span id="cb10-3"><a href="#cb10-3"></a>  ^ ^  ^  ^   ^  ^  ^   ^  ^^   ^^^   ^^</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can see how well distributed are two similar bytes. Every nibble has <span class="math inline">\(1\)</span> or <span class="math inline">\(2\)</span> bits that are being changed. So, we are already seeing a real avalanche behavior here. Things are getting moved, things are getting mutated, it all looks cool.</p>
<p>Let us look at few hash functions that are considered to be reasonably state-of-the-art.</p>
</section>
<section id="murmur-hash" class="level3">
<h3 class="anchored" data-anchor-id="murmur-hash">Murmur Hash</h3>
<p>```cpp uint32_t murmur3_32(const uint8_t* key, size_t len, uint32_t seed) { const uint32_t c1 = 0xcc9e2d51; const uint32_t c2 = 0x1b873593; const uint32_t n = 0xe6546b64;</p>
<pre><code>uint32_t hash = seed;
uint32_t k;

/* Read in groups of 4. */
for (size_t i = len &gt;&gt; 2; i; i--) {
    // Here is a source of differing results across endiannesses.
    // A swap here has no effects on hash properties though.
    memcpy(&amp;k, key, sizeof(uint32_t));
    key += sizeof(uint32_t);
    hash ^= murmur_32_scramble(k);
    hash = (h &lt;&lt; 13) | (h &gt;&gt; 19);
    hash = hash * 5 + 0xe6546b64;
}
/* Read the rest. */
k = 0;
for (size_t i = len &amp; 3; i; i--) {
    k &lt;&lt;= 8;
    k |= key[i - 1];
}
// A swap is *not* necessary here because the preceding loop already
// places the low bytes in the low places according to whatever endianness
// we use. Swaps only apply when the memory is copied in a chunk.
hash ^= murmur_32_scramble(k);
/* Finalize. */
hash ^= len;
hash ^= hash &gt;&gt; 16;
hash *= 0x85ebca6b;
hash ^= hash &gt;&gt; 13;
hash *= 0xc2b2ae35;
hash ^= hash &gt;&gt; 16;
return hash;</code></pre>
<p>}</p>
<p>Murmur3 hash has a few constants. Quite a few of those are primes. There is also a seed value that somettimes the user provides or is hardcoded at times. It also means that, if you want to generate different hash values for different users, you have a way to do it.</p>
<p>Then we start the mixing function.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="quasar-chunawala/quantdev" data-repo-id="R_kgDOL2t5-A" data-category="General" data-category-id="DIC_kwDOL2t5-M4ClndQ" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>