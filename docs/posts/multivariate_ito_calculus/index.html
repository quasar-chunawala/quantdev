<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quasar">
<meta name="dcterms.date" content="2024-07-04">

<title>Quant Insights - Multivariate Ito Calculus</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9993009899870547" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Quant Insights</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Multivariate Ito Calculus</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Stochastic Calculus</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Quasar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 4, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#multivariate-ito-calculus." id="toc-multivariate-ito-calculus." class="nav-link active" data-scroll-target="#multivariate-ito-calculus.">Multivariate Ito Calculus.</a>
  <ul class="collapse">
  <li><a href="#multidimensional-brownian-motion." id="toc-multidimensional-brownian-motion." class="nav-link" data-scroll-target="#multidimensional-brownian-motion.">Multidimensional Brownian motion.</a>
  <ul class="collapse">
  <li><a href="#d-brownian-motion" id="toc-d-brownian-motion" class="nav-link" data-scroll-target="#d-brownian-motion">2D Brownian Motion</a></li>
  <li><a href="#brownian-motion-with-correlated-coordinates" id="toc-brownian-motion-with-correlated-coordinates" class="nav-link" data-scroll-target="#brownian-motion-with-correlated-coordinates">Brownian motion with correlated coordinates</a></li>
  </ul></li>
  <li><a href="#itos-formula." id="toc-itos-formula." class="nav-link" data-scroll-target="#itos-formula.">Ito’s Formula.</a>
  <ul class="collapse">
  <li><a href="#brownian-martingales" id="toc-brownian-martingales" class="nav-link" data-scroll-target="#brownian-martingales">Brownian Martingales</a></li>
  </ul></li>
  <li><a href="#multidimensional-ito-formula---functions-of-space-and-time" id="toc-multidimensional-ito-formula---functions-of-space-and-time" class="nav-link" data-scroll-target="#multidimensional-ito-formula---functions-of-space-and-time">Multidimensional Ito formula - Functions of space and time</a></li>
  <li><a href="#polyas-random-walk-theorem" id="toc-polyas-random-walk-theorem" class="nav-link" data-scroll-target="#polyas-random-walk-theorem">Polya’s Random Walk Theorem</a>
  <ul class="collapse">
  <li><a href="#mathbbz1-case" id="toc-mathbbz1-case" class="nav-link" data-scroll-target="#mathbbz1-case"><span class="math inline">\(\mathbb{Z}^1\)</span> case</a></li>
  <li><a href="#mathbbz2-case" id="toc-mathbbz2-case" class="nav-link" data-scroll-target="#mathbbz2-case"><span class="math inline">\(\mathbb{Z}^2\)</span> case</a></li>
  <li><a href="#mathbbz3-case" id="toc-mathbbz3-case" class="nav-link" data-scroll-target="#mathbbz3-case"><span class="math inline">\(\mathbb{Z}^3\)</span> case</a></li>
  </ul></li>
  <li><a href="#recurrence-and-transience-of-brownian-motion" id="toc-recurrence-and-transience-of-brownian-motion" class="nav-link" data-scroll-target="#recurrence-and-transience-of-brownian-motion">Recurrence and Transience of Brownian Motion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="multivariate-ito-calculus." class="level1">
<h1>Multivariate Ito Calculus.</h1>
<p>We can generalize the theory to functions of several brownian motions. This unleashes the full power of Ito calculus.</p>
<section id="multidimensional-brownian-motion." class="level2">
<h2 class="anchored" data-anchor-id="multidimensional-brownian-motion.">Multidimensional Brownian motion.</h2>
<div id="def-brownian-motion-in-Rd" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Brownian motion in <span class="math inline">\(\mathbf{R}^{d}\)</span>.) </strong></span>Take <span class="math inline">\(d\in\mathbf{N}\)</span>. Let <span class="math inline">\(B^{(1)},\ldots,B^{(d)}\)</span> be independent standard Brownian motions in <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span>. The process <span class="math inline">\((B_{t}:t\geq0)\)</span> taking values in <span class="math inline">\(\mathbf{R}^{d}\)</span> defined by :</p>
<span class="math display">\[\begin{aligned}
B_{t} &amp; =(B_{t}^{(1)},\ldots,B_{t}^{(d)}),\quad t\geq0
\end{aligned}\]</span>
<p>is called a <span class="math inline">\(d-\)</span>dimensional Brownian motion or a Brownian motion in <span class="math inline">\(\mathbf{R}^{d}\)</span>.</p>
</div>
<p>The Brownian filtration <span class="math inline">\((\mathcal{F}_{t}:t\geq0)\)</span> is now composed of the information of all Brownian motions. In other words, it is given by the sigma-fields:</p>
<span class="math display">\[\begin{aligned}
\mathcal{F}_{t} &amp; =\sigma(B_{s}^{(i)},1\leq i\leq d,s\leq t)
\end{aligned}\]</span>
<p>For every outcome <span class="math inline">\(\omega\)</span>, the path of trajectory of a <span class="math inline">\(d-\)</span>dimensional Brownian motion is a curve in space parametrized by the time <span class="math inline">\(t\)</span>:</p>
<span class="math display">\[\begin{aligned}
t\mapsto B_{t}(\omega) &amp; =(B_{t}^{(1)}(\omega),B_{t}^{(2)}(\omega),\ldots,B_{t}^{(d)}(\omega))
\end{aligned}\]</span>
<p>Of course, this curve is continuous, since each coordinate is. The below numerical project gives an example of one path of a two-dimensional brownian motion. This is a very rugged and intertwined curve! We might wonder, what it does as <span class="math inline">\(t\to\infty\)</span>. Does it wander around <span class="math inline">\((0,0)\)</span> ad infinitum or does it eventually escape to infinity? We will answer this question in a later section. For doing so, we shall need a version of Ito’s formula for multi-dimensional Brownian motion. We finish this section by noticing that it is also easy to construct Brownian motions in higher dimensions for which the coordinates are correlated.</p>
<section id="d-brownian-motion" class="level3">
<h3 class="anchored" data-anchor-id="d-brownian-motion">2D Brownian Motion</h3>
<p>Consider a two-dimensional Brownian motion <span class="math inline">\((B_{t}^{(1)},B_{2}^{(2)})\)</span> starting at <span class="math inline">\((0,0)\)</span>.</p>
<p>Let’s plot one path of this Brownian motion on the plane <span class="math inline">\(\mathbf{R}^{2}\)</span> on the plane in <span class="math inline">\(\mathbf{R}^{2}\)</span> on the time interval <span class="math inline">\([0,5]\)</span> using a discretization of <span class="math inline">\(0.001\)</span>.</p>
<p>We define <code>BrownianMotion2D</code> class.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BrownianMotion2D:</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Generate sample paths for a 2d-brownian motion</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        endpoint : <span class="bu">float</span> <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        discretization : <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.endpoint <span class="op">=</span> endpoint</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.discretization <span class="op">=</span> discretization</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_paths(<span class="va">self</span>, num_paths : <span class="bu">int</span>):</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        steps <span class="op">=</span> <span class="bu">int</span>(<span class="va">self</span>.endpoint<span class="op">/</span><span class="va">self</span>.discretization)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        delta_z <span class="op">=</span> np.sqrt(<span class="va">self</span>.discretization) <span class="op">*</span> np.random.randn(num_paths,<span class="dv">2</span>,steps)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># paths has shape [num_paths,2,num_steps]</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        paths <span class="op">=</span> np.cumsum(delta_z,axis<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Brownian motion has position (0,0) at time t=0</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append initial position </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        init_position <span class="op">=</span> np.zeros((num_paths,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        paths <span class="op">=</span> np.append(init_position,paths,axis<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> paths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then configure and use <code>BrownianMotion2D</code> objects as we please.</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>bm <span class="op">=</span> BrownianMotion2D(endpoint<span class="op">=</span><span class="fl">5.0</span>,discretization<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>paths <span class="op">=</span> bm.generate_paths(num_paths<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> paths[<span class="dv">0</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r'$x$'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r'$y$'</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r'2D-Brownian motion'</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>plt.plot(path[<span class="dv">0</span>],path[<span class="dv">1</span>],linewidth<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-3-output-1.png" width="594" height="447"></p>
</div>
</div>
</section>
<section id="brownian-motion-with-correlated-coordinates" class="level3">
<h3 class="anchored" data-anchor-id="brownian-motion-with-correlated-coordinates">Brownian motion with correlated coordinates</h3>
<div id="exm-brownian-motion-with-correlated-coordinates" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (Brownian motion with correlated coordinates) </strong></span>Let <span class="math inline">\((B_{t}:t\geq0)\)</span> be a two dimensional brownian motion. Let <span class="math inline">\(-1&lt;\rho&lt;1\)</span>. We construct the two dimensional process as follows: <span class="math inline">\(W_{t}=(W_{t}^{(1)},W_{t}^{(2)})\)</span> where:</p>
<span class="math display">\[\begin{aligned}
W_{t}^{(1)} &amp; =B_{t}^{(1)}\\
W_{t}^{(2)} &amp; =\rho B_{t}^{(1)}+\sqrt{1-\rho^{2}}B_{t}^{(2)}
\end{aligned}\]</span>
<p><span class="math inline">\(W_{t}^{(1)}=B_{t}^{(1)}\)</span> is Gaussian with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(t\)</span>. Since, <span class="math inline">\(B_{t}^{(1)}\)</span> and <span class="math inline">\(B_{t}^{(2)}\)</span>are independent gaussian random variables and the sum of IID Gaussians is Gaussian, <span class="math inline">\(W_{t}^{(2)}\)</span> is Gaussian with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(t\)</span>. The covariance between <span class="math inline">\(W_{t}^{(1)}\)</span> and <span class="math inline">\(W_{t}^{(2)}\)</span> is:</p>
<span class="math display">\[\begin{aligned}
\mathbf{E}[W_{t}^{(1)}W_{t}^{(2)}] &amp; =\mathbf{E}[B_{t}^{(1)}(\rho B_{t}^{(1)}+\sqrt{1-\rho^{2}}B_{t}^{(2)})]\\
&amp; =\mathbf{E}[\rho(B_{t}^{(1)})^{2}+\sqrt{1-\rho^{2}}B_{t}^{(1)}B_{t}^{(2)}]\\
&amp; =\rho t
\end{aligned}\]</span>
<p>Hence, the coordinates at time <span class="math inline">\(t\)</span> are not independent.</p>
</div>
<p>Consider now the process <span class="math inline">\((W_{t}:t\geq0)\)</span> for <span class="math inline">\(\rho=1/2\)</span> as in example 2. Let’s plot one path of this process on the plane <span class="math inline">\(\mathbf{R}^{2}\)</span> on the time-interval <span class="math inline">\([0,5]\)</span> using a discretization of <span class="math inline">\(0.001\)</span>.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BrownianMotion2DWithCorrelatedCoords(BrownianMotion2D):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Generate sample paths for a 2d-brownian motion</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">    have correlated coordiantes</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        endpoint: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1.0</span>, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        discretization: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        rho: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.endpoint <span class="op">=</span> endpoint</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.discretization <span class="op">=</span> discretization</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.rho <span class="op">=</span> rho</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_paths(<span class="va">self</span>, num_paths: <span class="bu">int</span>):</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Call the base class generate_paths() method to generate a pair of</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># independent brownian motion paths. It returns a tensor of</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># shape (num_paths, 2, num_steps)</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        paths <span class="op">=</span> <span class="bu">super</span>().generate_paths(num_paths<span class="op">=</span>num_paths)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract the brownian motions B1(t) and B2(t)</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># B1(t) and B2(t) have dimensions [num_paths,num_steps]</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        x_coord <span class="op">=</span> paths[:, <span class="dv">0</span>, :]</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        y_coord <span class="op">=</span> paths[:, <span class="dv">1</span>, :]</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Apply the transformation</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># W1(t) = B1(t)</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># W2(t) = rho * B1(t) + sqrt(1 - rho**2) B2(t)</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        x_coord <span class="op">=</span> x_coord</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        y_coord <span class="op">=</span> <span class="va">self</span>.rho <span class="op">*</span> x_coord <span class="op">+</span> np.sqrt(<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.rho<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> y_coord</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Assemble back the x- and y- coordinates</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        x_coord <span class="op">=</span> np.expand_dims(x_coord, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        y_coord <span class="op">=</span> np.expand_dims(y_coord, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Return a tensor of shape [num_paths,d=2,num_steps]</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.concatenate([x_coord, y_coord], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s configure the <code>BrownianMotion2DWithCorrelatedCoords</code> engine with the settings <code>endpoint=5.0</code>, <code>discretization=0.001</code> and <code>rho=0.5</code> and generate a sample path.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bm <span class="op">=</span> BrownianMotion2DWithCorrelatedCoords(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    endpoint<span class="op">=</span><span class="fl">5.0</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    discretization<span class="op">=</span><span class="fl">0.001</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    rho<span class="op">=</span><span class="fl">0.50</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>paths <span class="op">=</span> bm.generate_paths(num_paths<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> paths[<span class="dv">0</span>]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r'$x$'</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r'$y$'</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r'Correlated Brownian motion $W(t)=(W^{(1)}(t),W^{(2)}(t))$'</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>plt.plot(path[<span class="dv">0</span>],path[<span class="dv">1</span>],linewidth<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-5-output-1.png" width="586" height="452"></p>
</div>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r'$t$'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r'$W_t$'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r'Correlated Brownian motion paths'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="fl">0.0</span>,stop<span class="op">=</span><span class="fl">5.0</span>,num<span class="op">=</span><span class="dv">5001</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.plot(t,path[<span class="dv">0</span>],linewidth<span class="op">=</span><span class="fl">0.75</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.plot(t,path[<span class="dv">1</span>],linewidth<span class="op">=</span><span class="fl">0.75</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-6-output-1.png" width="584" height="447"></p>
</div>
</div>
</section>
</section>
<section id="itos-formula." class="level2">
<h2 class="anchored" data-anchor-id="itos-formula.">Ito’s Formula.</h2>
<div id="thm-ito-formula-function-of-d-brownian-motions" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Ito’s Formula.) </strong></span>Let <span class="math inline">\((B_{t}:t\geq0)\)</span> be a <span class="math inline">\(d-\)</span>dimensional brownian motion. Consider <span class="math inline">\(f\in\mathcal{C}^{2}(\mathbf{R}^{d})\)</span>. Then, we have with probability one that for all <span class="math inline">\(t\geq0\)</span>:</p>
<span class="math display">\[\begin{aligned}
f(B_{t})-f(B_{0}) &amp; =\sum_{i=1}^{d}\int_{0}^{t}\partial_{x_{i}}f(B_{s})dB_{s}^{(i)}+\frac{1}{2}\int_{0}^{t}\sum_{i=1}^{d}\partial_{x_{i}}^{2}f(B_{s})ds\label{eq:multidimensional-ito-formula}
\end{aligned}\]</span>
</div>
<div id="rem-equality-of-processes">
<p>I stress that, as in the one-dimensional case, Ito’s formula is an equality of processes (and not an equality in distribution). Thus, the processes on both sides must agree for each path.</p>
</div>
<p>Interestingly, the mixed partials <span class="math inline">\(\partial_{x_{i}x_{j}}f(B_{s})\)</span>, <span class="math inline">\(i\neq j\)</span> do not appear in the formula! We see from Ito’s formula that the process <span class="math inline">\(f(B_{t})\)</span> can be represented as a sum of <span class="math inline">\(d+1\)</span> processes: <span class="math inline">\(d\)</span> Ito integrals and one Riemann integral (which is a process of finite variation). In vector notation, the formula takes the form:</p>
<span class="math display">\[\begin{aligned}
f(B_{t})-f(B_{0}) &amp; =\int_{0}^{t}\nabla f(B_{s})^{T}dB_{s}+\frac{1}{2}\int_{0}^{t}\nabla^{2}f(B_{s})ds
\end{aligned}\]</span>
<p>where it is understood that the first term is the sum of the <span class="math inline">\(d\)</span> Ito integrals in the equation. The symbol <span class="math inline">\(\nabla^{2}\)</span> is the Laplacian of <span class="math inline">\(f\)</span>:</p>
<p><span class="math inline">\(\sum_{i=1}^{d}\frac{\partial^{2}}{\partial x_{i}^{2}}f(B_{s}^{(1)},\ldots,B_{s}^{(d)})ds\)</span></p>
<p>In differential form, Ito’s formula becomes very neat:</p>
<span class="math display">\[\begin{aligned}
df(B_{t}) &amp; =\sum_{i=1}^{d}\partial_{x_{i}}f(B_{s})dB_{t}^{(i)}+\frac{1}{2}\sum_{i=1}^{d}\partial_{x_{i}}^{2}f(B_{s})dt=\nabla f(B_{t})^{T}dB_{s}+\frac{1}{2}\nabla^{2}f(B_{t})dt
\end{aligned}\]</span>
<div id="exm-ito-formula-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 </strong></span>Consider the functions (1) <span class="math inline">\(f(x_{1},x_{2})=x_{1}^{2}+x_{2}^{2}\)</span> (2) <span class="math inline">\(f(x_{1},x_{2})=e^{x_{1}}\cos x_{2}\)</span> and the processes <span class="math inline">\((X_{t}:t\geq0)\)</span> and <span class="math inline">\((Y_{t}:t\geq0)\)</span>. If we apply Ito’s formula to the first process, we have:</p>
<span class="math display">\[\begin{aligned}
X_{t} &amp; =\int_{0}^{t}2B_{s}^{(1)}dB_{s}^{(1)}+\int_{0}^{t}2B_{s}^{(2)}dB_{s}^{(2)}+\frac{1}{2}\int_{0}^{t}(4dt)\\
&amp; =\int_{0}^{t}2B_{s}^{(1)}dB_{s}^{(1)}+\int_{0}^{t}2B_{s}^{(2)}dB_{s}^{(2)}+2t
\end{aligned}\]</span>
<p>The second process gives:</p>
<span class="math display">\[\begin{aligned}
Y_{t} &amp; =\cos B_{s}^{(2)}\int_{0}^{t}e^{B_{s}^{(1)}}dB_{s}^{(1)}-e^{B_{s}^{(1)}}\int\sin B_{s}^{(2)}dB_{s}^{(2)}+\frac{1}{2}\int_{0}^{t}\left(e^{B_{s}^{(1)}}\cos B_{s}^{(2)}-e^{B_{s}^{(1)}}\cos B_{s}^{(2)}\right)dt\\
&amp; =1+\cos B_{s}^{(2)}\int_{0}^{t}e^{B_{s}^{(1)}}dB_{s}^{(1)}-e^{B_{s}^{(1)}}\int\sin B_{s}^{(2)}dB_{s}^{(2)}
\end{aligned}\]</span>
</div>
<div id="exm-cross-variation-of-b1-and-b2" class="theorem example">
<p><span class="theorem-title"><strong>Example 3 </strong></span>(Cross-Variation of <span class="math inline">\(B_{t}^{(1)}\)</span> and <span class="math inline">\(B_{t}^{(2)}\)</span>). Let <span class="math inline">\((t_{j}:j\leq n)\)</span> be a sequence of partitions of <span class="math inline">\([0,t]\)</span> such that <span class="math inline">\(\max_{j}|t_{j+1}-t_{j}|\to0\)</span> as <span class="math inline">\(n\to\infty\)</span>. Prove that:</p>
<span class="math display">\[\begin{aligned}
\lim_{n\to\infty}\sum_{j=0}^{n-1}(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)}) &amp; =0\quad\text{in } L^{2}
\end{aligned}\]</span>
<p>This justifies the rule <span class="math inline">\(dB_{t}^{(1)}\cdot dB_{t}^{(2)}=0\)</span>.</p>
<p><em>Hint</em>: Just compute the second moment of the sum.</p>
</div>
<div id="sol-solution-1">
<p>We have:</p>
<span class="math display">\[\begin{aligned}
&amp; \mathbf{E}\left[\left(\sum_{j=0}^{n-1}(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)})\right)^{2}\right]\\
= &amp; \sum_{j=0}^{n-1}\mathbf{E}[(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})^{2}(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)})^{2}]\\
+ &amp; 2\sum_{j&lt;k}\mathbf{E}\left[(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})(B_{t_{k+1}}^{(1)}-B_{t_{k}}^{(1)})(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)})(B_{t_{k+1}}^{(2)}-B_{t_{k}}^{(2)})\right]
\end{aligned}\]</span>
<p>Both these expectations are zero, since the brownian motions are independent and non-overlapping increments are independent.</p>
<p>Consequently, <span class="math inline">\(\sum_{j=0}^{n-1}(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)})(B_{t_{j+1}}^{(2)}-B_{t_{j}}^{(2)})\to0\)</span> in the <span class="math inline">\(L^{2}\)</span> sense.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>The proof of the formula follows the usual recipe: Taylor’s theorem together with the quadratic variation and the cross-variation. In this case, we do get a cross-variation between the different Brownian motions. More precisely, consider a partition <span class="math inline">\((t_{j}:j\leq n)\)</span> of <span class="math inline">\([0,t]\)</span>. Then we can write:</p>
<span class="math display">\[\begin{aligned}
f(B_{t})-f(B_{0}) &amp; =\sum_{j=0}^{n-1}(f(B_{t_{j+1}})-f(B_{t_{j}}))
\end{aligned}\]</span>
<p>We can apply the Taylor’s series expansion for each <span class="math inline">\(j\)</span> to get:</p>
<span class="math display">\[\begin{aligned}
f(B_{t})-f(B_{0}) &amp; =\sum_{j=0}^{n-1}\nabla f(B_{t_{j}})(B_{t_{j+1}}-B_{t_{j}})\\
&amp; +\frac{1}{2}\sum_{j=0}^{n-1}(B_{t_{j+1}}-B_{t_{j}})^{T}Hf(B_{t_{j}})(B_{t_{j+1}}-B_{t_{j}})+\mathcal{E}
\end{aligned}\]</span>
<p>where <span class="math inline">\(Hf\)</span> is the Hessian matrix of <span class="math inline">\(f\)</span>. We wrote the expansion using the vector notation to be economical. Let’s keep in mind that each term is a sum over the derivatives. The first term will converge to <span class="math inline">\(d\)</span> Ito integrals as in the one-dimensional case. Now, the summand in the second term is:</p>
<p><span class="math display">\[(B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)},\ldots,B_{t_{j+1}}^{(d)}-B_{t_{j}}^{(d)})\left[\begin{array}{ccc}
\partial_{x_{1}}^{2}f(B_{t_{j}}) &amp; \ldots &amp; \partial_{x_{1}x_{d}}^{2}f(B_{t_{j}})\\
\vdots &amp; \ddots\\
\partial_{x_{d}x_{1}}^{2}f(B_{t_{j}}) &amp;  &amp; \partial_{x_{d}}^{2}f(B_{t_{j}})
\end{array}\right]\left[\begin{array}{c}
B_{t_{j+1}}^{(1)}-B_{t_{j}}^{(1)}\\
\vdots\\
B_{t_{j+1}}^{(d)}-B_{t_{j}}^{(d)}
\end{array}\right]\]</span></p>
<p>So, <span class="math inline">\((B_{t_{j+1}}^{(i)}-B_{t_{j}}^{(i)})\)</span> is pre-multiplied with the term <span class="math inline">\(\partial_{x_{i}x_{k}}^{2}f(B_{t_{j}})\)</span> and it is post-multiplied <span class="math inline">\((B_{t_{j+1}}^{(k)}-B_{t_{j}}^{(k)})\)</span>. Consequently, the second term in the Taylor’s series expansion can be re-written as:</p>
<p><span class="math display">\[\sum_{j=0}^{n-1}\left(\sum_{i=1}^{d}\partial_{x_{i}}^{2}f(B_{t_{j}})(B_{t_{j+1}}^{(i)}-B_{t_{j}}^{(i)})^{2}+\sum_{1\leq i&lt;k\leq d}\partial_{x_{i}x_{k}}^{2}f(B_{t_{j}})(B_{t_{j+1}}^{(i)}-B_{t_{j}}^{(i)})(B_{t_{j+1}}^{(k)}-B_{t_{j}}^{(k)})\right)\]</span></p>
<p>The second term on the right converges to <span class="math inline">\(0\)</span> in the <span class="math inline">\(L^{2}\)</span> sense when <span class="math inline">\(i\neq k\)</span>, from exercise. This explains why the mixed derivatives disappear in the multi-dimensional Ito’s formula. As for the case <span class="math inline">\(i=k\)</span>, it reduces to the quadratic variation as in the one-dimensional case. This is where the Riemann integral arises, after suitable conditioning on <span class="math inline">\(\mathcal{F}_{t_{j}}\)</span>, the sigma-field generated by <span class="math inline">\(B_{s}\)</span>, <span class="math inline">\(s\leq t_{j}\)</span>.</p>
</div>
<p>As in the one-dimensional case,it is not necessary to learn Ito’s formula by heart. It suffices to write the differential of the function <span class="math inline">\(f\)</span> to second order. We can then apply the rules of multivariate Ito calculus:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(\cdot\)</span></th>
<th style="text-align: center;"><span class="math inline">\(dt\)</span></th>
<th style="text-align: center;"><span class="math inline">\(dB_{t}^{(1)}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(dB_{t}^{(2)}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\ldots\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(dt\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(dB_{t}^{(1)}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(dt\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(dB_{t}^{(2)}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(dt\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\ldots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(dt\)</span></td>
</tr>
</tbody>
</table>
<p>Note that the rule <span class="math inline">\(dB_{t}^{(i)}dB_{t}^{(j)}=0\)</span> for <span class="math inline">\(i\neq j\)</span> is being motivated by the cross-variation result.</p>
<p>How can we construct martingales using the Ito’s formula? Recall that an Ito integral <span class="math inline">\((\int_{0}^{t}X_{s}dB_{s},t\leq T)\)</span> is a martingale whenever the integrand is in <span class="math inline">\(\mathcal{L}_{c}^{2}(T)\)</span>, the space of adapted processes with continuous paths and for which:</p>
<span class="math display">\[\begin{aligned}
\int_{0}^{T}\mathbf{E}[X_{s}^{2}]ds &amp; &lt;\infty
\end{aligned}\]</span>
<p>The only difference here is that the integrand is a function of many Brownian motions. However, the integrands involved in the Ito integrals of the multidimensional Ito’s formula are clearly adapted to the filtration <span class="math inline">\((\mathcal{F}_{t}:t\geq0)\)</span> of <span class="math inline">\((B_{t}:t\geq0)\)</span> as they are functions of the Brownian motion at the time. The arguments of Ito integral in and apply verbatim, if we take the definition of <span class="math inline">\(\mathcal{L}_{c}^{2}(t)\)</span> with the filtration <span class="math inline">\((\mathcal{F}_{t}:t\geq0)\)</span> of <span class="math inline">\((B_{t}:t\geq0)\)</span>. With this in mind, we have the following corollary.</p>
<section id="brownian-martingales" class="level3">
<h3 class="anchored" data-anchor-id="brownian-martingales">Brownian Martingales</h3>
<div id="cor-brownian-martingales" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 1 (Brownian Martingales.) </strong></span>Let <span class="math inline">\((B_{t}:t\geq0)\)</span> be a Brownian motion in <span class="math inline">\(\mathbf{R}^{d}\)</span>. Consider <span class="math inline">\(f\in\mathcal{C}^{2}(\mathbf{R}^{d})\)</span> such that processes <span class="math inline">\((\partial_{x {i}}f(B_{t}),t\leq T)\in\mathcal{L}_{c}^{2}(T)\)</span> for every <span class="math inline">\(i\leq d\)</span>. Then, the process :</p>
<p><span class="math display">\[f(B_{t})-\frac{1}{2}\int_{0}^{t}\nabla^{2}f(B_{s})ds,\quad t\leq T\]</span></p>
<p>where <span class="math inline">\(\nabla^{2}=\sum_{i=1}^{d}\partial_{x_{i}}^{2}\)</span> is the Laplacian, is a martingale for the Brownian filtration.</p>
</div>
<p>For example, consider the processes <span class="math inline">\(X_{t}=(B_{t}^{(1)})^{2}+(B_{t}^{(2)})^{2}\)</span> and <span class="math inline">\(Y_{t}=\exp(B_{t}^{(1)})\cos(B_{t}^{(2)})\)</span>. Then, we have :</p>
<p><span class="math display">\[\frac{1}{2}\int_{0}^{t}\nabla^{2}X_{s}ds=\frac{1}{2}\int_{0}^{t}4ds=2t\]</span></p>
<p>and</p>
<span class="math display">\[\begin{aligned}
\frac{1}{2}\int_{0}^{t}\nabla^{2}Y_{s}ds &amp; =\frac{1}{2}\int_{0}^{t}0\cdot ds=0
\end{aligned}\]</span>
<p>Thus, the processes <span class="math inline">\(X_{t}-2t\)</span> and <span class="math inline">\(Y_{t}\)</span> are martingales for the Brownian filtration. In one dimension, there are no interesting martingales constructed with functions of <em>space</em> only. Indeed, <span class="math inline">\((f(B_{t}):t\geq0)\)</span> is a martingale if and only if <span class="math inline">\(f''(x)=0\)</span> for all <span class="math inline">\(x\)</span>. But, such functions are of the form <span class="math inline">\(f(x)=ax+b\)</span>, <span class="math inline">\(a,b\in\mathbf{R}\)</span>. In other words, in one dimension, Brownian martingales of the form <span class="math inline">\(f(B_{t})\)</span> are simply <span class="math inline">\(aB_{t}+b\)</span>. Not very surprising! The situation is very different in higher dimensions. Indeed, corollary implies that <span class="math inline">\(f(B_{t})\)</span> is a martingale whenever <span class="math inline">\(f\)</span> is a harmonic function:</p>
<div id="def-harmonic-function" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 (Harmonic function.) </strong></span>A function <span class="math inline">\(f:\mathbf{R}^{d}\to\mathbf{R}\)</span> is harmonic in <span class="math inline">\(\mathbf{R}^{d}\)</span> if and only if <span class="math inline">\(\nabla^{2}f(x)\equiv0\)</span> for all <span class="math inline">\(x\in\mathbf{R}^{d}\)</span>. More generally, a function <span class="math inline">\(f:\mathbf{R}^{d}\to\mathbf{R}\)</span> is harmonic in the region <span class="math inline">\(\mathcal{O}\subset\mathbf{R}^{d}\)</span> if and only if <span class="math inline">\(\nabla^{2}f(x)\equiv0\)</span> for all <span class="math inline">\(x\in\mathcal{O}\)</span>.</p>
</div>
<p>Note that the function <span class="math inline">\(f(x)=e^{x_{1}}\cos x_{2}\)</span> is harmonic in <span class="math inline">\(\mathbf{R}^{d}\)</span>. This is why the process <span class="math inline">\(Y_{t}=\exp(B_{t}^{(1)})\cos(B_{t}^{(2)})\)</span> is a martingale. The distinction to a subset of <span class="math inline">\(\mathbf{R}^{d}\)</span> in the above definition is important since it may happen that the function is harmonic only in a subset of the space; see for example equation. It is possible to define a Brownian martingale in such cases by considering the process until it exits the region. This will turn out to be important as we move ahead.</p>
<p>The multidimensional Ito’s formula generalizes to functions of time and space as in proposition:</p>
<div id="def-function-in-C12" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3 </strong></span>A function <span class="math inline">\(f:[0,\infty)\times\mathbf{R}^{d}\to\mathbf{R}\)</span> is in <span class="math inline">\(\mathcal{C}^{1,2}([0,T]\times\mathbf{R}^{d})\)</span> if the partial derivative in <em>time</em> :</p>
<p><span class="math display">\[\frac{\partial}{\partial t}f(t,\mathbf{x})\]</span></p>
<p>exists and is continuous and the second order partial derivatives in space:</p>
<p><span class="math display">\[\frac{\partial^{2}}{\partial x_{i}^{2}}f(t,x_{1},x_{2},\ldots,x_{i},\ldots,x_{d}),\quad1\leq i\leq d\]</span></p>
<p>exist and are continuous.</p>
</div>
</section>
</section>
<section id="multidimensional-ito-formula---functions-of-space-and-time" class="level2">
<h2 class="anchored" data-anchor-id="multidimensional-ito-formula---functions-of-space-and-time">Multidimensional Ito formula - Functions of space and time</h2>
<div id="thm-Multidimensional-Ito-formula-functions-of-space-and-time" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Multidimensional Ito’s formula for functions of space and time) </strong></span>Let <span class="math inline">\((B_{t}:t\leq T)\)</span> be a <span class="math inline">\(d\)</span>-dimensional Brownian motion. Consider a function <span class="math inline">\(f\in\mathcal{C}^{1,2}([0,T]\times\mathbf{R}^{d})\)</span>. Then, we have with probability one for all <span class="math inline">\(t\leq T\)</span>:</p>
<span class="math display">\[\begin{aligned}
f(t,B_{t})-f(0,B_{0}) &amp; =\sum_{i=1}^{d}\int_{0}^{t}\partial_{x_{i}}f(s,B_{s})dB_{s}^{(i)}+\int_{0}^{t}\left(\partial_{t}f(s,B_{s})+\sum_{i=1}^{d}\partial_{x_{i}}^{2}f(s,B_{s})\right)ds
\end{aligned}\]</span>
</div>
<p>The martingale condition is then similar to the ones in corollary (<a href="#cor:brownian-martingales-in-Rd" data-reference-type="ref" data-reference="cor:brownian-martingales-in-Rd">[cor:brownian-martingales-in-Rd]</a>): if the processes <span class="math inline">\((\partial_{x_{i}}f(s,B_{s}),t\leq T)\in\mathcal{L}_{c}^{2}(T)\)</span> for every <span class="math inline">\(1\leq i\leq d\)</span>, then the process</p>
<p><span class="math display">\[f(t,B_{t})-\int_{0}^{t}\left\{ \partial_{t}f(s,B_{s})++\sum_{i=1}^{d}\partial_{x_{i}}^{2}f(s,B_{s})\right\} ds,\quad t\leq T\]</span></p>
<p>is a martingale for the Brownian filtration. In particular, if <span class="math inline">\(f\)</span> satisfies the partial differential equation:</p>
<span class="math display">\[\begin{aligned}
\frac{\partial f}{\partial t}+\frac{1}{2}\nabla^{2}f &amp; =0
\end{aligned}\]</span>
<p>then the process <span class="math inline">\((f(t,B_{t}):t\leq T)\)</span> itself is a martingale.</p>
</section>
<section id="polyas-random-walk-theorem" class="level2">
<h2 class="anchored" data-anchor-id="polyas-random-walk-theorem">Polya’s Random Walk Theorem</h2>
<p>Consider a <em>simple random walk</em> on the integer lattice <span class="math inline">\(\mathbb{Z}^d\)</span>. At each time step, a random walker makes a random move of length one in one of the lattice directions.</p>
<p>We say that, if the random walk returns to the origin with probability one infinitely many times, it is <em>recurrent</em>, if it does not we will call it <em>transient</em>.</p>
<p>It’s worth to spend a moment visiting Polya’s Random Walk Theorem, a fascinating, but not so intuitive result.</p>
<p>Assuming all random walks start at the origin, we define <span class="math inline">\(u\)</span> to be the probability that a random walker returns to the origin. The probability that the random walker returns to the origin exactly <span class="math inline">\(m\)</span> times is:</p>
<p><span class="math display">\[\begin{align*}
{m \choose m-1} u^{m-1} (1 - u)^{m - (m - 1)} = u^{m-1}(1-u)
\end{align*}\]</span></p>
<p>The expected number of times the particle returns to the origin for an infinite random walk is:</p>
<p><span class="math display">\[\begin{align*}
E &amp;= \sum_{m = 1}^{\infty} m (u^{m-1}(1-u))\\
&amp;= (1-u)\sum_{m=1}^{\infty}mu^{m-1}\\
&amp;= (1-u)\sum_{m=1}^{\infty}\frac{d}{du}u^{m}\\
\end{align*}\]</span></p>
<p>We note that limit exchanging is acceptable since the power series <span class="math inline">\(\sum_{n=1}^{\infty}x^n\)</span> converges uniformly for <span class="math inline">\(u &lt; 1\)</span> and we can apply the differentiable limit theorem.</p>
<p>So we obtain:</p>
<p><span class="math display">\[\begin{align*}
E &amp;= (1-u)\frac{d}{du}\sum_{m = 1}^{\infty} u^m \\
&amp;= (1-u)\cdot \frac{1}{(1-u)^2}\\
&amp;= \frac{1}{1-u}
\end{align*}\]</span></p>
<p>So, we see that if <span class="math inline">\(E\)</span> is finite, <span class="math inline">\(u &lt; 1\)</span>, then the walk is transient and if <span class="math inline">\(E = +\infty\)</span>, <span class="math inline">\(u=1\)</span>, then the walk is recurrent.</p>
<p>We then define <span class="math inline">\(u_n\)</span> to be the probability that a given walk is at the origin on the <span class="math inline">\(n\)</span>th step, defining the value <span class="math inline">\(u_0=1\)</span> for the trivial loop. We also introduce an indicator random variable <span class="math inline">\(x_n\)</span>, which takes the value <span class="math inline">\(1\)</span>, if the particle is at the origin on the <span class="math inline">\(n\)</span>th step and zero otherwise.</p>
<p>Then</p>
<p><span class="math display">\[\begin{align*}
T = \sum_{n=1}^{\infty}x_n
\end{align*}\]</span></p>
<p>is the total number of times, the particle is at the origin, so <span class="math inline">\(E\)</span> is equal to the expectation of <span class="math inline">\(T\)</span>, <span class="math inline">\(\mathbb{E}(T)\)</span>, which is equal to:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}[T] &amp;= \sum_{n=1}^{\infty}\mathbb{E}[x_n]\\
&amp;= \sum_{n=1}^{\infty} u_n
\end{align*}\]</span></p>
<p>But, we showed previously that if <span class="math inline">\(E\)</span> is finite, then the walk is transient and if <span class="math inline">\(E = \infty\)</span>, then the walk is recurrent, so we have established that if:</p>
<p><span class="math display">\[\begin{align*}
\sum_{n=1}^{\infty}u_n
\end{align*}\]</span></p>
<p>converges then the walk is transient and if the sum diverges, then the walk is recurrent.</p>
<section id="mathbbz1-case" class="level3">
<h3 class="anchored" data-anchor-id="mathbbz1-case"><span class="math inline">\(\mathbb{Z}^1\)</span> case</h3>
<p>Now that we have built up the necessary tools, we will consider the cases. We start by considering a simple random walk on <span class="math inline">\(\mathbb{Z}^1\)</span>. Since, as mentioned previously, a walk must have an even number of steps to be a loop, we only look at <span class="math inline">\(u_{2n},n \in \mathbb{Z}^+\)</span>. A path of length <span class="math inline">\(2n\)</span> returning to the origin must have <span class="math inline">\(n\)</span> up-moves and <span class="math inline">\(n\)</span> down-moves. The number of such paths are <span class="math inline">\({2n \choose n}\)</span>. Each such path has a probability of occurrence <span class="math inline">\(\frac{1}{2^{2n}}\)</span>. Thus,</p>
<p><span class="math display">\[\begin{align*}
u_{2n} = \frac{1}{2^{2n}}{2n \choose n}
\end{align*}\]</span></p>
<p>Using Stirling’s approximation <span class="math inline">\(n! \sim \sqrt{2\pi n} e^{-n} n^{n}\)</span>, we obtain:</p>
<p><span class="math display">\[\begin{align*}
u_{2n} &amp;= \frac{1}{2^{2n}} \frac{(2n)!}{n! n!}\\
&amp;\approx \frac{1}{2^{2n}} \cdot \frac{\sqrt{2\pi(2n)} e^{-2n}(2n)^{2n}}{\left(\sqrt{2\pi n} e^{-n} n^n\right)^2}\\
&amp;=\frac{1}{\sqrt{\pi n}}
\end{align*}\]</span></p>
<p>So, we see that:</p>
<p><span class="math display">\[\begin{align*}
\sum_{n=0}^{\infty} u_{2n} \approx \sum_{n=0}^{\infty} \frac{1}{\sqrt{n\pi}}
\end{align*}\]</span></p>
<p>And the series on the right certainly diverges so, we see that a simple random walk in <span class="math inline">\(\mathbb{Z}^1\)</span> is recurrent since <span class="math inline">\(E\)</span> diverges.</p>
</section>
<section id="mathbbz2-case" class="level3">
<h3 class="anchored" data-anchor-id="mathbbz2-case"><span class="math inline">\(\mathbb{Z}^2\)</span> case</h3>
<p>A particle has an equal probability <span class="math inline">\(1/4\)</span> of moving left, right, up or down randomly in the <span class="math inline">\(d=2\)</span> dimensional lattice. Each path of <span class="math inline">\(2n\)</span> steps has a probability <span class="math inline">\(\frac{1}{4^{2n}}\)</span> of occurring. We then consider the number of paths with equal steps left and right (say <span class="math inline">\(L\)</span> steps in each horizontal direction) and equal steps up and down (then <span class="math inline">\(n-L\)</span>) is:</p>
<p><span class="math display">\[\begin{align*}
{2n \choose L}{2n - L \choose L}{2n - 2L \choose n - L}{n-L \choose n - L} = \frac{(2n)!}{L! L! (n-L)! (n-L)!}
\end{align*}\]</span></p>
<p>So we get:</p>
<p><span class="math display">\[\begin{align*}
u_{2n} &amp;= \frac{1}{4^{2n}} \sum_{L=0}^n \frac{(2n)!}{L! L! (n-L)! (n-L)!} \\
&amp;= \frac{1}{4^{2n}} \sum_{L=0}^n \frac{(2n)!}{n! n!} \cdot \left(\frac{n!}{L! (n-L)!}\right)^2 \\
&amp;=\frac{1}{4^{2n}} {2n \choose n}\sum_{L=0}^n {n \choose L}^2
\end{align*}\]</span></p>
<p>Suppose, we are to form a team of <span class="math inline">\(n\)</span> players from a population of <span class="math inline">\(2n\)</span> participants. There <span class="math inline">\({2n \choose n}\)</span> distinguishable teams of size <span class="math inline">\(n\)</span>. Alternatively, we could divide the population into two halves of <span class="math inline">\(n\)</span> participants each, choose <span class="math inline">\(L\)</span> participants from the first sub-population, and the remaining <span class="math inline">\(n-L\)</span> participants from the second sub-population. So, the number of distinguishable teams is:</p>
<p><span class="math display">\[\begin{align*}
\sum_{L=0}^{n}{n \choose L}{n \choose n - L} = \sum_{L=0}^{n} {n \choose L}^2
\end{align*}\]</span></p>
<p>So, we have the combinatorial identity:</p>
<p><span class="math display">\[\begin{align*}
\sum_{L=0}^{n} {n \choose L}^2 = {2n \choose n}
\end{align*}\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[\begin{align*}
u_{2n} &amp;=\frac{1}{4^{2n}} {2n \choose n}\sum_{L=0}^n {n \choose L}^2\\
&amp;= \left(\frac{1}{2^{2n}} {2n \choose n}\right)^2
\end{align*}\]</span></p>
<p>So, we have that, it is just the square of the result from <span class="math inline">\(\mathbb{Z}^1\)</span>, so we see in this case that:</p>
<p><span class="math display">\[\begin{align*}
u_{2n} &amp;\approx \sum_{n=0}^{\infty} \frac{1}{\pi n}
\end{align*}\]</span></p>
<p>And the series on the right certainly diverges, so we see that a simple random walk in <span class="math inline">\(\mathbb{Z}^2\)</span> is recurrent as <span class="math inline">\(E\)</span> diverges.</p>
</section>
<section id="mathbbz3-case" class="level3">
<h3 class="anchored" data-anchor-id="mathbbz3-case"><span class="math inline">\(\mathbb{Z}^3\)</span> case</h3>
<p>As before, in order to have a walk return to the origin we must have equal steps in the positive and negative directions for each direction and each path of <span class="math inline">\(2n\)</span> has a probability of occurring of <span class="math inline">\(\frac{1}{6^{2n}}\)</span>. Then, extending the idea from the previous subsection, the number of paths (of total length <span class="math inline">\(2n\)</span>) with <span class="math inline">\(L\)</span> steps left and right, <span class="math inline">\(U\)</span> steps up and down and <span class="math inline">\(n - L - U\)</span> steps forward and backward is:</p>
<p><span class="math display">\[\begin{align*}
\frac{(2n)!}{L! L! U! U! (n - L - U)! (n - L - U)!}
\end{align*}\]</span></p>
<p>So, we get:</p>
<p><span id="eq-probability-of-return-to-origin-at-nth-step-in-3d"><span class="math display">\[
\begin{align*}
u_{2n} &amp;= \frac{1}{6^{2n}} \sum_{L,U,L+U \leq n} \frac{(2n)!}{L! L! U! U! (n - L - U)! (n - L - U)!} \\
&amp;= \frac{1}{2^{2n}} {2n \choose n} \sum_{L,U,L+U \leq n} \left(\frac{1}{3^n}\frac{n!}{L! U! (n - U - L)!}\right)^2
\end{align*}
\tag{1}\]</span></span></p>
<p>Consider a <span class="math inline">\(3\)</span>-sided fair coin, with <span class="math inline">\(\mathbb{P}\{\text{Heads}\} = \mathbb{P}\{\text{Tails}\} = \mathbb{P}\{\text{Edge}\} = \frac{1}{3}\)</span>. Suppose that the coin is tossed <span class="math inline">\(n=3^2 = 9\)</span> times. The probability of landing <span class="math inline">\(L\)</span> heads, <span class="math inline">\(U\)</span> tails and <span class="math inline">\(n - L - U\)</span> edges is <span class="math inline">\(\frac{n!}{L!U!(n-L-U)!} \frac{1}{3^n}\)</span>. This is precisely the term seen in the above expression. The number of heads, tails and edges in <span class="math inline">\(n\)</span> coin tosses follows a multinomial distribution. It can be easily demonstrated, that in, <span class="math inline">\(n/3 = 3\)</span> heads, <span class="math inline">\(n/3\)</span> tails and <span class="math inline">\(n/3\)</span> edges are most likely to occur in <span class="math inline">\(n\)</span> coin tosses. So, we can find an upper bound on the summand in (1) as:</p>
<p><span class="math display">\[\begin{align*}
\frac{n!}{3^n L! U! (n- L - U)!} \leq \frac{n!}{3^n \lfloor\frac{n}{3}\rfloor! \lfloor\frac{n}{3}\rfloor! \lfloor\frac{n}{3}\rfloor!}
\end{align*}\]</span></p>
<p>Also, from the multinomial expansion theorem:</p>
<p><span class="math display">\[\begin{align*}
(1 + a + b)^n = \sum_{L,U,L+U\leq n} \frac{n!}{L! U! (n-L-U)!} a^L b^U
\end{align*}\]</span></p>
<p>Setting <span class="math inline">\(a = b = 1\)</span>, we get:</p>
<p><span class="math display">\[\begin{align*}
\sum_{L,U,L+U\leq n} \frac{n!}{3^n L! U! (n-L-U)!} a^L b^U = 1
\end{align*}\]</span></p>
<p>We then see that:</p>
<p><span class="math display">\[\begin{align*}
u_{2n} \leq \frac{1}{2^{2n}} {2n \choose n} \frac{n!}{3^n \lfloor\frac{n}{3}\rfloor! \lfloor\frac{n}{3}\rfloor! \lfloor\frac{n}{3}\rfloor!}
\end{align*}\]</span></p>
<p>We can simplify this as:</p>
<p><span class="math display">\[\begin{align*}
u_{2n} &amp;= \frac{1}{2^{2n}}{2n \choose n} \frac{n!}{3^n \left(\lfloor\frac{n}{3}\rfloor!\right)^3} \\
&amp;\approx \frac{1}{\sqrt{\pi n}} \times \frac{\sqrt{2\pi n} e^{-n} n^n}{3^n \left\{\sqrt{2\pi \frac{n}{3}}e^{-n/3} \left(\frac{n}{3}\right)^{n/3}\right\}^3}\\
&amp;= \frac{1}{\sqrt{\pi n}} \frac{\sqrt{2\pi n} e^{-n} n^n}{3^n \frac{(2\pi n)^{3/2}}{3^{3/2}} e^{-n} \frac{n^n}{3^n}}\\
&amp;= \frac{1}{\sqrt{\pi n}} \frac{\sqrt{2\pi n} \cancel{e^{-n}} \cancel{n^n}}{\cancel{3^n} \frac{(2\pi n)^{3/2}}{3^{3/2}} \cancel{e^{-n}} \frac{ \cancel{n^n}}{\cancel{3^n}}}\\
&amp;\approx \frac{M}{(\pi n)^{3/2}}
\end{align*}\]</span></p>
<p>where <span class="math inline">\(M\)</span> is a positive constant. We then see:</p>
<p><span class="math display">\[\begin{align*}
\sum_n u_2n &amp;= M \sum_n \frac{1}{n^{\frac{3}{2}}}
\end{align*}\]</span></p>
<p>The sum on the right hand side converges, so we have that a simple random walk in three dimensions is transient. The proof of Polya’s Random Walk Theorem is complete.</p>
</section>
</section>
<section id="recurrence-and-transience-of-brownian-motion" class="level2">
<h2 class="anchored" data-anchor-id="recurrence-and-transience-of-brownian-motion">Recurrence and Transience of Brownian Motion</h2>
<p>In one dimension, we established that every path of a Brownian motion reaches any level <span class="math inline">\(a \in \mathbf{R}\)</span>. More precisely, for <span class="math inline">\(a &gt; 0\)</span>, if we define the stopping time :</p>
<p><span class="math display">\[\begin{align*}
\tau = \min \{ t \geq 0 : B_t \geq a\}
\end{align*}\]</span></p>
<p>we have <span class="math inline">\(\mathbb{P}\{\tau_a &lt; \infty \} = 1\)</span>. This implies in particular that every path will come back to <span class="math inline">\(0\)</span> and will do infinitely many times. This is because <span class="math inline">\(B(t+\tau) - B(t)\)</span> is a standard brownian motion. This property of Brownian motion is called <em>recurrence</em>. This is to be compared with Brownian motion with a drift. In our analysis, we found that, if the drift is negative, then there are paths that will not reach a given level <span class="math inline">\(a &gt; 0\)</span> with positive probability. Such paths go to infinity without ever going back to <span class="math inline">\(0\)</span>. This property of the process is called <em>transience</em>.</p>
<p>We can derive similar properties for the multidimensional Brownian motion. We will rely heavily on <a href="#cor-brownian-martingales">Corollary&nbsp;1</a> and on some knowledge of harmonic functions. Harmonic functions play a very important role in mathematics, physics and in nature in general. As we mentioned earlier, if <span class="math inline">\(d = 1\)</span>, the only harmonic functions are the linear functions, since the equation <span class="math inline">\(f''(x) = 0\)</span> has the solutions <span class="math inline">\(f(x)=ax+b\)</span>. However, in higher dimensions, the collection of harmonic functions is very rich. This gives access to a plethora of Brownian martingales. For example, the following functions are harmonic in the whole space minus the origin, <span class="math inline">\(\mathbf{R}^d \setminus \{0\}\)</span>.</p>
<p><span id="eq-example-of-harmonic-function"><span class="math display">\[
h(x) = \begin{cases}
\log ||x||, &amp; d = 2 \\
||x||^{2 - d}, &amp; d \geq 3
\end{cases}
\tag{2}\]</span></span></p>
<p>where <span class="math inline">\(x\in\mathbf{R}^d\)</span>.</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Consider</p>
<p><span class="math display">\[\begin{align*}
f(x_1,x_2) = \log \sqrt {x_1^2 + x_2^2}
\end{align*}\]</span></p>
<p>We have:</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial f}{\partial x_1} &amp;= \frac{1}{\sqrt{x_1^2 + x_2^2}} \cdot \frac{\partial }{\partial x_1} (\sqrt{x_1^2 + x_2^2})\\
&amp;=\frac{1}{\sqrt{x_1^2 + x_2^2}} \cdot \frac{x_1}{\sqrt{x_1^2 + x_2^2}}\\
&amp;= \frac{x_1}{x_1^2 + x_2^2}
\end{align*}\]</span></p>
<p>Further,</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial^2 f}{\partial x_1^2} &amp;= \frac{(x_1^2 + x_2^2)(1) - x_1(2x_1)}{(x_1^2 + x_2^2)^2} \\
&amp;= \frac{x_1^2 - x_2^2}{(x_1^2 + x_2^2)}
\end{align*}\]</span></p>
<p>By symmetry,</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial^2 f}{\partial x_2^2}
&amp;= \frac{x_2^2 - x_1^2}{(x_1^2 + x_2^2)}
\end{align*}\]</span></p>
<p>So,</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial^2 f}{\partial x_1^2} &amp;= - \frac{\partial^2 f}{\partial x_2^2}\\
\frac{\partial^2 f}{\partial x_1^2} + \frac{\partial^2 f}{\partial x_2^2}&amp;=0
\end{align*}\]</span></p>
<p>We conclude that <span class="math inline">\(f\)</span> is harmonic.</p>
<p>Next, consider</p>
<p><span class="math display">\[\begin{align*}
g(x_1,x_2,\ldots,x_d) = \frac{1}{\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^{d-2}}
\end{align*}\]</span></p>
<p>Now,</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial g}{\partial x_i} &amp;= \frac{(2-d)}{\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^{d-1}} \cdot \frac{\partial }{\partial x_i}\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)\\
&amp;= \frac{(2-d)}{\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^{d-1}}\cdot \frac{2x_i}{2\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)}\\
&amp;= \frac{(2-d)x_i}{\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^d}
\end{align*}\]</span></p>
<p>Further, we have:</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial^2 g}{\partial x_i^2} &amp;= (2-d)\frac{\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^d (1) - (x_i)\cdot d \cdot\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^{d-1}\cdot \frac{x_i}{\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)}}{\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^{2d}}\\
&amp;=(2-d)\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^{d-2} \frac{\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^2  - d x_i^2}{\left(\sqrt{x_1^2 + x_2^2 + \ldots + x_d^2}\right)^{2d}}\\
&amp;=(2-d) \frac{\left(\sum_{i=1}^d x_i^2\right) - dx_i^2 }{||x||^{d+2}}
\end{align*}\]</span></p>
<p>We conclude that:</p>
<p><span class="math display">\[\begin{align*}
\sum_{i=1}^{d} \frac{\partial^2 g}{\partial x_i^2} = 0
\end{align*}\]</span></p>
<p>and hence <span class="math inline">\(g\)</span> is harmonic.</p>
</div>
<p>Interestingly enough, the answer to the recurrence versus transience puzzle depends on the dimension. We will show that Brownian motion is recurrent in dimension <span class="math inline">\(d=2\)</span> in the sense that every Brownian motion path starting from <span class="math inline">\(x\)</span> will eventually enter a disc around the origin, no matter how small the disc is. The Brownian path will then enter this disc infinitely many times, as <span class="math inline">\(t \to \infty\)</span>. Note that, we did not say that the path actually hits <span class="math inline">\(0\)</span>, but that <em>it enters a disc around the <span class="math inline">\(0\)</span></em>. This nuance is important, as we will in fact show that a Brownian path actually never hits a given point. In dimension <span class="math inline">\(d=3\)</span> or higher, it is proved that there are some paths starting from a given <span class="math inline">\(x\)</span> that will never enter a given ball around the origin with positive probability. This is the transience property.</p>
<p>The strategy of the proof is similar to the approach for Brownian motion with a drift. We will find a good function <span class="math inline">\(h : \mathbf{R}^d \to \mathbf{R}\)</span> for which <span class="math inline">\(h(B_t)\)</span> is a martingale. In light of <a href="#cor-brownian-martingales">Corollary&nbsp;1</a>, this function needs to be harmonic in a suitable region. The desired probability is then obtained by considering the right boundary values.</p>
<div id="thm-recurrence-and-transience-of-brownian-motion" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Recurrence and transience of a brownian motion in <span class="math inline">\(\mathbf{R}^d\)</span>) </strong></span>Let <span class="math inline">\((B_t,t\geq 0)\)</span> be a Brownian motion in <span class="math inline">\(\mathbf{R}^d\)</span> starting at <span class="math inline">\(B_0 = x\)</span>. Consider for <span class="math inline">\(r &lt; ||x||\)</span>, the stopping time</p>
<p><span class="math display">\[\begin{align*}
\tau_r = \min \{t \geq 0 : ||B_t|| &lt; r\}
\end{align*}\]</span></p>
<p>the first hitting time of the paths in a ball of radius <span class="math inline">\(r\)</span> around the origin. We have:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{P}(\tau_r &lt; \infty) =
\begin{cases}
1 &amp; \text{ if }d \leq 2 \\
\left(\frac{r}{||x||}\right)^{d-2} &amp; \text{ if }d \geq 3
\end{cases}
\end{align*}\]</span></p>
<p>In particular, for <span class="math inline">\(d \leq 2\)</span>, the paths are recurrent; that is, they come back infinitely many times in a neighbourhood of the origin. For <span class="math inline">\(d \geq 3\)</span>, each path will eventually never come back to a neighbourhood of the origin.</p>
</div>
<p>Note that we made sure that the starting point of the Brownian motion <span class="math inline">\(x\)</span> is outside the ball of radius <span class="math inline">\(r\)</span>.</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Consider another hitting time of a ball with a radius larger than <span class="math inline">\(||x||\)</span>:</p>
<p><span class="math display">\[\begin{align*}
\tau_R' = \min \{t \geq 0 : ||B_t|| \geq R\}, \quad r &lt; ||x|| &lt; R
\end{align*}\]</span></p>
<p>Note that <span class="math inline">\(\tau_R'\)</span> must increase with <span class="math inline">\(R\)</span> and that it must go to <span class="math inline">\(+\infty\)</span> as <span class="math inline">\(R \to \infty\)</span>. Moreover, the sequence of events <span class="math inline">\(\{\tau_r &lt; \tau_R'\}_{R &gt; ||x||}\)</span> is increasing. In particular, by continuity of probability measure, we have:</p>
<p><span class="math display">\[\begin{align*}
\lim_{R \to \infty} \mathbb{P}(\tau_r &lt; \tau_R') &amp;= \mathbb{P}(\lim_{R \to \infty} \tau_r &lt; \tau_R')\\
&amp;= \mathbb{P}(\tau_r &lt; \infty)
\end{align*}\]</span></p>
<p>If we set <span class="math inline">\(\tau = \tau_r \land \tau_R'\)</span>, then the event <span class="math inline">\(\{\tau_r &lt; \tau_R'\}\)</span> is the same as the event <span class="math inline">\(\{||B_\tau||=r\}\)</span>. So, <span class="math inline">\(\lim_{R \to \infty} \mathbb{P}(\tau_r &lt; \tau_R') = \lim_{R \to \infty} \mathbb{P}(||B_\tau||=r)\)</span>.</p>
<p>Now, consider the event <span class="math inline">\(\{\tau &lt; \infty\}\)</span>. Let <span class="math inline">\(E_n\)</span> be the event that the <span class="math inline">\(n\)</span>th increment <span class="math inline">\(||B_n - B_{n-1}||\)</span> exceeds <span class="math inline">\(R\)</span>. If <span class="math inline">\(E_n\)</span> occurs, then we must have the Brownian motion exits the spherical shell of thickness <span class="math inline">\(R-r\)</span>. Moreover, we have <span class="math inline">\(\mathbb{P}(E_1) = \ldots = \mathbb{P}(E_n)\)</span>, for all <span class="math inline">\(n\)</span>. Call this probability <span class="math inline">\(p\)</span>. Clearly, <span class="math inline">\(0 &lt; p &lt; 1\)</span>. Since the events <span class="math inline">\(E_n\)</span> are independent, we have:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{P}(E_1^C \cap \ldots \cap E_n^C) = (1 - p)^n
\end{align*}\]</span></p>
<p>As <span class="math inline">\(n \to \infty\)</span>, we have <span class="math inline">\(\lim_{n \to \infty} \mathbb{P}(\bigcap_{k=1}^{n}E_k^C) = 0\)</span>. Now, let <span class="math inline">\(F_k\)</span> be the event that there are no excursions upto <span class="math inline">\(k\)</span>. That is, <span class="math inline">\(F_k = \bigcap_{i=1}^{k}E_i^C\)</span>. Now, the event <span class="math inline">\(F_{k+1}\)</span> implies <span class="math inline">\(F_k\)</span>, or equivalently, <span class="math inline">\(F_{k+1} \subseteq F_k\)</span>. So, <span class="math inline">\(\{F_k\}_{k=1}^{\infty}\)</span> is a decreasing sequence of events. Moreover, <span class="math inline">\(\bigcap_{k=1}^n F_k = \bigcap_{k=1}^n E_k^C\)</span>. So, by continuity of probability measure,</p>
<p><span class="math display">\[\begin{align*}
\lim_{n \to \infty} \mathbb{P}(\bigcap_{k=1}^{n}E_k^C)
&amp;= \lim_{n \to \infty} \mathbb{P}(\bigcap_{k=1}^{n}F_k) \\
&amp;= \mathbb{P}(\lim_{n \to \infty} \bigcap_{k=1}^{n}F_k) \\
&amp;= \mathbb{P}(\bigcap_{k=1}^{\infty}F_k) \\
&amp;= \mathbb{P}(\bigcap_{k=1}^{\infty}E_k^C)
\end{align*}\]</span></p>
<p>So, <span class="math inline">\(\mathbb{P}(\bigcup_{k=1}^{\infty}E_k) = 1\)</span>. There exists an <span class="math inline">\(n_0 \in \mathbf{N}\)</span>, such that the event <span class="math inline">\(E_{n_0}\)</span>, an excursion at <span class="math inline">\(n_0\)</span> occurs with probability <span class="math inline">\(1\)</span>. So, the event <span class="math inline">\(\{\tau &lt; \infty\}\)</span> occurs almost surely.</p>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>