<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quasar">
<meta name="dcterms.date" content="2025-11-21">

<title>quantdev.blog - Pythonic code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap')
</style>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9993009899870547" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../.././symbol.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quantdev.blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../sell_side_quant_critical_path.html" rel="" target="">
 <span class="menu-text">Sell-side Quant</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../roadmap.html" rel="" target="">
 <span class="menu-text">C++ Roadmap</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://patreon.com/u59411143?utm_medium=unknown&amp;utm_source=join_link&amp;utm_campaign=creatorshare_creator&amp;utm_content=copyLink" rel="" target=""><i class="bi bi-patreon" role="img">
</i> 
 <span class="menu-text">Become a patreon</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/quasar-chunawala" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://linkedin.com/in/quasar-chunawala" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Pythonic code</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Python</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Quasar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 21, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pythonic-code" id="toc-pythonic-code" class="nav-link active" data-scroll-target="#pythonic-code">Pythonic code</a>
  <ul class="collapse">
  <li><a href="#context-managers" id="toc-context-managers" class="nav-link" data-scroll-target="#context-managers">Context Managers</a>
  <ul class="collapse">
  <li><a href="#implementing-context-managers" id="toc-implementing-context-managers" class="nav-link" data-scroll-target="#implementing-context-managers">Implementing context managers</a></li>
  </ul></li>
  <li><a href="#comprehensions-and-assignment-expressions" id="toc-comprehensions-and-assignment-expressions" class="nav-link" data-scroll-target="#comprehensions-and-assignment-expressions">Comprehensions and assignment expressions</a></li>
  <li><a href="#properties-attributes-and-different-types-of-methods-for-objects" id="toc-properties-attributes-and-different-types-of-methods-for-objects" class="nav-link" data-scroll-target="#properties-attributes-and-different-types-of-methods-for-objects">Properties, attributes and different types of methods for objects</a>
  <ul class="collapse">
  <li><a href="#underscores-in-python" id="toc-underscores-in-python" class="nav-link" data-scroll-target="#underscores-in-python">Underscores in Python</a></li>
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties">Properties</a></li>
  </ul></li>
  <li><a href="#using-dataclasses" id="toc-using-dataclasses" class="nav-link" data-scroll-target="#using-dataclasses">Using <code>dataclasses</code></a>
  <ul class="collapse">
  <li><a href="#immutable-dataclass" id="toc-immutable-dataclass" class="nav-link" data-scroll-target="#immutable-dataclass">Immutable <code>dataclass</code></a></li>
  <li><a href="#why-not-just-use-attrs" id="toc-why-not-just-use-attrs" class="nav-link" data-scroll-target="#why-not-just-use-attrs">Why not just use <code>attrs</code>?</a></li>
  </ul></li>
  <li><a href="#iterable-objects" id="toc-iterable-objects" class="nav-link" data-scroll-target="#iterable-objects">Iterable objects</a>
  <ul class="collapse">
  <li><a href="#creating-iterable-objects" id="toc-creating-iterable-objects" class="nav-link" data-scroll-target="#creating-iterable-objects">Creating iterable objects</a></li>
  <li><a href="#the-basic-mechanics" id="toc-the-basic-mechanics" class="nav-link" data-scroll-target="#the-basic-mechanics">The basic mechanics</a></li>
  </ul></li>
  <li><a href="#creating-sequences" id="toc-creating-sequences" class="nav-link" data-scroll-target="#creating-sequences">Creating sequences</a></li>
  <li><a href="#container-objects" id="toc-container-objects" class="nav-link" data-scroll-target="#container-objects">Container objects</a></li>
  <li><a href="#dynamic-attributes" id="toc-dynamic-attributes" class="nav-link" data-scroll-target="#dynamic-attributes">Dynamic attributes</a></li>
  <li><a href="#callable-objects" id="toc-callable-objects" class="nav-link" data-scroll-target="#callable-objects">Callable objects</a></li>
  <li><a href="#python-collections.abc-module" id="toc-python-collections.abc-module" class="nav-link" data-scroll-target="#python-collections.abc-module">Python <code>collections.abc</code> module</a></li>
  <li><a href="#caveats" id="toc-caveats" class="nav-link" data-scroll-target="#caveats">Caveats</a>
  <ul class="collapse">
  <li><a href="#mutable-default-arguments" id="toc-mutable-default-arguments" class="nav-link" data-scroll-target="#mutable-default-arguments">Mutable default arguments</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="pythonic-code" class="level1">
<h1>Pythonic code</h1>
<section id="context-managers" class="level2">
<h2 class="anchored" data-anchor-id="context-managers">Context Managers</h2>
<p>Context managers are a very useful feature in Python. Most of the time, we see contet managers around resource management. For example, in situations, when we open files, we want to make sure they are closed after processing (so we do not leak file descriptors). Or, if we open a connection to a service (or even a socket), we also want to be sure to close it accordingly. In all of these cases, you would normally have to remember to free all of the resources that were allocated and that is just thinking about the best case - there could be also be exceptions and error handling. Handling all possible combinations and execution paths of our program makes it harder. There is a elegant Pythonic way of handling this.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="cf">with</span> <span class="bu">open</span>(filename) <span class="im">as</span> fd:</span>
<span id="cb1-2"><a href="#cb1-2"></a>    process_file(fd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>with</code> statement (PEP-43) enters the context manager. In this case, the <code>open</code> function implements the context manager protocol, which means that the file will be automatically closed when the block is finished, even if an exception occurred.</p>
<p>Context managers consist of two magic methods <code>__enter__</code> and <code>__exit__</code>. On the first line of the context manager, the <code>with</code> statement will call the first method, <code>__enter__</code>, and whatever this method returns will be assigned to the variable after <code>as</code>. This is optional - we don’t really need to return anything specific on the <code>__enter__</code> method, even if we do, there is still no strict reason to assign it to a variable if it is not needed.</p>
<p>After this line is executed, the code enters a new context, where any other Python code can be run. After the last statement on the block is finished, the context will be exited, meaning that Python will call the <code>__exit__</code> method of the original context manager object we first invoked.</p>
<p>If there is an exception or error inside the context manager block, the <code>__exit__</code> method will still be called, which makes it convenient for safely cleaning up the conditions. In fact, this method receives the exceptions that was triggered on the block in case we want to handle it in a custom fashion.</p>
<p>Context managers are a good way of seperating concerns and isolating parts of the code that should be kept independent, because if we mix them, then the logic will become harder to maintain.</p>
<p>As an example, consider a situation where we want to run a backup of our database with a script. The caveat is that the backup is offline, which means that we can only do it while the database is not running, and for this we have to stop it. After running the backup, we want to be sure that we start the process again, regardless of how the backup itself went.</p>
<p>Instead of creating a monolithic function to do this, we can tackle this issue with context managers:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">def</span> stop_database():</span>
<span id="cb2-2"><a href="#cb2-2"></a>    run(<span class="st">"systemctl stop postgresql.service"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">def</span> start_database():</span>
<span id="cb2-5"><a href="#cb2-5"></a>    run(<span class="st">"systemctl start postgresql.service"</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">class</span> DBHandler:</span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="kw">def</span> <span class="fu">__enter__</span>(<span class="va">self</span>):</span>
<span id="cb2-9"><a href="#cb2-9"></a>        stop_database()</span>
<span id="cb2-10"><a href="#cb2-10"></a>        <span class="cf">return</span> <span class="va">self</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>    </span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="kw">def</span> <span class="fu">__exit__</span>(<span class="va">self</span>, exc_type, ex_value, ex_traceback):</span>
<span id="cb2-13"><a href="#cb2-13"></a>        start_database()</span>
<span id="cb2-14"><a href="#cb2-14"></a>    </span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="kw">def</span> db_backup():</span>
<span id="cb2-16"><a href="#cb2-16"></a>    run(<span class="st">"pg_dump database"</span>)</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="kw">def</span> main():</span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="cf">with</span> DBHandler():</span>
<span id="cb2-20"><a href="#cb2-20"></a>        db_backup()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="implementing-context-managers" class="level3">
<h3 class="anchored" data-anchor-id="implementing-context-managers">Implementing context managers</h3>
<p>In general, we can implement context managers like the one in the previous example. All we need is just a class that implements the <code>__enter__</code> and <code>__exit__</code> magic methods, and then that object will be able to support the context manager protocol. While this is the most common way for context managers to be implemented, it is not the only one.</p>
<p>The <code>contextlib</code> module in the Python standard library contains a lot of helper functions and objects to implement context managers or use ones already provided that can help us write more compact code.</p>
<p>Lets start by looking at the <code>contextmanager</code> decorator.</p>
<p>When the <code>contextlib.contextmanager</code> decorator is applied to a function, it converts the code on that function into a context manager. The function in question has to be a particular kind of function called a <code>generator</code> function, which will separate statements into what is going to be on <code>__enter__</code> and <code>__exit__</code> magic methods respectively.</p>
<p>The equivalent code in the previous example can be written as:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> contextlib</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="at">@contextlib.contextmanager</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">def</span> db_handler():</span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="cf">try</span>:</span>
<span id="cb3-6"><a href="#cb3-6"></a>        stop_database()</span>
<span id="cb3-7"><a href="#cb3-7"></a>        <span class="cf">yield</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="cf">finally</span>:</span>
<span id="cb3-9"><a href="#cb3-9"></a>        start_database()</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="cf">with</span> db_handler():</span>
<span id="cb3-12"><a href="#cb3-12"></a>    db_backup()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, we define the <code>generator</code> function and apply the <code>@contextlib.contextmanager</code> decorator to it. The function contains a <code>yield</code> statement, which makes it a generator function. Details on generators are not important at this point. All we need to know, is when the decorator is applied, everything before the <code>yield</code> statement will be run as if it were part of the <code>__enter__</code> method. Then the yielded value is going to be the result of the context manager evaluation (what <code>__enter__</code> would return and what would be assigned to the variable if we chose to assign it like <code>as x:</code> - in this case nothing is yielded).</p>
<p>At the <code>yield</code> statement, the <code>generator</code> function is suspended, and the context manager is entered, where, again we run the backup code for our database. After this completes, the execution resumes, so we can consider every line that comes after the <code>yield</code> statement will be part of <code>__exit__</code> logic.</p>
<p>Writing context managers like this has the advantage that it is easier to refactor existing functions, reuse code and in general a good idea when we need a context manager that doesn’t belong to a particular object.</p>
<p>Using context managers is considered idiomatic.</p>
</section>
</section>
<section id="comprehensions-and-assignment-expressions" class="level2">
<h2 class="anchored" data-anchor-id="comprehensions-and-assignment-expressions">Comprehensions and assignment expressions</h2>
<p>The use of comprehensions is recommended to create data-structures in a single instruction, instead of multiple operations. For example, if we wanted to create a list with calculations over some numbers in it, instead of:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>numbers <span class="op">=</span> []</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb4-3"><a href="#cb4-3"></a>    numbers.append(run_calculation(i))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>we could do:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>numbers <span class="op">=</span> [run_calculation(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The introduction of assignment expressions in <a href="https://www.python.org/dev/peps/pep-0572/">PEP-572</a> is also very useful.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Compute partial sums in a list comprehension</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>partial_sums <span class="op">=</span> [total <span class="op">:=</span> total <span class="op">+</span> v <span class="cf">for</span> v <span class="kw">in</span> values]</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="bu">print</span>(<span class="st">"Total:"</span>, total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>:=</code> operator is informally known as the walrus operator.</p>
<p>Keep in mind however, that a more compact code does not always mean better better code. If to write a one-liner, we have to create a convoluted expression, then its not worth it, and we would be better off using a naive approach. This is related to the <em>Keep it simple, stupid</em>(KISS) principle.</p>
<p>Another good reason for using assignment expressions in general is the performance considerations. If we have to use a function as part of our transformation logic, we don’t want to call that more than is necessary. Assigning the result of the function to a temporary identifier is a good optimization technique.</p>
</section>
<section id="properties-attributes-and-different-types-of-methods-for-objects" class="level2">
<h2 class="anchored" data-anchor-id="properties-attributes-and-different-types-of-methods-for-objects">Properties, attributes and different types of methods for objects</h2>
<p>All of the properties and functions of object are <code>public</code> in Python, which is different from other languages where properties can have the access specifier <code>public</code>, <code>private</code> and <code>protected</code>. That is, there is no point in preventing the caller from invoking any attributes an object has.</p>
<p>There is no strict enforcement, but there are some conventions. An attribute that starts with an underscore is meant to be <code>private</code> to that object, and we expect that no external agent calls it (but again nothing preventing this).</p>
<section id="underscores-in-python" class="level3">
<h3 class="anchored" data-anchor-id="underscores-in-python">Underscores in Python</h3>
<p>There are some conventions and implementation details that make use of underscores in Python, which is an interesting topic in itself that’s worthy of analysis.</p>
<p>Like I mentioned, by default, all attributes of an object in python are <code>public</code>. Consider the following example :</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">class</span> Point:</span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, x_value, y_value):</span>
<span id="cb7-3"><a href="#cb7-3"></a>        <span class="va">self</span>._x_value <span class="op">=</span> x_value</span>
<span id="cb7-4"><a href="#cb7-4"></a>        <span class="va">self</span>._y_value <span class="op">=</span> y_value</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a>p1 <span class="op">=</span> Point(<span class="fl">1.0</span>, <span class="fl">2.0</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>p1.__dict__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>{'_x_value': 1.0, '_y_value': 2.0}</code></pre>
</div>
</div>
<p>Attributes that start with an underscore must be respected as <code>private</code> and not called externally. Using a single underscore prefix is the Pythonic way of clearly delimiting the interface of the object.</p>
<p>Note that, using too many internal methods and attributes could be a sign that a class has too many tasks and doesn’t comply with the single responsibility princple.</p>
<p>There is however, a common misconception that some attributes and methods can actually be made <code>private</code>. This is again a misconception. Let us imagine that the <code>x_value</code> and <code>y_value</code> attributes are defined with a leading double underscore instead.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">class</span> Point:</span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, x_value : <span class="bu">float</span>, y_value : <span class="pp">FloatingPointError</span>):</span>
<span id="cb9-3"><a href="#cb9-3"></a>        <span class="va">self</span>.__x_value <span class="op">=</span> x_value</span>
<span id="cb9-4"><a href="#cb9-4"></a>        <span class="va">self</span>._y_value <span class="op">=</span> y_value</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a>    <span class="kw">def</span> scale(<span class="va">self</span>, scale_factor : <span class="bu">float</span>):</span>
<span id="cb9-7"><a href="#cb9-7"></a>        <span class="va">self</span>.__x_value <span class="op">*=</span> scale_factor</span>
<span id="cb9-8"><a href="#cb9-8"></a>        <span class="va">self</span>._y_value <span class="op">*=</span> scale_factor</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a>p1 <span class="op">=</span> Point(<span class="fl">1.0</span>, <span class="fl">2.0</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a>p1.scale(<span class="fl">2.0</span>)</span>
<span id="cb9-13"><a href="#cb9-13"></a>p1.__x_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource shell number-lines code-with-copy"><code class="sourceCode"><span id="cb10-1"><a href="#cb10-1"></a>--------------------------------------------------------------------------</span>
<span id="cb10-2"><a href="#cb10-2"></a>AttributeError                            Traceback (most recent call last)</span>
<span id="cb10-3"><a href="#cb10-3"></a>Cell In[7], line 13</span>
<span id="cb10-4"><a href="#cb10-4"></a>     11 p1 = Point(1.0, 2.0)</span>
<span id="cb10-5"><a href="#cb10-5"></a>     12 p1.scale(2.0)</span>
<span id="cb10-6"><a href="#cb10-6"></a>---&gt; 13 p1.__x_value</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>AttributeError: 'Point' object has no attribute '__x_value'</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Some developers use this method to hide some attributes, thinking that <code>x_value</code> is now <code>private</code> and that no other object can modify it. Now, take a look at the exception that it raised when trying to access <code>__x_value</code>. It’s <code>AttributeError</code> saying that it doesn’t exist. It doesn’t say something like <em>this is private</em>,</p>
<p>What’s actually happening is that with the double underscores, Python creates a different name for the attribute (this is called as name mangling). What it does is create the attribute with the following name instead <code>&lt;class_name&gt;__&lt;attribute_name&gt;</code>. In this case the attribute named <code>Point__x_value</code> will be created.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>p1.__dict__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>{'_x_value': 1.0, '_y_value': 2.0}</code></pre>
</div>
</div>
<p>The idea of a double underscore in Python is completely different. It was created as a means to override different methods of a class that is going to be extended several times. Double underscores are a non-Pythonic approach. If you need to defined attributes as <code>private</code>, use a single underscore and respect the Pythonic convention that it is a <code>private</code> attribute.</p>
</section>
<section id="properties" class="level3">
<h3 class="anchored" data-anchor-id="properties">Properties</h3>
<p>Typically, in object-oriented design we create objects to represent an abstraction over an entity of the problem domain. In this sense, objects can encapsulate the behavior or data. And more often than not, the accuracy of the data determines if an object can be created or not. That is to say, entities can exist for certain values of the data only, and incorrect values should not be allowed.</p>
<p>That is, why we create validation methods, typically to be used in <code>setter</code> operations. However, in Python, we can encapsulate the <code>setter</code> and <code>getter</code> methods more compactly using <code>properties</code>.</p>
<p>Consider the example of a geographical system that needs to deal with coordinates. There is only a certain range of values for which the latitude and the longitude make sense. Outside of those values, a coordinate cannot exist.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">class</span> Coordinate:</span>
<span id="cb13-2"><a href="#cb13-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, lat: <span class="bu">float</span>, <span class="bu">long</span>: <span class="bu">float</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb13-3"><a href="#cb13-3"></a>        <span class="va">self</span>._latitude <span class="op">=</span> <span class="va">self</span>._longitude <span class="op">=</span> <span class="va">None</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>        <span class="va">self</span>.latitude <span class="op">=</span> lat</span>
<span id="cb13-5"><a href="#cb13-5"></a>        <span class="va">self</span>.longitude <span class="op">=</span> <span class="bu">long</span></span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="at">@property</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>    <span class="kw">def</span> latitude(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb13-9"><a href="#cb13-9"></a>        <span class="cf">return</span> <span class="va">self</span>._latitude</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a>    <span class="at">@latitude.setter</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>    <span class="kw">def</span> latitude(<span class="va">self</span>, lat_value: <span class="bu">float</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb13-13"><a href="#cb13-13"></a>        <span class="cf">if</span> lat_value <span class="kw">not</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">90</span>, <span class="dv">90</span> <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb13-14"><a href="#cb13-14"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"</span><span class="sc">{</span>lat_value<span class="sc">}</span><span class="ss"> is an invalid value for latitude"</span>)</span>
<span id="cb13-15"><a href="#cb13-15"></a></span>
<span id="cb13-16"><a href="#cb13-16"></a>        <span class="va">self</span>._latitude <span class="op">=</span> lat_value</span>
<span id="cb13-17"><a href="#cb13-17"></a></span>
<span id="cb13-18"><a href="#cb13-18"></a>    <span class="at">@property</span></span>
<span id="cb13-19"><a href="#cb13-19"></a>    <span class="kw">def</span> longitude(<span class="va">self</span>)<span class="op">-&gt;</span><span class="bu">float</span>:</span>
<span id="cb13-20"><a href="#cb13-20"></a>        <span class="cf">return</span> <span class="va">self</span>._longitude</span>
<span id="cb13-21"><a href="#cb13-21"></a></span>
<span id="cb13-22"><a href="#cb13-22"></a>    <span class="at">@longitude.setter</span></span>
<span id="cb13-23"><a href="#cb13-23"></a>    <span class="kw">def</span> longitude(<span class="va">self</span>, long_value:<span class="bu">float</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb13-24"><a href="#cb13-24"></a>        <span class="cf">if</span> long_value <span class="kw">not</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">180</span><span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb13-25"><a href="#cb13-25"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"</span><span class="sc">{</span>lat_value<span class="sc">}</span><span class="ss"> is an invalid value for longitude"</span>)</span>
<span id="cb13-26"><a href="#cb13-26"></a></span>
<span id="cb13-27"><a href="#cb13-27"></a>        <span class="va">self</span>._longitude <span class="op">=</span> long_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="using-dataclasses" class="level2">
<h2 class="anchored" data-anchor-id="using-dataclasses">Using <code>dataclasses</code></h2>
<p>A <code>dataclass</code> is a class that exists primarily to store values which are accessible by attribute lookup and not complex logic. There is a common boilerplate when it comes to initialization of such objects, which is to declare in the <code>__init__</code> method all attributes that the object will have, and then set that to internal variables.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">class</span> Point:</span>
<span id="cb14-2"><a href="#cb14-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, x:<span class="bu">float</span>, y:<span class="bu">float</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb14-3"><a href="#cb14-3"></a>        <span class="va">self</span>._x <span class="op">=</span> x</span>
<span id="cb14-4"><a href="#cb14-4"></a>        <span class="va">self</span>._y <span class="op">=</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Since Python 3.7 we can simplify this by using the <code>dataclasses</code> module, which was introduced in <a href="https://peps.python.org/pep-0557/#rationale">PEP-557</a>. We’ll review this module briefly to understand how it helps us write compact code.</p>
<p>The module provides a <code>@dataclass</code> decorator objectr which when applied to a class, it’ll take all the class attributes with annotations and treat them as instance attributes, as if they were declared in the initialization method. When using this method, it will automatically generate the <code>__init__</code> method on the class.</p>
<p>Additionally, this module provides a <code>field</code> object that will help us define particular traits for some of the attributes.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass, field</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="at">@dataclass</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="kw">class</span> VanillaOptionQuote:</span>
<span id="cb15-5"><a href="#cb15-5"></a>    strike : <span class="bu">float</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>    spot : <span class="bu">float</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>    implied_vol : <span class="bu">float</span> </span>
<span id="cb15-8"><a href="#cb15-8"></a>    underlying : <span class="bu">str</span> </span>
<span id="cb15-9"><a href="#cb15-9"></a>    time_to_maturity : <span class="bu">float</span> <span class="op">=</span> field(default<span class="op">=</span><span class="fl">1.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>Field</code> objects describe each field. These objects are created internally and are returned by the <code>fields()</code> module-level method. Users should never instantiate a <code>Field</code> object directly. Its documented attributes are:</p>
<ul>
<li><code>name</code>: Name of the field</li>
<li><code>type</code>: The type of the field</li>
<li><code>default</code>: If provided, this will be th default value for this field.</li>
<li><code>default_factory</code>: If provided, it must be a zero-argument callable that will be called when a default value is needed for this field.</li>
<li><code>init</code>: If <code>true</code>(default), this field is included as a parameter in the generated <code>__init__</code> method.</li>
<li><code>__repr__</code> : If <code>true</code>(default), this field is included in the string returned by <code>__repr__</code> method.</li>
</ul>
<p>A good use-case for dataclass would be all those places when we need to use objects as data-containers or wrappers.</p>
<section id="immutable-dataclass" class="level3">
<h3 class="anchored" data-anchor-id="immutable-dataclass">Immutable <code>dataclass</code></h3>
<p>It is not possible to create truly immutable Python objects. However, by passing <code>frozen=True</code> to the <code>@dataclass</code> decorator you can emulate immutability. In that case, Data Classes will add <code>__setattr__</code> and <code>__delattr__</code> methods to the class. These methods will raise a <code>FrozenInstanceError</code> when invoked.</p>
</section>
<section id="why-not-just-use-attrs" class="level3">
<h3 class="anchored" data-anchor-id="why-not-just-use-attrs">Why not just use <code>attrs</code>?</h3>
<ul>
<li><code>attrs</code> moves faster than could be accomodated if it were moved to the standard library.</li>
<li><code>attrs</code> supports additional features not being proposed here : validators, converters, metadata etc.</li>
</ul>
</section>
</section>
<section id="iterable-objects" class="level2">
<h2 class="anchored" data-anchor-id="iterable-objects">Iterable objects</h2>
<p>In python, we have objects that can be iterated by default. For example, lists, sets, tuples and dictionaries can not only hold data in the structure, but also be iterated over a <code>for</code> loop to get those values repeatedly.</p>
<p>However, the built-in <code>iterable</code> objects are not the only kind we can have in a <code>for</code> loop. We can also create our own iterable, with the logic we define for iteration.</p>
<p>In order to achieve this, we rely again on magic methods. Iteration works in Python by its own protocol(namely the <code>iterator</code> protocol). When you try to iterate an object in the form <code>for e in my_collection:...</code>, at a high-level, Python checks for:</p>
<ul>
<li>If the object contains one of the iterator methods - <code>__next__</code> or <code>__iter__</code>.</li>
<li>If the object is a sequence and has <code>__len__</code> and <code>__get_item__</code></li>
</ul>
<section id="creating-iterable-objects" class="level3">
<h3 class="anchored" data-anchor-id="creating-iterable-objects">Creating iterable objects</h3>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="im">from</span> datetime <span class="im">import</span> timedelta</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw">class</span> DateRange:</span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="co">"""An iterable that contains its own iterator object."""</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, start_date: dt.date, end_date: dt.date):</span>
<span id="cb16-7"><a href="#cb16-7"></a>        <span class="va">self</span>._start_date <span class="op">=</span> start_date</span>
<span id="cb16-8"><a href="#cb16-8"></a>        <span class="va">self</span>._end_date <span class="op">=</span> end_date</span>
<span id="cb16-9"><a href="#cb16-9"></a>        <span class="va">self</span>._present_date <span class="op">=</span> start_date</span>
<span id="cb16-10"><a href="#cb16-10"></a></span>
<span id="cb16-11"><a href="#cb16-11"></a>    <span class="kw">def</span> <span class="fu">__iter__</span>(<span class="va">self</span>):</span>
<span id="cb16-12"><a href="#cb16-12"></a>        <span class="cf">return</span> <span class="va">self</span></span>
<span id="cb16-13"><a href="#cb16-13"></a></span>
<span id="cb16-14"><a href="#cb16-14"></a>    <span class="kw">def</span> <span class="fu">__next__</span>(<span class="va">self</span>):</span>
<span id="cb16-15"><a href="#cb16-15"></a>        <span class="cf">if</span> <span class="va">self</span>._present_date <span class="op">&gt;=</span> <span class="va">self</span>._end_date:</span>
<span id="cb16-16"><a href="#cb16-16"></a>            <span class="cf">raise</span> <span class="pp">StopIteration</span>()</span>
<span id="cb16-17"><a href="#cb16-17"></a></span>
<span id="cb16-18"><a href="#cb16-18"></a>        today <span class="op">=</span> <span class="va">self</span>._present_date</span>
<span id="cb16-19"><a href="#cb16-19"></a>        <span class="va">self</span>._present_date <span class="op">+=</span> timedelta(days<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-20"><a href="#cb16-20"></a>        <span class="cf">return</span> today</span>
<span id="cb16-21"><a href="#cb16-21"></a></span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="cf">for</span> day <span class="kw">in</span> DateRange(dt.date(<span class="dv">2026</span>,<span class="dv">1</span>,<span class="dv">1</span>), dt.date(<span class="dv">2026</span>, <span class="dv">1</span>, <span class="dv">8</span>)):</span>
<span id="cb16-23"><a href="#cb16-23"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>day<span class="sc">}</span><span class="ss">"</span>)        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2026-01-01
2026-01-02
2026-01-03
2026-01-04
2026-01-05
2026-01-06
2026-01-07</code></pre>
</div>
</div>
</section>
<section id="the-basic-mechanics" class="level3">
<h3 class="anchored" data-anchor-id="the-basic-mechanics">The basic mechanics</h3>
<p>Here, the <code>for</code> loop starts a new iteration over our object. At this point Python will call the <code>iter()</code> function on it, which in turn will call the <code>__iter__</code> magic method. On this method, it is decided to return <code>self</code>, indicating that the object is an <code>iterable</code> itself. Every step of the loop calls the <code>next()</code> function on this object, which delegates to <code>__next__</code> method. When there is nothing else to produce, we have to signal this to Python by raising <code>StopIteration</code> exception.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>r <span class="op">=</span> DateRange(dt.date(<span class="dv">2026</span>,<span class="dv">1</span>,<span class="dv">1</span>), dt.date(<span class="dv">2026</span>, <span class="dv">1</span>, <span class="dv">8</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="bu">print</span>(<span class="bu">next</span>(r))</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="bu">print</span>(<span class="bu">next</span>(r))</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="bu">print</span>(<span class="bu">next</span>(r))</span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="bu">print</span>(<span class="bu">next</span>(r))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2026-01-01
2026-01-02
2026-01-03
2026-01-04</code></pre>
</div>
</div>
<p>This example works, but it has a small problem - once exhausted, the <code>iterable</code> will continue to be empty, hence raising <code>StopIteration</code>.</p>
<p>If there are two or more consecutive <code>for</code> loops, only the first one will work, while the second one will remain empty. Because, there is only one shared iteration state. We should separate out the iterator from the iterable.</p>
</section>
</section>
<section id="creating-sequences" class="level2">
<h2 class="anchored" data-anchor-id="creating-sequences">Creating sequences</h2>
<p>Maybe our object does not define the <code>__iter__()</code> method, but we still want to be able to iterate over it. If <code>__iter__</code> is not defined on the object, the <code>iter()</code> function will look for the presence of <code>__getitem__</code>, and if this is not found, it will raise <code>TypeError</code>.</p>
<p>A sequence is an object that implements <code>__len__</code> and <code>__getitem__</code> magic methods and expects to be able to get the elements it contains, one at a time, in order, starting at <span class="math inline">\(0\)</span> as the first index. This means that you should be careful in the logic so that you correctly implement <code>__get_item__</code> to expect this type of index, or the iteration will not work.</p>
<p>The example from the previous section had the advantage that it uses less memory. This means that it is only holding one date at a time and knows how to produce the days one by one. However, it has the drawback that if we want to get to the <code>n</code>th element, we have no way to do so but iterate <span class="math inline">\(n\)</span> times. until we reach it. This is a typical trade-off in CS between memory and CPU usage.</p>
<p>The implementation with an <code>iterable</code> will use memory, but take <span class="math inline">\(O(n)\)</span> time, whereas implementing a sequence will use more(because we have to hold everything at once),but supports indexing in constant time.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">class</span> DateRangeSequence:</span>
<span id="cb20-2"><a href="#cb20-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, start_date : dt.date, end_date:dt.date):</span>
<span id="cb20-3"><a href="#cb20-3"></a>        <span class="va">self</span>._start_date <span class="op">=</span> start_date</span>
<span id="cb20-4"><a href="#cb20-4"></a>        <span class="va">self</span>._end_date <span class="op">=</span> end_date</span>
<span id="cb20-5"><a href="#cb20-5"></a>        <span class="va">self</span>._range <span class="op">=</span> <span class="va">self</span>._create_range()</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a>    <span class="kw">def</span> _create_range(<span class="va">self</span>):</span>
<span id="cb20-8"><a href="#cb20-8"></a>        days <span class="op">=</span> []</span>
<span id="cb20-9"><a href="#cb20-9"></a>        current_date <span class="op">=</span> <span class="va">self</span>._start_date</span>
<span id="cb20-10"><a href="#cb20-10"></a>        <span class="cf">while</span> current_date <span class="op">&lt;</span> <span class="va">self</span>._end_date:</span>
<span id="cb20-11"><a href="#cb20-11"></a>            days.append(current_date)</span>
<span id="cb20-12"><a href="#cb20-12"></a>            current_date <span class="op">+=</span> timedelta(days<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-13"><a href="#cb20-13"></a></span>
<span id="cb20-14"><a href="#cb20-14"></a>        <span class="cf">return</span> days</span>
<span id="cb20-15"><a href="#cb20-15"></a>    </span>
<span id="cb20-16"><a href="#cb20-16"></a>    <span class="kw">def</span> <span class="fu">__getitem__</span>(<span class="va">self</span>, day_idx):</span>
<span id="cb20-17"><a href="#cb20-17"></a>        <span class="cf">return</span> <span class="va">self</span>._range[day_idx]</span>
<span id="cb20-18"><a href="#cb20-18"></a></span>
<span id="cb20-19"><a href="#cb20-19"></a>    <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</span>
<span id="cb20-20"><a href="#cb20-20"></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>._range)</span>
<span id="cb20-21"><a href="#cb20-21"></a></span>
<span id="cb20-22"><a href="#cb20-22"></a>s1 <span class="op">=</span> DateRangeSequence(dt.date(<span class="dv">2026</span>,<span class="dv">1</span>,<span class="dv">1</span>), dt.date(<span class="dv">2026</span>,<span class="dv">1</span>,<span class="dv">6</span>))</span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="cf">for</span> day <span class="kw">in</span> s1:</span>
<span id="cb20-24"><a href="#cb20-24"></a>    <span class="bu">print</span>(day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2026-01-01
2026-01-02
2026-01-03
2026-01-04
2026-01-05</code></pre>
</div>
</div>
</section>
<section id="container-objects" class="level2">
<h2 class="anchored" data-anchor-id="container-objects">Container objects</h2>
<p>Containers are objects that implement a <code>__contains__</code> method(that usually returns a <code>boolean</code> value). This method is called in the presence of the python keyword <code>in</code>.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="at">@dataclass</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="kw">class</span> Interval:</span>
<span id="cb22-5"><a href="#cb22-5"></a>    left_end_point : <span class="bu">float</span> </span>
<span id="cb22-6"><a href="#cb22-6"></a>    right_end_point : <span class="bu">float</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>    exclude_right_end : <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span></span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a>    <span class="kw">def</span> <span class="fu">__contains__</span>(<span class="va">self</span>, x_value : <span class="bu">float</span>):</span>
<span id="cb22-10"><a href="#cb22-10"></a>        <span class="cf">if</span> <span class="va">self</span>.exclude_right_end:</span>
<span id="cb22-11"><a href="#cb22-11"></a>            <span class="cf">return</span> <span class="va">self</span>.left_end_point <span class="op">&lt;=</span> x_value <span class="kw">and</span> x_value <span class="op">&lt;</span> <span class="va">self</span>.right_end_point </span>
<span id="cb22-12"><a href="#cb22-12"></a>        <span class="cf">else</span>:</span>
<span id="cb22-13"><a href="#cb22-13"></a>            <span class="cf">return</span> <span class="va">self</span>.left_end_point <span class="op">&lt;=</span> x_value <span class="kw">and</span> x_value <span class="op">&lt;=</span> <span class="va">self</span>.right_end_point </span>
<span id="cb22-14"><a href="#cb22-14"></a></span>
<span id="cb22-15"><a href="#cb22-15"></a>interval <span class="op">=</span> Interval(<span class="fl">0.0</span>,<span class="fl">1.0</span>)</span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="bu">print</span>(<span class="ss">f"Is 0.5 contained in the interval [0,1) : </span><span class="sc">{</span><span class="fl">0.5</span> <span class="kw">in</span> interval<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="bu">print</span>(<span class="ss">f"Is 1.0 contained in the interval [0,1) : </span><span class="sc">{</span><span class="fl">1.0</span> <span class="kw">in</span> interval<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Is 0.5 contained in the interval [0,1) : True
Is 1.0 contained in the interval [0,1) : False</code></pre>
</div>
</div>
</section>
<section id="dynamic-attributes" class="level2">
<h2 class="anchored" data-anchor-id="dynamic-attributes">Dynamic attributes</h2>
<p>It is possible to control the way attributes are obtained from objects by means of the <code>__getattr__</code> magic method. When we call something like <code>&lt;my_object&gt;.&lt;my_attribute&gt;</code>, Python will look at <code>&lt;my_attribute&gt;</code> in the dictionary of the object, calling <code>__get_attribute__</code>. If this is not found (that is, the object does not have the attribute we are looking for), then the extra method <code>__getattr__</code> is called, passing in the name of the attribute as a parameter.</p>
<p>By receiving this value, we can control the way things should be returned to our objects. We can even create new attributes on the fly.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">class</span> DynamicAttributes:</span>
<span id="cb24-2"><a href="#cb24-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, attribute):</span>
<span id="cb24-3"><a href="#cb24-3"></a>        <span class="va">self</span>.attribute <span class="op">=</span> attribute</span>
<span id="cb24-4"><a href="#cb24-4"></a>    </span>
<span id="cb24-5"><a href="#cb24-5"></a>    <span class="kw">def</span> <span class="fu">__getattr__</span>(<span class="va">self</span>, attr):</span>
<span id="cb24-6"><a href="#cb24-6"></a>        <span class="cf">if</span> attr.startswith(<span class="st">"fallback_"</span>):</span>
<span id="cb24-7"><a href="#cb24-7"></a>            name <span class="op">=</span> attr.replace(<span class="st">"fallback_"</span>, <span class="st">""</span>)</span>
<span id="cb24-8"><a href="#cb24-8"></a>            <span class="cf">return</span> <span class="ss">f"[fallback resolved] </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>    </span>
<span id="cb24-10"><a href="#cb24-10"></a>        <span class="cf">raise</span> <span class="pp">AttributeError</span>(<span class="ss">f"</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>__class__<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> has no attribute </span><span class="sc">{</span>attr<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="callable-objects" class="level2">
<h2 class="anchored" data-anchor-id="callable-objects">Callable objects</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="kw">class</span> CallCount:</span>
<span id="cb25-4"><a href="#cb25-4"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb25-5"><a href="#cb25-5"></a>        <span class="va">self</span>._counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a></span>
<span id="cb25-7"><a href="#cb25-7"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, argument):</span>
<span id="cb25-8"><a href="#cb25-8"></a>        <span class="va">self</span>._counts[argument] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>        <span class="cf">return</span> <span class="va">self</span>._counts[argument]</span>
<span id="cb25-10"><a href="#cb25-10"></a></span>
<span id="cb25-11"><a href="#cb25-11"></a>call_count <span class="op">=</span> CallCount()</span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="bu">print</span>(call_count(<span class="st">"Hello"</span>))</span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="bu">print</span>(call_count(<span class="st">"World"</span>))</span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="bu">print</span>(call_count(<span class="st">"Hello"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
1
2</code></pre>
</div>
</div>
</section>
<section id="python-collections.abc-module" class="level2">
<h2 class="anchored" data-anchor-id="python-collections.abc-module">Python <code>collections.abc</code> module</h2>
<p>The best way to implement these methods is to declare our class to inherit from the corresponding class defined in the <code>collections.abc</code> module.</p>
<p>These interfaces provide the methods that need to be implemented, so it’ll make it easier for you to define the class correctly.</p>
<p>With practice and experience, you become more fluent with these features of Python, until it becomes second nature for you wrap the logic you’re writing behind abstractions with nice and small interfaces. Give it enough time, and you’ll naturally think of having small, clean interfaces in your programs.</p>
</section>
<section id="caveats" class="level2">
<h2 class="anchored" data-anchor-id="caveats">Caveats</h2>
<section id="mutable-default-arguments" class="level3">
<h3 class="anchored" data-anchor-id="mutable-default-arguments">Mutable default arguments</h3>
<p>Don’t use mutable objects as the default arguments of functions.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="quasar-chunawala/quantdev" data-repo-id="R_kgDOL2t5-A" data-category="General" data-category-id="DIC_kwDOL2t5-M4ClndQ" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>