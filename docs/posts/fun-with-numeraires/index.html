<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quasar">
<meta name="dcterms.date" content="2024-11-28">

<title>Fun with numeraires! â€“ quantdev.blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-d129a44951930463e8a313df5966fbea.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7c43ab0dc1b5750ae198bce08b29e1b3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap')
</style>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9993009899870547" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quantdev.blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Fun with numeraires!</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">Stochastic Calculus</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Quasar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 28, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  
  <li><a href="#girsanov-theorem" id="toc-girsanov-theorem" class="nav-link" data-scroll-target="#girsanov-theorem">Girsanov Theorem</a></li>
  <li><a href="#what-is-a-numeraire" id="toc-what-is-a-numeraire" class="nav-link" data-scroll-target="#what-is-a-numeraire">What is a numeraire?</a></li>
  <li><a href="#abstract-bayes-formula" id="toc-abstract-bayes-formula" class="nav-link" data-scroll-target="#abstract-bayes-formula">Abstract Bayes Formula</a></li>
  <li><a href="#martingale-property" id="toc-martingale-property" class="nav-link" data-scroll-target="#martingale-property">Martingale property</a></li>
  <li><a href="#drift-transformation-under-change-of-numeraire" id="toc-drift-transformation-under-change-of-numeraire" class="nav-link" data-scroll-target="#drift-transformation-under-change-of-numeraire">Drift transformation under change of numeraire</a></li>
  <li><a href="#examples-of-numeraires" id="toc-examples-of-numeraires" class="nav-link" data-scroll-target="#examples-of-numeraires">Examples of numeraires</a>
  <ul class="collapse">
  <li><a href="#bank-account-numeraire" id="toc-bank-account-numeraire" class="nav-link" data-scroll-target="#bank-account-numeraire">Bank-account numeraire</a></li>
  <li><a href="#forward-numeraire" id="toc-forward-numeraire" class="nav-link" data-scroll-target="#forward-numeraire">Forward numeraire</a></li>
  <li><a href="#pricing-an-irs" id="toc-pricing-an-irs" class="nav-link" data-scroll-target="#pricing-an-irs">Pricing an IRS</a></li>
  <li><a href="#the-annuity-measure" id="toc-the-annuity-measure" class="nav-link" data-scroll-target="#the-annuity-measure">The Annuity Measure</a></li>
  </ul></li>
  <li><a href="#pricing-the-payoff-vt-s_ts_t---k" id="toc-pricing-the-payoff-vt-s_ts_t---k" class="nav-link" data-scroll-target="#pricing-the-payoff-vt-s_ts_t---k">Pricing the payoff <span class="math inline">\(V(T) = S_T(S_T - K)^{+}\)</span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>A proficiency in the change-of-measure technique is useful to the working quant. An excellent summary of the important results is the note <a href="https://www.researchgate.net/publication/361692645_Girsanov_Numeraires_and_All_That">Girsanov, Numeraires and all that</a>, by Andrew Lesniewski. In this post, I would like to derive relevant results and then we can enjoy pricing some payoffs together!</p>
</section>

<section id="girsanov-theorem" class="level2">
<h2 class="anchored" data-anchor-id="girsanov-theorem">Girsanov Theorem</h2>
<div id="thm-Girsanov-theorem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Girsanov Theorem)</strong></span> Let <span class="math inline">\((W^{\mathbb{P}},t\geq 0)\)</span> be a <span class="math inline">\(\mathbb{P}\)</span> standard brownian motion on <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> and let <span class="math inline">\(\phi\)</span> be any adapted process. Choose fixed <span class="math inline">\(T\)</span> and defined the process <span class="math inline">\(L\)</span> on <span class="math inline">\([0,T]\)</span> by:</p>
<p><span id="eq-dynamics-of-Lt"><span class="math display">\[
\begin{align*}
dL_t = \phi_t L_t dW^{\mathbb{P}}_t
\end{align*}
\tag{1}\]</span></span></p>
<p><span id="eq-initial-condition"><span class="math display">\[
\begin{align*}
L_0 = 1
\end{align*}
\tag{2}\]</span></span></p>
<p>that is:</p>
<p><span id="eq-likelihood-process"><span class="math display">\[
\begin{align*}
L_t = \exp\left(\int_0^t \phi_s dW^{\mathbb{P}}_s - \int_0^t \phi^2_s ds\right)
\end{align*}
\tag{3}\]</span></span></p>
<p>Assume that:</p>
<p><span id="eq-expectation-of-likelihood-process"><span class="math display">\[
\begin{align*}
\mathbb{E}^{\mathbb{P}}[L_T] = 1
\end{align*}
\tag{4}\]</span></span></p>
<p>and define the new probability measure <span class="math inline">\(\mathbb{Q}\)</span> on <span class="math inline">\(\mathcal{F}_t\)</span> by:</p>
<p><span id="eq-radon-nikodym-derivative"><span class="math display">\[
L_T = \frac{d\mathbb{Q}}{d\mathbb{P}}
\tag{5}\]</span></span></p>
<p>Then,</p>
<p><span id="eq-girsanov-transformation"><span class="math display">\[
dW^{\mathbb{P}}_t = dW^{\mathbb{Q}}_t + \phi_t dt
\tag{6}\]</span></span></p>
<p>where <span class="math inline">\(dW^{\mathbb{Q}}_t\)</span> is a <span class="math inline">\(\mathbb{Q}\)</span>-standard brownian motion.</p>
</div>
<p><em>Proof.</em></p>
<p>Our claim is that, under the <span class="math inline">\(\mathbb{Q}\)</span> measure, the increments <span class="math inline">\((W^{\mathbb{Q}}_t - W^{\mathbb{Q}}_s)\)</span> are normally distributed with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\((t-s)\)</span>. We start with the special case <span class="math inline">\(s=0\)</span>. Using moment generating functions, it is enough to show that:</p>
<p>It is straightforward to derive <a href="#eq-likelihood-process" class="quarto-xref">Equation&nbsp;3</a> using Itoâ€™s lemma. Let <span class="math inline">\(f(x) = \ln x\)</span>. Then, <span class="math inline">\(f_x = \frac{1}{x}\)</span>, <span class="math inline">\(f_{xx} = -\frac{1}{x^2}\)</span>.</p>
<p><span class="math display">\[
\begin{align*}
d(\ln L_t) &amp;= \frac{1}{L_t}dL_t -\frac{1}{2} \frac{1}{L_t^2}(dL_t)^2 \\
&amp;= \frac{1}{L_t}{\phi_t L_t dW^{\mathbb{P}}_t} - \frac{1}{2L_t^2}\phi_t^2 L_t^2 dt\\
&amp;= \phi_t dW^{\mathbb{P}}_t -\frac{1}{2} \phi_t^2 dt \\
L_t &amp;= \exp\left(\int_0^t \phi_s dW^{\mathbb{P}}_s - \frac{1}{2}\int_0^t \phi_s^2 ds \right)
\end{align*}
\]</span></p>
<p>To prove our main result, we will now use the MGF of the increments. For <span class="math inline">\(n \in \mathbb{N}\)</span> and <span class="math inline">\((t_j,j\leq n)\)</span> a partition of <span class="math inline">\([0,T]\)</span>, with <span class="math inline">\(t_n = T\)</span>, I will show that :</p>
<p><span id="eq-MGF-of-gaussian"><span class="math display">\[
\begin{align*}
\mathbb{E}^{\mathbb{Q}}\left[\exp\left(\sum_{j=0}^{n-1}\lambda_j (W^{\mathbb{Q}}_{t_{j+1}} - W^{\mathbb{Q}}_{t_{j}})\right)\right] = \exp\left[\sum_{j=0}^{n-1}\lambda_j^2(t_{j+1}-t_j)\right]
\end{align*}
\tag{7}\]</span></span></p>
<p>This proves that the increments are the ones of standard brownian motion.</p>
<p>Let <span class="math inline">\((\mathcal{F}_{t_j},j\leq n)\)</span> be the filtrations of the Brownian motion at the time of the partition. The proof is by successively conditioning from <span class="math inline">\(t_{n-1}\)</span> to <span class="math inline">\(t_1\)</span>. We have:</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}^{\mathbb{Q}}\left[\exp\left(\sum _{j=0}^{n-1} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\right)\right] &amp; =\mathbb{E}^{\mathbb{P}}\left[\mathbb{E}^{\mathbb{P}}\left[ L_{t_{n}}\exp\left(\sum _{j=0}^{n-1} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\right) |\mathcal{F}_{t_{n-1}}\right]\right]\\
&amp; =\mathbb{E}^{\mathbb{P}}\left[\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\mathbb{E}^{\mathbb{P}}\left[ L_{t_{n}}\exp\left( \lambda _{n-1} (W_{t_{n}}^{\mathbb{Q}} -W_{t_{n-1}}^{\mathbb{Q}} )\right) |\mathcal{F}_{t_{n-1}}\right]\right]\\
&amp; =\mathbb{E}^{\mathbb{P}}\left[\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\mathbb{E}^{\mathbb{P}}\left[\exp\left(\int _{t_{n-1}}^{t_{n}} \phi _{s} dW_{s}^{\mathbb{Q}} +\frac{1}{2}\int _{t_{n-1}}^{t_{n}} \phi _{s}^{2} ds\right)\exp\left( \lambda _{n-1}\int _{t_{n-1}}^{t_{n}} dW_{s}^{\mathbb{Q}}\right) |\mathcal{F}_{t_{n-1}}\right]\right]\\
&amp; =\mathbb{E}^{\mathbb{P}}\left[\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\mathbb{E}^{\mathbb{P}}\left[\exp\left(\int _{t_{n-1}}^{t_{n}}( \phi _{s} +\lambda _{n-1}) dW_{s}^{\mathbb{Q}} +\frac{1}{2}\int _{t_{n-1}}^{t_{n}} \phi _{s}^{2} ds\right) |\mathcal{F}_{t_{n-1}}\right]\right]\\
&amp; =\mathbb{E}^{\mathbb{P}}\left[\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\mathbb{E}^{\mathbb{P}}\left[\exp\left(\int _{t_{n-1}}^{t_{n}}( \phi _{s} +\lambda _{n-1})\left( dW_{s}^{\mathbb{P}} -\theta ds\right) +\frac{1}{2}\int _{t_{n-1}}^{t_{n}} \phi _{s}^{2} ds\right) |\mathcal{F}_{t_{n-1}}\right]\right]\\
&amp; =\mathbb{E}^{\mathbb{P}}\left[\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\exp\left(\frac{1}{2}\int _{t_{n-1}}^{t_{n}} \phi _{s}^{2} +\int _{t_{n-1}}^{t_{n}} -\phi _{s}( \phi _{s} +\lambda _{n-1}) ds\right) \ \exp\left(\frac{1}{2}\int _{t_{n-1}}^{t_{n}}( \phi _{s} +\lambda _{n-1})^{2} ds\right)\right]\\
&amp; \left\{\ \int XdW_{s}^{\mathbb{P}} \ \text{ is a }\mathcal{N}^{\mathbb{P}}\left( 0,\int \mathbb{E}\left[ X^{2}\right] ds\right) \ \text{gaussian random variable.}\right\} \ \\
&amp; =\mathbb{E}^{\mathbb{P}}\left[\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\exp\left(\int _{t_{n-1}}^{t_{n}}\left( -\frac{1}{2} \phi _{s}^{2} -\lambda _{n-1} \phi _{s} +\frac{1}{2} \phi _{s}^{2} +\lambda _{n-1} \phi _{s} +\lambda _{n-1}^{2}\right) ds\right)\right]\\
&amp; =\mathbb{E}^{\mathbb{P}}\left[\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\exp\left( \lambda _{n-1}\int _{t_{n-1}}^{t_{n}} ds\right)\right]\\
&amp; =\exp( \lambda _{n-1}( t_{n} -t_{n-1}) \cdot \mathbb{E}^{\mathbb{P}}\left[\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\right]
\end{aligned}
\]</span></p>
<p>Here, I used the fact that <span class="math inline">\(L_{t_{n-1}}\)</span> is <span class="math inline">\(\mathcal{F}_{t_{n-1}}\)</span> measurable. I can now condition on <span class="math inline">\(\mathcal{F}_{t_{n-2}}\)</span> down to <span class="math inline">\(\mathcal{F}_{t_1}\)</span> and proceed as above to obtain the desired result.</p>
<p>The process <span class="math inline">\(\phi_t\)</span> is called the <em>Girsanov kernel</em>.</p>
</section>
<section id="what-is-a-numeraire" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-numeraire">What is a numeraire?</h2>
<p>As Shreve puts it, <em>a numeraire is the unit of account in which other assets are denominated</em>. In practice, we tend to choose numeraires that simply the payoff expression.</p>
<p>Any strictly positive (<em>non-dividend paying</em>) price process can be chosen as a numeraire. A numeraire must be a tradable asset.</p>
<p>Consider a unit of stock worth <span class="math inline">\(S_t\)</span>. It can be used as numeraire, because the price process <span class="math inline">\(e^{-rt}S_t\)</span> (assume a constant short rate) is a martingale under risk-neutral measure <span class="math inline">\(\mathbb{Q}^M\)</span>. Powers of the stock price <span class="math inline">\(S_t^\alpha\)</span> cannot be used as numeraires, because their discounted values are not martingales under the risk-neutral measure. Clearly, set the short rate <span class="math inline">\(r = 0\)</span>, then <span class="math inline">\(\mathbb{E}^{\mathbb{Q}^M}[S_T^2] \geq (\mathbb{E}^{\mathbb{Q}^M}[S_T])^2 =S_0^2\)</span> by the Jensenâ€™s inequality.</p>
<p>The price-process <span class="math inline">\(V_t\)</span> of a derivative contract that pays <span class="math inline">\(V_T=S_T^2\)</span> is a martingale under <span class="math inline">\(\mathbb{Q}\)</span> and can be used as a numeraire.</p>
<p>Consider the price of a contract that pays a unit sum <span class="math inline">\(1\)</span> at maturity <span class="math inline">\(T\)</span>. This instrument is the zero-coupon bond. Its an observable and tradable asset. Its price process <span class="math inline">\(P(t,T) = \mathbb{E}^{\mathbb{Q}^M}[1/M_T]\)</span> can be used as a numeraire. <span class="math inline">\(\mathbb{Q}^T\)</span> is called the <span class="math inline">\(T\)</span>-forward measure.</p>
</section>
<section id="abstract-bayes-formula" class="level2">
<h2 class="anchored" data-anchor-id="abstract-bayes-formula">Abstract Bayes Formula</h2>
<div id="thm-abstract-bayes-formula" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Abstract Bayes Formula)</strong></span> Let <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> be a probability space and let <span class="math inline">\(\mathbb{Q}\)</span> be any other probability measure on it. By the Radon-Nikodym theorem, <span class="math inline">\(\exists L = \frac{d\mathbb{Q}}{d\mathbb{P}}\)</span>, <span class="math inline">\(L \geq 0\)</span> with <span class="math inline">\(\mathbb{E}^{\mathbb{P}}[L]=1\)</span>. Then we have:</p>
<p><span id="eq-abstract-bayes-formula"><span class="math display">\[
\begin{align*}
\mathbb{E}^{\mathbb{Q}}[X|\mathcal{G}] = \frac{\mathbb{E}^{\mathbb{P}}[LX|\mathcal{G}]}{\mathbb{E}^{\mathbb{P}}[L|\mathcal{G}]}
\end{align*}
\tag{8}\]</span></span></p>
</div>
<p><em>Proof.</em></p>
<p>By the definition of conditional expectations, recall that if <span class="math inline">\(W\)</span> is any <span class="math inline">\(\mathcal{G}\)</span>-measurable random variable, then the conditional expectation must satisfy the relationship:</p>
<p><span class="math display">\[
\mathbb{E}[WX] = \mathbb{E}[W\mathbb{E}[X|\mathcal{G}]]
\]</span></p>
<p>It is sufficient to prove that:</p>
<p><span class="math display">\[
\mathbb{E}^{\mathbb{P}}[X|\mathcal{G}]\mathbb{E}^{\mathbb{Q}}[L|\mathcal{G}] = \mathbb{E}^{\mathbb{P}}[LX|\mathcal{G}]
\]</span></p>
<p>Let <span class="math inline">\(G\)</span> be an arbitrary set in <span class="math inline">\(\mathcal{G}\)</span>. We have:</p>
<p><span class="math display">\[
\begin{align*}
&amp; \int_G \mathbb{E}^{\mathbb{Q}}[X|\mathcal{G}]\mathbb{E}^{\mathbb{P}}[L|\mathcal{G}] d\mathbb{P} \\
&amp;= \int_G \mathbb{E}^{\mathbb{P}}[L\cdot \mathbb{E}^{\mathbb{Q}}[X|\mathcal{G}]|\mathcal{G}] d\mathbb{P} \\
&amp; \quad \{ \mathbb{E}^{\mathbb{Q}}[X|\mathcal{G}] \text{ is }\mathcal{G}\text{-measurable } \}\\
&amp;= \int_G  L\cdot \mathbb{E}^{\mathbb{Q}}[X|\mathcal{G}] d\mathbb{P}\\
&amp;= \int_G  \frac{d\mathbb{Q}}{d\mathbb{P}}\cdot \mathbb{E}^{\mathbb{Q}}[X|\mathcal{G}] d\mathbb{P}\\
&amp;= \int_G \mathbb{E}^{\mathbb{Q}}[X|\mathcal{G}] d\mathbb{Q}\\
&amp;= \int_G X d\mathbb{Q}
\end{align*}
\]</span></p>
<p>Also, we have:</p>
<p><span class="math display">\[
\begin{align*}
\int_{G} \mathbb{E}^{\mathbb{P}}[LX|\mathcal{G}]d\mathbb{P} &amp;= \int_G LX d\mathbb{P}\\
&amp;= \int_G \frac{d\mathbb{Q}}{d\mathbb{P}} X d\mathbb{P}\\
&amp;= \int_G X d\mathbb{Q}
\end{align*}
\]</span></p>
<p>Hence, proved.</p>
<p>Note that, the filtration <span class="math inline">\(\mathcal{G}\)</span> is the same irrespective of what probability measure we construct on <span class="math inline">\(\Omega\)</span>.</p>
</section>
<section id="martingale-property" class="level2">
<h2 class="anchored" data-anchor-id="martingale-property">Martingale property</h2>
<div id="prp-martingale-property" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1</strong></span> Assume that there exists a numeraire <span class="math inline">\(M\)</span> and a probability measure <span class="math inline">\(\mathbb{Q}^M\)</span>, such that the price of any traded asset <span class="math inline">\(X\)</span> (without intermediate payments) relative to <span class="math inline">\(M\)</span> is a martingale under <span class="math inline">\(\mathbb{Q}^M\)</span>.That is:</p>
<p><span class="math display">\[
\frac{X_t}{M_t} = \mathbb{E}^{\mathbb{Q}^M} \left\{\frac{X_T}{M_T}|\mathcal{F}_t\right\}
\]</span></p>
<p>Let <span class="math inline">\(N_t\)</span> be an arbitrary numeraire. Then, there exists a probability measure <span class="math inline">\(\mathbb{Q}^N\)</span> such that the price of <span class="math inline">\(X\)</span> normalized by <span class="math inline">\(N\)</span> is a martingale under <span class="math inline">\(\mathbb{Q}^N\)</span>.</p>
<p><span class="math display">\[
\frac{X_t}{N_t} = \mathbb{E}^{\mathbb{Q}^N} \left\{\frac{X_T}{N_T}|\mathcal{F}_t\right\}
\]</span></p>
<p>Moreover, the Radon-Nikodym derivative defining the measure <span class="math inline">\(\mathbb{Q}^N\)</span> is given by:</p>
<p><span class="math display">\[
\frac{d\mathbb{Q}^N}{d\mathbb{Q}^M} = \frac{N_T/N_0}{M_T/M_0}
\]</span></p>
</div>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><span class="math display">\[
X_0 = M_0 \mathbb{E}^{\mathbb{Q}^M}\left[\frac{X_T}{M_T}\right]
\]</span></p>
<p>Imposing the simple fact that, the price of the derivative contract should be the same, even if we switch numeraires from <span class="math inline">\(M\)</span> to <span class="math inline">\(N\)</span>, we should have:</p>
<p><span class="math display">\[
X_0 = N_0 \mathbb{E}^{\mathbb{Q}^N}\left[\frac{X_T}{N_T}\right]
\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[
\begin{aligned}
N_{0}\mathbb{E}^{\mathbb{Q}^{N}}\left[\frac{X_{T}}{N_{T}}\right] &amp; =M_{0}\mathbb{E}^{\mathbb{Q}^{M}}\left[\frac{X_{T}}{M_{T}}\right]\\
\frac{N_{T}}{N_{0}} \times N_{0}\mathbb{E}^{\mathbb{Q}^{N}}\left[\frac{X_{T}}{N_{T}}\right] &amp; =\frac{N_{T}}{N_{0}} \times M_{0} \ \mathbb{E}^{\mathbb{Q}^{M}}\left[\frac{X_{T}}{M_{T}}\right] \quad \left\{\text{Multiplying both sides by }\frac{N_{T}}{N_{0}}\right\}\\
\Longrightarrow \mathbb{E}^{\mathbb{Q}^{N}}[ X_{T}] &amp; =\mathbb{E}^{\mathbb{Q}^{M}}\left[\frac{N_{T} /N_{0}}{M_{T} /M_{0}} X_{T}\right]
\end{aligned}
\]</span></p>
<p>But, we know that:</p>
<p><span class="math display">\[
\mathbb{E}^{\mathbb{Q}^N}[X_T] = \mathbb{E}^{\mathbb{Q}^M}\left[\frac{d\mathbb{Q}^N}{d\mathbb{Q}^M}X_T\right]
\]</span></p>
<p>Consequently, our candidate for the Radon-Nikodym derivative should be:</p>
<p><span class="math display">\[
L_T = \frac{d\mathbb{Q}^N}{d\mathbb{Q}^M} = \frac{N_T/N_0}{M_T/M_0}
\]</span></p>
<p>Further <span class="math inline">\((X_t/N_t)\)</span> is a martingale under <span class="math inline">\(\mathbb{Q}^N\)</span>. Its easy to see that:</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}^{\mathbb{Q}^{N}}\left[\frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right] &amp; =\frac{\mathbb{E}^{\mathbb{Q}^{M}}\left[ L_{T} \cdot \frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right]}{\mathbb{E}^{\mathbb{Q}^{M}}[ L_{T} |\mathcal{F}_{t}]} \quad \left\{\text{ Abstract bayes formula }\right\}\\
&amp; =\frac{\mathbb{E}^{\mathbb{Q}^{M}}\left[ L_{T} \cdot \frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right]}{L_{t}}\\
&amp; =\frac{\mathbb{E}^{\mathbb{Q}^{M}}\left[\frac{N_{T}}{N_{0}} \cdot \frac{M_{0}}{M_{T}} \cdot \frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right]}{\frac{N_{t}}{N_{0}} \cdot \frac{M_{0}}{M_{t}}}\\
&amp; =\frac{\mathbb{E}^{\mathbb{Q}^{M}}\left[\frac{N_{T}}{N_{0}} \cdot \frac{M_{0}}{M_{T}} \cdot \frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right]}{\frac{N_{t}}{N_{0}} \cdot \frac{M_{0}}{M_{t}}}\\
&amp; =\frac{M_{t}}{N_{t}} \cdot \mathbb{E}^{\mathbb{Q}^{M}}\left[\frac{X_{T}}{M_{T}}\right]\\
&amp; =\frac{M_{t}}{N_{t}} \cdot \frac{X_{t}}{M_{t}}\\
&amp; =\frac{X_{t}}{N_{t}}
\end{aligned}
\]</span></p>
<p>Since we determined the relevant likelihood process, it is easy to find the Girsanov Kernel.</p>
</section>
<section id="drift-transformation-under-change-of-numeraire" class="level2">
<h2 class="anchored" data-anchor-id="drift-transformation-under-change-of-numeraire">Drift transformation under change of numeraire</h2>
<p>Suppose we are interested in the dynamics of the stochastic process <span class="math inline">\((X_t,t\geq 0)\)</span>. Under <span class="math inline">\(\mathbb{Q}^M\)</span> measure, its dynamics reads:</p>
<p><span id="eq-p-dynamics-of-x"><span class="math display">\[
\begin{aligned}
dX(t) = \mu_X^{\mathbb{Q}^M}(t) dt + c_X(t)dW^{\mathbb{Q}^M}_t
\end{aligned}
\tag{9}\]</span></span></p>
<p>I supressed <span class="math inline">\(\mu_X^{\mathbb{Q}^M}(t,X_t)\)</span> as <span class="math inline">\(\mu_X^{\mathbb{Q}^M}(t)\)</span> for brevity.</p>
<p>Under the <span class="math inline">\(\mathbb{Q}^N\)</span> measure, its dynamics reads:</p>
<p><span id="eq-q-dynamics-of-x"><span class="math display">\[
\begin{aligned}
dX(t) = \mu_X^{\mathbb{Q}^N}(t) dt + c_X(t)dW^{\mathbb{Q}^N}_t
\end{aligned}
\tag{10}\]</span></span></p>
<p>Remember that the diffusion coefficients in these equations are unaffected by the change of measure! We assume that <span class="math inline">\(\mathbb{Q}^M\)</span> is associated with the numeraire <span class="math inline">\(M(t)\)</span> whose dynamics is given by:</p>
<p><span class="math display">\[
dM(t) = \mu_M(t)dt + c_M(t)dW^{\mathbb{Q}^M}
\]</span></p>
<p>and that the numeraire <span class="math inline">\(N\)</span> has <span class="math inline">\(\mathbb{Q}^M\)</span> dynamics:</p>
<p><span class="math display">\[
dN(t) = \mu_N(t)dt + c_N(t)dW^{\mathbb{Q}^N}
\]</span></p>
<p>According to the Girsanov theorem, the likelihood process <span class="math inline">\(L(t)\)</span> accompanying this change of measure is a martingale under the measure <span class="math inline">\(\mathbb{Q}^M\)</span> measure and satisfies the stochastic differential equation:</p>
<p><span class="math display">\[
dL_t = L(t)\theta(t)dW^{\mathbb{Q}^M}_t
\]</span></p>
<p>Explicitly, the likelihood process <span class="math inline">\(L(t)\)</span> is given by the stochastic exponential of the martingale <span class="math inline">\(\int_0^t \theta_s dW^{\mathbb{Q}^M}_s\)</span>:</p>
<p><span class="math display">\[
L(t) = \exp\left(\int_0^t \theta_s dW^{\mathbb{Q}^M}_s - \frac{1}{2}\int_0^t \theta^2_s ds \right)
\]</span></p>
<p>On the other hand, from <a href="#prp-martingale-property" class="quarto-xref">Proposition&nbsp;1</a>, we have:</p>
<p><span class="math display">\[
L_t = \frac{N_t / N_0}{M_t / M_0}
\]</span></p>
<p>Differentiating using Itoâ€™s lemma, we have:</p>
<p><span class="math display">\[
\begin{aligned}
dL_{t} &amp; =\frac{M_{0}}{N_{0}} d\left(\frac{N_{t}}{M_{t}}\right)\\
&amp; =\frac{M_{0}}{N_{0}}\left( -\frac{N_{t}}{M_{t}^{2}} dM_{t} +\frac{1}{M_{t}} dN_{t} +\frac{1}{2} \cdot \frac{2N_{t}}{M_{t}^{3}}( dM_{t})^{2} -\frac{1}{M_{t}^{2}}( dM_{t} \cdot dN_{t})\right)\\
&amp;  \begin{array}{l}
=\frac{M_{0}}{N_{0}}( -\frac{N_{t}}{M_{t}^{2}}\left( \mu _{M}( t) dt+c_{M}( t) dW_{t}^{\mathbb{Q}^{M}}\right) +\frac{1}{M_{t}}\left( \mu _{N}( t) dt+c_{N}( t) dW_{t}^{\mathbb{Q}^{M}}\right)\\
+\frac{N_{t}}{M_{t}^{3}} c_{M}^{2}( t) dt-\frac{1}{M_{t}^{2}} c_{M}( t) c_{N}( t) dt
\end{array}
\end{aligned}
\]</span></p>
<p>But since <span class="math inline">\(L_t\)</span> is driftless, we can ignore the <span class="math inline">\(dt\)</span> terms (whatever they are, they are bound to cancel out) and only look at the diffusion coefficient. So, we can write:</p>
<p><span class="math display">\[
\begin{aligned}
dL_{t} &amp; =\frac{M_{0}}{N_{0}}\left( -\frac{N_{t}}{M_{t}^{2}} c_{M}( t) +\frac{1}{M_{t}} c_{N}( t)\right) dW{_{t}^{\mathbb{Q}}}^{M}\\
&amp; =\frac{N_{t} /N_{0}}{M_{t} /M_{0}}\left(\frac{c_{N}( t)}{N_{t}} -\frac{c_{M}( t)}{M_{t}}\right) dW{_{t}^{\mathbb{Q}}}^{M}\\
&amp; =L_{t}\left(\frac{c_{N}( t)}{N_{t}} -\frac{c_{M}( t)}{M_{t}}\right) dW{_{t}^{\mathbb{Q}}}^{M}
\end{aligned}
\]</span></p>
<p>Comparing this, we can infer that:</p>
<p><span class="math display">\[
\theta_t = \frac{c_N(t)}{N_t} - \frac{c_M(t)}{M_t}
\]</span></p>
<p>Since we can write:</p>
<p><span id="eq-p-and-q-dynamics"><span class="math display">\[
\begin{align*}
dX_t = \mu^{\mathbb{P}}_X(t) dt + c_X(t)dW^{\mathbb{P}}(t) &amp;= \mu^{\mathbb{Q}}_X(t) + c_X(t)dW^{\mathbb{Q}}(t)\\
dW^{\mathbb{P}}(t) &amp;= \frac{\mu^{\mathbb{Q}}_X(t) - \mu^{\mathbb{P}}_X(t)}{c_X(t)} + dW^{\mathbb{Q}}(t)
\end{align*}
\tag{11}\]</span></span></p>
<p>Using <a href="#eq-p-and-q-dynamics" class="quarto-xref">Equation&nbsp;11</a>, we conclude that the change of drift accompanying a change of numeraire is given by:</p>
<p><span id="eq-change-of-drift-accompanying-change-of-numeraire"><span class="math display">\[
\begin{align*}
\mu_X^{\mathbb{Q}}(t) - \mu_X^{\mathbb{P}}(t) = c_X(t)\left(\frac{c_M(t)}{M(t)} - \frac{c_N(t)}{N(t)}\right)
\end{align*}
\tag{12}\]</span></span></p>
</section>
<section id="examples-of-numeraires" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-numeraires">Examples of numeraires</h2>
<p>The basic component of an interest rate model is an instantaneous forward rate process <span class="math inline">\(f(t,s)\)</span>. Its value is the future instantaneous interest rate at a future time <span class="math inline">\(s\)</span>, that is the rate for the infinitesimally short term <span class="math inline">\([s,s+ds]\)</span> observed at time <span class="math inline">\(t \leq s\)</span>.</p>
<p>A <em>zero-coupon bond</em> settling at time <span class="math inline">\(T_0\)</span> and maturing at time <span class="math inline">\(T &gt; T_0\)</span> is the process:</p>
<p><span class="math display">\[
P(t,T_0,T) = \exp\left(-\int_{T_0}^Tf(t,s)ds\right)
\]</span></p>
<p>for <span class="math inline">\(t \leq T_0\)</span>. In other words, it is the time <span class="math inline">\(T_0\)</span> value of 1<span class="math inline">\(\$\)</span> (without the risk of default) at <span class="math inline">\(T\)</span>, as observed at time <span class="math inline">\(t \leq T_0\)</span>. Its current value is given by:</p>
<section id="bank-account-numeraire" class="level3">
<h3 class="anchored" data-anchor-id="bank-account-numeraire">Bank-account numeraire</h3>
<p>The bank-account(money-market account) numeraire is simply the value of <span class="math inline">\(1\$\)</span> deposited in a bank and accruing the (credit-riskless) instantaneous interest rate. In reality, the bank credits interest to the account daily, but this can very well be approximated to a continous process. The associated stochastic price process <span class="math inline">\(M(t)\)</span> is given by:</p>
<p><span class="math display">\[
\begin{align*}
M(t) = \exp(\int_0^t r(s)ds)
\end{align*}
\]</span></p>
<p>Here, the spot rate <span class="math inline">\(r(t)\)</span> is the instantaneous forward observed at the time it settles. That is,</p>
<p><span class="math display">\[
r(t) = f(t,t)
\]</span></p>
</section>
<section id="forward-numeraire" class="level3">
<h3 class="anchored" data-anchor-id="forward-numeraire">Forward numeraire</h3>
<p>A zero-coupon bond(ZCB) is a simple contract with unit payoff <span class="math inline">\(1\$\)</span> at maturity <span class="math inline">\(T\)</span>. By the risk-neutral valuation formula:</p>
<p><span class="math display">\[
P(t,t,T) = V(t) = M(t) \mathbb{E}^{\mathbb{Q}^M}\left[\frac{1}{M(T)}\right]
\]</span></p>
<p>So, a <span class="math inline">\(T\)</span>-maturity ZCB is a tradable asset and its price <span class="math inline">\(P(t,T)\)</span> can be used as a numeraire. The associated measure is called the <span class="math inline">\(T\)</span>-foward measure <span class="math inline">\(\mathbb{Q}^T\)</span>.</p>
<p>The term(e.g.&nbsp;3 months) forward rates for settlement at <span class="math inline">\(T_0\)</span> and maturity at <span class="math inline">\(T\)</span> are defined by the equation:</p>
<p><span class="math display">\[
\begin{align*}
P(t,T_0,T) = \frac{1}{1 + \delta F(t,T_0,T)}
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\delta\)</span> is the day-count fraction for the period <span class="math inline">\([T_0,T]\)</span>. Re-arranging, we have:</p>
<p><span class="math display">\[
\begin{align*}
F(t,T_0,T) &amp;= \frac{1}{\delta}\frac{P(t,T,T) - P(t,T_0, T)}{P(t,T_0,T)}
F(t,T_0,T)P(t,T_0,T) &amp;= \frac{1}{\delta}(P(t,T,T) - P(t,T_0,T))
\end{align*}
\]</span></p>
<p>Clearly, it is a multiple of a difference <span class="math inline">\(P(t,T,T)\)</span> and <span class="math inline">\(P(t,T_0,T)\)</span> normalized by <span class="math inline">\(T\)</span>-maturity zero coupon bond price <span class="math inline">\(P(t,T_0,T)\)</span>. So, the forward iBOR-rate must be a martingale under the <span class="math inline">\(T\)</span>-forward measure <span class="math inline">\(Q^T\)</span>.</p>
<div id="prp-forward-rates-are-martingales-under-forward-measure" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 2 (Forward rates are <span class="math inline">\(\mathbb{Q}^T\)</span> expectations of future spot rates.)</strong></span> Any simply compounded forward rate spanning a time interval ending in <span class="math inline">\(T\)</span> is a martingale under the <span class="math inline">\(T\)</span>-forward measure.</p>
<p><span class="math display">\[
\mathbb{E}^{\mathbb{Q}^T}[F(t;S,T)|\mathcal{F}_u] = F(u;S,T)
\]</span></p>
<p>for each <span class="math inline">\(0 \leq u \leq t \leq S &lt; T\)</span>. In particular, the forward rate spanning the interval <span class="math inline">\([S,T]\)</span> is the <span class="math inline">\(\mathbb{Q}^T\)</span> expectation of the future simply-compounded spot rate at time <span class="math inline">\(S\)</span> for the maturity T.</p>
<p><span id="eq-forward-rate-is-the-QT-expectation-of-future-spot-rate"><span class="math display">\[
\mathbb{E}^{\mathbb{Q}^T}[L(S,T)|\mathcal{F}_t] = F(t;S,T)
\tag{13}\]</span></span></p>
</div>
<div id="expected-value-of-any-future-instantaneous-rates">
<p>The expected value of any future instantaneous spot interest rate, under the corresponding forward measure, is equal to the related instantaneuous forward rate. That is, <span class="math display">\[
\begin{align*}
\mathbb{E}^T{r_T|\mathcal{F}_t} = f(t,T)
\end{align*}
\]</span></p>
<p>for each <span class="math inline">\(0 \leq t \leq T\)</span>.</p>
</div>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><span class="math display">\[
\begin{align*}
\mathbb{E}^{\mathbb{Q}^T} [r_T|\mathcal{F}_t] &amp;= \frac{1}{P(t,T)}\mathbb{E}\left[r_TP(t,T)|\mathcal{F}_t\right]\\
&amp;= - \frac{1}{P(t,T)}\mathbb{E}\left[r_Te^{-\int_t^T r(s)ds}|\mathcal{F}_t\right]\\
&amp;= - \frac{1}{P(t,T)}\mathbb{E}\left[\frac{\partial}{\partial T}e^{-\int_t^T r(s)ds}|\mathcal{F}_t\right]\\
&amp;= - \frac{1}{P(t,T)}\frac{\partial}{\partial T}\mathbb{E}\left[e^{-\int_t^T r(s)ds}|\mathcal{F}_t\right]\\
&amp;= - \frac{1}{P(t,T)}\frac{\partial}{\partial T}P(t,T)\\
&amp;= f(t,T)
\end{align*}
\]</span></p>
</section>
<section id="pricing-an-irs" class="level3">
<h3 class="anchored" data-anchor-id="pricing-an-irs">Pricing an IRS</h3>
<p>Consider a forward starting interest rate swap(IRS) which settles in <span class="math inline">\(T_0\)</span> and matures in <span class="math inline">\(T_N\)</span> years from now. An IRS is a transaction between two counterparties who exchange interest rate payments on an agreed notional principal.</p>
<p>On a vanilla swap, a fixed-coupon interest payments are exchanged for floating rate payments. For the sake of simplicity, we assume that the payment dates on the fixed and floating leg of the swap are the same, and that the floating rate is the same as the discounting rate. The former of these assumptions is a minor simplification, made to lighten up the notation only. The latter is an important simplification, as the basis between the floating rate and the discounting rate may exhibit a complex dynamics.</p>
<p>Let <span class="math inline">\(S\)</span> be the fixed-rate on the swap. By the risk-neutral valuation formula, the fixed leg value at time <span class="math inline">\(t\)</span> can be expressed as:</p>
<p><span class="math display">\[
\begin{align*}
V_{fixed}(t) &amp;=   N \cdot \sum_{i=1}^N \mathbb{E}^{\mathbb{Q^M}}[e^{-r(T_i-t)}S \tau(T_{i-1},T_i)|\mathcal{F}_t]\\
&amp;=S \cdot N \cdot \sum_{i=1}^N \mathbb{E}^{\mathbb{Q}}[e^{-r(T_i-t)}\tau(T_{i-1},T_i)|\mathcal{F}_t]\\
&amp;=S \cdot N \cdot \left(\sum_{i=1}^N P(t,T_i)\tau(T_{i-1},T_i)\right)
\end{align*}
\]</span></p>
<p>The floating leg can be written as:</p>
<p><span class="math display">\[
\begin{align*}
V_{float}(t) &amp; = N \cdot \sum_{i=1}^N P(t,T_i)\mathbb{E}^{T_i}\left[L(T,T_{i-1}, T_i)|\mathcal{F}_t\right]\tau(T_{i-1},T_i)\\
&amp;=  N \cdot \sum_{i=1}^N P(t,T_i)L(t,T_{i-1}, T_i)\tau(T_{i-1},T_i)\\
&amp;= N \cdot \sum_{i=1}^N P(t,T_i)\frac{1}{\tau(T_{i-1},T_i)}\cdot\left(\frac{P(t,T_{i-1})}{P(t,T_{i})}-1\right)\tau(T_{i-1},T_i)\\
&amp;= N \cdot \sum_{i=1}^N (P(t,T_i) - P(t,T_{i-1}))\\
&amp;= -N P(t,T_0) + NP(t,T_N)
\end{align*}
\]</span></p>
<p>where the expectations are under the <span class="math inline">\(T_i\)</span>-forward measure. Note that, I used the fact that the iBOR-rates are martingales under the forward measure.</p>
<p>The par-swap rate <span class="math inline">\(S\)</span> is the fixed-rate which renders the value of the swap zero at the contract start date <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
\begin{align*}
-V_{fix} + V_{floating} &amp;= 0\\
S \cdot N \cdot \left(\sum_{i=1}^N P(t,T_i)\tau(T_{i-1},T_i)\right) &amp;= -N P(t,T_0) + NP(t,T_N) \\
S(t,T_{0:N}) &amp;= \frac{- P(t,T_0) + P(t,T_N)}{\left(\sum_{i=1}^N P(t,T_i)\tau(T_{i-1},T_i)\right)}
\end{align*}
\]</span></p>
</section>
<section id="the-annuity-measure" class="level3">
<h3 class="anchored" data-anchor-id="the-annuity-measure">The Annuity Measure</h3>
<p>The annuity is an asset that pays <span class="math inline">\(1\$\)</span> on each coupon payment day of the swap, accrued according to the swapâ€™s day count convention.</p>
<p><span class="math display">\[
A(t,T_{0:N}) = \left( \sum_{i=1}^N P(t,T_i)\tau(T_{i-1},T_i) \right)
\]</span></p>
<p>Since, it is a portfolio of zero coupon bonds, it is a tradable asset and its price <span class="math inline">\(A(t,T_{0:N})\)</span> can be used as numeraire. This is called the <em>Annuity numeraire</em> and the measure <span class="math inline">\(\mathbb{Q}^{T_{0:N}}\)</span> associated with this numeraire is called the (forward) swap measure. The annuity numeraire arises as the natural numeraire when valuing swaptions. It is the mechanism that allows us to link the swaption as an option on a swap to the option on the corresponding swap rate.</p>
<p>The forward swap rate <span class="math inline">\(S(t,T_{0:N})\)</span> is a martingale in the annuity measure <span class="math inline">\(\mathbb{Q}^{T_{0:N}}\)</span>.</p>
</section>
</section>
<section id="pricing-the-payoff-vt-s_ts_t---k" class="level2">
<h2 class="anchored" data-anchor-id="pricing-the-payoff-vt-s_ts_t---k">Pricing the payoff <span class="math inline">\(V(T) = S_T(S_T - K)^{+}\)</span></h2>
<p>Under the risk-neutral measure <span class="math inline">\(\mathbb{Q}^M\)</span> associated with the money-market account numeraire <span class="math inline">\(M(t)\)</span>, the stock price <span class="math inline">\(S(t)\)</span> evolves according to:</p>
<p><span id="eq-diffusion"><span class="math display">\[
\begin{align*}
dS_t = r S_t dt + \sigma S_t dW^{\mathbb{Q}^M}
\end{align*}
\tag{14}\]</span></span></p>
<p>which has the solution:</p>
<p><span id="eq-solution-of-gbm"><span class="math display">\[
\begin{align*}
S_t = S_0\exp\left[\left(r - \frac{\sigma^2}{2}\right)t + \sigma W^{\mathbb{Q}^M}(t)\right]
\end{align*}
\tag{15}\]</span></span></p>
<p>By the risk-neutral pricing formula, we have:</p>
<p><span id="eq-risk-neutral"><span class="math display">\[
\begin{align*}
V(0) &amp;= \mathbb{E}^{\mathbb{Q}^M}\left[\frac{V(T)}{M(T)}\right] \\
&amp;= \mathbb{E}^{\mathbb{Q}^M}\left[\frac{S_T}{M_T}(S_T - K)^{+}\right]
\end{align*}
\tag{16}\]</span></span></p>
<p>By the change-of-measure formula, if <span class="math inline">\(N\)</span> is any other numeraire with associated probability measure <span class="math inline">\(\mathbb{Q}^N\)</span>, we know that:</p>
<p><span id="eq-change-of-measure"><span class="math display">\[
\begin{align*}
\mathbb{E}^{\mathbb{Q}^N}[V(T)]=\mathbb{E}^{\mathbb{Q}^M}\left[\frac{d\mathbb{Q}^N}{d\mathbb{Q}^M}V(T)\right]
\end{align*}
\tag{17}\]</span></span></p>
<p>We switch to the stock numeraire <span class="math inline">\(S_t\)</span>. The Radon-Nikodym derivative <span class="math inline">\(L_T = d\mathbb{Q}^S/d\mathbb{Q}^M\)</span> is simply:</p>
<p><span id="eq-radon-nikodym"><span class="math display">\[
\begin{align*}
L_T = \frac{d\mathbb{Q}^S}{d\mathbb{Q}^M} = \frac{S(T)/S(0)}{M(T)/M(0)}  = \frac{1}{S(0)}\cdot \frac{S(T)}{M(T)}
\end{align*}
\tag{18}\]</span></span></p>
<p>The dynamics of <span class="math inline">\(L_t\)</span> under the <span class="math inline">\(\mathbb{Q}_M\)</span> measure is given by:</p>
<p><span class="math display">\[
dL_t = \phi_t L_t dW^{\mathbb{Q}^M}
\]</span></p>
<p>where the Girsanov kernel <span class="math inline">\(\phi_t = \sigma\)</span>. Then, the Girsanov transformation is:</p>
<p><span id="eq-girsanov-drift"><span class="math display">\[
W^{\mathbb{Q}^M}_T = W^{\mathbb{Q}^S}_T + \sigma T
\tag{19}\]</span></span></p>
<p>So, the <span class="math inline">\(\mathbb{Q}^S\)</span> dynamics of the stock price is:</p>
<p><span id="eq-Qs-dynamics"><span class="math display">\[
\begin{align*}
S_T &amp;= S_0 \exp\left[\left(r - \frac{\sigma^2}{2}\right)T + \sigma (W^{\mathbb{Q}^S}_T + \sigma T)\right]\\
&amp;=  S_0 \exp\left[\left(r + \frac{\sigma^2}{2}\right)T + \sigma (W^{\mathbb{Q}^S}_T)\right]
\end{align*}
\tag{20}\]</span></span></p>
<p>We can develop the expression in <a href="#eq-risk-neutral" class="quarto-xref">Equation&nbsp;16</a> to be:</p>
<p><span id="eq-develop-the-expression"><span class="math display">\[
\begin{align*}
V(0) &amp;= S_0\mathbb{E}^{\mathbb{Q}^M}\left[\frac{1}{S_0}\frac{S_T}{M_T}(S_T - K)^{+}\right]
\end{align*}
\tag{21}\]</span></span></p>
<p>Applying the change-of-measure (abstract <em>Bayeâ€™s</em> formula),we have:</p>
<p><span id="eq-applying-change-of-measure-formula"><span class="math display">\[
\begin{align*}
V(0) &amp;= S_0\mathbb{E}^{\mathbb{Q}^S}\left[(S_T - K)^{+}\right]
\end{align*}
\tag{22}\]</span></span></p>
<p>Now, we have:</p>
<p><span id="eq-probability-under-stock-measure"><span class="math display">\[
\begin{align*}
\mathbb{Q}^S(S_T &gt; K) &amp;= \mathbb{Q}^S\left(S_0 \exp\left[\left(r + \frac{\sigma^2}{2}\right)T + \sigma (W^{\mathbb{Q}^S}_T)\right] &gt; K\right)\\
&amp;= \mathbb{Q}^S\left(S_0 \exp\left[\left(r + \frac{\sigma^2}{2}\right)T + \sigma (-\sqrt{T}Z)\right] &gt; K\right)\\
&amp;= \mathbb{Q}^S\left(\log \frac{S_0}{K}  + \left(r + \frac{\sigma^2}{2}\right)T   &gt; \sigma\sqrt{T}Z\right)\\
\end{align*}
\tag{23}\]</span></span></p>
<p>where we subbed <span class="math inline">\(-\sqrt{T}Z=W^{\mathbb{Q}^S}_T\)</span>. Recall, the standard normals <span class="math inline">\(Z\)</span> and <span class="math inline">\(-Z\)</span> have the same distribution by symmetry.</p>
<p>Define</p>
<p><span id="eq-expression-for-d2"><span class="math display">\[
d_{-} = \frac{\log \frac{S_0}{K}  + \left(r + \frac{\sigma^2}{2}\right)T}{\sigma\sqrt{T}}
\tag{24}\]</span></span></p>
<p>Then, since <span class="math inline">\(Z \sim \mathcal{N}^{\mathbb{Q}^S}(0,1)\)</span>:</p>
<p><span id="eq-STgtKprobability"><span class="math display">\[
\mathbb{Q}^S(S_T &gt; K) = \mathbb{Q}^S(Z &lt; d_{-}) = \Phi(d_{-})
\tag{25}\]</span></span></p>
<p>So, we can expand the expectation in <a href="#eq-applying-change-of-measure-formula" class="quarto-xref">Equation&nbsp;22</a>. The indicator random variable <span class="math inline">\(1_{\{S_T &gt; K\}}\)</span> is <span class="math inline">\(1\)</span> for all points <span class="math inline">\(Z &lt; d_{-}\)</span>. So, the limits of integration will be <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(d_{-}\)</span>.</p>
<p><span class="math display">\[
\begin{align*}
V(0) &amp;= S_0\left[\int_{-\infty}^{d_{-}} S_T  d\mathbb{Q}^S - K\int_{-\infty}^{d_{-}} dQ^S\right]\\
&amp;= S_0\left[\int_{-\infty}^{d_{-}} S_T f_Z^{\mathbb{Q}^S}(z)dz - K\int_{-\infty}^{d_{-}} f_Z^{\mathbb{Q}^S}(z)dz\right]\\
&amp;= S_0\left[\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{d_{-}} S_0 \exp\left[\left(r + \frac{\sigma^2}{2}\right)T - \sigma \sqrt{T}z\right] \exp(-\frac{z^2}{2})dz - K\Phi(d_{-})\right]
\end{align*}
\]</span></p>
<p>Completing the square, we have:</p>
<p><span class="math display">\[
\begin{align*}
V(0) &amp;= S_0\left[\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{d_{-}} S_0 \exp\left[-\frac{1}{2}(z^2 + 2\sigma\sqrt{T}z + (\sigma \sqrt{T})^2)\right] \exp\left[\left(r + \sigma^2\right)T\right]dz - K\Phi(d_{-})\right]\\
&amp;=S_0 \left[S_0\frac{e^{(r + \sigma^2) T}}{\sqrt{2\pi}}\int_{-\infty}^{d_{-}} \exp\left(-\frac{1}{2}(z + \sigma\sqrt{T})^2\right) dz - K\Phi(d_{-})\right]\\
\end{align*}
\]</span></p>
<p>Let <span class="math inline">\(u = z + \sigma\sqrt{T}\)</span>. And define:</p>
<p><span class="math display">\[
d_{+} = d_{-} + \sigma \sqrt{T} = \frac{\log \frac{S_0}{K} + \left(r + \frac{3}{2}\sigma^2\right)}{\sigma \sqrt{T}}
\]</span></p>
<p>We have the closed-form formula:</p>
<p><span class="math display">\[
V(0) = S_0^2 e^{(r+\sigma^2)T} \Phi(d_{+}) - KS_0 \Phi(d_{-})
\]</span></p>


<!-- -->

</section>

<div id="quarto-appendix" class="default"><section id="references" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">References</h2><div class="quarto-appendix-contents">

<ul>
<li><em><a href="https://www.researchgate.net/publication/361692645_Girsanov_Numeraires_and_All_That">Girsanov, Numeraires and all that</a>, Andrew Lesniewski.</em></li>
<li><em><a href="https://www.amazon.co.uk/Interest-Rate-Models-Practice-Inflation/dp/3662517434/ref=sr_1_1?crid=1SKFOQ7E4MVVT&amp;dib=eyJ2IjoiMSJ9.sIa_RDjVspfj1fp3RjniAVMu8d7q5jc-2tCJwGcfH95dH0e8LajwYlsYKeqFmBNBrNuluzfxqoDYd0R81JqWowKq0TW4WLFIA3DIhDNVaV4.60e9Igmtf-h5uPKHAhEAv-NX9S1e5zfOFoq3JaOGQQo&amp;dib_tag=se&amp;keywords=brigo+mercurio&amp;qid=1738095976&amp;sprefix=Brigo+and+Mercurio%2Caps%2C62&amp;sr=8-1">Interest-rate Models - Theory and Practice</a>, Damiano Brigo and Fabio Mercurio.</em></li>
</ul>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="quasar-chunawala/quantdev" data-repo-id="R_kgDOL2t5-A" data-category="General" data-category-id="DIC_kwDOL2t5-M4ClndQ" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="an">title:</span><span class="co"> "Fun with numeraires!"</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="an">author:</span><span class="co"> "Quasar"</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="an">date:</span><span class="co"> "2024-11-28"</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="an">categories:</span><span class="co"> [Stochastic Calculus]      </span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="an">image:</span><span class="co"> "image.jpg"</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="an">toc-depth:</span><span class="co"> 3</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">---</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">## Introduction</span></span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>A proficiency in the change-of-measure technique is useful to the working quant. An excellent summary of the important results is the note <span class="co">[</span><span class="ot">Girsanov, Numeraires and all that</span><span class="co">](https://www.researchgate.net/publication/361692645_Girsanov_Numeraires_and_All_That)</span>, by Andrew Lesniewski. In this post, I would like to derive relevant results and then we can enjoy pricing some payoffs together!</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">## References {.appendix}</span></span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="ss">- </span>*[Girsanov, Numeraires and all that](https://www.researchgate.net/publication/361692645_Girsanov_Numeraires_and_All_That), Andrew Lesniewski.*</span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="ss">- </span>*[Interest-rate Models - Theory and Practice](https://www.amazon.co.uk/Interest-Rate-Models-Practice-Inflation/dp/3662517434/ref=sr_1_1?crid=1SKFOQ7E4MVVT&amp;dib=eyJ2IjoiMSJ9.sIa_RDjVspfj1fp3RjniAVMu8d7q5jc-2tCJwGcfH95dH0e8LajwYlsYKeqFmBNBrNuluzfxqoDYd0R81JqWowKq0TW4WLFIA3DIhDNVaV4.60e9Igmtf-h5uPKHAhEAv-NX9S1e5zfOFoq3JaOGQQo&amp;dib_tag=se&amp;keywords=brigo+mercurio&amp;qid=1738095976&amp;sprefix=Brigo+and+Mercurio%2Caps%2C62&amp;sr=8-1), Damiano Brigo and Fabio Mercurio.*</span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="fu">## Girsanov Theorem</span></span>
<span id="cb1-23"><a href="#cb1-23"></a></span>
<span id="cb1-24"><a href="#cb1-24"></a>:::{#thm-Girsanov-theorem}</span>
<span id="cb1-25"><a href="#cb1-25"></a></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="fu">### Girsanov Theorem</span></span>
<span id="cb1-27"><a href="#cb1-27"></a></span>
<span id="cb1-28"><a href="#cb1-28"></a>Let $(W^{\mathbb{P}},t\geq 0)$ be a $\mathbb{P}$ standard brownian motion on $(\Omega,\mathcal{F},\mathbb{P})$ and let $\phi$ be any adapted process. Choose fixed $T$ and defined the process $L$ on $<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$ by:</span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a>$$</span>
<span id="cb1-31"><a href="#cb1-31"></a>\begin{align*}</span>
<span id="cb1-32"><a href="#cb1-32"></a>dL_t = \phi_t L_t dW^{\mathbb{P}}_t</span>
<span id="cb1-33"><a href="#cb1-33"></a>\end{align*}</span>
<span id="cb1-34"><a href="#cb1-34"></a>$$ {#eq-dynamics-of-Lt}</span>
<span id="cb1-35"><a href="#cb1-35"></a></span>
<span id="cb1-36"><a href="#cb1-36"></a>$$</span>
<span id="cb1-37"><a href="#cb1-37"></a>\begin{align*}</span>
<span id="cb1-38"><a href="#cb1-38"></a>L_0 = 1</span>
<span id="cb1-39"><a href="#cb1-39"></a>\end{align*}</span>
<span id="cb1-40"><a href="#cb1-40"></a>$$ {#eq-initial-condition}</span>
<span id="cb1-41"><a href="#cb1-41"></a></span>
<span id="cb1-42"><a href="#cb1-42"></a>that is:</span>
<span id="cb1-43"><a href="#cb1-43"></a></span>
<span id="cb1-44"><a href="#cb1-44"></a>$$</span>
<span id="cb1-45"><a href="#cb1-45"></a>\begin{align*}</span>
<span id="cb1-46"><a href="#cb1-46"></a>L_t = \exp\left(\int_0^t \phi_s dW^{\mathbb{P}}_s - \int_0^t \phi^2_s ds\right)</span>
<span id="cb1-47"><a href="#cb1-47"></a>\end{align*}</span>
<span id="cb1-48"><a href="#cb1-48"></a>$$ {#eq-likelihood-process}</span>
<span id="cb1-49"><a href="#cb1-49"></a></span>
<span id="cb1-50"><a href="#cb1-50"></a>Assume that:</span>
<span id="cb1-51"><a href="#cb1-51"></a></span>
<span id="cb1-52"><a href="#cb1-52"></a>$$</span>
<span id="cb1-53"><a href="#cb1-53"></a>\begin{align*}</span>
<span id="cb1-54"><a href="#cb1-54"></a>\mathbb{E}^{\mathbb{P}}<span class="co">[</span><span class="ot">L_T</span><span class="co">]</span> = 1</span>
<span id="cb1-55"><a href="#cb1-55"></a>\end{align*}</span>
<span id="cb1-56"><a href="#cb1-56"></a>$$ {#eq-expectation-of-likelihood-process}</span>
<span id="cb1-57"><a href="#cb1-57"></a></span>
<span id="cb1-58"><a href="#cb1-58"></a>and define the new probability measure $\mathbb{Q}$ on $\mathcal{F}_t$ by:</span>
<span id="cb1-59"><a href="#cb1-59"></a></span>
<span id="cb1-60"><a href="#cb1-60"></a>$$</span>
<span id="cb1-61"><a href="#cb1-61"></a>L_T = \frac{d\mathbb{Q}}{d\mathbb{P}}</span>
<span id="cb1-62"><a href="#cb1-62"></a>$$ {#eq-radon-nikodym-derivative}</span>
<span id="cb1-63"><a href="#cb1-63"></a></span>
<span id="cb1-64"><a href="#cb1-64"></a>Then,</span>
<span id="cb1-65"><a href="#cb1-65"></a></span>
<span id="cb1-66"><a href="#cb1-66"></a>$$</span>
<span id="cb1-67"><a href="#cb1-67"></a>dW^{\mathbb{P}}_t = dW^{\mathbb{Q}}_t + \phi_t dt</span>
<span id="cb1-68"><a href="#cb1-68"></a>$$ {#eq-girsanov-transformation}</span>
<span id="cb1-69"><a href="#cb1-69"></a></span>
<span id="cb1-70"><a href="#cb1-70"></a>where $dW^{\mathbb{Q}}_t$ is a $\mathbb{Q}$-standard brownian motion.</span>
<span id="cb1-71"><a href="#cb1-71"></a></span>
<span id="cb1-72"><a href="#cb1-72"></a>:::</span>
<span id="cb1-73"><a href="#cb1-73"></a></span>
<span id="cb1-74"><a href="#cb1-74"></a>*Proof.*</span>
<span id="cb1-75"><a href="#cb1-75"></a></span>
<span id="cb1-76"><a href="#cb1-76"></a>Our claim is that, under the $\mathbb{Q}$ measure, the increments $(W^{\mathbb{Q}}_t - W^{\mathbb{Q}}_s)$ are normally distributed with mean $0$ and variance $(t-s)$. We start with the special case $s=0$. Using moment generating functions, it is enough to show that:</span>
<span id="cb1-77"><a href="#cb1-77"></a></span>
<span id="cb1-78"><a href="#cb1-78"></a>It is straightforward to derive @eq-likelihood-process using Ito's lemma. Let $f(x) = \ln x$. Then, $f_x = \frac{1}{x}$, $f_{xx} = -\frac{1}{x^2}$.</span>
<span id="cb1-79"><a href="#cb1-79"></a></span>
<span id="cb1-80"><a href="#cb1-80"></a>$$</span>
<span id="cb1-81"><a href="#cb1-81"></a>\begin{align*}</span>
<span id="cb1-82"><a href="#cb1-82"></a>d(\ln L_t) &amp;= \frac{1}{L_t}dL_t -\frac{1}{2} \frac{1}{L_t^2}(dL_t)^2 <span class="sc">\\</span></span>
<span id="cb1-83"><a href="#cb1-83"></a>&amp;= \frac{1}{L_t}{\phi_t L_t dW^{\mathbb{P}}_t} - \frac{1}{2L_t^2}\phi_t^2 L_t^2 dt<span class="sc">\\</span></span>
<span id="cb1-84"><a href="#cb1-84"></a>&amp;= \phi_t dW^{\mathbb{P}}_t -\frac{1}{2} \phi_t^2 dt <span class="sc">\\</span></span>
<span id="cb1-85"><a href="#cb1-85"></a>L_t &amp;= \exp\left(\int_0^t \phi_s dW^{\mathbb{P}}_s - \frac{1}{2}\int_0^t \phi_s^2 ds \right)</span>
<span id="cb1-86"><a href="#cb1-86"></a>\end{align*}</span>
<span id="cb1-87"><a href="#cb1-87"></a>$$</span>
<span id="cb1-88"><a href="#cb1-88"></a></span>
<span id="cb1-89"><a href="#cb1-89"></a>To prove our main result, we will now use the MGF of the increments. For $n \in \mathbb{N}$ and $(t_j,j\leq n)$ a partition of $<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$, with $t_n = T$, I will show that :</span>
<span id="cb1-90"><a href="#cb1-90"></a></span>
<span id="cb1-91"><a href="#cb1-91"></a>$$</span>
<span id="cb1-92"><a href="#cb1-92"></a>\begin{align*}</span>
<span id="cb1-93"><a href="#cb1-93"></a>\mathbb{E}^{\mathbb{Q}}\left<span class="co">[</span><span class="ot">\exp\left(\sum_{j=0}^{n-1}\lambda_j (W^{\mathbb{Q}}_{t_{j+1}} - W^{\mathbb{Q}}_{t_{j}})\right)\right</span><span class="co">]</span> = \exp\left<span class="co">[</span><span class="ot">\sum_{j=0}^{n-1}\lambda_j^2(t_{j+1}-t_j)\right</span><span class="co">]</span></span>
<span id="cb1-94"><a href="#cb1-94"></a>\end{align*}</span>
<span id="cb1-95"><a href="#cb1-95"></a>$$ {#eq-MGF-of-gaussian}</span>
<span id="cb1-96"><a href="#cb1-96"></a></span>
<span id="cb1-97"><a href="#cb1-97"></a>This proves that the increments are the ones of standard brownian motion. </span>
<span id="cb1-98"><a href="#cb1-98"></a></span>
<span id="cb1-99"><a href="#cb1-99"></a>Let $(\mathcal{F}_{t_j},j\leq n)$ be the filtrations of the Brownian motion at the time of the partition. The proof is by successively conditioning from $t_{n-1}$ to $t_1$. We have:</span>
<span id="cb1-100"><a href="#cb1-100"></a></span>
<span id="cb1-101"><a href="#cb1-101"></a>$$</span>
<span id="cb1-102"><a href="#cb1-102"></a>\begin{aligned}</span>
<span id="cb1-103"><a href="#cb1-103"></a>\mathbb{E}^{\mathbb{Q}}\left<span class="co">[</span><span class="ot">\exp\left(\sum _{j=0}^{n-1} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\right)\right</span><span class="co">]</span> &amp; =\mathbb{E}^{\mathbb{P}}\left<span class="co">[</span><span class="ot">\mathbb{E}^{\mathbb{P}}\left[ L_{t_{n}}\exp\left(\sum _{j=0}^{n-1} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\right) |\mathcal{F}_{t_{n-1}}\right]\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-104"><a href="#cb1-104"></a> &amp; =\mathbb{E}^{\mathbb{P}}\left<span class="co">[</span><span class="ot">\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\mathbb{E}^{\mathbb{P}}\left[ L_{t_{n}}\exp\left( \lambda _{n-1} (W_{t_{n}}^{\mathbb{Q}} -W_{t_{n-1}}^{\mathbb{Q}} )\right) |\mathcal{F}_{t_{n-1}}\right]\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-105"><a href="#cb1-105"></a> &amp; =\mathbb{E}^{\mathbb{P}}\left<span class="co">[</span><span class="ot">\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\mathbb{E}^{\mathbb{P}}\left[\exp\left(\int _{t_{n-1}}^{t_{n}} \phi _{s} dW_{s}^{\mathbb{Q}} +\frac{1}{2}\int _{t_{n-1}}^{t_{n}} \phi _{s}^{2} ds\right)\exp\left( \lambda _{n-1}\int _{t_{n-1}}^{t_{n}} dW_{s}^{\mathbb{Q}}\right) |\mathcal{F}_{t_{n-1}}\right]\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-106"><a href="#cb1-106"></a> &amp; =\mathbb{E}^{\mathbb{P}}\left<span class="co">[</span><span class="ot">\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\mathbb{E}^{\mathbb{P}}\left[\exp\left(\int _{t_{n-1}}^{t_{n}}( \phi _{s} +\lambda _{n-1}) dW_{s}^{\mathbb{Q}} +\frac{1}{2}\int _{t_{n-1}}^{t_{n}} \phi _{s}^{2} ds\right) |\mathcal{F}_{t_{n-1}}\right]\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-107"><a href="#cb1-107"></a> &amp; =\mathbb{E}^{\mathbb{P}}\left<span class="co">[</span><span class="ot">\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\mathbb{E}^{\mathbb{P}}\left[\exp\left(\int _{t_{n-1}}^{t_{n}}( \phi _{s} +\lambda _{n-1})\left( dW_{s}^{\mathbb{P}} -\theta ds\right) +\frac{1}{2}\int _{t_{n-1}}^{t_{n}} \phi _{s}^{2} ds\right) |\mathcal{F}_{t_{n-1}}\right]\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-108"><a href="#cb1-108"></a> &amp; =\mathbb{E}^{\mathbb{P}}\left<span class="co">[</span><span class="ot">\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\exp\left(\frac{1}{2}\int _{t_{n-1}}^{t_{n}} \phi _{s}^{2} +\int _{t_{n-1}}^{t_{n}} -\phi _{s}( \phi _{s} +\lambda _{n-1}) ds\right) \ \exp\left(\frac{1}{2}\int _{t_{n-1}}^{t_{n}}( \phi _{s} +\lambda _{n-1})^{2} ds\right)\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-109"><a href="#cb1-109"></a> &amp; \left<span class="sc">\{</span>\ \int XdW_{s}^{\mathbb{P}} \ \text{ is a }\mathcal{N}^{\mathbb{P}}\left( 0,\int \mathbb{E}\left<span class="co">[</span><span class="ot"> X^{2}\right</span><span class="co">]</span> ds\right) \ \text{gaussian random variable.}\right<span class="sc">\}</span> \ <span class="sc">\\</span></span>
<span id="cb1-110"><a href="#cb1-110"></a> &amp; =\mathbb{E}^{\mathbb{P}}\left<span class="co">[</span><span class="ot">\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\exp\left(\int _{t_{n-1}}^{t_{n}}\left( -\frac{1}{2} \phi _{s}^{2} -\lambda _{n-1} \phi _{s} +\frac{1}{2} \phi _{s}^{2} +\lambda _{n-1} \phi _{s} +\lambda _{n-1}^{2}\right) ds\right)\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-111"><a href="#cb1-111"></a> &amp; =\mathbb{E}^{\mathbb{P}}\left<span class="co">[</span><span class="ot">\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\exp\left( \lambda _{n-1}\int _{t_{n-1}}^{t_{n}} ds\right)\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-112"><a href="#cb1-112"></a> &amp; =\exp( \lambda _{n-1}( t_{n} -t_{n-1}) \cdot \mathbb{E}^{\mathbb{P}}\left[\sum _{j=0}^{n-2} \lambda _{j} (W_{t_{j+1}}^{\mathbb{Q}} -W_{t_{j}}^{\mathbb{Q}} )\right]</span>
<span id="cb1-113"><a href="#cb1-113"></a>\end{aligned}</span>
<span id="cb1-114"><a href="#cb1-114"></a>$$</span>
<span id="cb1-115"><a href="#cb1-115"></a></span>
<span id="cb1-116"><a href="#cb1-116"></a>Here, I used the fact that $L_{t_{n-1}}$ is $\mathcal{F}_{t_{n-1}}$ measurable. I can now condition on $\mathcal{F}_{t_{n-2}}$ down to $\mathcal{F}_{t_1}$ and proceed as above to obtain the desired result. </span>
<span id="cb1-117"><a href="#cb1-117"></a></span>
<span id="cb1-118"><a href="#cb1-118"></a>The process $\phi_t$ is called the *Girsanov kernel*. </span>
<span id="cb1-119"><a href="#cb1-119"></a></span>
<span id="cb1-120"><a href="#cb1-120"></a><span class="fu">## What is a numeraire?</span></span>
<span id="cb1-121"><a href="#cb1-121"></a></span>
<span id="cb1-122"><a href="#cb1-122"></a>As Shreve puts it, *a numeraire is the unit of account in which other assets are denominated*. In practice, we tend to choose numeraires that simply the payoff expression. </span>
<span id="cb1-123"><a href="#cb1-123"></a></span>
<span id="cb1-124"><a href="#cb1-124"></a>Any strictly positive (*non-dividend paying*) price process can be chosen as a numeraire. A numeraire must be a tradable asset. </span>
<span id="cb1-125"><a href="#cb1-125"></a></span>
<span id="cb1-126"><a href="#cb1-126"></a>Consider a unit of stock worth $S_t$. It can be used as numeraire, because the price process $e^{-rt}S_t$ (assume a constant short rate) is a martingale under risk-neutral measure $\mathbb{Q}^M$. Powers of the stock price $S_t^\alpha$ cannot be used as numeraires, because their discounted values are not martingales under the risk-neutral measure. Clearly, set the short rate $r = 0$, then $\mathbb{E}^{\mathbb{Q}^M}<span class="co">[</span><span class="ot">S_T^2</span><span class="co">]</span> \geq (\mathbb{E}^{\mathbb{Q}^M}<span class="co">[</span><span class="ot">S_T</span><span class="co">]</span>)^2 =S_0^2$ by the Jensen's inequality. </span>
<span id="cb1-127"><a href="#cb1-127"></a></span>
<span id="cb1-128"><a href="#cb1-128"></a>The price-process $V_t$ of a derivative contract that pays $V_T=S_T^2$ is a martingale under $\mathbb{Q}$ and can be used as a numeraire.</span>
<span id="cb1-129"><a href="#cb1-129"></a></span>
<span id="cb1-130"><a href="#cb1-130"></a>Consider the price of a contract that pays a unit sum $1$ at maturity $T$. This instrument is the zero-coupon bond. Its an observable and tradable asset. Its price process $P(t,T) = \mathbb{E}^{\mathbb{Q}^M}<span class="co">[</span><span class="ot">1/M_T</span><span class="co">]</span>$ can be used as a numeraire. $\mathbb{Q}^T$ is called the $T$-forward measure.</span>
<span id="cb1-131"><a href="#cb1-131"></a></span>
<span id="cb1-132"><a href="#cb1-132"></a><span class="fu">## Abstract Bayes Formula</span></span>
<span id="cb1-133"><a href="#cb1-133"></a></span>
<span id="cb1-134"><a href="#cb1-134"></a>:::{#thm-abstract-bayes-formula} </span>
<span id="cb1-135"><a href="#cb1-135"></a></span>
<span id="cb1-136"><a href="#cb1-136"></a><span class="fu">### Abstract Bayes Formula </span></span>
<span id="cb1-137"><a href="#cb1-137"></a>Let $(\Omega,\mathcal{F},\mathbb{P})$ be a probability space and let $\mathbb{Q}$ be any other probability measure on it. By the Radon-Nikodym theorem, $\exists L = \frac{d\mathbb{Q}}{d\mathbb{P}}$, $L \geq 0$ with $\mathbb{E}^{\mathbb{P}}<span class="co">[</span><span class="ot">L</span><span class="co">]</span>=1$. Then we have:</span>
<span id="cb1-138"><a href="#cb1-138"></a></span>
<span id="cb1-139"><a href="#cb1-139"></a>$$</span>
<span id="cb1-140"><a href="#cb1-140"></a>\begin{align*}</span>
<span id="cb1-141"><a href="#cb1-141"></a>\mathbb{E}^{\mathbb{Q}}<span class="co">[</span><span class="ot">X|\mathcal{G}</span><span class="co">]</span> = \frac{\mathbb{E}^{\mathbb{P}}<span class="co">[</span><span class="ot">LX|\mathcal{G}</span><span class="co">]</span>}{\mathbb{E}^{\mathbb{P}}<span class="co">[</span><span class="ot">L|\mathcal{G}</span><span class="co">]</span>}</span>
<span id="cb1-142"><a href="#cb1-142"></a>\end{align*}</span>
<span id="cb1-143"><a href="#cb1-143"></a>$$ {#eq-abstract-bayes-formula}</span>
<span id="cb1-144"><a href="#cb1-144"></a></span>
<span id="cb1-145"><a href="#cb1-145"></a>:::</span>
<span id="cb1-146"><a href="#cb1-146"></a></span>
<span id="cb1-147"><a href="#cb1-147"></a>*Proof.*</span>
<span id="cb1-148"><a href="#cb1-148"></a></span>
<span id="cb1-149"><a href="#cb1-149"></a>By the definition of conditional expectations, recall that if $W$ is any $\mathcal{G}$-measurable random variable, then the conditional expectation must satisfy the relationship:</span>
<span id="cb1-150"><a href="#cb1-150"></a></span>
<span id="cb1-151"><a href="#cb1-151"></a>$$</span>
<span id="cb1-152"><a href="#cb1-152"></a>\mathbb{E}<span class="co">[</span><span class="ot">WX</span><span class="co">]</span> = \mathbb{E}<span class="co">[</span><span class="ot">W\mathbb{E}[X|\mathcal{G}]</span><span class="co">]</span></span>
<span id="cb1-153"><a href="#cb1-153"></a>$$</span>
<span id="cb1-154"><a href="#cb1-154"></a></span>
<span id="cb1-155"><a href="#cb1-155"></a>It is sufficient to prove that:</span>
<span id="cb1-156"><a href="#cb1-156"></a></span>
<span id="cb1-157"><a href="#cb1-157"></a>$$</span>
<span id="cb1-158"><a href="#cb1-158"></a>\mathbb{E}^{\mathbb{P}}<span class="co">[</span><span class="ot">X|\mathcal{G}</span><span class="co">]</span>\mathbb{E}^{\mathbb{Q}}<span class="co">[</span><span class="ot">L|\mathcal{G}</span><span class="co">]</span> = \mathbb{E}^{\mathbb{P}}<span class="co">[</span><span class="ot">LX|\mathcal{G}</span><span class="co">]</span></span>
<span id="cb1-159"><a href="#cb1-159"></a>$$</span>
<span id="cb1-160"><a href="#cb1-160"></a></span>
<span id="cb1-161"><a href="#cb1-161"></a>Let $G$ be an arbitrary set in $\mathcal{G}$. We have:</span>
<span id="cb1-162"><a href="#cb1-162"></a></span>
<span id="cb1-163"><a href="#cb1-163"></a>$$</span>
<span id="cb1-164"><a href="#cb1-164"></a>\begin{align*}</span>
<span id="cb1-165"><a href="#cb1-165"></a>&amp; \int_G \mathbb{E}^{\mathbb{Q}}<span class="co">[</span><span class="ot">X|\mathcal{G}</span><span class="co">]</span>\mathbb{E}^{\mathbb{P}}<span class="co">[</span><span class="ot">L|\mathcal{G}</span><span class="co">]</span> d\mathbb{P} <span class="sc">\\</span></span>
<span id="cb1-166"><a href="#cb1-166"></a>&amp;= \int_G \mathbb{E}^{\mathbb{P}}<span class="co">[</span><span class="ot">L\cdot \mathbb{E}^{\mathbb{Q}}[X|\mathcal{G}]|\mathcal{G}</span><span class="co">]</span> d\mathbb{P} <span class="sc">\\</span></span>
<span id="cb1-167"><a href="#cb1-167"></a>&amp; \quad <span class="sc">\{</span> \mathbb{E}^{\mathbb{Q}}<span class="co">[</span><span class="ot">X|\mathcal{G}</span><span class="co">]</span> \text{ is }\mathcal{G}\text{-measurable } <span class="sc">\}\\</span></span>
<span id="cb1-168"><a href="#cb1-168"></a>&amp;= \int_G  L\cdot \mathbb{E}^{\mathbb{Q}}<span class="co">[</span><span class="ot">X|\mathcal{G}</span><span class="co">]</span> d\mathbb{P}<span class="sc">\\</span></span>
<span id="cb1-169"><a href="#cb1-169"></a>&amp;= \int_G  \frac{d\mathbb{Q}}{d\mathbb{P}}\cdot \mathbb{E}^{\mathbb{Q}}<span class="co">[</span><span class="ot">X|\mathcal{G}</span><span class="co">]</span> d\mathbb{P}<span class="sc">\\</span></span>
<span id="cb1-170"><a href="#cb1-170"></a>&amp;= \int_G \mathbb{E}^{\mathbb{Q}}<span class="co">[</span><span class="ot">X|\mathcal{G}</span><span class="co">]</span> d\mathbb{Q}<span class="sc">\\</span></span>
<span id="cb1-171"><a href="#cb1-171"></a>&amp;= \int_G X d\mathbb{Q}</span>
<span id="cb1-172"><a href="#cb1-172"></a>\end{align*}</span>
<span id="cb1-173"><a href="#cb1-173"></a>$$</span>
<span id="cb1-174"><a href="#cb1-174"></a></span>
<span id="cb1-175"><a href="#cb1-175"></a>Also, we have:</span>
<span id="cb1-176"><a href="#cb1-176"></a></span>
<span id="cb1-177"><a href="#cb1-177"></a>$$</span>
<span id="cb1-178"><a href="#cb1-178"></a>\begin{align*}</span>
<span id="cb1-179"><a href="#cb1-179"></a>\int_{G} \mathbb{E}^{\mathbb{P}}<span class="co">[</span><span class="ot">LX|\mathcal{G}</span><span class="co">]</span>d\mathbb{P} &amp;= \int_G LX d\mathbb{P}<span class="sc">\\</span></span>
<span id="cb1-180"><a href="#cb1-180"></a>&amp;= \int_G \frac{d\mathbb{Q}}{d\mathbb{P}} X d\mathbb{P}<span class="sc">\\</span></span>
<span id="cb1-181"><a href="#cb1-181"></a>&amp;= \int_G X d\mathbb{Q}</span>
<span id="cb1-182"><a href="#cb1-182"></a>\end{align*}</span>
<span id="cb1-183"><a href="#cb1-183"></a>$$</span>
<span id="cb1-184"><a href="#cb1-184"></a></span>
<span id="cb1-185"><a href="#cb1-185"></a>Hence, proved.</span>
<span id="cb1-186"><a href="#cb1-186"></a></span>
<span id="cb1-187"><a href="#cb1-187"></a>Note that, the filtration $\mathcal{G}$ is the same irrespective of what probability measure we construct on $\Omega$. </span>
<span id="cb1-188"><a href="#cb1-188"></a></span>
<span id="cb1-189"><a href="#cb1-189"></a><span class="fu">## Martingale property</span></span>
<span id="cb1-190"><a href="#cb1-190"></a></span>
<span id="cb1-191"><a href="#cb1-191"></a>:::{#prp-martingale-property} </span>
<span id="cb1-192"><a href="#cb1-192"></a></span>
<span id="cb1-193"><a href="#cb1-193"></a>Assume that there exists a numeraire $M$ and a probability measure $\mathbb{Q}^M$, such that the price of any traded asset $X$ (without intermediate payments) relative to $M$ is a martingale under $\mathbb{Q}^M$.That is:</span>
<span id="cb1-194"><a href="#cb1-194"></a></span>
<span id="cb1-195"><a href="#cb1-195"></a>$$</span>
<span id="cb1-196"><a href="#cb1-196"></a>\frac{X_t}{M_t} = \mathbb{E}^{\mathbb{Q}^M} \left<span class="sc">\{</span>\frac{X_T}{M_T}|\mathcal{F}_t\right<span class="sc">\}</span></span>
<span id="cb1-197"><a href="#cb1-197"></a>$$</span>
<span id="cb1-198"><a href="#cb1-198"></a></span>
<span id="cb1-199"><a href="#cb1-199"></a>Let $N_t$ be an arbitrary numeraire. Then, there exists a probability measure $\mathbb{Q}^N$ such that the price of $X$ normalized by $N$ is a martingale under $\mathbb{Q}^N$.</span>
<span id="cb1-200"><a href="#cb1-200"></a></span>
<span id="cb1-201"><a href="#cb1-201"></a>$$</span>
<span id="cb1-202"><a href="#cb1-202"></a>\frac{X_t}{N_t} = \mathbb{E}^{\mathbb{Q}^N} \left<span class="sc">\{</span>\frac{X_T}{N_T}|\mathcal{F}_t\right<span class="sc">\}</span></span>
<span id="cb1-203"><a href="#cb1-203"></a>$$</span>
<span id="cb1-204"><a href="#cb1-204"></a></span>
<span id="cb1-205"><a href="#cb1-205"></a>Moreover, the Radon-Nikodym derivative defining the measure $\mathbb{Q}^N$ is given by:</span>
<span id="cb1-206"><a href="#cb1-206"></a></span>
<span id="cb1-207"><a href="#cb1-207"></a>$$</span>
<span id="cb1-208"><a href="#cb1-208"></a>\frac{d\mathbb{Q}^N}{d\mathbb{Q}^M} = \frac{N_T/N_0}{M_T/M_0}</span>
<span id="cb1-209"><a href="#cb1-209"></a>$$</span>
<span id="cb1-210"><a href="#cb1-210"></a>:::</span>
<span id="cb1-211"><a href="#cb1-211"></a></span>
<span id="cb1-212"><a href="#cb1-212"></a>*Proof.*</span>
<span id="cb1-213"><a href="#cb1-213"></a></span>
<span id="cb1-214"><a href="#cb1-214"></a>We have:</span>
<span id="cb1-215"><a href="#cb1-215"></a></span>
<span id="cb1-216"><a href="#cb1-216"></a>$$</span>
<span id="cb1-217"><a href="#cb1-217"></a>X_0 = M_0 \mathbb{E}^{\mathbb{Q}^M}\left<span class="co">[</span><span class="ot">\frac{X_T}{M_T}\right</span><span class="co">]</span></span>
<span id="cb1-218"><a href="#cb1-218"></a>$$</span>
<span id="cb1-219"><a href="#cb1-219"></a></span>
<span id="cb1-220"><a href="#cb1-220"></a>Imposing the simple fact that, the price of the derivative contract should be the same, even if we switch numeraires from $M$ to $N$, we should have:</span>
<span id="cb1-221"><a href="#cb1-221"></a></span>
<span id="cb1-222"><a href="#cb1-222"></a>$$</span>
<span id="cb1-223"><a href="#cb1-223"></a>X_0 = N_0 \mathbb{E}^{\mathbb{Q}^N}\left<span class="co">[</span><span class="ot">\frac{X_T}{N_T}\right</span><span class="co">]</span></span>
<span id="cb1-224"><a href="#cb1-224"></a>$$</span>
<span id="cb1-225"><a href="#cb1-225"></a></span>
<span id="cb1-226"><a href="#cb1-226"></a>Thus,</span>
<span id="cb1-227"><a href="#cb1-227"></a></span>
<span id="cb1-228"><a href="#cb1-228"></a>$$</span>
<span id="cb1-229"><a href="#cb1-229"></a>\begin{aligned}</span>
<span id="cb1-230"><a href="#cb1-230"></a>N_{0}\mathbb{E}^{\mathbb{Q}^{N}}\left<span class="co">[</span><span class="ot">\frac{X_{T}}{N_{T}}\right</span><span class="co">]</span> &amp; =M_{0}\mathbb{E}^{\mathbb{Q}^{M}}\left<span class="co">[</span><span class="ot">\frac{X_{T}}{M_{T}}\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-231"><a href="#cb1-231"></a>\frac{N_{T}}{N_{0}} \times N_{0}\mathbb{E}^{\mathbb{Q}^{N}}\left<span class="co">[</span><span class="ot">\frac{X_{T}}{N_{T}}\right</span><span class="co">]</span> &amp; =\frac{N_{T}}{N_{0}} \times M_{0} \ \mathbb{E}^{\mathbb{Q}^{M}}\left<span class="co">[</span><span class="ot">\frac{X_{T}}{M_{T}}\right</span><span class="co">]</span> \quad \left<span class="sc">\{</span>\text{Multiplying both sides by }\frac{N_{T}}{N_{0}}\right<span class="sc">\}\\</span></span>
<span id="cb1-232"><a href="#cb1-232"></a>\Longrightarrow \mathbb{E}^{\mathbb{Q}^{N}}<span class="co">[</span><span class="ot"> X_{T}</span><span class="co">]</span> &amp; =\mathbb{E}^{\mathbb{Q}^{M}}\left<span class="co">[</span><span class="ot">\frac{N_{T} /N_{0}}{M_{T} /M_{0}} X_{T}\right</span><span class="co">]</span></span>
<span id="cb1-233"><a href="#cb1-233"></a>\end{aligned}</span>
<span id="cb1-234"><a href="#cb1-234"></a>$$</span>
<span id="cb1-235"><a href="#cb1-235"></a></span>
<span id="cb1-236"><a href="#cb1-236"></a>But, we know that:</span>
<span id="cb1-237"><a href="#cb1-237"></a></span>
<span id="cb1-238"><a href="#cb1-238"></a>$$</span>
<span id="cb1-239"><a href="#cb1-239"></a>\mathbb{E}^{\mathbb{Q}^N}<span class="co">[</span><span class="ot">X_T</span><span class="co">]</span> = \mathbb{E}^{\mathbb{Q}^M}\left<span class="co">[</span><span class="ot">\frac{d\mathbb{Q}^N}{d\mathbb{Q}^M}X_T\right</span><span class="co">]</span></span>
<span id="cb1-240"><a href="#cb1-240"></a>$$</span>
<span id="cb1-241"><a href="#cb1-241"></a></span>
<span id="cb1-242"><a href="#cb1-242"></a>Consequently, our candidate for the Radon-Nikodym derivative should be:</span>
<span id="cb1-243"><a href="#cb1-243"></a></span>
<span id="cb1-244"><a href="#cb1-244"></a>$$</span>
<span id="cb1-245"><a href="#cb1-245"></a>L_T = \frac{d\mathbb{Q}^N}{d\mathbb{Q}^M} = \frac{N_T/N_0}{M_T/M_0}</span>
<span id="cb1-246"><a href="#cb1-246"></a>$$</span>
<span id="cb1-247"><a href="#cb1-247"></a></span>
<span id="cb1-248"><a href="#cb1-248"></a>Further $(X_t/N_t)$ is a martingale under $\mathbb{Q}^N$. Its easy to see that:</span>
<span id="cb1-249"><a href="#cb1-249"></a></span>
<span id="cb1-250"><a href="#cb1-250"></a>$$</span>
<span id="cb1-251"><a href="#cb1-251"></a>\begin{aligned}</span>
<span id="cb1-252"><a href="#cb1-252"></a>\mathbb{E}^{\mathbb{Q}^{N}}\left<span class="co">[</span><span class="ot">\frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right</span><span class="co">]</span> &amp; =\frac{\mathbb{E}^{\mathbb{Q}^{M}}\left<span class="co">[</span><span class="ot"> L_{T} \cdot \frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right</span><span class="co">]</span>}{\mathbb{E}^{\mathbb{Q}^{M}}<span class="co">[</span><span class="ot"> L_{T} |\mathcal{F}_{t}</span><span class="co">]</span>} \quad \left<span class="sc">\{</span>\text{ Abstract bayes formula }\right<span class="sc">\}\\</span></span>
<span id="cb1-253"><a href="#cb1-253"></a> &amp; =\frac{\mathbb{E}^{\mathbb{Q}^{M}}\left<span class="co">[</span><span class="ot"> L_{T} \cdot \frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right</span><span class="co">]</span>}{L_{t}}<span class="sc">\\</span></span>
<span id="cb1-254"><a href="#cb1-254"></a> &amp; =\frac{\mathbb{E}^{\mathbb{Q}^{M}}\left<span class="co">[</span><span class="ot">\frac{N_{T}}{N_{0}} \cdot \frac{M_{0}}{M_{T}} \cdot \frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right</span><span class="co">]</span>}{\frac{N_{t}}{N_{0}} \cdot \frac{M_{0}}{M_{t}}}<span class="sc">\\</span></span>
<span id="cb1-255"><a href="#cb1-255"></a> &amp; =\frac{\mathbb{E}^{\mathbb{Q}^{M}}\left<span class="co">[</span><span class="ot">\frac{N_{T}}{N_{0}} \cdot \frac{M_{0}}{M_{T}} \cdot \frac{X_{T}}{N_{T}} |\mathcal{F}_{t}\right</span><span class="co">]</span>}{\frac{N_{t}}{N_{0}} \cdot \frac{M_{0}}{M_{t}}}<span class="sc">\\</span></span>
<span id="cb1-256"><a href="#cb1-256"></a> &amp; =\frac{M_{t}}{N_{t}} \cdot \mathbb{E}^{\mathbb{Q}^{M}}\left<span class="co">[</span><span class="ot">\frac{X_{T}}{M_{T}}\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-257"><a href="#cb1-257"></a> &amp; =\frac{M_{t}}{N_{t}} \cdot \frac{X_{t}}{M_{t}}<span class="sc">\\</span></span>
<span id="cb1-258"><a href="#cb1-258"></a> &amp; =\frac{X_{t}}{N_{t}}</span>
<span id="cb1-259"><a href="#cb1-259"></a>\end{aligned}</span>
<span id="cb1-260"><a href="#cb1-260"></a>$$</span>
<span id="cb1-261"><a href="#cb1-261"></a></span>
<span id="cb1-262"><a href="#cb1-262"></a>Since we determined the relevant likelihood process, it is easy to find the Girsanov Kernel.</span>
<span id="cb1-263"><a href="#cb1-263"></a></span>
<span id="cb1-264"><a href="#cb1-264"></a><span class="fu">## Drift transformation under change of numeraire</span></span>
<span id="cb1-265"><a href="#cb1-265"></a></span>
<span id="cb1-266"><a href="#cb1-266"></a>Suppose we are interested in the dynamics of the stochastic process $(X_t,t\geq 0)$. Under $\mathbb{Q}^M$ measure, its dynamics reads:</span>
<span id="cb1-267"><a href="#cb1-267"></a></span>
<span id="cb1-268"><a href="#cb1-268"></a>$$</span>
<span id="cb1-269"><a href="#cb1-269"></a>\begin{aligned}</span>
<span id="cb1-270"><a href="#cb1-270"></a>dX(t) = \mu_X^{\mathbb{Q}^M}(t) dt + c_X(t)dW^{\mathbb{Q}^M}_t</span>
<span id="cb1-271"><a href="#cb1-271"></a>\end{aligned}</span>
<span id="cb1-272"><a href="#cb1-272"></a>$$ {#eq-p-dynamics-of-x}</span>
<span id="cb1-273"><a href="#cb1-273"></a></span>
<span id="cb1-274"><a href="#cb1-274"></a>I supressed $\mu_X^{\mathbb{Q}^M}(t,X_t)$ as $\mu_X^{\mathbb{Q}^M}(t)$ for brevity.</span>
<span id="cb1-275"><a href="#cb1-275"></a></span>
<span id="cb1-276"><a href="#cb1-276"></a>Under the $\mathbb{Q}^N$ measure, its dynamics reads:</span>
<span id="cb1-277"><a href="#cb1-277"></a></span>
<span id="cb1-278"><a href="#cb1-278"></a>$$</span>
<span id="cb1-279"><a href="#cb1-279"></a>\begin{aligned}</span>
<span id="cb1-280"><a href="#cb1-280"></a>dX(t) = \mu_X^{\mathbb{Q}^N}(t) dt + c_X(t)dW^{\mathbb{Q}^N}_t</span>
<span id="cb1-281"><a href="#cb1-281"></a>\end{aligned}</span>
<span id="cb1-282"><a href="#cb1-282"></a>$$ {#eq-q-dynamics-of-x}</span>
<span id="cb1-283"><a href="#cb1-283"></a></span>
<span id="cb1-284"><a href="#cb1-284"></a>Remember that the diffusion coefficients in these equations are unaffected by the change of measure! We assume that $\mathbb{Q}^M$ is associated with the numeraire $M(t)$ whose dynamics is given by:</span>
<span id="cb1-285"><a href="#cb1-285"></a></span>
<span id="cb1-286"><a href="#cb1-286"></a>$$</span>
<span id="cb1-287"><a href="#cb1-287"></a>dM(t) = \mu_M(t)dt + c_M(t)dW^{\mathbb{Q}^M}</span>
<span id="cb1-288"><a href="#cb1-288"></a>$$</span>
<span id="cb1-289"><a href="#cb1-289"></a></span>
<span id="cb1-290"><a href="#cb1-290"></a>and that the numeraire $N$ has $\mathbb{Q}^M$ dynamics:</span>
<span id="cb1-291"><a href="#cb1-291"></a></span>
<span id="cb1-292"><a href="#cb1-292"></a>$$</span>
<span id="cb1-293"><a href="#cb1-293"></a>dN(t) = \mu_N(t)dt + c_N(t)dW^{\mathbb{Q}^N}</span>
<span id="cb1-294"><a href="#cb1-294"></a>$$</span>
<span id="cb1-295"><a href="#cb1-295"></a></span>
<span id="cb1-296"><a href="#cb1-296"></a>According to the Girsanov theorem, the likelihood process $L(t)$ accompanying this change of measure is a martingale under the measure $\mathbb{Q}^M$ measure and satisfies the stochastic differential equation:</span>
<span id="cb1-297"><a href="#cb1-297"></a></span>
<span id="cb1-298"><a href="#cb1-298"></a>$$</span>
<span id="cb1-299"><a href="#cb1-299"></a>dL_t = L(t)\theta(t)dW^{\mathbb{Q}^M}_t</span>
<span id="cb1-300"><a href="#cb1-300"></a>$$</span>
<span id="cb1-301"><a href="#cb1-301"></a></span>
<span id="cb1-302"><a href="#cb1-302"></a>Explicitly, the likelihood process $L(t)$ is given by the stochastic exponential of the martingale $\int_0^t \theta_s dW^{\mathbb{Q}^M}_s$:</span>
<span id="cb1-303"><a href="#cb1-303"></a></span>
<span id="cb1-304"><a href="#cb1-304"></a>$$</span>
<span id="cb1-305"><a href="#cb1-305"></a>L(t) = \exp\left(\int_0^t \theta_s dW^{\mathbb{Q}^M}_s - \frac{1}{2}\int_0^t \theta^2_s ds \right)</span>
<span id="cb1-306"><a href="#cb1-306"></a>$$</span>
<span id="cb1-307"><a href="#cb1-307"></a></span>
<span id="cb1-308"><a href="#cb1-308"></a>On the other hand, from @prp-martingale-property, we have:</span>
<span id="cb1-309"><a href="#cb1-309"></a></span>
<span id="cb1-310"><a href="#cb1-310"></a>$$</span>
<span id="cb1-311"><a href="#cb1-311"></a>L_t = \frac{N_t / N_0}{M_t / M_0}</span>
<span id="cb1-312"><a href="#cb1-312"></a>$$</span>
<span id="cb1-313"><a href="#cb1-313"></a></span>
<span id="cb1-314"><a href="#cb1-314"></a>Differentiating using Ito's lemma, we have:</span>
<span id="cb1-315"><a href="#cb1-315"></a></span>
<span id="cb1-316"><a href="#cb1-316"></a>$$</span>
<span id="cb1-317"><a href="#cb1-317"></a>\begin{aligned}</span>
<span id="cb1-318"><a href="#cb1-318"></a>dL_{t} &amp; =\frac{M_{0}}{N_{0}} d\left(\frac{N_{t}}{M_{t}}\right)<span class="sc">\\</span></span>
<span id="cb1-319"><a href="#cb1-319"></a> &amp; =\frac{M_{0}}{N_{0}}\left( -\frac{N_{t}}{M_{t}^{2}} dM_{t} +\frac{1}{M_{t}} dN_{t} +\frac{1}{2} \cdot \frac{2N_{t}}{M_{t}^{3}}( dM_{t})^{2} -\frac{1}{M_{t}^{2}}( dM_{t} \cdot dN_{t})\right)<span class="sc">\\</span></span>
<span id="cb1-320"><a href="#cb1-320"></a> &amp;  \begin{array}{l}</span>
<span id="cb1-321"><a href="#cb1-321"></a>=\frac{M_{0}}{N_{0}}( -\frac{N_{t}}{M_{t}^{2}}\left( \mu _{M}( t) dt+c_{M}( t) dW_{t}^{\mathbb{Q}^{M}}\right) +\frac{1}{M_{t}}\left( \mu _{N}( t) dt+c_{N}( t) dW_{t}^{\mathbb{Q}^{M}}\right)<span class="sc">\\</span></span>
<span id="cb1-322"><a href="#cb1-322"></a>+\frac{N_{t}}{M_{t}^{3}} c_{M}^{2}( t) dt-\frac{1}{M_{t}^{2}} c_{M}( t) c_{N}( t) dt</span>
<span id="cb1-323"><a href="#cb1-323"></a>\end{array}</span>
<span id="cb1-324"><a href="#cb1-324"></a>\end{aligned}</span>
<span id="cb1-325"><a href="#cb1-325"></a>$$</span>
<span id="cb1-326"><a href="#cb1-326"></a></span>
<span id="cb1-327"><a href="#cb1-327"></a>But since $L_t$ is driftless, we can ignore the $dt$ terms (whatever they are, they are bound to cancel out) and only look at the diffusion coefficient. So, we can write:</span>
<span id="cb1-328"><a href="#cb1-328"></a></span>
<span id="cb1-329"><a href="#cb1-329"></a>$$</span>
<span id="cb1-330"><a href="#cb1-330"></a>\begin{aligned}</span>
<span id="cb1-331"><a href="#cb1-331"></a>dL_{t} &amp; =\frac{M_{0}}{N_{0}}\left( -\frac{N_{t}}{M_{t}^{2}} c_{M}( t) +\frac{1}{M_{t}} c_{N}( t)\right) dW{_{t}^{\mathbb{Q}}}^{M}<span class="sc">\\</span></span>
<span id="cb1-332"><a href="#cb1-332"></a> &amp; =\frac{N_{t} /N_{0}}{M_{t} /M_{0}}\left(\frac{c_{N}( t)}{N_{t}} -\frac{c_{M}( t)}{M_{t}}\right) dW{_{t}^{\mathbb{Q}}}^{M}<span class="sc">\\</span></span>
<span id="cb1-333"><a href="#cb1-333"></a> &amp; =L_{t}\left(\frac{c_{N}( t)}{N_{t}} -\frac{c_{M}( t)}{M_{t}}\right) dW{_{t}^{\mathbb{Q}}}^{M}</span>
<span id="cb1-334"><a href="#cb1-334"></a>\end{aligned}</span>
<span id="cb1-335"><a href="#cb1-335"></a>$$</span>
<span id="cb1-336"><a href="#cb1-336"></a></span>
<span id="cb1-337"><a href="#cb1-337"></a>Comparing this, we can infer that:</span>
<span id="cb1-338"><a href="#cb1-338"></a></span>
<span id="cb1-339"><a href="#cb1-339"></a>$$</span>
<span id="cb1-340"><a href="#cb1-340"></a>\theta_t = \frac{c_N(t)}{N_t} - \frac{c_M(t)}{M_t}</span>
<span id="cb1-341"><a href="#cb1-341"></a>$$</span>
<span id="cb1-342"><a href="#cb1-342"></a></span>
<span id="cb1-343"><a href="#cb1-343"></a>Since we can write:</span>
<span id="cb1-344"><a href="#cb1-344"></a></span>
<span id="cb1-345"><a href="#cb1-345"></a>$$</span>
<span id="cb1-346"><a href="#cb1-346"></a>\begin{align*}</span>
<span id="cb1-347"><a href="#cb1-347"></a>dX_t = \mu^{\mathbb{P}}_X(t) dt + c_X(t)dW^{\mathbb{P}}(t) &amp;= \mu^{\mathbb{Q}}_X(t) + c_X(t)dW^{\mathbb{Q}}(t)<span class="sc">\\</span></span>
<span id="cb1-348"><a href="#cb1-348"></a>dW^{\mathbb{P}}(t) &amp;= \frac{\mu^{\mathbb{Q}}_X(t) - \mu^{\mathbb{P}}_X(t)}{c_X(t)} + dW^{\mathbb{Q}}(t)</span>
<span id="cb1-349"><a href="#cb1-349"></a>\end{align*}</span>
<span id="cb1-350"><a href="#cb1-350"></a>$${#eq-p-and-q-dynamics}</span>
<span id="cb1-351"><a href="#cb1-351"></a></span>
<span id="cb1-352"><a href="#cb1-352"></a>Using @eq-p-and-q-dynamics, we conclude that the change of drift accompanying a change of numeraire is given by:</span>
<span id="cb1-353"><a href="#cb1-353"></a></span>
<span id="cb1-354"><a href="#cb1-354"></a>$$</span>
<span id="cb1-355"><a href="#cb1-355"></a>\begin{align*}</span>
<span id="cb1-356"><a href="#cb1-356"></a>\mu_X^{\mathbb{Q}}(t) - \mu_X^{\mathbb{P}}(t) = c_X(t)\left(\frac{c_M(t)}{M(t)} - \frac{c_N(t)}{N(t)}\right)</span>
<span id="cb1-357"><a href="#cb1-357"></a>\end{align*}</span>
<span id="cb1-358"><a href="#cb1-358"></a>$${#eq-change-of-drift-accompanying-change-of-numeraire}</span>
<span id="cb1-359"><a href="#cb1-359"></a></span>
<span id="cb1-360"><a href="#cb1-360"></a><span class="fu">## Examples of numeraires</span></span>
<span id="cb1-361"><a href="#cb1-361"></a></span>
<span id="cb1-362"><a href="#cb1-362"></a>The basic component of an interest rate model is an instantaneous forward rate process $f(t,s)$. Its value is the future instantaneous interest rate at a future time $s$, that is the rate for the infinitesimally short term $<span class="co">[</span><span class="ot">s,s+ds</span><span class="co">]</span>$ observed at time $t \leq s$.</span>
<span id="cb1-363"><a href="#cb1-363"></a></span>
<span id="cb1-364"><a href="#cb1-364"></a>A *zero-coupon bond* settling at time $T_0$ and maturing at time $T &gt; T_0$ is the process:</span>
<span id="cb1-365"><a href="#cb1-365"></a></span>
<span id="cb1-366"><a href="#cb1-366"></a>$$</span>
<span id="cb1-367"><a href="#cb1-367"></a>P(t,T_0,T) = \exp\left(-\int_{T_0}^Tf(t,s)ds\right)</span>
<span id="cb1-368"><a href="#cb1-368"></a>$$</span>
<span id="cb1-369"><a href="#cb1-369"></a></span>
<span id="cb1-370"><a href="#cb1-370"></a>for $t \leq T_0$. In other words, it is the time $T_0$ value of 1$\$$ (without the risk of default) at $T$, as observed at time $t \leq T_0$. Its current value is given by:</span>
<span id="cb1-371"><a href="#cb1-371"></a></span>
<span id="cb1-372"><a href="#cb1-372"></a><span class="fu">### Bank-account numeraire</span></span>
<span id="cb1-373"><a href="#cb1-373"></a></span>
<span id="cb1-374"><a href="#cb1-374"></a>The bank-account(money-market account) numeraire is simply the value of $1\$$ deposited in a bank and accruing the (credit-riskless) instantaneous interest rate. In reality, the bank credits interest to the account daily, but this can very well be approximated to a continous process. The associated stochastic price process $M(t)$ is given by:</span>
<span id="cb1-375"><a href="#cb1-375"></a></span>
<span id="cb1-376"><a href="#cb1-376"></a>$$</span>
<span id="cb1-377"><a href="#cb1-377"></a>\begin{align*}</span>
<span id="cb1-378"><a href="#cb1-378"></a>M(t) = \exp(\int_0^t r(s)ds)</span>
<span id="cb1-379"><a href="#cb1-379"></a>\end{align*}</span>
<span id="cb1-380"><a href="#cb1-380"></a>$$</span>
<span id="cb1-381"><a href="#cb1-381"></a></span>
<span id="cb1-382"><a href="#cb1-382"></a>Here, the spot rate $r(t)$ is the instantaneous forward observed at the time it settles. That is,</span>
<span id="cb1-383"><a href="#cb1-383"></a></span>
<span id="cb1-384"><a href="#cb1-384"></a>$$</span>
<span id="cb1-385"><a href="#cb1-385"></a>r(t) = f(t,t)</span>
<span id="cb1-386"><a href="#cb1-386"></a>$$</span>
<span id="cb1-387"><a href="#cb1-387"></a></span>
<span id="cb1-388"><a href="#cb1-388"></a><span class="fu">### Forward numeraire</span></span>
<span id="cb1-389"><a href="#cb1-389"></a></span>
<span id="cb1-390"><a href="#cb1-390"></a>A zero-coupon bond(ZCB) is a simple contract with unit payoff $1\$$ at maturity $T$. By the risk-neutral valuation formula:</span>
<span id="cb1-391"><a href="#cb1-391"></a></span>
<span id="cb1-392"><a href="#cb1-392"></a>$$</span>
<span id="cb1-393"><a href="#cb1-393"></a>P(t,t,T) = V(t) = M(t) \mathbb{E}^{\mathbb{Q}^M}\left<span class="co">[</span><span class="ot">\frac{1}{M(T)}\right</span><span class="co">]</span></span>
<span id="cb1-394"><a href="#cb1-394"></a>$$</span>
<span id="cb1-395"><a href="#cb1-395"></a></span>
<span id="cb1-396"><a href="#cb1-396"></a>So, a $T$-maturity ZCB is a tradable asset and its price $P(t,T)$ can be used as a numeraire. The associated measure is called the $T$-foward measure $\mathbb{Q}^T$.</span>
<span id="cb1-397"><a href="#cb1-397"></a></span>
<span id="cb1-398"><a href="#cb1-398"></a>The term(e.g. 3 months) forward rates for settlement at $T_0$ and maturity at $T$ are defined by the equation:</span>
<span id="cb1-399"><a href="#cb1-399"></a></span>
<span id="cb1-400"><a href="#cb1-400"></a>$$</span>
<span id="cb1-401"><a href="#cb1-401"></a>\begin{align*}</span>
<span id="cb1-402"><a href="#cb1-402"></a>P(t,T_0,T) = \frac{1}{1 + \delta F(t,T_0,T)}</span>
<span id="cb1-403"><a href="#cb1-403"></a>\end{align*}</span>
<span id="cb1-404"><a href="#cb1-404"></a>$$</span>
<span id="cb1-405"><a href="#cb1-405"></a></span>
<span id="cb1-406"><a href="#cb1-406"></a>where $\delta$ is the day-count fraction for the period $<span class="co">[</span><span class="ot">T_0,T</span><span class="co">]</span>$. Re-arranging, we have:</span>
<span id="cb1-407"><a href="#cb1-407"></a></span>
<span id="cb1-408"><a href="#cb1-408"></a>$$</span>
<span id="cb1-409"><a href="#cb1-409"></a>\begin{align*}</span>
<span id="cb1-410"><a href="#cb1-410"></a>F(t,T_0,T) &amp;= \frac{1}{\delta}\frac{P(t,T,T) - P(t,T_0, T)}{P(t,T_0,T)}</span>
<span id="cb1-411"><a href="#cb1-411"></a>F(t,T_0,T)P(t,T_0,T) &amp;= \frac{1}{\delta}(P(t,T,T) - P(t,T_0,T))</span>
<span id="cb1-412"><a href="#cb1-412"></a>\end{align*}</span>
<span id="cb1-413"><a href="#cb1-413"></a>$$</span>
<span id="cb1-414"><a href="#cb1-414"></a></span>
<span id="cb1-415"><a href="#cb1-415"></a>Clearly, it is a multiple of a difference $P(t,T,T)$ and $P(t,T_0,T)$ normalized by $T$-maturity zero coupon bond price $P(t,T_0,T)$. So, the forward iBOR-rate must be a martingale under the $T$-forward measure $Q^T$.</span>
<span id="cb1-416"><a href="#cb1-416"></a></span>
<span id="cb1-417"><a href="#cb1-417"></a>:::{#prp-forward-rates-are-martingales-under-forward-measure} </span>
<span id="cb1-418"><a href="#cb1-418"></a></span>
<span id="cb1-419"><a href="#cb1-419"></a><span class="fu">### Forward rates are $\mathbb{Q}^T$ expectations of future spot rates. </span></span>
<span id="cb1-420"><a href="#cb1-420"></a>Any simply compounded forward rate spanning a time interval ending in $T$ is a martingale under the $T$-forward measure. </span>
<span id="cb1-421"><a href="#cb1-421"></a></span>
<span id="cb1-422"><a href="#cb1-422"></a>$$</span>
<span id="cb1-423"><a href="#cb1-423"></a>\mathbb{E}^{\mathbb{Q}^T}<span class="co">[</span><span class="ot">F(t;S,T)|\mathcal{F}_u</span><span class="co">]</span> = F(u;S,T)</span>
<span id="cb1-424"><a href="#cb1-424"></a>$$</span>
<span id="cb1-425"><a href="#cb1-425"></a></span>
<span id="cb1-426"><a href="#cb1-426"></a>for each $0 \leq u \leq t \leq S &lt; T$. In particular, the forward rate spanning the interval $<span class="co">[</span><span class="ot">S,T</span><span class="co">]</span>$ is the $\mathbb{Q}^T$ expectation of the future simply-compounded spot rate at time $S$ for the maturity T. </span>
<span id="cb1-427"><a href="#cb1-427"></a></span>
<span id="cb1-428"><a href="#cb1-428"></a>$$</span>
<span id="cb1-429"><a href="#cb1-429"></a>\mathbb{E}^{\mathbb{Q}^T}<span class="co">[</span><span class="ot">L(S,T)|\mathcal{F}_t</span><span class="co">]</span> = F(t;S,T)</span>
<span id="cb1-430"><a href="#cb1-430"></a>$${#eq-forward-rate-is-the-QT-expectation-of-future-spot-rate}</span>
<span id="cb1-431"><a href="#cb1-431"></a>:::</span>
<span id="cb1-432"><a href="#cb1-432"></a></span>
<span id="cb1-433"><a href="#cb1-433"></a>:::{#expected-value-of-any-future-instantaneous-rates}</span>
<span id="cb1-434"><a href="#cb1-434"></a></span>
<span id="cb1-435"><a href="#cb1-435"></a>The expected value of any future instantaneous spot interest rate, under the corresponding forward measure, is equal to the related instantaneuous forward rate. That is,</span>
<span id="cb1-436"><a href="#cb1-436"></a>$$</span>
<span id="cb1-437"><a href="#cb1-437"></a>\begin{align*}</span>
<span id="cb1-438"><a href="#cb1-438"></a>\mathbb{E}^T{r_T|\mathcal{F}_t} = f(t,T)</span>
<span id="cb1-439"><a href="#cb1-439"></a>\end{align*}</span>
<span id="cb1-440"><a href="#cb1-440"></a>$$</span>
<span id="cb1-441"><a href="#cb1-441"></a></span>
<span id="cb1-442"><a href="#cb1-442"></a>for each $0 \leq t \leq T$.</span>
<span id="cb1-443"><a href="#cb1-443"></a>:::</span>
<span id="cb1-444"><a href="#cb1-444"></a></span>
<span id="cb1-445"><a href="#cb1-445"></a>*Proof.*</span>
<span id="cb1-446"><a href="#cb1-446"></a></span>
<span id="cb1-447"><a href="#cb1-447"></a>We have:</span>
<span id="cb1-448"><a href="#cb1-448"></a></span>
<span id="cb1-449"><a href="#cb1-449"></a>$$</span>
<span id="cb1-450"><a href="#cb1-450"></a>\begin{align*}</span>
<span id="cb1-451"><a href="#cb1-451"></a>\mathbb{E}^{\mathbb{Q}^T} <span class="co">[</span><span class="ot">r_T|\mathcal{F}_t</span><span class="co">]</span> &amp;= \frac{1}{P(t,T)}\mathbb{E}\left<span class="co">[</span><span class="ot">r_TP(t,T)|\mathcal{F}_t\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-452"><a href="#cb1-452"></a>&amp;= - \frac{1}{P(t,T)}\mathbb{E}\left<span class="co">[</span><span class="ot">r_Te^{-\int_t^T r(s)ds}|\mathcal{F}_t\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-453"><a href="#cb1-453"></a>&amp;= - \frac{1}{P(t,T)}\mathbb{E}\left<span class="co">[</span><span class="ot">\frac{\partial}{\partial T}e^{-\int_t^T r(s)ds}|\mathcal{F}_t\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-454"><a href="#cb1-454"></a>&amp;= - \frac{1}{P(t,T)}\frac{\partial}{\partial T}\mathbb{E}\left<span class="co">[</span><span class="ot">e^{-\int_t^T r(s)ds}|\mathcal{F}_t\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-455"><a href="#cb1-455"></a>&amp;= - \frac{1}{P(t,T)}\frac{\partial}{\partial T}P(t,T)<span class="sc">\\</span></span>
<span id="cb1-456"><a href="#cb1-456"></a>&amp;= f(t,T)</span>
<span id="cb1-457"><a href="#cb1-457"></a>\end{align*}</span>
<span id="cb1-458"><a href="#cb1-458"></a>$$</span>
<span id="cb1-459"><a href="#cb1-459"></a></span>
<span id="cb1-460"><a href="#cb1-460"></a><span class="fu">### Pricing an IRS</span></span>
<span id="cb1-461"><a href="#cb1-461"></a></span>
<span id="cb1-462"><a href="#cb1-462"></a>Consider a forward starting interest rate swap(IRS) which settles in $T_0$ and matures in $T_N$ years from now. An IRS is a transaction between two counterparties who exchange interest rate payments on an agreed notional principal. </span>
<span id="cb1-463"><a href="#cb1-463"></a></span>
<span id="cb1-464"><a href="#cb1-464"></a>On a vanilla swap, a fixed-coupon interest payments are exchanged for floating rate payments. For the sake of simplicity, we assume that the payment dates on the fixed and floating leg of the swap are the same, and that the floating rate is the same as the discounting rate. The former of these assumptions is a minor simplification, made to lighten up the notation only. The latter is an important simplification, as the basis between the floating rate and the discounting rate may exhibit a complex dynamics.</span>
<span id="cb1-465"><a href="#cb1-465"></a></span>
<span id="cb1-466"><a href="#cb1-466"></a>Let $S$ be the fixed-rate on the swap. By the risk-neutral valuation formula, the fixed leg value at time $t$ can be expressed as:</span>
<span id="cb1-467"><a href="#cb1-467"></a></span>
<span id="cb1-468"><a href="#cb1-468"></a>$$</span>
<span id="cb1-469"><a href="#cb1-469"></a>\begin{align*}</span>
<span id="cb1-470"><a href="#cb1-470"></a>V_{fixed}(t) &amp;=   N \cdot \sum_{i=1}^N \mathbb{E}^{\mathbb{Q^M}}<span class="co">[</span><span class="ot">e^{-r(T_i-t)}S \tau(T_{i-1},T_i)|\mathcal{F}_t</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-471"><a href="#cb1-471"></a>&amp;=S \cdot N \cdot \sum_{i=1}^N \mathbb{E}^{\mathbb{Q}}<span class="co">[</span><span class="ot">e^{-r(T_i-t)}\tau(T_{i-1},T_i)|\mathcal{F}_t</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-472"><a href="#cb1-472"></a>&amp;=S \cdot N \cdot \left(\sum_{i=1}^N P(t,T_i)\tau(T_{i-1},T_i)\right)</span>
<span id="cb1-473"><a href="#cb1-473"></a>\end{align*}</span>
<span id="cb1-474"><a href="#cb1-474"></a>$$</span>
<span id="cb1-475"><a href="#cb1-475"></a></span>
<span id="cb1-476"><a href="#cb1-476"></a>The floating leg can be written as:</span>
<span id="cb1-477"><a href="#cb1-477"></a></span>
<span id="cb1-478"><a href="#cb1-478"></a>$$</span>
<span id="cb1-479"><a href="#cb1-479"></a>\begin{align*}</span>
<span id="cb1-480"><a href="#cb1-480"></a>V_{float}(t) &amp; = N \cdot \sum_{i=1}^N P(t,T_i)\mathbb{E}^{T_i}\left<span class="co">[</span><span class="ot">L(T,T_{i-1}, T_i)|\mathcal{F}_t\right</span><span class="co">]</span>\tau(T_{i-1},T_i)<span class="sc">\\</span></span>
<span id="cb1-481"><a href="#cb1-481"></a>&amp;=  N \cdot \sum_{i=1}^N P(t,T_i)L(t,T_{i-1}, T_i)\tau(T_{i-1},T_i)<span class="sc">\\</span></span>
<span id="cb1-482"><a href="#cb1-482"></a>&amp;= N \cdot \sum_{i=1}^N P(t,T_i)\frac{1}{\tau(T_{i-1},T_i)}\cdot\left(\frac{P(t,T_{i-1})}{P(t,T_{i})}-1\right)\tau(T_{i-1},T_i)<span class="sc">\\</span></span>
<span id="cb1-483"><a href="#cb1-483"></a>&amp;= N \cdot \sum_{i=1}^N (P(t,T_i) - P(t,T_{i-1}))<span class="sc">\\</span></span>
<span id="cb1-484"><a href="#cb1-484"></a>&amp;= -N P(t,T_0) + NP(t,T_N)</span>
<span id="cb1-485"><a href="#cb1-485"></a>\end{align*}</span>
<span id="cb1-486"><a href="#cb1-486"></a>$$</span>
<span id="cb1-487"><a href="#cb1-487"></a></span>
<span id="cb1-488"><a href="#cb1-488"></a>where the expectations are under the $T_i$-forward measure. Note that, I used the fact that the iBOR-rates are martingales under the forward measure.</span>
<span id="cb1-489"><a href="#cb1-489"></a></span>
<span id="cb1-490"><a href="#cb1-490"></a>The par-swap rate $S$ is the fixed-rate which renders the value of the swap zero at the contract start date $t$.</span>
<span id="cb1-491"><a href="#cb1-491"></a></span>
<span id="cb1-492"><a href="#cb1-492"></a>$$</span>
<span id="cb1-493"><a href="#cb1-493"></a>\begin{align*}</span>
<span id="cb1-494"><a href="#cb1-494"></a>-V_{fix} + V_{floating} &amp;= 0<span class="sc">\\</span></span>
<span id="cb1-495"><a href="#cb1-495"></a>S \cdot N \cdot \left(\sum_{i=1}^N P(t,T_i)\tau(T_{i-1},T_i)\right) &amp;= -N P(t,T_0) + NP(t,T_N) <span class="sc">\\</span></span>
<span id="cb1-496"><a href="#cb1-496"></a>S(t,T_{0:N}) &amp;= \frac{- P(t,T_0) + P(t,T_N)}{\left(\sum_{i=1}^N P(t,T_i)\tau(T_{i-1},T_i)\right)}</span>
<span id="cb1-497"><a href="#cb1-497"></a>\end{align*}</span>
<span id="cb1-498"><a href="#cb1-498"></a>$$</span>
<span id="cb1-499"><a href="#cb1-499"></a></span>
<span id="cb1-500"><a href="#cb1-500"></a><span class="fu">### The Annuity Measure</span></span>
<span id="cb1-501"><a href="#cb1-501"></a></span>
<span id="cb1-502"><a href="#cb1-502"></a>The annuity is an asset that pays $1\$$ on each coupon payment day of the swap, accrued according to the swap's day count convention. </span>
<span id="cb1-503"><a href="#cb1-503"></a></span>
<span id="cb1-504"><a href="#cb1-504"></a>$$</span>
<span id="cb1-505"><a href="#cb1-505"></a>A(t,T_{0:N}) = \left( \sum_{i=1}^N P(t,T_i)\tau(T_{i-1},T_i) \right)</span>
<span id="cb1-506"><a href="#cb1-506"></a>$$</span>
<span id="cb1-507"><a href="#cb1-507"></a></span>
<span id="cb1-508"><a href="#cb1-508"></a>Since, it is a portfolio of zero coupon bonds, it is a tradable asset and its price $A(t,T_{0:N})$ can be used as numeraire. This is called the *Annuity numeraire* and the measure $\mathbb{Q}^{T_{0:N}}$ associated with this numeraire is called the (forward) swap measure. The annuity numeraire arises as the natural numeraire when valuing swaptions. It is the mechanism that allows us to link the swaption as an option on a swap to the option on the corresponding swap rate. </span>
<span id="cb1-509"><a href="#cb1-509"></a></span>
<span id="cb1-510"><a href="#cb1-510"></a>The forward swap rate $S(t,T_{0:N})$ is a martingale in the annuity measure $\mathbb{Q}^{T_{0:N}}$. </span>
<span id="cb1-511"><a href="#cb1-511"></a></span>
<span id="cb1-512"><a href="#cb1-512"></a><span class="fu">## Pricing the payoff $V(T) = S_T(S_T - K)^{+}$</span></span>
<span id="cb1-513"><a href="#cb1-513"></a></span>
<span id="cb1-514"><a href="#cb1-514"></a>Under the risk-neutral measure $\mathbb{Q}^M$ associated with the money-market account numeraire $M(t)$, the stock price $S(t)$ evolves according to:</span>
<span id="cb1-515"><a href="#cb1-515"></a></span>
<span id="cb1-516"><a href="#cb1-516"></a>$$</span>
<span id="cb1-517"><a href="#cb1-517"></a>\begin{align*}</span>
<span id="cb1-518"><a href="#cb1-518"></a>dS_t = r S_t dt + \sigma S_t dW^{\mathbb{Q}^M}</span>
<span id="cb1-519"><a href="#cb1-519"></a>\end{align*}</span>
<span id="cb1-520"><a href="#cb1-520"></a>$$ {#eq-diffusion}</span>
<span id="cb1-521"><a href="#cb1-521"></a></span>
<span id="cb1-522"><a href="#cb1-522"></a>which has the solution:</span>
<span id="cb1-523"><a href="#cb1-523"></a></span>
<span id="cb1-524"><a href="#cb1-524"></a>$$</span>
<span id="cb1-525"><a href="#cb1-525"></a>\begin{align*}</span>
<span id="cb1-526"><a href="#cb1-526"></a>S_t = S_0\exp\left<span class="co">[</span><span class="ot">\left(r - \frac{\sigma^2}{2}\right)t + \sigma W^{\mathbb{Q}^M}(t)\right</span><span class="co">]</span></span>
<span id="cb1-527"><a href="#cb1-527"></a>\end{align*}</span>
<span id="cb1-528"><a href="#cb1-528"></a>$$ {#eq-solution-of-gbm}</span>
<span id="cb1-529"><a href="#cb1-529"></a></span>
<span id="cb1-530"><a href="#cb1-530"></a>By the risk-neutral pricing formula, we have:</span>
<span id="cb1-531"><a href="#cb1-531"></a></span>
<span id="cb1-532"><a href="#cb1-532"></a>$$</span>
<span id="cb1-533"><a href="#cb1-533"></a>\begin{align*}</span>
<span id="cb1-534"><a href="#cb1-534"></a>V(0) &amp;= \mathbb{E}^{\mathbb{Q}^M}\left<span class="co">[</span><span class="ot">\frac{V(T)}{M(T)}\right</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb1-535"><a href="#cb1-535"></a>&amp;= \mathbb{E}^{\mathbb{Q}^M}\left<span class="co">[</span><span class="ot">\frac{S_T}{M_T}(S_T - K)^{+}\right</span><span class="co">]</span></span>
<span id="cb1-536"><a href="#cb1-536"></a>\end{align*}</span>
<span id="cb1-537"><a href="#cb1-537"></a>$$ {#eq-risk-neutral}</span>
<span id="cb1-538"><a href="#cb1-538"></a></span>
<span id="cb1-539"><a href="#cb1-539"></a>By the change-of-measure formula, if $N$ is any other numeraire with associated probability measure $\mathbb{Q}^N$, we know that:</span>
<span id="cb1-540"><a href="#cb1-540"></a></span>
<span id="cb1-541"><a href="#cb1-541"></a>$$</span>
<span id="cb1-542"><a href="#cb1-542"></a>\begin{align*}</span>
<span id="cb1-543"><a href="#cb1-543"></a>\mathbb{E}^{\mathbb{Q}^N}<span class="co">[</span><span class="ot">V(T)</span><span class="co">]</span>=\mathbb{E}^{\mathbb{Q}^M}\left<span class="co">[</span><span class="ot">\frac{d\mathbb{Q}^N}{d\mathbb{Q}^M}V(T)\right</span><span class="co">]</span></span>
<span id="cb1-544"><a href="#cb1-544"></a>\end{align*}</span>
<span id="cb1-545"><a href="#cb1-545"></a>$$ {#eq-change-of-measure}</span>
<span id="cb1-546"><a href="#cb1-546"></a></span>
<span id="cb1-547"><a href="#cb1-547"></a>We switch to the stock numeraire $S_t$. The Radon-Nikodym derivative $L_T = d\mathbb{Q}^S/d\mathbb{Q}^M$ is simply:</span>
<span id="cb1-548"><a href="#cb1-548"></a></span>
<span id="cb1-549"><a href="#cb1-549"></a>$$</span>
<span id="cb1-550"><a href="#cb1-550"></a>\begin{align*}</span>
<span id="cb1-551"><a href="#cb1-551"></a>L_T = \frac{d\mathbb{Q}^S}{d\mathbb{Q}^M} = \frac{S(T)/S(0)}{M(T)/M(0)}  = \frac{1}{S(0)}\cdot \frac{S(T)}{M(T)}</span>
<span id="cb1-552"><a href="#cb1-552"></a>\end{align*}</span>
<span id="cb1-553"><a href="#cb1-553"></a>$$ {#eq-radon-nikodym}</span>
<span id="cb1-554"><a href="#cb1-554"></a></span>
<span id="cb1-555"><a href="#cb1-555"></a>The dynamics of $L_t$ under the $\mathbb{Q}_M$ measure is given by:</span>
<span id="cb1-556"><a href="#cb1-556"></a></span>
<span id="cb1-557"><a href="#cb1-557"></a>$$</span>
<span id="cb1-558"><a href="#cb1-558"></a>dL_t = \phi_t L_t dW^{\mathbb{Q}^M}</span>
<span id="cb1-559"><a href="#cb1-559"></a>$$</span>
<span id="cb1-560"><a href="#cb1-560"></a></span>
<span id="cb1-561"><a href="#cb1-561"></a>where the Girsanov kernel $\phi_t = \sigma$. Then, the Girsanov transformation is:</span>
<span id="cb1-562"><a href="#cb1-562"></a></span>
<span id="cb1-563"><a href="#cb1-563"></a>$$</span>
<span id="cb1-564"><a href="#cb1-564"></a>W^{\mathbb{Q}^M}_T = W^{\mathbb{Q}^S}_T + \sigma T</span>
<span id="cb1-565"><a href="#cb1-565"></a>$$ {#eq-girsanov-drift}</span>
<span id="cb1-566"><a href="#cb1-566"></a></span>
<span id="cb1-567"><a href="#cb1-567"></a>So, the $\mathbb{Q}^S$ dynamics of the stock price is:</span>
<span id="cb1-568"><a href="#cb1-568"></a></span>
<span id="cb1-569"><a href="#cb1-569"></a>$$</span>
<span id="cb1-570"><a href="#cb1-570"></a>\begin{align*}</span>
<span id="cb1-571"><a href="#cb1-571"></a>S_T &amp;= S_0 \exp\left<span class="co">[</span><span class="ot">\left(r - \frac{\sigma^2}{2}\right)T + \sigma (W^{\mathbb{Q}^S}_T + \sigma T)\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-572"><a href="#cb1-572"></a>&amp;=  S_0 \exp\left<span class="co">[</span><span class="ot">\left(r + \frac{\sigma^2}{2}\right)T + \sigma (W^{\mathbb{Q}^S}_T)\right</span><span class="co">]</span></span>
<span id="cb1-573"><a href="#cb1-573"></a>\end{align*}</span>
<span id="cb1-574"><a href="#cb1-574"></a>$$ {#eq-Qs-dynamics}</span>
<span id="cb1-575"><a href="#cb1-575"></a></span>
<span id="cb1-576"><a href="#cb1-576"></a>We can develop the expression in @eq-risk-neutral to be:</span>
<span id="cb1-577"><a href="#cb1-577"></a></span>
<span id="cb1-578"><a href="#cb1-578"></a>$$</span>
<span id="cb1-579"><a href="#cb1-579"></a>\begin{align*}</span>
<span id="cb1-580"><a href="#cb1-580"></a>V(0) &amp;= S_0\mathbb{E}^{\mathbb{Q}^M}\left<span class="co">[</span><span class="ot">\frac{1}{S_0}\frac{S_T}{M_T}(S_T - K)^{+}\right</span><span class="co">]</span></span>
<span id="cb1-581"><a href="#cb1-581"></a>\end{align*}</span>
<span id="cb1-582"><a href="#cb1-582"></a>$$ {#eq-develop-the-expression}</span>
<span id="cb1-583"><a href="#cb1-583"></a></span>
<span id="cb1-584"><a href="#cb1-584"></a>Applying the change-of-measure (abstract *Baye's* formula),we have:</span>
<span id="cb1-585"><a href="#cb1-585"></a></span>
<span id="cb1-586"><a href="#cb1-586"></a>$$</span>
<span id="cb1-587"><a href="#cb1-587"></a>\begin{align*}</span>
<span id="cb1-588"><a href="#cb1-588"></a>V(0) &amp;= S_0\mathbb{E}^{\mathbb{Q}^S}\left<span class="co">[</span><span class="ot">(S_T - K)^{+}\right</span><span class="co">]</span></span>
<span id="cb1-589"><a href="#cb1-589"></a>\end{align*}</span>
<span id="cb1-590"><a href="#cb1-590"></a>$$ {#eq-applying-change-of-measure-formula}</span>
<span id="cb1-591"><a href="#cb1-591"></a></span>
<span id="cb1-592"><a href="#cb1-592"></a>Now, we have:</span>
<span id="cb1-593"><a href="#cb1-593"></a></span>
<span id="cb1-594"><a href="#cb1-594"></a>$$</span>
<span id="cb1-595"><a href="#cb1-595"></a>\begin{align*}</span>
<span id="cb1-596"><a href="#cb1-596"></a>\mathbb{Q}^S(S_T &gt; K) &amp;= \mathbb{Q}^S\left(S_0 \exp\left<span class="co">[</span><span class="ot">\left(r + \frac{\sigma^2}{2}\right)T + \sigma (W^{\mathbb{Q}^S}_T)\right</span><span class="co">]</span> &gt; K\right)<span class="sc">\\</span></span>
<span id="cb1-597"><a href="#cb1-597"></a>&amp;= \mathbb{Q}^S\left(S_0 \exp\left<span class="co">[</span><span class="ot">\left(r + \frac{\sigma^2}{2}\right)T + \sigma (-\sqrt{T}Z)\right</span><span class="co">]</span> &gt; K\right)<span class="sc">\\</span></span>
<span id="cb1-598"><a href="#cb1-598"></a>&amp;= \mathbb{Q}^S\left(\log \frac{S_0}{K}  + \left(r + \frac{\sigma^2}{2}\right)T   &gt; \sigma\sqrt{T}Z\right)<span class="sc">\\</span></span>
<span id="cb1-599"><a href="#cb1-599"></a>\end{align*}</span>
<span id="cb1-600"><a href="#cb1-600"></a>$$ {#eq-probability-under-stock-measure}</span>
<span id="cb1-601"><a href="#cb1-601"></a></span>
<span id="cb1-602"><a href="#cb1-602"></a>where we subbed $-\sqrt{T}Z=W^{\mathbb{Q}^S}_T$. Recall, the standard normals $Z$ and $-Z$ have the same distribution by symmetry.</span>
<span id="cb1-603"><a href="#cb1-603"></a></span>
<span id="cb1-604"><a href="#cb1-604"></a>Define </span>
<span id="cb1-605"><a href="#cb1-605"></a></span>
<span id="cb1-606"><a href="#cb1-606"></a>$$</span>
<span id="cb1-607"><a href="#cb1-607"></a>d_{-} = \frac{\log \frac{S_0}{K}  + \left(r + \frac{\sigma^2}{2}\right)T}{\sigma\sqrt{T}}</span>
<span id="cb1-608"><a href="#cb1-608"></a>$$ {#eq-expression-for-d2}</span>
<span id="cb1-609"><a href="#cb1-609"></a></span>
<span id="cb1-610"><a href="#cb1-610"></a>Then, since $Z \sim \mathcal{N}^{\mathbb{Q}^S}(0,1)$:</span>
<span id="cb1-611"><a href="#cb1-611"></a></span>
<span id="cb1-612"><a href="#cb1-612"></a>$$</span>
<span id="cb1-613"><a href="#cb1-613"></a>\mathbb{Q}^S(S_T &gt; K) = \mathbb{Q}^S(Z &lt; d_{-}) = \Phi(d_{-})</span>
<span id="cb1-614"><a href="#cb1-614"></a>$$ {#eq-STgtKprobability}</span>
<span id="cb1-615"><a href="#cb1-615"></a></span>
<span id="cb1-616"><a href="#cb1-616"></a>So, we can expand the expectation in @eq-applying-change-of-measure-formula. The indicator random variable $1_{<span class="sc">\{</span>S_T &gt; K<span class="sc">\}</span>}$ is $1$ for all points $Z &lt; d_{-}$. So, the limits of integration will be $-\infty$ to $d_{-}$.</span>
<span id="cb1-617"><a href="#cb1-617"></a></span>
<span id="cb1-618"><a href="#cb1-618"></a>$$</span>
<span id="cb1-619"><a href="#cb1-619"></a>\begin{align*}</span>
<span id="cb1-620"><a href="#cb1-620"></a>V(0) &amp;= S_0\left<span class="co">[</span><span class="ot">\int_{-\infty}^{d_{-}} S_T  d\mathbb{Q}^S - K\int_{-\infty}^{d_{-}} dQ^S\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-621"><a href="#cb1-621"></a>&amp;= S_0\left<span class="co">[</span><span class="ot">\int_{-\infty}^{d_{-}} S_T f_Z^{\mathbb{Q}^S}(z)dz - K\int_{-\infty}^{d_{-}} f_Z^{\mathbb{Q}^S}(z)dz\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-622"><a href="#cb1-622"></a>&amp;= S_0\left<span class="co">[</span><span class="ot">\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{d_{-}} S_0 \exp\left[\left(r + \frac{\sigma^2}{2}\right)T - \sigma \sqrt{T}z\right] \exp(-\frac{z^2}{2})dz - K\Phi(d_{-})\right</span><span class="co">]</span></span>
<span id="cb1-623"><a href="#cb1-623"></a>\end{align*}</span>
<span id="cb1-624"><a href="#cb1-624"></a>$$</span>
<span id="cb1-625"><a href="#cb1-625"></a></span>
<span id="cb1-626"><a href="#cb1-626"></a>Completing the square, we have:</span>
<span id="cb1-627"><a href="#cb1-627"></a></span>
<span id="cb1-628"><a href="#cb1-628"></a>$$</span>
<span id="cb1-629"><a href="#cb1-629"></a>\begin{align*}</span>
<span id="cb1-630"><a href="#cb1-630"></a>V(0) &amp;= S_0\left<span class="co">[</span><span class="ot">\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{d_{-}} S_0 \exp\left[-\frac{1}{2}(z^2 + 2\sigma\sqrt{T}z + (\sigma \sqrt{T})^2)\right] \exp\left[\left(r + \sigma^2\right)T\right]dz - K\Phi(d_{-})\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-631"><a href="#cb1-631"></a>&amp;=S_0 \left<span class="co">[</span><span class="ot">S_0\frac{e^{(r + \sigma^2) T}}{\sqrt{2\pi}}\int_{-\infty}^{d_{-}} \exp\left(-\frac{1}{2}(z + \sigma\sqrt{T})^2\right) dz - K\Phi(d_{-})\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb1-632"><a href="#cb1-632"></a>\end{align*}</span>
<span id="cb1-633"><a href="#cb1-633"></a>$$</span>
<span id="cb1-634"><a href="#cb1-634"></a></span>
<span id="cb1-635"><a href="#cb1-635"></a>Let $u = z + \sigma\sqrt{T}$. And define:</span>
<span id="cb1-636"><a href="#cb1-636"></a></span>
<span id="cb1-637"><a href="#cb1-637"></a>$$</span>
<span id="cb1-638"><a href="#cb1-638"></a>d_{+} = d_{-} + \sigma \sqrt{T} = \frac{\log \frac{S_0}{K} + \left(r + \frac{3}{2}\sigma^2\right)}{\sigma \sqrt{T}}</span>
<span id="cb1-639"><a href="#cb1-639"></a>$$</span>
<span id="cb1-640"><a href="#cb1-640"></a></span>
<span id="cb1-641"><a href="#cb1-641"></a>We have the closed-form formula:</span>
<span id="cb1-642"><a href="#cb1-642"></a></span>
<span id="cb1-643"><a href="#cb1-643"></a>$$</span>
<span id="cb1-644"><a href="#cb1-644"></a>V(0) = S_0^2 e^{(r+\sigma^2)T} \Phi(d_{+}) - KS_0 \Phi(d_{-})</span>
<span id="cb1-645"><a href="#cb1-645"></a>$$</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>