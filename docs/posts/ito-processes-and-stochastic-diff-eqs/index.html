<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quasar">
<meta name="dcterms.date" content="2024-07-08">

<title>Ito Processes and Stochastic Differential Equations – quantdev.blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-f2a1071e85750ec973bbb8a8f120da0f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c7c5442de8a335b1f49be48b1aa284fe.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap');
</style>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9993009899870547" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quantdev.blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Ito Processes and Stochastic Differential Equations</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">Stochastic Calculus</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Quasar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 8, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ito-processes-and-stochastic-differential-equations." id="toc-ito-processes-and-stochastic-differential-equations." class="nav-link active" data-scroll-target="#ito-processes-and-stochastic-differential-equations.">Ito Processes and Stochastic Differential Equations.</a>
  <ul class="collapse">
  <li><a href="#itos-formula." id="toc-itos-formula." class="nav-link" data-scroll-target="#itos-formula.">Ito’s Formula.</a></li>
  <li><a href="#multivariate-extension." id="toc-multivariate-extension." class="nav-link" data-scroll-target="#multivariate-extension.">Multivariate Extension.</a></li>
  <li><a href="#numerical-simulation-of-sdes" id="toc-numerical-simulation-of-sdes" class="nav-link" data-scroll-target="#numerical-simulation-of-sdes">Numerical Simulation of SDEs</a>
  <ul class="collapse">
  <li><a href="#python-implementation" id="toc-python-implementation" class="nav-link" data-scroll-target="#python-implementation">Python implementation</a></li>
  <li><a href="#convergence" id="toc-convergence" class="nav-link" data-scroll-target="#convergence">Convergence</a></li>
  </ul></li>
  <li><a href="#existence-and-uniqueness-of-sdes" id="toc-existence-and-uniqueness-of-sdes" class="nav-link" data-scroll-target="#existence-and-uniqueness-of-sdes">Existence and Uniqueness of SDEs</a></li>
  <li><a href="#martingale-representation-and-levys-characterization" id="toc-martingale-representation-and-levys-characterization" class="nav-link" data-scroll-target="#martingale-representation-and-levys-characterization">Martingale Representation and Levy’s Characterization</a></li>
  <li><a href="#exercise-problems" id="toc-exercise-problems" class="nav-link" data-scroll-target="#exercise-problems">Exercise Problems</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="ito-processes-and-stochastic-differential-equations." class="level1">
<h1>Ito Processes and Stochastic Differential Equations.</h1>
<p>Let’s start with the definition of Ito processes.</p>
<div id="def-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Ito Process)</strong></span> Let <span class="math inline">\((B(t):t\geq0)\)</span> be a standard brownian motion defined on <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span>. An Ito process <span class="math inline">\((X(t):t\geq0)\)</span> is of the form:</p>
<p><span id="eq-ito-process"><span class="math display">\[\begin{aligned}
X(t) &amp; =X(0)+\int_{0}^{t}V(s)dB(s)+\int_{0}^{t}D(s)ds
\end{aligned} \tag{1}\]</span></span></p>
<p>where <span class="math inline">\((V(t),t\geq0)\)</span> and <span class="math inline">\((D(t),t\geq0)\)</span> are two adapted processes for which the integrals make sense in the sense of Ito and Riemann. We refer to <span class="math inline">\((V(t):t\geq0)\)</span> as the <em>local volatility</em> and to <span class="math inline">\((D(t):t\geq0)\)</span> as the <em>local drift</em>.</p>
</div>
<p>We will often denote an Ito process <span class="math inline">\((X(t):t\geq0)\)</span> in differential form as:</p>
<p><span id="eq-ito-process-differential-form"><span class="math display">\[\begin{aligned}
dX(t) &amp; =D(t)dt+V(t)dB(t)
\end{aligned} \tag{2}\]</span></span></p>
<p>This form makes no rigorous sense; when we write it, we mean <a href="#eq-ito-process" class="quarto-xref">Equation&nbsp;1</a>. Nevertheless, the differential equation has two great advantages:</p>
<p>(1) It gives some intuition on what drives the variation of <span class="math inline">\(X(t)\)</span>. On one hand, there is a contribution of the Brownian increments which are modulated by the volatility <span class="math inline">\(V(t)\)</span>. On the other hand, there is a smoother contribution coming from the time variation which is modulated by the drift <span class="math inline">\(D(t)\)</span>.</p>
<p>(2) The differential notation has computational power. In particular, evaluating Ito’s formula is reduced to computing differentials, as in classical calculus, but by doing it upto the second order.</p>
<p>An important class of Ito processes is given by processes for which the volatility and the drift are simply functions of the position of the process.</p>
<div id="def-time-homogenous-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2</strong></span> Let <span class="math inline">\((B(t):t\geq0)\)</span> be a standard Brownian motion. An Ito process <span class="math inline">\((X(t):t\geq0)\)</span> of the form</p>
<p><span id="eq-time-homogenous-ito-process"><span class="math display">\[\begin{aligned}
dX(t) &amp; =\mu(X(t))dt+\sigma(X(t))dB(t),\quad X(0)=x
\end{aligned} \tag{3}\]</span></span></p>
<p>where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are functions from <span class="math inline">\(\mathbf{R}\)</span> to <span class="math inline">\(\mathbf{R}\)</span>, is called a time-homogenous diffusion.</p>
</div>
<div id="def-time-inhomogenous-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3</strong></span> An Ito-process <span class="math inline">\((Y(t),t\geq0)\)</span> of the form:</p>
<p><span id="eq-time-inhomogenous-SDE"><span class="math display">\[\begin{aligned}
{1}
dY(t) &amp; =\mu(t,X(t))dt+\sigma(t,X(t))dB(t)\quad Y(0)=y
\end{aligned} \tag{4}\]</span></span></p>
<p>where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are now functions <span class="math inline">\([0,\infty)\times\mathbf{R}\to\mathbf{R}\)</span> is called a time-inhomogenous diffusion.</p>
</div>
<p>The equations above are called <em>stochastic differential equations</em> (SDE) of the respective process <span class="math inline">\((X(t))\)</span> and <span class="math inline">\((Y(t))\)</span>.</p>
<p>In other words, a diffusion <span class="math inline">\((X(t),t\geq 0)\)</span> is an Ito process whose local volatility <span class="math inline">\(V(t)\)</span> and local drift <span class="math inline">\(D(t)\)</span> at time <span class="math inline">\(t\)</span> depend only on the position of the process at time <span class="math inline">\(t\)</span> and possibly on the time <span class="math inline">\(t\)</span> itself. It cannot depend on the path of the process before time <span class="math inline">\(t\)</span> or on the explicit values of the driving Brownian motion at that time (which is not the process <span class="math inline">\(X(t)\)</span> itself). The class of diffusions, and of the Ito processes in general, constitutes a huge collection of stochastic processes for stochastic modelling.</p>
<p>Note that an SDE is a generalization of ordinary differential equations or ODEs. Indeed, if there were no randomness, that is, no Brownian motion, the SDE would be reduced to</p>
<p><span class="math display">\[\begin{aligned}
dX(t) &amp; =\mu(X(t))dt
\end{aligned}\]</span></p>
<p>This can be written for <span class="math inline">\(X(t)=f(t)\)</span> as:</p>
<p><span class="math display">\[\begin{aligned}
\frac{df}{dt} &amp; =\mu(f)
\end{aligned}\]</span></p>
<p>This is a first-order ordinary differential equation. It governs the deterministic evolution of the function <span class="math inline">\(X(t)=f(t)\)</span> in time. An SDE adds a random term to this evolution that is formally written as:</p>
<p><span class="math display">\[\begin{aligned}
\frac{dX}{dt} &amp; =\mu(X(t))+\sigma(X(t))\frac{dB(t)}{dt}
\end{aligned}\]</span></p>
<p>We know very well, that Brownian motion is not differentiable; hence the above is not well-defined. The ill-defined term <span class="math inline">\(dB(t)/dt\)</span> is sometimes called white noise. However, equation <a href="#eq-time-homogenous-ito-process" class="quarto-xref">Equation&nbsp;3</a> is well-defined in the sense of the Ito process. These types of equations are well-suited to model phenomena with intrinsic randomness.</p>
<p>Here are some examples of diffusions:</p>
<div id="exm-brownian-motion-with-a-drift" class="theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> (Brownian Motion with a drift). If we take <span class="math inline">\(X(t)=\sigma B(t)+\mu t\)</span> for some <span class="math inline">\(\sigma&gt;0\)</span> and <span class="math inline">\(\mu\in\mathbf{R}\)</span>, then we can write <span class="math inline">\(X(t)\)</span> as:</p>
<p><span class="math display">\[\begin{aligned}
X(t) &amp; =\int_{0}^{t}\sigma dB(t)+\int_{0}^{t}\mu dt,\quad X(0)=0
\end{aligned}\]</span></p>
<p>In the differential form this becomes</p>
<p><span class="math display">\[\begin{aligned}
dX(t) &amp; =\mu dt+\sigma dB(t)
\end{aligned}\]</span></p>
<p>In this case, the local drift and the local volatility are constant.</p>
</div>
<div id="exm-geometric-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> (Geometric Brownian Motion). We consider the process <span class="math inline">\(S(t)=\exp((\mu-\sigma^{2}/2)t+\sigma B(t))\)</span>. To find the stochastic differential equation, we apply the Ito’s Lemma to</p>
<p><span class="math display">\[\begin{aligned}
f(t,x) &amp; =\exp((\mu-\sigma^{2}/2)t+\sigma x)
\end{aligned}\]</span></p>
<p>We have:</p>
<p><span class="math display">\[\begin{aligned}
df(t,x) &amp; =\left((\mu-\sigma^{2}/2)+\frac{1}{2}\sigma^{2}\right)\exp((\mu-\sigma^{2}/2)t+\sigma x)dt+\sigma\exp((\mu-\sigma^{2}/2)t+\sigma x)dB(t)\\
&amp; =\mu S(t)dt+\sigma S(t)dB(t)
\end{aligned}\]</span></p>
<p>Note that the local drift and the local volatility are now proportional to the position. So, the higher <span class="math inline">\(S(t)\)</span>, the higher the volatility and drift.</p>
</div>
<div id="exm-smooth-function-of-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 3</strong></span> (Any smooth function of Brownian motion). Ito’s formula gurarantees that any smooth function <span class="math inline">\(f(t,B(t))\)</span> of time and a Brownian motion is an Ito process with volatility <span class="math inline">\(V(t)=\partial_{t}f(t,B(t))\)</span> and drift <span class="math inline">\(D(t)=\partial_{x}f(t,B(t))+\frac{1}{2}\partial_{xx}f(t,B(t))\)</span>. We will see in further ahead, that, in general, any reasonable function of an Ito process remains an Ito process.</p>
</div>
<div id="exm-ito-process-that-is-not-a-diffusion" class="theorem example">
<p><span class="theorem-title"><strong>Example 4</strong></span> (An Ito process that is not a diffusion) Consider the process</p>
<p><span class="math display">\[\begin{aligned}
X(t) &amp; =\int_{0}^{t}B^{2}(s)dB(s)
\end{aligned}\]</span></p>
<p>This is an Ito process with local volatility <span class="math inline">\(V(t)=B(t)^{2}\)</span> and local drift <span class="math inline">\(D(t)=0\)</span>. However, it is not a diffusion, because the local volatility is not an explicit function of <span class="math inline">\(X(t)\)</span>.</p>
<p>It turns out that the Brownian bridge is a time-inhomogenous diffusion and that the Ornstein-Uhlenbeck process is a time-homogenous diffusion. To understand these examples, we need to extend Ito’s formula to Ito processes.</p>
</div>
<section id="itos-formula." class="level2">
<h2 class="anchored" data-anchor-id="itos-formula.">Ito’s Formula.</h2>
<p>The first step towards a general Ito’s formula is the quadratic variation of an Ito process.</p>
<div id="prp-quadratic-variation-of-an-ito-process" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1 (Quadratic variation of an Ito process.)</strong></span> Let <span class="math inline">\((B(t),t\geq0)\)</span> be a standard Brownian motion and <span class="math inline">\((X(t):t\geq0)\)</span> be an Ito process of the form <span class="math inline">\(dX(t)=V(t)dB(t)+D(t)dt\)</span>. Then, the quadratic variation of the process <span class="math inline">\((X(t):t\geq0)\)</span> is:*</p>
<p><span id="eq-quadratic-variation-ito-process"><span class="math display">\[\begin{aligned}
&lt;X,X&gt;_{t} &amp; =\lim_{n\to\infty}\sum_{j=0}^{n-1}(X(t_{j+1})-X(t_{j}))^{2}=\int_{0}^{t}V(s)^{2}ds
\end{aligned} \tag{5}\]</span></span></p>
<p><em>for any partition <span class="math inline">\((t_{j},j\leq n)\)</span> of <span class="math inline">\([0,t]\)</span>, where the limit is in probability.</em></p>
</div>
<div id="rem-remark1" class="proof remark">
<p><span class="proof-title"><em>Remark 1</em>. </span>Note that the quadratic variation is increasing in <span class="math inline">\(t\)</span>, but it is not deterministic in general! <span class="math inline">\(V_t\)</span> is a random variable. The quadratic variation is a smooth stochastic process. (It is differentiable) Observe that we recover the quadratic variation for the Brownian motion for <span class="math inline">\(V(t)=1\)</span> as expected. We also notice that the formula follows easily from the rules of Ito Calculus, thereby showing the consistency of the theory. Indeed we have:</p>
<p><span class="math display">\[\begin{aligned}
d&lt;X,X&gt;_{t} &amp; =(dX(t))^{2}=(V(t)dB(t)+D(t)dt)^{2}\\
&amp; =V(t)^{2}(dB(t))^{2}+2V(t)D(t)dB(t)\cdot dt+D^{2}(t)(dt)^{2}\\
&amp; =V(t)^{2}dt
\end{aligned}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><em>Proof.</em> The proof is involved, but it reviews some important concepts of stochastic calculus. We prove the case when the process <span class="math inline">\(V\)</span> is in <span class="math inline">\(\mathcal{L}_{c}^{2}(T)\)</span> for some <span class="math inline">\(T&gt;0\)</span>. We write <span class="math inline">\(I(t)=\int_{0}^{t}V(s)dB(s)\)</span> and <span class="math inline">\(R(t)=\int_{0}^{t}D(s)ds\)</span>. We first show that only the Ito integral contributes to the quadratic variation and the Riemann integral does not contribute, so that:</p>
<p><span id="eq-quadratic-variation-ito-process-ii"><span class="math display">\[\begin{aligned}
&lt;X,X&gt;_{t} &amp; =&lt;I,I&gt;_{t}
\end{aligned} \tag{6}\]</span></span></p>
<p>We have that the increment square of <span class="math inline">\(X(t)\)</span> is:</p>
<p><span class="math display">\[\begin{aligned}
(X(t_{j+1})-X(t_{j}))^{2} &amp; =(I(t_{j+1})-I(t_{j}))^{2}+2(I(t_{j+1})-I(t_{j}))(R(t_{j+1})-R(t_{j}))+(R(t_{j+1})-R(t_{j}))^{2}
\end{aligned}\]</span></p>
<p>The Cauchy-Schwarz inequality implies :</p>
<p><span class="math display">\[\begin{aligned}
\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))(R(t_{j+1})-R(t_{j})) &amp; \leq\left(\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}\right)^{1/2}\left(\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2}\right)^{1/2}
\end{aligned}\]</span></p>
<p>Therefore, to prove equation <a href="#eq-quadratic-variation-ito-process" class="quarto-xref">Equation&nbsp;5</a>, it suffices to show that <span class="math inline">\(\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2}\to 0\)</span> almost surely. Since <span class="math inline">\(D(s)\)</span> is an almost surely continuous process, the stochastic process <span class="math inline">\(R(t)=\int_{0}^{t}D(s)ds\)</span> has continuous paths with probability <span class="math inline">\(1\)</span>. Therefore:</p>
<p><span class="math display">\[\begin{aligned}
\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2} &amp; =\max_{1\leq j\leq n}|R(t_{j+1})-R(t_{j})|\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))
\end{aligned}\]</span></p>
<p>Since, <span class="math inline">\(R(t)\)</span> is continuous on the compact set <span class="math inline">\([0,t]\)</span>, it is uniformly continuous a.s. So, as <span class="math inline">\(|t_{j+1}-t_{j}|\to 0\)</span>, by uniform continuity it follows that <span class="math inline">\(\max|R(t_{j+1})-R(t_{j})|\to 0\)</span> a.s.</p>
<p>It remains to prove that <span class="math inline">\(&lt;I,I&gt;_{t}=\int_{0}^{t}V(s)^{2}ds\)</span>. We first prove the case when <span class="math inline">\(V\in\mathcal{S}(T)\)</span> is a simple adapted process. Consider a partition <span class="math inline">\((t_{j}:j\leq n)\)</span> of <span class="math inline">\([0,t]\)</span>. Without loss of generality, we can suppose that <span class="math inline">\(V\)</span> is constant on each <span class="math inline">\([t_{j},t_{j+1})\)</span> by refining the partition. We then have:</p>
<p><span class="math display">\[\begin{aligned}
\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2} &amp; =\sum_{j=0}^{n-1}V(t_{j})^{2}(B(t_{j+1})-B(t_{j}))^{2}
\end{aligned}\]</span></p>
<p>Now, we have seen in the proof of Ito’s formula that <span class="math inline">\(\mathbb{E}\left[\left\{ \sum_{j=0}^{n-1}V(t_{j})^{2}((B(t_{j+1})-B(t_{j}))^{2}-(t_{j+1}-t_{j})\right\} ^{2}\right]\to 0\)</span>, so <span class="math inline">\(\sum_{j=0}^{n-1}V(t_{j})^{2}(B(t_{j+1})-B(t_{j}))^{2}\)</span> approaches <span class="math inline">\(\sum_{j=0}^{n-1}V(t_{j})^{2}(t_{j+1}-t_{j})\)</span> in the mean square sense. As the mesh size becomes finer, the <span class="math inline">\(L^{2}\)</span>-limit is <span class="math inline">\(\int_{0}^{t}V(t)^{2}dt\)</span>.</p>
<p>The case <span class="math inline">\(V\in\mathcal{L}_{c}^{2}(T)\)</span> is proved by approximating <span class="math inline">\(V\)</span> by a simple process in <span class="math inline">\(\mathcal{S}(T)\)</span>. More precisely, we can find a simple process <span class="math inline">\(V^{(\epsilon)}(t)\)</span> that is <span class="math inline">\(\epsilon\)</span>-close to <span class="math inline">\(V\)</span> in the sense:</p>
<p><span id="eq-sequence-of-simple-processes"><span class="math display">\[\begin{aligned}
||I^{(\epsilon)}-I|| &amp; =||\int V^{\epsilon}dB(t)-\int VdB(t)||=\int_{0}^{t}\mathbb{E}[(V^{(\epsilon)}(t)-V(t))^{2}]ds&lt;\epsilon
\end{aligned} \tag{7}\]</span></span></p>
<p>To prove the claim, we need to show that for <span class="math inline">\(t\leq T\)</span>,</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-\int_{0}^{t}(V(s))^{2}ds\right|\right] &amp; \to0\quad\text{as }\quad n\to\infty
\end{aligned}\]</span></p>
<p><span class="math inline">\(L^{1}\)</span>-convergence implies convergence in probability of the sequence <span class="math inline">\(\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}\)</span>. We now introduce the <span class="math inline">\(V^{(\epsilon)}(t)\)</span> approximation inside the absolute value as well as its corresponding integral <span class="math inline">\(I^{(\epsilon)}(t)=\int_{0}^{t}V^{(\epsilon)}(s)ds\)</span>. By the triangle inequality, we have:</p>
<p><span id="eq-quadratic-variation-of-ito-process-i"><span class="math display">\[\begin{aligned}
&amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-\int_{0}^{t}(V(s))^{2}ds\right|\right]\nonumber \\
= &amp; \mathbb{E}\left[\Biggl|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}+(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}-\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds\right.\nonumber \\
&amp; +\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\Biggr]\nonumber \\
\leq &amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}\right|\right]+\mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}-\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds\right|\right]\\
&amp; +\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\right]\nonumber
\end{aligned} \tag{8}\]</span></span></p>
<p>We show that the first and third terms converge uniformly and that the second term goes to <span class="math inline">\(0\)</span> as <span class="math inline">\(n\to\infty\)</span>.</p>
<p>The second term goes to <span class="math inline">\(0\)</span> as <span class="math inline">\(n\to\infty\)</span> by the argument for simple processes.</p>
<p><span class="math inline">\(&lt;I^{(\epsilon)},I^{(\epsilon)}&gt;_{t}=\int_{0}^{t}V^{(\epsilon)}(s)^{2}ds\)</span>.</p>
<p>For the third term, the linearity of the integral and the Cauchy Schwarz inequality (applied to <span class="math inline">\(\mathbb{E}\int_{0}^{t}\)</span>) imply that it is:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\right] &amp; \leq\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s)-V(s))^{2}ds\Biggr|\right]^{1/2}\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s)+V(s))^{2}ds\Biggr|\right]^{1/2}
\end{aligned}\]</span></p>
<p>The first factor is smaller than the square root of <span class="math inline">\(\epsilon\)</span> by <a href="#eq-sequence-of-simple-processes" class="quarto-xref">Equation&nbsp;7</a>, whereas the second factor is bounded.</p>
<p>The first term in equation <a href="#eq-quadratic-variation-of-ito-process-i" class="quarto-xref">Equation&nbsp;8</a> is handled similarly. The linearity of the Ito integral and the Cauchy-Schwarz inequality applied to <span class="math inline">\(\mathbb{E}\left[\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}\cdot\right)\right]\)</span> give that the first term is:</p>
<p><span class="math display">\[\begin{aligned}
&amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}(V(s))^{2}dB(s)-\int_{t_{j}}^{t_{j+1}}(V^{\epsilon}(s))^{2}dB(s)\right|\right]\\
= &amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\int_{t_{j}}^{t_{j+1}}(V(s)+V^{\epsilon}(s))dB(s)\right|\right]\\
\leq &amp; \mathbb{E}\left[\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\right]^{1/2}\mathbb{E}\left[\Biggl|\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)+V^{\epsilon}(s))dB(s)\right)^{2}\Biggr|\right]^{1/2}
\end{aligned}\]</span></p>
<p>By Ito isometry, the first factor in the above expression can be simplified:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\right]^{1/2} &amp; =\sum_{j=0}^{n-1}\mathbb{E}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\\
&amp; =\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}\mathbb{E}[(V(s)-V^{\epsilon}(s))^{2}]ds
\end{aligned}\]</span></p>
<p>By <a href="#eq-sequence-of-simple-processes" class="quarto-xref">Equation&nbsp;7</a>, this factor is smaller than <span class="math inline">\(\epsilon\)</span>. The second factor equals <span class="math inline">\(\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}\mathbb{E}[(V(s)+V^{\epsilon}(s))^{2}]ds\)</span> by Ito-isometry and is uniformly bounded. This concludes the proof of the proposition. <span class="math inline">\(\blacksquare\)</span></p>
</div>
<p>Note that quadratic variation <span class="math inline">\(&lt;I,I&gt;_{t}=\int(V(s))^{2}ds\)</span> is computed path-by-path and hence the result is random. On the other the variance of the Ito integral <span class="math inline">\(Var(I(t))=\mathbb{E}[I_{t}^{2}]=\int\mathbb{E}[V_{s}^{2}]ds\)</span> is the mean value of all possible paths of the quadratic variation and hence is non-random. We are now ready to state Ito’s formula for Ito processes. We write the result in differential form for conciseness.</p>
<div id="thm-ito-formula-for-ito-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Ito’s formula for Ito processes)</strong></span> Let <span class="math inline">\((B(t):t\geq0)\)</span> be a standard brownian motion, and let <span class="math inline">\((X(t):t\geq0)\)</span> be an Ito process of the form <span class="math inline">\(dX(t)=V(t)dB(t)+D(t)dt\)</span>. Consider a function <span class="math inline">\(f(t,x)\in\mathcal{C}^{1,2}([0,T]\times\mathbf{R})\)</span>. Then we have with probability one for all <span class="math inline">\(t\leq T\)</span>:*</p>
<p><em><span class="math display">\[\begin{aligned}
df(t,X(t)) &amp; =\partial_{x}f(t,X(t))dX(t)+\partial_{t}f(t,X(t))dt+\frac{1}{2}\partial_{xx}f(t,X(t))d&lt;X,X&gt;_{t}
\end{aligned}\]</span></em></p>
<p><em>This can also be written as:</em></p>
<p><em><span class="math display">\[\begin{aligned}
df(t,X(t))= &amp; \partial_{x}f(t,X(t))V(t)dB(t)+\left[\partial_{x}f(t,X(t))D(t)+\partial_{t}f(t,X(t))+\frac{1}{2}(V(t))^{2}\partial_{xx}f(t,X(t))\right]dt
\end{aligned}\]</span></em></p>
</div>
<p>The proof of the <a href="#thm-ito-formula-for-ito-processes" class="quarto-xref">Theorem&nbsp;1</a> is again a Taylor approximation with the form of the quadratic variation of the process. We will omit it.</p>
<div id="exm-ornstein-uhlenbeck-process" class="theorem example">
<p><span class="theorem-title"><strong>Example 5</strong></span> (Ornstein-Uhlenbeck Process). Consider the Ornstein-Uhlenbeck process <span class="math inline">\((Y(t):t\geq0)\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
Y(t) &amp; =Y(0)e^{-t}+e^{-t}\int_{0}^{t}e^{s}dB(s)
\end{aligned}\]</span></p>
<p>Note that this process is an explicit function of <span class="math inline">\(t\)</span> and of the Ito process <span class="math inline">\(X(t)=Y(0)+\int_{0}^{t}e^{s}dB(s)\)</span>. Indeed, we have:</p>
<p><span class="math display">\[\begin{aligned}
Y(t) &amp; =e^{-t}X(t)
\end{aligned}\]</span></p>
<p>Let <span class="math inline">\(f(t,x)=e^{-t}x\)</span>. Then, <span class="math inline">\(f_{x}(t,x)=e^{-t}\)</span>, <span class="math inline">\(f_{xx}(t,x)=0\)</span> and <span class="math inline">\(f_{t}(t,x)=-e^{-t}x\)</span>. So, by Ito’s lemma,</p>
<p><span id="eq-ornstein-uhlenbeck-sde"><span class="math display">\[\begin{aligned}
df(t,x) &amp; =f_{t}(t,X(t))dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\nonumber \\
dY(t) &amp; =-Y(t)dt+e^{-t}dX(t)\nonumber \\
dY(t) &amp; =-Y(t)dt+e^{-t}(e^{t}dB(t))\nonumber \\
dY(t) &amp; =-Y(t)dt+dB(t)
\end{aligned} \tag{9}\]</span></span></p>
<p>This is the SDE for the Ornstein Uhlenbeck process.</p>
<p>The SDE has a very nice interpretation: The drift is positive if <span class="math inline">\(Y(t)&lt;0\)</span> and negative if <span class="math inline">\(Y(t)&gt;0\)</span>. Moreover, the drift is proportional to the position (exactly like a spring pulling the process back to the <span class="math inline">\(x\)</span>-axis following the Hooke’s law!). This is the mechanism that ensures that the process does not venture too far from <span class="math inline">\(0\)</span> and is eventually stationary.</p>
<p>The SDE <a href="#eq-ornstein-uhlenbeck-sde" class="quarto-xref">Equation&nbsp;9</a> is now easily generalized by adding two parameters for the volatility and the drift:</p>
<p><span id="eq-ornstein-uhlenbeck-sde-ii"><span class="math display">\[\begin{aligned}
dY(t) &amp; =-kY(t)dt+\sigma dB(t),\quad k\in\mathbf{R},\sigma&gt;0
\end{aligned} \tag{10}\]</span></span></p>
<p>It is not hard to check that the solution to the SDE is:</p>
<p><span id="eq-solution-to-the-ornstein-uhlenbeck-sde"><span class="math display">\[\begin{aligned}
Y(t) &amp; =Y(0)e^{-kt}+e^{-kt}\int_{0}^{t}e^{ks}\sigma dB(s)
\end{aligned} \tag{11}\]</span></span></p>
</div>
<div id="exr-the-ornstein-uhlenbeck-process-with-parameters" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> The Ornstein-Uhlenbeck process with parameters. Use the Ito’s formula to show that the <a href="#eq-solution-to-the-ornstein-uhlenbeck-sde" class="quarto-xref">Equation&nbsp;11</a> is the solution to the Ornstein-Uhlenbeck SDE <a href="#eq-ornstein-uhlenbeck-sde-ii" class="quarto-xref">Equation&nbsp;10</a>.</p>
</div>
<p><em>Solution.</em></p>
<p>Let <span class="math inline">\(X(t)=Y(0)+\int_{0}^{t}e^{ks}\sigma dB(s)\)</span>, so <span class="math inline">\(dX(t)=e^{kt}\sigma dB(t)\)</span>. Then, <span class="math inline">\(Y(t)=e^{-kt}X(t)\)</span>. Let <span class="math inline">\(f(t,x)=e^{-kt}x\)</span>. Then, by Ito’s formula:</p>
<p><span class="math display">\[\begin{aligned}
df(t,x) &amp; =-ke^{-kt}X(t)dt+e^{-kt}dX(t)\\
dY(t) &amp; =-kY(t)dt+e^{-kt}e^{kt}\sigma dB(t)\\
dY(t) &amp; =-kY(t)dt+\sigma dB(t)
\end{aligned}\]</span></p>
<p>The latest version of Ito’s formula is another useful tool for producing martingales from a function of an Ito process. We start with two examples generalizing martingales for Brownian motion.</p>
<div id="exm-generalization-of-bt2-t" class="theorem example">
<p><span class="theorem-title"><strong>Example 6</strong></span> (A generalization of <span class="math inline">\((B(t))^{2}-t\)</span>). Let <span class="math inline">\((V(t):t\leq T)\)</span> be a process in <span class="math inline">\(\mathcal{L}_{c}^{2}(T)\)</span>. Consider an Ito process <span class="math inline">\((X(t):t\leq T)\)</span> given by <span class="math inline">\(dX(t)=V(t)dB(t)\)</span>. Note that <span class="math inline">\(((X(t))^{2}:t\leq T)\)</span> is a submartingale by Jensen’s inequality, since <span class="math inline">\(\mathbb{E}[X^{2}(t)|\mathcal{F}_{s}]\geq(\mathbb{E}[X(t)|\mathcal{F}_{s})^{2}=X^{2}(s)\)</span>. We show that the compensated process</p>
<p><span class="math display">\[\begin{aligned}
M(t) &amp; =X^{2}(t)-\int_{0}^{t}V^{2}(s)ds,\quad t\leq T
\end{aligned}\]</span></p>
<p>is a martingale for the Brownian filtration. (This is another instance of the Doob-Meyer decomposition). By the Ito’s formula for <span class="math inline">\(f(x)=x^{2}\)</span>, we have:</p>
<p><span class="math display">\[\begin{aligned}
df(x) &amp; =f_{x}(X(t)dX(t)+\frac{1}{2}f_{xx}(X(t))d&lt;X,X&gt;_{t}\\
&amp; =2X(t)dX(t)+(V(t))^{2}dt\\
df(X(t)) &amp; =2X(t)V(t)dB(t)+(V(t))^{2}dt
\end{aligned}\]</span></p>
<p>In Integral form this implies:</p>
<p><span class="math display">\[\begin{aligned}
(X(t))^{2} &amp; =(X(0))^{2}+2\int_{0}^{t}X(s)V(s)dB(s)+\int_{0}^{t}(V(s))^{2}ds\\
M(t)=(X(t))^{2}-\int_{0}^{t}(V(s))^{2}ds &amp; =(X(0))^{2}+2\int_{0}^{t}X(s)V(s)dB(s)
\end{aligned}\]</span></p>
<p>We conclude that <span class="math inline">\((M(t):t\leq T)\)</span> is a martingale, provided <span class="math inline">\(X(t)V(t)\in L_{c}^{2}(T)\)</span>.</p>
<p>There is another more direct way to prove that <span class="math inline">\((M(t):t\leq T)\)</span> is a martingale whenever <span class="math inline">\((V(t):t\leq T)\in\mathcal{L}_{c}^{2}(T)\)</span>. This is by using increments: for <span class="math inline">\(t'&lt;t\leq T\)</span>,</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[X_{t'}^{2}|\mathcal{F}_{t}] &amp; =\mathbb{E}[(X_{t}+(X_{t'}-X_{t}))^{2}|\mathcal{F}_{t}]\\
&amp; =\mathbb{E}[X_{t}^{2}+2X_{t}(X_{t'}-X_{t})+(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}]\\
&amp; =X_{t}^{2}+2X_{t}\mathbb{E}[X_{t'}-X_{t}|\mathcal{F}_{t}]+\mathbb{E}[(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}]
\end{aligned}\]</span></p>
<p>Since <span class="math inline">\((X_{t}:t\geq0)\)</span> is a martingale, <span class="math inline">\(\mathbb{E}[(X_{t'}-X_{t})|M_{t}]=0\)</span>, so the middle term equals zero and we are left with:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[X_{t'}^{2}|\mathcal{F}_{t}] &amp; =X_{t}^{2}+\mathbb{E}[(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}]
\end{aligned}\]</span></p>
<p>By conditional Ito Isometry,</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}] &amp; =\int_{0}^{t'}V_{s}^{2}ds-\int_{0}^{t}V_{s}^{2}ds=\int_{t}^{t'}V_{s}^{2}ds
\end{aligned}\]</span></p>
</div>
<div id="exm-generalization-of-gbm" class="theorem example">
<p><span class="theorem-title"><strong>Example 7</strong></span> (A generalization of the geometric Brownian motion). Let <span class="math inline">\(\sigma(t)\)</span> be a continuous, deterministic function such that <span class="math inline">\(|\sigma(t)|\leq1\)</span>, <span class="math inline">\(t\in[0,T]\)</span>. The process</p>
<p><span class="math display">\[\begin{aligned}
M(t) &amp; =\exp\left(\int_{0}^{t}\sigma(s)dB(s)-\frac{1}{2}\int_{0}^{t}\sigma^{2}(s)ds\right),\quad t\leq T
\end{aligned}\]</span></p>
<p>is a martingale for the Brownian filtration. To see this, note that we can write <span class="math inline">\(M(t)=f(t,X(t))\)</span> where <span class="math inline">\(f(t,x)=\exp(x-\frac{1}{2}\int\sigma^{2}(s)ds)\)</span> and <span class="math inline">\(X(t)=\int_{0}^{t}\sigma(s)dB(s)\)</span>, so <span class="math inline">\(dX(t)=\sigma(t)dB(t)\)</span>. Ito’s formula gives:</p>
<p><span class="math display">\[\begin{aligned}
df(t,x) &amp; =f_{t}(t,X(t)dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\\
dM(t) &amp; =-\frac{1}{2}\sigma^{2}(t)M(t)dt+M(t)\sigma(t)dB(t)+\frac{1}{2}M(t)\sigma^{2}(t)dt\\
&amp; =M(t)\sigma(t)dB(t)\\
M(t) &amp; =M(0)+\int_{0}^{t}M(s)\sigma(s)dB(s)
\end{aligned}\]</span></p>
<p>Observe also that:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[M_{t}^{2}] &amp; =e^{-\int_{0}^{t}\sigma^{2}(s)ds}\mathbb{E}[e^{2\int_{0}^{t}\sigma(s)dB(s)}]=e^{\int_{0}^{t}\sigma^{2}(s)ds}
\end{aligned}\]</span></p>
<p>since <span class="math inline">\(\int_{0}^{t}\sigma(s)dB(s)\)</span> is a Gaussian random variable with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\int_{0}^{t}\sigma^{2}(s)ds\)</span>.</p>
<p>We conclude from the equation that <span class="math inline">\((M(t),t\geq0)\)</span> is a martingale.</p>
</div>
<div id="exm-martingales-of-gbm" class="theorem example">
<p><span class="theorem-title"><strong>Example 8</strong></span> (Martingales of Geometric Brownian Motion). Let</p>
<p><span class="math display">\[\begin{aligned}
S(t) &amp; =S(0)\exp(\sigma B(t)-\sigma^{2}t/2)
\end{aligned}\]</span></p>
<p>be a geometric brownian motion. We find a PDE satisfied by <span class="math inline">\(f(t,x)\)</span> for <span class="math inline">\(f(t,S(t))\)</span> to be a martingale. It suffices to apply Ito’s formula of <a href="#thm-ito-formula-for-ito-processes" class="quarto-xref">Theorem&nbsp;1</a>. We get:</p>
<p><span class="math display">\[\begin{aligned}
df(t,S(t)) &amp; =f_{t}(t,S(t))dt+f_{x}(t,S(t))dS(t)+\frac{1}{2}f_{xx}(t,S(t))dS(t)\cdot dS(t)
\end{aligned}\]</span></p>
<p>Now note from the earlier result that <span class="math inline">\(dS(t)=S(t)\sigma dB(t)\)</span>. So, <span class="math inline">\(dS(t)\cdot dS(t)=\frac{1}{2}\sigma^{2}(S(t))^{2}dt\)</span>. So,</p>
<p><span class="math display">\[\begin{aligned}
df(t,S(t)) &amp; =\left\{ \frac{\partial f}{\partial t}+\frac{1}{2}\sigma^{2}(S(t))^{2}\frac{\partial^{2}f}{\partial x^{2}}\right\} dt+\sigma S(t)\frac{\partial f}{\partial x}dB(t)
\end{aligned}\]</span></p>
<p>Finally, the PDE for <span class="math inline">\(f(t,x)\)</span> is obtained by setting the factor in front of <span class="math inline">\(dt\)</span> to <span class="math inline">\(0\)</span>, because we want <span class="math inline">\(f\)</span> to be a martingale process. It is important to keep in mind, that the PDE should always be written in terms of the time variable <span class="math inline">\(t\)</span> and the space variable <span class="math inline">\(x\)</span>. Therefore, the PDE of <span class="math inline">\(f\)</span> as a function of time and space is:</p>
<p><span class="math display">\[\begin{aligned}
\frac{1}{2}\sigma^{2}x^{2}\frac{\partial^{2}f}{\partial x^{2}}(t,x)+\frac{\partial f}{\partial t}(t,x) &amp; =0
\end{aligned}\]</span></p>
<p>No more randomness appears in the PDE!</p>
</div>
<p>Here is a specific case where we can apply the Ito’s formula to construct martingales of Ito processes.</p>
<div id="exm-martingale-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 9</strong></span> Consider the process given by the SDE:</p>
<p><span class="math display">\[\begin{aligned}
dX(t) &amp; =X(t)dB(t),\quad X(0)=2
\end{aligned}\]</span></p>
<p>Let’s find a PDE for which <span class="math inline">\(f(t,X(t))\)</span> is a martingale for the Brownian filtration. We have by Ito’s formula that:</p>
<p><span class="math display">\[\begin{aligned}
df(t,X(t)) &amp; =f_{t}(t,X(t))dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\\
&amp; =\left(\frac{\partial f}{\partial t}+\frac{1}{2}(X(t))^{2}\frac{\partial^{2}f}{\partial x^{2}}\right)dt+X(t)\frac{\partial f}{\partial x}dB(t)
\end{aligned}\]</span></p>
<p>Setting the drift term to <span class="math inline">\(0\)</span> gives the PDE:</p>
<p><span class="math display">\[\begin{aligned}
\frac{\partial f}{\partial t}+\frac{1}{2}x^{2}\frac{\partial^{2}f}{\partial x^{2}} &amp; =0
\end{aligned}\]</span></p>
<p>It is then easy to check that <span class="math inline">\(X(t)\)</span> is a martingale and so is <span class="math inline">\(t+\log(X(t))^{2}\)</span>, since the functions <span class="math inline">\(f(t,x)=x\)</span> and <span class="math inline">\(f(t,x)=t+\log x^{2}\)</span> satisfy the PDE. However, the process <span class="math inline">\(tX(t)\)</span> is not, as the function <span class="math inline">\(f(t,x)=xt\)</span> is not a solution of the PDE.</p>
</div>
</section>
<section id="multivariate-extension." class="level2">
<h2 class="anchored" data-anchor-id="multivariate-extension.">Multivariate Extension.</h2>
<p>Ito’s formula can be generalized to several Ito processes. Let’s start by stating an example of a function of two Ito processes. Such a function <span class="math inline">\(f(x_{1},x_{2})\)</span> will be a function of two space variables. Not surprisingly, it needs to have two derivatives in each variable and they need to be a continuous function; we need <span class="math inline">\(f\in\mathcal{C}^{2\times2}(\mathbf{R}\times\mathbf{R})\)</span>.</p>
<div id="thm-ito-formula-for-many-ito-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Ito’s formula for many Ito processes)</strong></span> Let <span class="math inline">\((X(t):t\geq0)\)</span> and (Y(t):t)$ be two Ito processes of the form:</p>
<p><span id="eq-two-ito-processes"><span class="math display">\[\begin{aligned}
dX(t) &amp; =V(t)dB(t)+D(t)dt\nonumber \\
dY(t) &amp; =U(t)dB(t)+R(t)dt
\end{aligned} \tag{12}\]</span></span></p>
<p>where <span class="math inline">\((B(t):t\geq0)\)</span> is a standard Brownian motion. Then, for <span class="math inline">\(f\in\mathcal{C}^{2\times2}(\mathbf{R}\times\mathbf{R})\)</span>, we have:</p>
<p><span class="math display">\[\begin{aligned}
df(X(t),Y(t)) &amp; =f_{x}(X(t),Y(t))dX(t)+f_{y}(X(t),Y(t))dY(t)+\frac{1}{2}f_{xx}(X(t),Y(t))d&lt;X,X&gt;_{t}\\
&amp; +f_{xy}(X(t),Y(t))d&lt;X,Y&gt;_{t}+\frac{1}{2}f_{yy}(X(t),Y(t))d&lt;Y,Y&gt;_{t}
\end{aligned}\]</span></p>
</div>
<p>The idea of the proof is the same as in <a href="#thm-ito-formula-for-ito-processes" class="quarto-xref">Theorem&nbsp;1</a> : Taylor’s expansion and quadratic variation, together with the cross-variation of two processes.</p>
<p><span class="math display">\[\begin{aligned}
dX(t)\cdot dY(t) &amp; =(V(t)dB(t)+D(t)dt)(U(t)dB(t)+R(t)dt)\\
&amp; =U(t)V(t)dt
\end{aligned}\]</span></p>
<div id="exm-product-rule" class="theorem example">
<p><span class="theorem-title"><strong>Example 10</strong></span> (Product Rule) An important example of this formula is Ito’s product rule. Let <span class="math inline">\(X(t)\)</span> and <span class="math inline">\(Y(t)\)</span> be as in <a href="#eq-two-ito-processes" class="quarto-xref">Equation&nbsp;12</a>. Then:</p>
<p><span class="math display">\[\begin{aligned}
d(X(t)Y(t)) &amp; =Y(t)dX(t)+X(t)dY(t)+dX(t)\cdot dY(t)
\end{aligned}\]</span></p>
</div>
<div id="exr-a-riemann-integral" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> Let <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> be a probability space and let <span class="math inline">\((B_{t}:t\geq0)\)</span> be a standard brownian motion. Using integration by parts, show that</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}B(s)ds &amp; =\int_{0}^{t}(t-s)dB(s)
\end{aligned}\]</span></p>
<p>and prove that <span class="math inline">\(\int_{0}^{t}B(s)ds\sim\mathcal{N}(0,t^{3}/3)\)</span>.</p>
<p>Is</p>
<p><span class="math display">\[\begin{aligned}
X(t) &amp; =\begin{cases}
0 &amp; t=0\\
\frac{\sqrt{3}}{t}\int_{0}^{t}B(s)ds &amp; t&gt;0
\end{cases}
\end{aligned}\]</span></p>
<p>a standard Wiener process?</p>
<p><em>Solution.</em></p>
<p>Clearly, <span class="math inline">\(B(s,\omega)\)</span> is a random variable and the Riemann integral <span class="math inline">\(\int_0^t B(s,\omega)ds\)</span> depends on the sample path <span class="math inline">\(\omega\)</span>. So, <span class="math inline">\((\int_0^t B_s ds, t\leq T)\)</span> is a stochastic process. Using integration by parts:</p>
<p><span class="math display">\[\begin{aligned}
\int u\left(\frac{dv}{ds}\right)ds &amp; =uv-\int v\left(\frac{du}{ds}\right)ds
\end{aligned}\]</span></p>
<p>We set <span class="math inline">\(u=B(s)\)</span> and <span class="math inline">\(dv/ds=1\)</span>. Then:</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}B(s)ds &amp; =sB(s)|_{0}^{t}-\int_{0}^{t}sdB(s)\\
&amp; =tB(t)-\int_{0}^{t}sdB(s)\\
&amp; =\int_{s=0}^{s=t}tdB(s)-\int_{0}^{t}sdB(s)\\
&amp; =\int_{0}^{t}(t-s)dB(s)
\end{aligned}\]</span></p>
<p>Thus, <span class="math inline">\(\int_{0}^{t}B(s)ds\)</span> is a Gaussian random variable with:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\int_{0}^{t}B(s)ds\right] &amp; =\mathbb{E}\left[\int_{0}^{t}(t-s)dB(s)\right]\\
&amp; =0
\end{aligned}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\left(\int_{0}^{t}B(s)ds\right)^{2}\right] &amp; =\int_{0}^{t}(t-s)^{2}ds\\
&amp; =\left.\frac{(t-s)^{3}}{-3}\right|_{0}^{t}\\
&amp; =\frac{t^{3}}{3}
\end{aligned}\]</span></p>
<p>Thus, using the properties of Ito Integral, <span class="math inline">\(\int_{0}^{t}B(s)ds=\int_{0}^{t}(t-s)dB(s)\)</span> is a martingale. Now the quadratic variation <span class="math inline">\(&lt;M,M&gt;_{t}=0\)</span>, and this can be a bit tricky. Remember, <span class="math inline">\(\left\langle \int_{0}^{t}f(s,B_{s})dB(s),\int_{0}^{t}f(s,B_{s})dB(s)\right\rangle =\int_{0}^{t}f^{2}(s,B_{s})ds\)</span> if and only if <span class="math inline">\(f\)</span> is a function of the time <span class="math inline">\(s\)</span> and the position of the Brownian motion <span class="math inline">\(B(s)\)</span>. Since, <span class="math inline">\(f\)</span> is a function of <span class="math inline">\(t\)</span> as well, this rule cannot be applied.</p>
<p>By first principles, we can show that, the quadratic variation is indeed <span class="math inline">\(0\)</span>: <span class="math display">\[\begin{aligned}
\lim_{n\to\infty}\mathbb{E}\left[\sum_{j=0}^{n-1}\left(I(t_{j+1})-I(t_{j})\right)^{2}\right] &amp; =\lim_{n\to\infty}\mathbb{E}\left[\sum_{j=0}^{n-1}B_{t_{j}}^{2}(t_{j+1}-t_{j})^{2}\right]\\
&amp; =\lim_{n\to\infty}\max_{1\leq j\leq n}|t_{j+1}-t_{j}|\cdot\mathbb{E}\left[\sum_{j=0}^{n-1}B_{t_{j}}^{2}(t_{j+1}-t_{j})\right]
\end{aligned}\]</span></p>
<p>Since the paths of <span class="math inline">\(B_{t}\)</span> are continuous, so are the paths <span class="math inline">\(B_{t}^{2}\)</span> on the compact interval <span class="math inline">\([0,t]\)</span>. So, <span class="math inline">\((B_{s}^{2},s\in[0,t])\)</span> is uniformly bounded. Thus, the expectation term is bounded. As <span class="math inline">\(n\to\infty\)</span>, the mesh size approaches zero, and consequently the quadratic variation approaches zero.</p>
</div>
<div id="exm-something-that-is-not-a-martingale" class="theorem example">
<p><span class="theorem-title"><strong>Example 11</strong></span> Let <span class="math inline">\(X_{t}=\int_{0}^{t}B_{s}dB_{s}\)</span> and <span class="math inline">\(Y_{t}=\int_{0}^{t}B_{s}^{2}dB_{s}\)</span>. Is <span class="math inline">\((X_{t}Y_{t},t\geq0)\)</span> a martingale?</p>
</div>
<p><em>Solution.</em></p>
<p>By Ito’s product rule, we have:</p>
<p><span class="math display">\[\begin{aligned}
d(X_{t}Y_{t}) &amp; =X_{t}dY_{t}+Y_{t}dX_{t}+dX_{t}\cdot dY_{t}\\
&amp; =X_{t}B_{s}^{2}dB_{s}+Y_{t}B_{s}dB_{s}+(B_{s}dB_{s})\cdot(B_{s}^{2}dB_{s})\\
&amp; =X_{t}B_{s}^{2}dB_{s}+Y_{t}B_{s}dB_{s}+B_{s}^{3}dt\\
X_{t}Y_{t} &amp; =X_{0}Y_{0}+\int_{0}^{t}X_{t}B_{s}^{2}dB_{s}+\int_{0}^{t}Y_{t}B_{s}dB_{s}+\int_{0}^{t}B_{s}^{3}dt
\end{aligned}\]</span></p>
<p>The term in <span class="math inline">\(dt\)</span> is not zero, so the product cannot be a martingale.</p>
<div id="exm-generalization-of-gbm-ii" class="theorem example">
<p><span class="theorem-title"><strong>Example 12</strong></span> (A generalization of Geometric Brownian Motion). Consider <span class="math inline">\((\int_{0}^{t}V_{s}dB_{s},t\geq0)\)</span> an Ito process. Define the positive process:</p>
<p><span id="eq-generalization-of-gbm"><span class="math display">\[\begin{aligned}
M_{t} &amp; =\exp\left(\int_{0}^{t}V_{s}dB_{s}-\frac{1}{2}\int_{0}^{t}V_{s}^{2}ds\right),\quad t\geq0
\end{aligned} \tag{13}\]</span></span></p>
</div>
<p><em>Solution.</em></p>
<p>Ito’s formula applied to the processes <span class="math inline">\(X_{t}=\int_{0}^{t}V_{s}dB_{s}\)</span> and <span class="math inline">\(Y_{t}=\frac{1}{2}\int_{0}^{t}V_{s}^{2}ds\)</span> with the function <span class="math inline">\(f(x,y)=e^{x-y}\)</span> yields:</p>
<p><span class="math display">\[\begin{aligned}
df(x,y) &amp; =f_{x}(X_{t},Y_{t})dX_{t}+f_{y}(X_{t},Y_{t})dY_{t}\\
&amp; +\frac{1}{2}f_{xx}(X_{t},Y_{t})dX_{t}\cdot dX_{t}+\frac{1}{2}f_{yy}(X_{t},Y_{t})dY_{t}\cdot dY_{t}\\
&amp; +f_{xy}(X_{t},Y_{t})dX_{t}\cdot dY_{t}
\end{aligned}\]</span></p>
<p>Now, all first and second order derivatives are <span class="math inline">\(\partial_{x}(e^{x-y})=M_{t}\)</span>, <span class="math inline">\(\partial_{y}(e^{x-y})=-e^{x-y}=-M_{t}\)</span>, <span class="math inline">\(\partial_{xx}(e^{x-y})=M_{t}\)</span></p>
<p><span class="math inline">\(dX_{t}=V_{t}dB_{t}\)</span>. <span class="math inline">\(dY_{t}=\frac{1}{2}V_{t}^{2}dt\)</span>.</p>
<p><span class="math inline">\(dX_{t}\cdot dX_{t}=V_{t}^{2}dt\)</span>, <span class="math inline">\(dX_{t}\cdot dY_{t}=0\)</span>,</p>
<p><span class="math inline">\(dY_{t}\cdot dY_{t}=0\)</span>.</p>
<p>Consequently, we have:</p>
<p><span class="math display">\[\begin{aligned}
dM_{t} &amp; =M_{t}V_{t}dB_{t}-\frac{1}{2}M_{t}V_{t}^{2}dt\\
&amp; +\frac{1}{2}M_{t}V_{t}^{2}dt\\
&amp; =M_{t}V_{t}dB_{t}
\end{aligned}\]</span></p>
<p>Thus, <span class="math inline">\((M_{t},t\geq0)\)</span> is a martingale.</p>
<div id="exr-generalized-ito-integral" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> (Generalized Ito Integral). Let <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> be a probability space and let <span class="math inline">\((B_{t}:t\geq0)\)</span> be a standard brownian motion. Given that <span class="math inline">\(f\)</span> is a simple process, show that:</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}f(s,B_{s})dB_{s} &amp; =B_{t}f(t,B_{t})-\int_{0}^{t}\left[B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}B_{s}\frac{\partial^{2}f}{\partial x^{2}}\right]ds\\
&amp; -\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}f(s,B_{s})ds &amp; =tf(t,B_{t})-\int_{0}^{t}s\left[\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right]ds-\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
</div>
<p><em>Solution.</em></p>
<p>I suppress <span class="math inline">\((t,B_{t})\)</span> for simplicity. Applying the product rule to <span class="math inline">\(B_{t}f\)</span>, we get:</p>
<p><span class="math display">\[\begin{aligned}
d(B_{t}f) &amp; =fdB_{t}+B_{t}df+dB_{t}\cdot df\\
&amp; =fdB_{t}+B_{t}\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; +dB_{t}\cdot\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; =fdB_{t}+\left(B_{t}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}B_{t}\right)dt+B_{t}\frac{\partial f}{\partial x}dB_{t}\\
B_{t}f &amp; =\int_{0}^{t}fdB_{s}+\int_{0}^{t}\left(B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}B_{s}\right)ds+\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}\\
\int_{0}^{t}fdB_{s} &amp; =B_{t}f-\int_{0}^{t}\left(B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}B_{s}\right)ds-\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
<p>Applying product rule to <span class="math inline">\(tf(t,B_{t})\)</span>, we get:</p>
<p><span class="math display">\[\begin{aligned}
d(tf) &amp; =fdt+tdf+dt\cdot df\\
&amp; =fdt+t\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; +dt\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; =fdt+t\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)dt+t\frac{\partial f}{\partial x}dB_{t}\\
tf &amp; =\int_{0}^{t}fds+\int_{0}^{t}s\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)ds+\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}\\
\int_{0}^{t}fds &amp; =tf-\int_{0}^{t}s\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)ds-\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
<p>The following example will be important when we discuss the Girsanov theorem.</p>
<div id="thm-ito-formula-for-many-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Ito’s formula for many Ito processes)</strong></span> Let <span class="math inline">\(X_t = (X_t^{(j)},j\leq d,j\in\mathbf{N})\)</span> be Ito processes constructed on <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> and <span class="math inline">\(f \in C^{1,2}([0,T]\times \mathbb{R}^d)\)</span>. Then for <span class="math inline">\(t \in [0,T]\)</span>, we have:</p>
<p><span class="math display">\[
df(t,X_t) = \partial_t f(t,X_t) dt + \sum_{j=1}^{d} \partial_{x_j} f(t,X_t) dX_t^{(j)} + \frac{1}{2}\sum_{j=1}^{d} \sum_{k=1}^d \partial_{x_j x_k}^2 f(t,X_t) dX_t^{(j)}\cdot dX_t^{(k)}
\]</span></p>
</div>
</section>
<section id="numerical-simulation-of-sdes" class="level2">
<h2 class="anchored" data-anchor-id="numerical-simulation-of-sdes">Numerical Simulation of SDEs</h2>
<p>The good news is that it is not too hard to implement iterative schemes to sample paths of a diffusion. Consider <span class="math inline">\((X_t,t\leq T)\)</span> a solution to the SDE:</p>
<p><span class="math display">\[
dX_t = \sigma(X_t) dB_t + \mu(X_t) dt
\]</span></p>
<p>To keep the notation to a minimum, we consider a time-homogeonous diffusion. For a partition <span class="math inline">\((t_j,j\leq n)\)</span> of <span class="math inline">\([0,T]\)</span> with <span class="math inline">\(t_n = T\)</span>, consider the increment</p>
<p><span id="eq-increment-of-a-diffusion"><span class="math display">\[
X_{t_{j+1}} - X_{t_j} = \int_{t_j}^{t_{j+1}} \sigma(X_s) dB(s) + \int_{t_j}^{t_{j+1}} \mu(X_s) ds
\tag{14}\]</span></span></p>
<p>Note that, if <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\mu\)</span> are smooth functions, we can apply Ito’s formula to <span class="math inline">\(\sigma(X_s)\)</span> and <span class="math inline">\(\mu(X_s)\)</span> for <span class="math inline">\(s\in (t_j,t_{j+1}]\)</span>! We get:</p>
<p><span id="eq-ito-taylor-expansion-of-mu-and-sigma"><span class="math display">\[
\begin{align*}
\sigma(X_s) &amp;= \sigma(X_{t_j}) + \int_{t_j}^{s}\sigma'(X_u) dX_u + \frac{1}{2}\int_{t_j}^{s} \sigma''(X_u)(dX_u)^2\\
\mu(X_s) &amp;= \mu(X_{t_j}) + \int_{t_j}^{s}\mu'(X_u) dX_u + \frac{1}{2}\int_{t_j}^{s} \mu''(X_u)(dX_u)^2
\end{align*}
\tag{15}\]</span></span></p>
<p>Now, we can approximate the increment in <a href="#eq-increment-of-a-diffusion" class="quarto-xref">Equation&nbsp;14</a> at different levels of precision by considering a different estimate for <a href="#eq-ito-taylor-expansion-of-mu-and-sigma" class="quarto-xref">Equation&nbsp;15</a>.</p>
<div id="exm-euler-maruyama-scheme" class="theorem example">
<p><span class="theorem-title"><strong>Example 13</strong></span> (Euler-Maruyama Scheme). This scheme consists of taking <span class="math inline">\(\sigma(X_s) \approx \sigma(X_{t_j})\)</span> and <span class="math inline">\(\mu(X_s) \approx \mu(X_{t_j})\)</span> for <span class="math inline">\(s \in [t_j,t_{j+1})\)</span> in <a href="#eq-ito-taylor-expansion-of-mu-and-sigma" class="quarto-xref">Equation&nbsp;15</a>. Putting this back in <a href="#eq-increment-of-a-diffusion" class="quarto-xref">Equation&nbsp;14</a>, we get:</p>
<p><span id="eq-euler-maruyama"><span class="math display">\[
X_{t_{j+1}} - X_{t_j} \approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j)
\tag{16}\]</span></span></p>
<p>The process <span class="math inline">\(X_t\)</span> can then be constructed recursively on the discrete set <span class="math inline">\((t_j,j \leq n)\)</span> as follows:</p>
<p><span class="math display">\[
\begin{align*}
X_0 &amp;= x\\
X_{t_1} &amp;= (X_{t_1} - X_0) + X_0\\
X_{t_2} &amp;= (X_{t_2} - X_{t_1}) + (X_{t_1} - X_0) + X_0\\
\vdots\\
X_{t_n} &amp;= \sum_{j=0}^{n-1}(X_{t_{j+1}} - X_{t_j}) + X_0
\end{align*}
\]</span></p>
</div>
<div id="exm-milstein-scheme" class="theorem example">
<p><span class="theorem-title"><strong>Example 14</strong></span> (Milstein Scheme). In this scheme, we go an order further for the approximation of the volatility in <a href="#eq-ito-taylor-expansion-of-mu-and-sigma" class="quarto-xref">Equation&nbsp;15</a> and consider also the integral in <span class="math inline">\(dX_u\)</span>. We take <span class="math inline">\(dX_u = \sigma(X_{t_j})dB_u\)</span>. We then express <span class="math inline">\(\sigma(X_s)\)</span> in <a href="#eq-ito-taylor-expansion-of-mu-and-sigma" class="quarto-xref">Equation&nbsp;15</a> as:</p>
<p><span class="math display">\[
\begin{align*}
\sigma(X_s) &amp;\approx \sigma(X_{t_j}) + \int_{t_j}^{s} \sigma'(X_{t_j}) (\sigma(X_{t_j})dB_u)\\
&amp;= \sigma(X_{t_j}) + \sigma'(X_{t_j}) \sigma(X_{t_j}) \int_{t_j}^{s}  dB_u\\
&amp;= \sigma(X_{t_j}) + \sigma'(X_{t_j}) \sigma(X_{t_j}) (B_s - B_{t_j})
\end{align*}
\]</span></p>
<p>If we put this back in <a href="#eq-increment-of-a-diffusion" class="quarto-xref">Equation&nbsp;14</a>, we get:</p>
<p><span id="eq-milstein-approx-step1"><span class="math display">\[
\begin{align*}
X_{t_{j+1}} - X_{t_j} &amp;\approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+ \sigma'(X_{t_j}) \sigma(X_{t_j}) \int_{t_j}^{t_{j+1}} (B(s) - B(t_j))dB(s)
\end{align*}
\tag{17}\]</span></span></p>
<p>Now, consider the function <span class="math inline">\(f(x)=x^2\)</span>. We have:</p>
<p><span class="math display">\[
\begin{align*}
f_x(x) &amp;= 2x\\
f_{xx}(x) &amp;= 2
\end{align*}
\]</span></p>
<p>So, we get:</p>
<p><span class="math display">\[
B^2(t_{j+1}) - B^2(t_j) = 2 \int_{t_j}^{t_{j+1}} B(s) dB(s) + \frac{1}{2} \int_{t_j}^{t_{j+1}} (2) ds
\]</span></p>
<p>Thus,</p>
<p><span id="eq-ito-integral-of-bm"><span class="math display">\[
\int_{t_j}^{t_{j+1}} B(s) dB(s) = \frac{1}{2}[(B_{t_{j+1}}^2 - B_{t_j}^2)-(t_{j+1}-t_j)]
\tag{18}\]</span></span></p>
<p>Substituting <a href="#eq-ito-integral-of-bm" class="quarto-xref">Equation&nbsp;18</a> into <a href="#eq-milstein-approx-step1" class="quarto-xref">Equation&nbsp;17</a>, we get the Milstein approximation:</p>
<p><span class="math display">\[
\begin{align*}
X_{t_{j+1}} - X_{t_j} &amp;\approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+\sigma'(X_{t_j}) \sigma(X_{t_j})  \left[\frac{1}{2}((B_{t_{j+1}}^2 - B_{t_j}^2)-(t_{j+1}-t_j)) -  B_{t_j}(B_{t_{j+1}}-B_{t_j})\right]\\
&amp;= \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+ \frac{\sigma'(X_{t_j}) \sigma(X_{t_j})}{2}  \left[(B_{t_{j+1}}^2 - B_{t_j}^2)-(t_{j+1}-t_j) -  2B_{t_j}B_{t_{j+1}}+2B_{t_j}^2\right]\\
&amp;= \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+ \frac{\sigma'(X_{t_j}) \sigma(X_{t_j})}{2}  \left[(B_{t_{j+1}} - B_{t_j})^2-(t_{j+1}-t_j)\right]
\end{align*}
\]</span></p>
<p>Thus, under the Milstein scheme</p>
<p><span id="eq-milstein"><span class="math display">\[
\begin{align*}
X_{t_{j+1}} - X_{t_j} &amp;\approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+ \frac{\sigma'(X_{t_j}) \sigma(X_{t_j})}{2}  \left[(B_{t_{j+1}} - B_{t_j})^2-(t_{j+1}-t_j)\right]
\end{align*}
\tag{19}\]</span></span></p>
<p>The recursive nature of these two schemes makes them easy to implement numerically. The Milstein scheme is not much more costly to implement as it contains only one more term than the Euler scheme.</p>
</div>
<section id="python-implementation" class="level3">
<h3 class="anchored" data-anchor-id="python-implementation">Python implementation</h3>
<p>Let’s code an <code>SIVP</code> class and an abstract base class <code>Solver</code>.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> abc <span class="im">import</span> ABC, abstractmethod</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Callable, Optional</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># More descriptive type hints</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.ndarray</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.ndarray</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SIVP:</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">    An abstraction for a stochastic initial value problem</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    t_start : <span class="bu">float</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    t_end : <span class="bu">float</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    initial_condition: <span class="bu">float</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    drift: Callable[[<span class="bu">float</span>, np.ndarray], np.ndarray]</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    vol: Callable[[<span class="bu">float</span>, np.ndarray], np.ndarray]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    dvol_dx: Optional[Callable[[<span class="bu">float</span>, np.ndarray], np.ndarray]] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Solver(ABC):</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">    An abstract base class for all numerical schemes</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    num_steps: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    num_paths: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> __post_init__(<span class="va">self</span>):</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.<span class="bu">iter</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># x_values is a matrix of shape [num_paths,num_steps]</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x_values <span class="op">=</span> np.zeros((<span class="va">self</span>.num_paths, <span class="va">self</span>.num_steps <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.step_size <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="va">self</span>.num_steps</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># gaussian increments</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.brownian_increments <span class="op">=</span> np.sqrt(<span class="va">self</span>.step_size) <span class="op">*</span> np.random.standard_normal(</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>            size<span class="op">=</span>(<span class="va">self</span>.num_paths, <span class="va">self</span>.num_steps)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.brownian <span class="op">=</span> np.cumsum(<span class="va">self</span>.brownian_increments, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.brownian <span class="op">=</span> np.concatenate(</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>            [np.zeros(shape<span class="op">=</span>(<span class="va">self</span>.num_paths, <span class="dv">1</span>)), <span class="va">self</span>.brownian], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractmethod</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> iterate(<span class="va">self</span>, sivp: SIVP) <span class="op">-&gt;</span> X:</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co">        Compute the next iterate X(n+1)</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> solve(<span class="va">self</span>, sivp: SIVP) <span class="op">-&gt;</span> (T, X):</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co">        Solve the SIVP</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x_values[:, <span class="dv">0</span>] <span class="op">=</span> np.full(</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>            shape<span class="op">=</span>(<span class="va">self</span>.num_paths,), fill_value<span class="op">=</span>sivp.initial_condition</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">self</span>.<span class="bu">iter</span> <span class="op">&lt;</span> <span class="va">self</span>.num_steps:</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span> <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> <span class="va">self</span>.iterate(sivp)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.<span class="bu">iter</span> <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        times <span class="op">=</span> np.linspace(sivp.t_start, sivp.t_end, <span class="va">self</span>.num_steps <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> times, <span class="va">self</span>.x_values</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reset(<span class="va">self</span>):</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__post_init__()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>EulerMaruyama</code> and <code>Milstein</code> methods will derive from the abstract base class <code>Solver</code>.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EulerMaruyama(Solver):</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Numerical solver for a stochastic differential equation(SDE) using</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    the Euler-Maruyama method.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Consider an SDE of the form :</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">    dX_t = mu(t,X_t) dt + sigma(t,X_t) dB_t</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">    with initial condition X_0 = x_0</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">    The solution to the SDE can be computed using the increments</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">    X_{n+1} - X_n = mu(n,X_n)(t_{n+1}-t_n) + sigma(n,X_n)(B(n+1)-B(n))</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> iterate(<span class="va">self</span>, sivp: SIVP) <span class="op">-&gt;</span> X:</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">        Generate the next iterate X(n+1)</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        current_time <span class="op">=</span> <span class="va">self</span>.<span class="bu">iter</span> <span class="op">*</span> <span class="va">self</span>.step_size</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        mu_n <span class="op">=</span> sivp.drift(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        sigma_n <span class="op">=</span> sivp.vol(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        delta_x <span class="op">=</span> (</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>            mu_n <span class="op">*</span> <span class="va">self</span>.step_size <span class="op">+</span> sigma_n <span class="op">*</span> <span class="va">self</span>.brownian_increments[:, <span class="va">self</span>.<span class="bu">iter</span>]</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>] <span class="op">+</span> delta_x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Milstein(Solver):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Numerical solver for a stochastic differential equation(SDE) using</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    the Euler-Maruyama method.</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Consider an SDE of the form :</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    dX_t = mu(t,X_t) dt + sigma(t,X_t) dB_t</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">    with initial condition X_0 = x_0</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">    The solution to the SDE can be computed using the increments</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">    X_{n+1} - X_n = mu(n,X_n)(t_{n+1}-t_n) + sigma(n,X_n)(B(n+1)-B(n))</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">    + 0.5 * sigma(n,X_n) * sigma'(n,X_n) * ((B(n+1) - B(n))**2 - (t_{n+1} - t_n))</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> iterate(<span class="va">self</span>, sivp: SIVP):</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">        Generate the next iterate X(n+1)</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        current_time <span class="op">=</span> <span class="va">self</span>.<span class="bu">iter</span> <span class="op">*</span> <span class="va">self</span>.step_size</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        mu_n <span class="op">=</span> sivp.drift(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        sigma_n <span class="op">=</span> sivp.vol(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        dvol_dx_n <span class="op">=</span> sivp.dvol_dx(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        delta_x <span class="op">=</span> (</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>            mu_n <span class="op">*</span> <span class="va">self</span>.step_size</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> sigma_n <span class="op">*</span> <span class="va">self</span>.brownian_increments[:, <span class="va">self</span>.<span class="bu">iter</span>]</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> <span class="fl">0.5</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span> sigma_n</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span> dvol_dx_n</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span> (<span class="va">self</span>.brownian_increments[:, <span class="va">self</span>.<span class="bu">iter</span>] <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> <span class="va">self</span>.step_size)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>] <span class="op">+</span> delta_x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="exr-simulating-sdes" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4</strong></span> (Simulating SDEs) Simulate 100 paths for the following diffusions given by their SDEs on <span class="math inline">\([0,1]\)</span> using the Euler-Maruyama scheme and the Milstein scheme for a discretization of <span class="math inline">\(0.01\)</span>.</p>
<ol type="a">
<li>Geometric Brownian Motion:</li>
</ol>
<p><span class="math display">\[
dS_t = S_t dB_t + \left(\mu + \frac{\sigma^2}{2}\right)S_t dt, \quad S_0 = 1
\]</span></p>
<p>for <span class="math inline">\(\mu=-1/2\)</span>, <span class="math inline">\(\mu=-2\)</span>, and <span class="math inline">\(\mu=0\)</span></p>
<ol start="2" type="a">
<li>Ornstein-Uhlenbeck process:</li>
</ol>
<p><span class="math display">\[
dX_t = -X_t dt + dB_t, \quad X_0 = 1
\]</span></p>
<ol start="3" type="a">
<li>The diffusion:</li>
</ol>
<p><span class="math display">\[
dX_t = \sqrt{1+X_t^2}dB_t + \sin X_t dt, \quad X_0 = 0
\]</span></p>
</div>
<p><em>Solution.</em></p>
<p>We can now use <code>EulerMaruyama</code> and <code>Milstein</code> solvers and generate some sample paths.</p>
<div class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_trajectories(ts, xs, title):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="vs">r'Time $t$'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="vs">r'$X(t)$'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    plt.plot(ts, xs.transpose())</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># mu = -0.5 case</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>euler <span class="op">=</span> EulerMaruyama(num_paths<span class="op">=</span><span class="dv">10</span>, num_steps<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>gbm_sde <span class="op">=</span> SIVP(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    t_start<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    t_end<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    initial_condition<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    drift<span class="op">=</span><span class="kw">lambda</span> t, s_t: np.zeros(<span class="dv">10</span>),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    vol<span class="op">=</span><span class="kw">lambda</span> t, s_t: s_t,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    dvol_dx<span class="op">=</span><span class="kw">lambda</span> t, s_t: np.ones(<span class="dv">10</span>),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>ts, xs <span class="op">=</span> euler.solve(gbm_sde)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Geometric Brownian Motion, $\mu=-0.5$'</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co"># mu = -2 case</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>gbm_sde.drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : <span class="op">-</span><span class="fl">1.5</span> <span class="op">*</span> s_t</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>ts, xs <span class="op">=</span> euler.solve(gbm_sde)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Geometric Brownian Motion, $\mu=-2.0$'</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># mu = 0 case</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>gbm_sde.drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : <span class="fl">0.5</span> <span class="op">*</span> s_t</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>ts, xs <span class="op">=</span> euler.solve(gbm_sde)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Geometric Brownian Motion, $\mu=0.0$'</span>)</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co"># ornstein-uhlenbeck</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>ornstein_uhlenbeck_sde <span class="op">=</span> SIVP(</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    t_start<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    t_end<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    initial_condition<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : <span class="op">-</span>s_t,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    vol <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.ones(<span class="dv">10</span>),</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    dvol_dx <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.zeros(<span class="dv">10</span>)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>ts, xs <span class="op">=</span> euler.solve(ornstein_uhlenbeck_sde)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Ornstein-Uhlenbeck'</span>)</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="co"># diffusion</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>diffusion_sde <span class="op">=</span> SIVP(</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    t_start<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    t_end<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    initial_condition<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.sin(s_t),</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    vol <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.sqrt(<span class="dv">1</span><span class="op">+</span>s_t<span class="op">**</span><span class="dv">2</span>),</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    dvol_dx <span class="op">=</span> <span class="kw">lambda</span> t, s_t : s_t <span class="op">/</span> np.sqrt(<span class="dv">1</span> <span class="op">+</span> s_t<span class="op">**</span><span class="dv">2</span>) </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>ts,xs <span class="op">=</span> euler.solve(diffusion_sde)</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of the diffusion'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-1.png" width="576" height="448" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-2.png" width="595" height="448" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-3.png" width="576" height="448" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-4.png" width="595" height="447" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-5.png" width="591" height="447" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="convergence" class="level3">
<h3 class="anchored" data-anchor-id="convergence">Convergence</h3>
<p>It is of course possible go beyond the Milstein scheme to improve the approximation. However, it turns out that the above schemes already converge quite rapidly to the process itself. To see this, consider the mean absolute error between the approximation <span class="math inline">\(X_T^{(n)}\)</span> at time <span class="math inline">\(T\)</span> and <span class="math inline">\(X_T\)</span>. Suppose that the approximation <span class="math inline">\(X^{(n)}\)</span> is obtained for a partition with discretization <span class="math inline">\(t_{j+1}-t_j = 1/n\)</span>. It is possible to show that for the Euler scheme, we have:</p>
<p><span class="math display">\[
\begin{align*}
\mathbb{E}[|X_T^{(n)} - X_T|] \leq \frac{C}{\sqrt{n}}
\end{align*}
\]</span></p>
<p>whereas for the Milstein scheme</p>
<p><span class="math display">\[
\begin{align*}
\mathbb{E}[|X_T^{(n)} - X_T|] \leq \frac{C'}{n}
\end{align*}
\]</span></p>
<p>for some constants <span class="math inline">\(C,C'&gt;0\)</span>. Note that the mean error between the two process must be the worst at the last point, since the errors add up.</p>
</section>
</section>
<section id="existence-and-uniqueness-of-sdes" class="level2">
<h2 class="anchored" data-anchor-id="existence-and-uniqueness-of-sdes">Existence and Uniqueness of SDEs</h2>
<p>As for the differential equations in standard calculus, SDEs play an important role in modelling stochastic phenomena. To model a trajectory <span class="math inline">\(X_t, t\leq T\)</span>, it suffices to write down the variation due to the deterministic change <span class="math inline">\(\mu(X_t)dt\)</span> for some function <span class="math inline">\(\mu(X_t)\)</span> and the variation due to local fluctuations <span class="math inline">\(\sigma(X_t)dB_t\)</span> for some function <span class="math inline">\(\sigma(X_t)\)</span>. Here, we assume that the local drift and volatility are time-homogenous for simplicity. This gives the SDE:</p>
<p><span class="math display">\[
dX_t = \mu(X_t) dt + \sigma(X_t) dB_t
\]</span></p>
<p>Do we get one nice Ito process for any choice of functions <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\mu\)</span>? The short answer is no. Here are sufficient conditions for the existence of a unique process.</p>
<div id="thm-existence-and-uniqueness-of-solutions-to-sde" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4 (Existence and Uniqueness of solutions to SDE)</strong></span> Consider the SDE</p>
<p><span class="math display">\[
dX_t = \mu(X_t) dt  + \sigma(X_t)dB_t, \quad X_0 = x, \quad t\in [0,T]
\]</span></p>
<p>If the functions <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\mu\)</span> grow not faster than <span class="math inline">\(Kx^2\)</span> for some <span class="math inline">\(K&gt;0\)</span> and are differentiable with bounded derivatives on <span class="math inline">\(\mathbb{R}^1\)</span>, then there exists a unique solution <span class="math inline">\((X_t,t\in[0,T])\)</span> to the SDE. In other words, there exists a continuous process <span class="math inline">\((X_t, t \leq T)\)</span> adapted to the filtration of the Brownian motion given by:</p>
<p><span class="math display">\[
X_t = x + \int_0^t \mu(X_s) ds + \int_0^t \sigma(X_s) dB_s, \quad t\leq T
\]</span></p>
</div>
<div id="exm-diffusion" class="theorem example">
<p><span class="theorem-title"><strong>Example 15</strong></span> Consider the SDE :</p>
<p><span id="eq-a-diffusion"><span class="math display">\[
dX_t = \sqrt{1 + X_t^2}dB_t + \sin X_t dt
\tag{20}\]</span></span></p>
<p>There exists a unique diffusion process <span class="math inline">\((X_t,t\geq 0)\)</span> that is a solution of this SDE. To see this, we verify the conditions of the <a href="#thm-existence-and-uniqueness-of-solutions-to-sde" class="quarto-xref">Theorem&nbsp;4</a>. We have:</p>
<p><span class="math display">\[
\sigma(x) = \sqrt{1 + x^2}, \quad \mu(x) = \sin x
\]</span></p>
<p>Clearly, these functions satisfy the growth condition since <span class="math inline">\(\mu\)</span> is bounded and <span class="math inline">\(\sigma\)</span> grows like <span class="math inline">\(|x|\)</span> for large <span class="math inline">\(x\)</span>. As for the derivatives, we have <span class="math inline">\(\sigma'(x)=\frac{x}{\sqrt{1+x^2}}\)</span> and <span class="math inline">\(\mu'(x)=\cos x\)</span>. The two derivatives are bounded.</p>
</div>
<p>The assumptions of <a href="#thm-existence-and-uniqueness-of-solutions-to-sde" class="quarto-xref">Theorem&nbsp;4</a> are not too surprising, since similar ones are found in the classical case of ODE. For example, if we have the ODE</p>
<p><span class="math display">\[
\frac{dX_t}{dt} = X_t^{1/2}, \quad X_0 = 0
\]</span></p>
<p>then clearly <span class="math inline">\(X_t = 0\)</span> for all <span class="math inline">\(t\)</span> is a solution. But, we also have by integrating that:</p>
<p><span class="math display">\[
X_t = \frac{t^2}{4}, t \geq 0
\]</span></p>
<p>Therefore, the uniqueness breaks down. Note, that the function <span class="math inline">\(\mu(x)=\sqrt{x}\)</span> does not have bounded derivatives at <span class="math inline">\(0\)</span>. Similarly, consider the ODE:</p>
<p><span class="math display">\[
\frac{dX_t}{dt} = e^{X_t}, X_0 = 0
\]</span></p>
<p>Here, the function <span class="math inline">\(\mu(x)\)</span> grows much faster than <span class="math inline">\(x^2\)</span>. The solution of the ODE is by integrating</p>
<p><span class="math display">\[
\begin{align*}
-(e^{-X_t} - 1) &amp;= t\\
e^{-X_t} &amp;= (1 - t)\\
-X_t &amp;= \log(1 - t)\\
X_t &amp;= \log \left(\frac{1}{1-t}\right)
\end{align*}
\]</span></p>
<p>The solution explodes at <span class="math inline">\(t=1\)</span>. The same phenomenon may occur for SDE; that is the process will almost surely go <span class="math inline">\(\infty\)</span> in finite time. These times are called <em>explosion times</em>. Note that it is possible to consider the paths of the diffusion upto these explosion times. It is important to keep in mind that the conditions of <a href="#thm-existence-and-uniqueness-of-solutions-to-sde" class="quarto-xref">Theorem&nbsp;4</a> are sufficient, but not necessary. In particular, it is sometimes possible to explicitly construct a diffusion whose local volatility and drift do not satisfy the conditions. Let’s look at two important instances of such diffusions.</p>
<div class="{exm-bessel-process}">
<p>Let <span class="math inline">\(B_t\)</span> be a brownian motion in <span class="math inline">\(\mathbb{R}^d\)</span> for <span class="math inline">\(d&gt;1\)</span>. Consider the process giving the distance at time <span class="math inline">\(t\)</span> of <span class="math inline">\(B_t\)</span> to the origin; that is:</p>
<p><span class="math display">\[
R_t = ||B_t|| = \left(\sum_{j=1}^d B_t^{(j)}\right)^2
\]</span></p>
<p>(For <span class="math inline">\(d=1\)</span>, this is simply <span class="math inline">\(|B_t|\)</span>. Ito’s formula cannot be applied in this case, since the absolute value is not differentiable at the origin.) In higher dimensions, the function is smooth enough as long as we stay away from the origin. This is not a problem as long as <span class="math inline">\(R_0 &gt; 0\)</span>.</p>
</div>
<p>Let’s find out the SDE that this process satisfies.</p>
<p>Let <span class="math inline">\(r=f(x_1,x_2,\ldots,x_d)=\sqrt{\sum_{j=1}^d x_j^2}\)</span>. We have:</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial r}{\partial x_j} &amp;= \frac{x_j}{\sqrt{\sum_{j=1}^d x_j^2}}\\
\frac{\partial^2 r}{\partial x_j^2} &amp;= \frac{||x|| - x_j \cdot \frac{x_j}{||x||}}{||x||^2}\\
&amp;= \frac{||x||^2 - x_j^2}{||x||^3}
\end{align*}\]</span></p>
<p>By Ito’s formula,</p>
<p><span class="math display">\[\begin{align*}
dR_t &amp;= \sum_{j=1}^{d} \frac{B_t^{j}}{R_t} dB_t^{(j)} + \frac{1}{2} \sum_{j=1}^{d} \frac{R_t^2 - (B_t^{(j)})^2}{R_t^3}\\
&amp;= \sum_{j=1}^{d} \frac{B_t^{j}}{R_t} dB_t^{(j)} + \frac{1}{2} \frac{d R_t^2 - R_t^2}{R_t^3}\\
&amp;= \sum_{j=1}^{d} \frac{B_t^{j}}{R_t} dB_t^{(j)} + \frac{1}{2} \frac{(d-1)}{R_t}
\end{align*}\]</span></p>
<p>We can define <span class="math inline">\(dW_t = \sum_{j=1}^{d} \frac{B_t^{(j)}}{R_t} dB_t^{(j)}\)</span>. Then, <span class="math inline">\(dR_t = dW_t + \frac{d-1}{2R_t}dt\)</span></p>
<p>It turns out that <span class="math inline">\((W_t,t \geq 0)\)</span> is a standard Brownian motion by Levy’s characterization theorem. This is the subject of the next section. The SDE shows that <span class="math inline">\(dR_t\)</span> is a diffusion. The SDE makes sense for any real number <span class="math inline">\(d &gt; 1\)</span>, not only integers. Moreover, the SDE is well-defined since <span class="math inline">\(R_t\)</span> is never equal to <span class="math inline">\(0\)</span>. However, the SDE does not satisfy the assumption of the existence and uniqueness of the solution of SDEs since <span class="math inline">\(1/x\)</span> diverges at <span class="math inline">\(0\)</span>. The solution to the SDE still exists since we constructed it! We sample paths of this process in numerical project.</p>
<div id="exm-cox-ingersoll-ross-process" class="theorem example">
<p><span class="theorem-title"><strong>Example 16 (The Cox-Ingersoll-Ross (CIR) model.)</strong></span> Consider the SDE:</p>
<p><span id="eq-cir-process"><span class="math display">\[
dS_t = \sigma \sqrt{S_t} dW_t + (a - bS_t)dt, \quad S_0 &gt; 0
\tag{21}\]</span></span></p>
<p>for some parameters <span class="math inline">\(a,b &gt; 0\)</span> where <span class="math inline">\((W_t,t \geq 0)\)</span> is a standard Brownian motion. The local volatility <span class="math inline">\(\sigma(x)=\sigma \sqrt{x}\)</span> does not have a bounded derivative close to <span class="math inline">\(0\)</span>, since <span class="math inline">\(\sigma'(x)=\frac{\sigma}{2\sqrt{x}}\)</span>. We will nevertheless construct a diffusion that is a solution to the SDE. Consider independent Ornstein-Uhlenbeck processes <span class="math inline">\(X_t^{(j)}, j \leq d\)</span>, with SDE:</p>
<p><span class="math display">\[
dX_t^{(j)} = \frac{-b}{2}X_t^{(j)}dt + \frac{\sigma}{2}dB_t^{(j)}, \quad X_0^{(j)} &gt; 0
\]</span></p>
<p>where <span class="math inline">\(B_t = (B_t^{(j)},j\leq d)\)</span> is a Brownian motion in <span class="math inline">\(\mathbb{R}^d\)</span>. We consider the process</p>
<p><span class="math display">\[
S_t = \sum_{j \leq d} (X_t^{(j)})^2
\]</span></p>
<p>Clearly, <span class="math inline">\(S_t\)</span> is nongegative for all <span class="math inline">\(t \geq 0\)</span> by design, so <span class="math inline">\(\sqrt{S_t}\)</span> is well-defined. Let’s compute the SDE of the process. By Ito’s formula, we have:</p>
<p><span class="math display">\[
\begin{align*}
dS_t &amp;= 2\sum_{j=1}^{d}X_t^{(j)} dX_t^{(j)} + \frac{1}{2}\sum_{j=1}^{d} 2 (dX_t^{(j)})^2\\
&amp;=2\sum_{j=1}^{d}X_t^{(j)} dX_t^{(j)} + \frac{\sigma^2}{4}\sum_{j=1}^{d} dt \\
&amp;=2\sum_{j=1}^{d}X_t^{(j)} \left(\frac{-b}{2}X_t^{(j)}dt + \frac{\sigma}{2}dB_t^{(j)}\right) + \frac{d\sigma^2}{4} dt\\
&amp;=\left[\left(\sum_{j=1}^d (-b)(X_t^{(j)})^2\right) + \frac{d\sigma^2}{4}\right] dt + \sigma \sum_{j=1}^{d} X_t^{(j)} dB_t^{(j)}\\
&amp;=\sigma \sum_{j=1}^{d} X_t^{(j)} dB_t^{(j)} + \left[\frac{d\sigma^2}{4} - b S_t\right] dt \\
&amp;= \sigma \sqrt{S_t} \sum_{j=1}^{d} \frac{X_t^{(j)}}{\sqrt{S_t}} dB_t^{(j)}  + \left[\frac{d\sigma^2}{4} - b S_t\right] dt \\
&amp;= \sigma \sqrt{S_t} dW_t  + \left[\frac{d\sigma^2}{4} - b S_t\right] dt \\
\end{align*}
\]</span></p>
<p>where we have defined <span class="math inline">\(dW_t = \sum_{j=1}^d \frac{X_t^{(j)}}{\sqrt{S_t}} dB_t^{(j)}\)</span>. It turns out that the process <span class="math inline">\((W_t,t\geq 0)\)</span> is a standard brownian motion by Levy’s characterization theorem. If we accept this for a moment, we have the SDE:</p>
<p><span id="eq-cir-process-2"><span class="math display">\[
dS_t = \sigma \sqrt{S_t} dW_t + \left(\frac{d \sigma^2}{4} - bS_t\right) dt, \quad S_0 &gt; 0
\tag{22}\]</span></span></p>
<p>This is a time-homogenous diffusion called the Cox-Ingersoll-Ross (CIR) process. Again, notice that there are no issues with square root, since <span class="math inline">\(S_t\)</span> is positive by construction! The SDE also makes sense if replace <span class="math inline">\(d\sigma^2/4\)</span> by a parameter <span class="math inline">\(a\)</span> in <a href="#eq-cir-process" class="quarto-xref">Equation&nbsp;21</a> as long as <span class="math inline">\(a \geq \frac{d\sigma^2}{4}\)</span>. This process is important for interest rates and stochastic volatility models.</p>
<p>Note that the local drift is <span class="math inline">\(a - bS_t, a\ge \frac{d\sigma^2}{4}\)</span>. This can be written as:</p>
<p><span class="math display">\[\begin{align*}
a - bS_t = b\left(\frac{b}{a} - S_t \right)
\end{align*}\]</span></p>
<p>This means that the local drift is negative if <span class="math inline">\(S_t &gt; \frac{a}{b}\)</span> and it is positive if <span class="math inline">\(S_t &lt; \frac{a}{b}\)</span>. So, the SDE exhibits the same phenomenon as for the SDE of the Ornstein-Uhlenbeck process in <a href="#exm-ornstein-uhlenbeck-process" class="quarto-xref">Example&nbsp;5</a>. In particular we should expect that for <span class="math inline">\(t\)</span> large, the process should fluctuate around the mean value <span class="math inline">\(\frac{a}{b}\)</span>. The CIR model is therefore an example of a mean-reverting process. More generally, this hints to the fact, that the process is stationary in the long run.</p>
</div>
</section>
<section id="martingale-representation-and-levys-characterization" class="level2">
<h2 class="anchored" data-anchor-id="martingale-representation-and-levys-characterization">Martingale Representation and Levy’s Characterization</h2>
<p>We know very well by now, that an Ito integral is continuous martingale with respect to the Brownian filtration, whenever the integrand is in <span class="math inline">\(\mathcal{L}_c^2(T)\)</span>. What can we say about the converse? In other words, if we have a martingale with respect to the Brownian filtration, can it be expressed as an Ito integral for some integrand <span class="math inline">\((V_t,t\leq T)\)</span>? Amazingly, the answer to this question is yes!</p>
<div id="thm-martingale-representation-theorem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5 (Martingale Representation Theorem.)</strong></span> Let <span class="math inline">\((B_t,t \geq 0)\)</span> be a Brownian motion with filtration <span class="math inline">\((\mathcal{F}_t,t\geq 0)\)</span> on <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span>. Consider a martingale <span class="math inline">\((M_t,t\leq T)\)</span> with respect to this filtration. Then, there exists an adapted process <span class="math inline">\((V_t,t \leq T)\)</span> such that:</p>
<p><span id="eq-martingale-representation-theorem"><span class="math display">\[
M_t = M_0 + \int_0^t V_s dB_s, \quad t \leq T
\tag{23}\]</span></span></p>
<p>One striking fact of the result is that <span class="math inline">\((M_t,t\leq T)\)</span> ought to be continuous. In other words, we cannot construct a process with a jump that is a martingale adapted to Brownian motion!</p>
<p>Instead of the proving the theorem, we will see how the result is not too surprising with stronger assumptions. Instead of supposing that <span class="math inline">\(M_t\)</span> is <span class="math inline">\(\mathcal{F}_t\)</span> measurable, take that <span class="math inline">\(M_t\)</span> is <span class="math inline">\(\sigma(B_t)\)</span>-measurable. In other words, <span class="math inline">\(M_t=h(B_t)\)</span> for some function <span class="math inline">\(h\)</span>. In the case where <span class="math inline">\(h\)</span> is smooth, then it is clear by Ito’s formula that the representation <a href="#eq-martingale-representation-theorem" class="quarto-xref">Equation&nbsp;23</a> holds with <span class="math inline">\(V_s = h'(B_s)\)</span>.</p>
</div>
<p>An important consequence of <a href="#thm-martingale-representation-theorem" class="quarto-xref">Theorem&nbsp;5</a> is a third definition of Brownian motion.</p>
<div id="thm-levy-characterization-theorem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6 (One-dimensional Levy’s Characterization theorem)</strong></span> Let <span class="math inline">\((M_t,t\in [0,T])\)</span> be a continuous martingale with respect to the filtration <span class="math inline">\((\mathcal{F}_t,t \leq T)\)</span> with <span class="math inline">\(M_0 = 0\)</span> and with quadratic variation <span class="math inline">\(&lt;M&gt;_t = t\)</span>. Then, <span class="math inline">\((M_t,t\leq T)\)</span> is a standard brownian motion.</p>
</div>
<p><em>Proof.</em></p>
<p>We first need to show that <span class="math inline">\(M_t - M_s \sim \mathcal{N}(0,t - s)\)</span> or using the characteristic function approach, we need to show that <span class="math inline">\(f_{(M_t - M_s)}(\theta)=\mathbb{E}[e^{\theta (M_t - M_s)}] = e^{\frac{1}{2}\theta^2 (t-s)}\)</span> for constant <span class="math inline">\(\theta\)</span>.</p>
<p>Let <span class="math inline">\(f(t,x) = e^{\theta x - \frac{1}{2}\theta^2 t}\)</span>.</p>
<p>By Ito’s formula, we have:</p>
<p><span class="math display">\[\begin{align*}
df(t,M_t) &amp;= \theta e^{\theta M_t - \frac{1}{2}\theta^2 t} dM_t + \left(-\frac{1}{2}\theta^2 + \frac{1}{2} \theta^2 \right)e^{\theta M_t - \frac{1}{2}\theta^2 t}dt\\
&amp;= \theta f(t,M_t) dM_t
\end{align*}\]</span></p>
<p>Integrating on both sides, we get:</p>
<p><span class="math display">\[\begin{align*}
f(t,M_t) - f(s,M_s) &amp;= \theta \int_0^t f(u,M_u) dM_u
\end{align*}\]</span></p>
<p>The ito integral <span class="math inline">\(\int_0^t f(s,M_s) dM_s\)</span> is well-defined and its expectation is <span class="math inline">\(0\)</span>. Hence, applying expectation operator on both sides, we get:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}[f(t,M_t) - f(s,M_s)] &amp;= \theta \mathbb{E} \left[ \int_0^t f(s,M_s) dM_s\right]\\
&amp;= 0
\end{align*}\]</span></p>
<p>Since <span class="math inline">\(e^{x} \neq 0\)</span> for all <span class="math inline">\(x\)</span>, dividing by <span class="math inline">\(f(s,M_s)\)</span>, we get:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}\left[\frac{f(t,M_t)}{f(s,M_s)}\right] &amp;= 1\\
\mathbb{E}\left[\frac{e^{\theta M_t - \frac{1}{2}\theta^2 t}}{e^{\theta M_s - \frac{1}{2}\theta^2 s}}\right] &amp;= 1\\
\mathbb{E}\left[e^{\theta(M_t - M_s)}\right] &amp;= e^{\frac{1}{2}\theta^2(t-s)}
\end{align*}\]</span></p>
<p>which is the moment generating function for the normal distribution with mean zero and variance <span class="math inline">\(t-s\)</span>. So, <span class="math inline">\(M_t - M_s \sim \mathcal{N}(0, t - s)\)</span>.</p>
<p>Further, consider <span class="math inline">\(t_1 \leq t_2 \leq t_3\)</span>. We have:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}[(M_{t_3} - M_{t_2})(M_{t_2} - M_{t_1})] &amp;= \mathbb{E}[\mathbb{E}[(M_{t_3} - M_{t_2})(M_{t_2} - M_{t_1})|\mathcal{F}_{t_2}]] \\
&amp;= \mathbb{E}[(M_{t_2} - M_{t_1})\mathbb{E}[(M_{t_3} - M_{t_2})|\mathcal{F}_{t_2}]] \\
&amp;= \mathbb{E}[(M_{t_2} - M_{t_1})(M_{t_2} - M_{t_2})] \\
&amp;= 0
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\mathbb{E}[M_{t_3} - M_{t_2}|\mathcal{F}_{t_2}] = 0\)</span> follows from the fact that <span class="math inline">\((M_t,t\geq 0)\)</span> is a martingale. Consequently, <span class="math inline">\(M_{t_3} - M_{t_2} \perp M_{t_2} - M_{t_1}\)</span> and non-overlapping increments are independent.</p>
<p>Moreover, <span class="math inline">\(M(0) = 0\)</span>. So, <span class="math inline">\((M_t,t\geq 0)\)</span> is a standard brownian motion. This closes the proof. <span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="exercise-problems" class="level2">
<h2 class="anchored" data-anchor-id="exercise-problems">Exercise Problems</h2>
<div id="exr-power-of-bm" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 5</strong></span> Let <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> be a probability space and <span class="math inline">\((W_t,t\geq 0)\)</span> be a standard Wiener process. Find the SDE for the random process <span class="math inline">\(X_t = W_t^n, n \in \mathbb{Z}^{+}\)</span>.</p>
<p>Show that</p>
<p><span class="math display">\[
\mathbb{E}[W_t^n] = \frac{1}{2}n(n-1) \int_0^t \mathbb{E}\left[W_s^{(n-2)}\right] ds
\]</span></p>
<p>and using mathematical induction prove that:</p>
<p><span class="math display">\[
\mathbb{E}[W_t^n] = \begin{cases}
\frac{n! t^{n/2}}{2^{n/2} \left(\frac{n}{2}\right)!}, &amp; n=2,4,6,\ldots\\
0, &amp; n=1,3,5,\ldots
\end{cases}
\]</span></p>
</div>
<p><em>Solution.</em></p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="quasar-chunawala/quantdev" data-repo-id="R_kgDOL2t5-A" data-category="General" data-category-id="DIC_kwDOL2t5-M4ClndQ" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb5" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Ito Processes and Stochastic Differential Equations"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Quasar"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-07-08"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Stochastic Calculus]      </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "image.jpg"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 3</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu"># Ito Processes and Stochastic Differential Equations.</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>Let's start with the definition of Ito processes.</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>::: {#def-ito-process}</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ito Process</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>Let $(B(t):t\geq0)$ be a standard brownian motion defined on $(\Omega,\mathcal{F},\mathbb{P})$. An Ito process $(X(t):t\geq0)$ is of the form:</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>X(t) &amp; =X(0)+\int_{0}^{t}V(s)dB(s)+\int_{0}^{t}D(s)ds</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-ito-process}</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>where $(V(t),t\geq0)$ and $(D(t),t\geq0)$ are two adapted processes for</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>which the integrals make sense in the sense of Ito and Riemann. We refer</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>to $(V(t):t\geq0)$ as the *local volatility* and to $(D(t):t\geq0)$ as</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>the *local drift*.</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>We will often denote an Ito process $(X(t):t\geq0)$ in differential form</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>as:</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>dX(t) &amp; =D(t)dt+V(t)dB(t)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-ito-process-differential-form}</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>This form makes no rigorous sense; when we write it, we mean @eq-ito-process. Nevertheless, the differential equation</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>has two great advantages:</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="sc">\(</span>1<span class="sc">\)</span> It gives some intuition on what drives the variation of $X(t)$. On</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>one hand, there is a contribution of the Brownian increments which are</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>modulated by the volatility $V(t)$. On the other hand, there is a</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>smoother contribution coming from the time variation which is modulated</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>by the drift $D(t)$.</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="sc">\(</span>2<span class="sc">\)</span> The differential notation has computational power. In particular,</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>evaluating Ito's formula is reduced to computing differentials, as in</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>classical calculus, but by doing it upto the second order.</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>An important class of Ito processes is given by processes for which the</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>volatility and the drift are simply functions of the position of the</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>process.</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>::: {#def-time-homogenous-ito-process}</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>Let $(B(t):t\geq0)$ be a standard Brownian motion. An Ito</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>process $(X(t):t\geq0)$ of the form</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>dX(t) &amp; =\mu(X(t))dt+\sigma(X(t))dB(t),\quad X(0)=x</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-time-homogenous-ito-process}</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>where $\mu$ and $\sigma$ are functions from $\mathbf{R}$ to</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>$\mathbf{R}$, is called a time-homogenous diffusion. </span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>::: {#def-time-inhomogenous-ito-process}</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>An Ito-process $(Y(t),t\geq0)$ of the form:</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>{1}</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>dY(t) &amp; =\mu(t,X(t))dt+\sigma(t,X(t))dB(t)\quad Y(0)=y</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-time-inhomogenous-SDE}</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>where $\mu$ and $\sigma$ are now functions</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>$[0,\infty)\times\mathbf{R}\to\mathbf{R}$ is called a time-inhomogenous</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>diffusion.</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>The equations above are called *stochastic differential equations* (SDE) of the respective process $(X(t))$ and $(Y(t))$.</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>In other words, a diffusion $(X(t),t\geq 0)$ is an Ito process</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>whose local volatility $V(t)$ and local drift $D(t)$ at time $t$ depend</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>only on the position of the process at time $t$ and possibly on the time</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>$t$ itself. It cannot depend on the path of the process before time $t$</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>or on the explicit values of the driving Brownian motion at that time</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>(which is not the process $X(t)$ itself). The class of diffusions, and</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>of the Ito processes in general, constitutes a huge collection of</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>stochastic processes for stochastic modelling.</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>Note that an SDE is a generalization of ordinary differential equations</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>or ODEs. Indeed, if there were no randomness, that is, no Brownian</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>motion, the SDE would be reduced to</span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>dX(t) &amp; =\mu(X(t))dt</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>This can be written for $X(t)=f(t)$ as:</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>\frac{df}{dt} &amp; =\mu(f)</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>This is a first-order ordinary differential equation. It governs the</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>deterministic evolution of the function $X(t)=f(t)$ in time. An SDE adds</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>a random term to this evolution that is formally written as:</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>\frac{dX}{dt} &amp; =\mu(X(t))+\sigma(X(t))\frac{dB(t)}{dt}</span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>We know very well, that Brownian motion is not differentiable; hence the</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>above is not well-defined. The ill-defined term $dB(t)/dt$ is sometimes</span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>called white noise. However, equation @eq-time-homogenous-ito-process is well-defined in the</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>sense of the Ito process. These types of equations are well-suited to</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>model phenomena with intrinsic randomness.</span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>Here are some examples of diffusions:</span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>::: {#exm-brownian-motion-with-a-drift}</span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>(Brownian Motion with a drift). If we take</span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>$X(t)=\sigma B(t)+\mu t$ for some $\sigma&gt;0$ and $\mu\in\mathbf{R}$,</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>then we can write $X(t)$ as:</span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>X(t) &amp; =\int_{0}^{t}\sigma dB(t)+\int_{0}^{t}\mu dt,\quad X(0)=0</span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>In the differential form this becomes</span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>dX(t) &amp; =\mu dt+\sigma dB(t)</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>In this case, the local drift and the local volatility are constant.</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>::: {#exm-geometric-brownian-motion}</span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>(Geometric Brownian Motion). We consider the process</span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>$S(t)=\exp((\mu-\sigma^{2}/2)t+\sigma B(t))$. To find the stochastic</span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>differential equation, we apply the Ito's Lemma to</span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>f(t,x) &amp; =\exp((\mu-\sigma^{2}/2)t+\sigma x)</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>We have:</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>df(t,x) &amp; =\left((\mu-\sigma^{2}/2)+\frac{1}{2}\sigma^{2}\right)\exp((\mu-\sigma^{2}/2)t+\sigma x)dt+\sigma\exp((\mu-\sigma^{2}/2)t+\sigma x)dB(t)<span class="sc">\\</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a> &amp; =\mu S(t)dt+\sigma S(t)dB(t)</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>Note that the local drift and the local volatility are now proportional</span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>to the position. So, the higher $S(t)$, the higher the volatility and</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>drift.</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>::: {#exm-smooth-function-of-brownian-motion}</span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>(Any smooth function of Brownian motion). Ito's formula</span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a>gurarantees that any smooth function $f(t,B(t))$ of time and a Brownian</span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a>motion is an Ito process with volatility $V(t)=\partial_{t}f(t,B(t))$</span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a>and drift $D(t)=\partial_{x}f(t,B(t))+\frac{1}{2}\partial_{xx}f(t,B(t))$. We will</span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a>see in further ahead, that, in general, any reasonable function of an</span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a>Ito process remains an Ito process.</span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>::: {#exm-ito-process-that-is-not-a-diffusion}</span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a>(An Ito process that is not a diffusion) Consider the process</span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a>X(t) &amp; =\int_{0}^{t}B^{2}(s)dB(s)</span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a>This is an Ito process with local volatility $V(t)=B(t)^{2}$ and local</span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a>drift $D(t)=0$. However, it is not a diffusion, because the local</span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a>volatility is not an explicit function of $X(t)$.</span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a>It turns out that the Brownian bridge is a time-inhomogenous diffusion</span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a>and that the Ornstein-Uhlenbeck process is a time-homogenous diffusion.</span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a>To understand these examples, we need to extend Ito's formula to Ito</span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a>processes.</span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ito's Formula.</span></span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a>The first step towards a general Ito's formula is the quadratic</span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a>variation of an Ito process.</span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a>::: {#prp-quadratic-variation-of-an-ito-process}</span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quadratic variation of an Ito process. </span></span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a>Let $(B(t),t\geq0)$ be a standard Brownian motion and $(X(t):t\geq0)$ be an Ito process of</span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a>the form $dX(t)=V(t)dB(t)+D(t)dt$. Then, the quadratic variation of the</span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a>process $(X(t):t\geq0)$ is:*</span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a>&lt;X,X&gt;_{t} &amp; =\lim_{n\to\infty}\sum_{j=0}^{n-1}(X(t_{j+1})-X(t_{j}))^{2}=\int_{0}^{t}V(s)^{2}ds</span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-quadratic-variation-ito-process}</span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a>*for any partition $(t_{j},j\leq n)$ of $<span class="co">[</span><span class="ot">0,t</span><span class="co">]</span>$, where the limit is in</span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a>probability.*</span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a>::: {#rem-remark1}</span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a>Note that the quadratic variation is increasing in $t$, but it is not deterministic in general! $V_t$ is a random variable. The quadratic variation is a smooth stochastic process. (It is differentiable) Observe that we recover the quadratic variation for the Brownian motion for $V(t)=1$ as expected. We also notice that the formula follows easily from the rules of Ito Calculus, thereby showing the consistency of the theory. Indeed we have:</span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a>d&lt;X,X&gt;_{t} &amp; =(dX(t))^{2}=(V(t)dB(t)+D(t)dt)^{2}<span class="sc">\\</span></span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a> &amp; =V(t)^{2}(dB(t))^{2}+2V(t)D(t)dB(t)\cdot dt+D^{2}(t)(dt)^{2}<span class="sc">\\</span></span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a> &amp; =V(t)^{2}dt</span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a>::: proof</span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a>*Proof.* The proof is involved, but it reviews some important concepts</span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a>of stochastic calculus. We prove the case when the process $V$ is in</span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a>$\mathcal{L}_{c}^{2}(T)$ for some $T&gt;0$. We write</span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a>$I(t)=\int_{0}^{t}V(s)dB(s)$ and $R(t)=\int_{0}^{t}D(s)ds$. We first</span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a>show that only the Ito integral contributes to the quadratic variation</span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a>and the Riemann integral does not contribute, so that:</span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a>&lt;X,X&gt;_{t} &amp; =&lt;I,I&gt;_{t}</span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-quadratic-variation-ito-process-ii}</span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a>We have that the increment square of $X(t)$ is:</span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a>(X(t_{j+1})-X(t_{j}))^{2} &amp; =(I(t_{j+1})-I(t_{j}))^{2}+2(I(t_{j+1})-I(t_{j}))(R(t_{j+1})-R(t_{j}))+(R(t_{j+1})-R(t_{j}))^{2}</span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a>The Cauchy-Schwarz inequality implies :</span>
<span id="cb5-243"><a href="#cb5-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-244"><a href="#cb5-244" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-245"><a href="#cb5-245" aria-hidden="true" tabindex="-1"></a>\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))(R(t_{j+1})-R(t_{j})) &amp; \leq\left(\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}\right)^{1/2}\left(\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2}\right)^{1/2}</span>
<span id="cb5-246"><a href="#cb5-246" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-247"><a href="#cb5-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-248"><a href="#cb5-248" aria-hidden="true" tabindex="-1"></a>Therefore, to prove equation @eq-quadratic-variation-ito-process, it suffices to show that $\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2}\to 0$ almost surely. Since $D(s)$ is an almost surely continuous process, the stochastic process $R(t)=\int_{0}^{t}D(s)ds$ has continuous paths with probability $1$. Therefore:</span>
<span id="cb5-249"><a href="#cb5-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-250"><a href="#cb5-250" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-251"><a href="#cb5-251" aria-hidden="true" tabindex="-1"></a>\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2} &amp; =\max_{1\leq j\leq n}|R(t_{j+1})-R(t_{j})|\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))</span>
<span id="cb5-252"><a href="#cb5-252" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-253"><a href="#cb5-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-254"><a href="#cb5-254" aria-hidden="true" tabindex="-1"></a>Since, $R(t)$ is continuous on the compact set $<span class="co">[</span><span class="ot">0,t</span><span class="co">]</span>$, it is uniformly</span>
<span id="cb5-255"><a href="#cb5-255" aria-hidden="true" tabindex="-1"></a>continuous a.s. So, as $|t_{j+1}-t_{j}|\to 0$, by uniform continuity it</span>
<span id="cb5-256"><a href="#cb5-256" aria-hidden="true" tabindex="-1"></a>follows that $\max|R(t_{j+1})-R(t_{j})|\to 0$ a.s.</span>
<span id="cb5-257"><a href="#cb5-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-258"><a href="#cb5-258" aria-hidden="true" tabindex="-1"></a>It remains to prove that $&lt;I,I&gt;_{t}=\int_{0}^{t}V(s)^{2}ds$. We first</span>
<span id="cb5-259"><a href="#cb5-259" aria-hidden="true" tabindex="-1"></a>prove the case when $V\in\mathcal{S}(T)$ is a simple adapted process.</span>
<span id="cb5-260"><a href="#cb5-260" aria-hidden="true" tabindex="-1"></a>Consider a partition $(t_{j}:j\leq n)$ of $<span class="co">[</span><span class="ot">0,t</span><span class="co">]</span>$. Without loss of</span>
<span id="cb5-261"><a href="#cb5-261" aria-hidden="true" tabindex="-1"></a>generality, we can suppose that $V$ is constant on each</span>
<span id="cb5-262"><a href="#cb5-262" aria-hidden="true" tabindex="-1"></a>$[t_{j},t_{j+1})$ by refining the partition. We then have:</span>
<span id="cb5-263"><a href="#cb5-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-264"><a href="#cb5-264" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-265"><a href="#cb5-265" aria-hidden="true" tabindex="-1"></a>\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2} &amp; =\sum_{j=0}^{n-1}V(t_{j})^{2}(B(t_{j+1})-B(t_{j}))^{2}</span>
<span id="cb5-266"><a href="#cb5-266" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-267"><a href="#cb5-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-268"><a href="#cb5-268" aria-hidden="true" tabindex="-1"></a>Now, we have seen in the proof of Ito's formula that $\mathbb{E}\left<span class="co">[</span><span class="ot">\left\{ \sum_{j=0}^{n-1}V(t_{j})^{2}((B(t_{j+1})-B(t_{j}))^{2}-(t_{j+1}-t_{j})\right\} ^{2}\right</span><span class="co">]</span>\to 0$, so $\sum_{j=0}^{n-1}V(t_{j})^{2}(B(t_{j+1})-B(t_{j}))^{2}$ approaches $\sum_{j=0}^{n-1}V(t_{j})^{2}(t_{j+1}-t_{j})$ in the mean square sense. As the mesh size becomes finer, the $L^{2}$-limit is $\int_{0}^{t}V(t)^{2}dt$.</span>
<span id="cb5-269"><a href="#cb5-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-270"><a href="#cb5-270" aria-hidden="true" tabindex="-1"></a>The case $V\in\mathcal{L}_{c}^{2}(T)$ is proved by approximating $V$ by a simple process in $\mathcal{S}(T)$. More precisely, we can find a simple process $V^{(\epsilon)}(t)$ that is $\epsilon$-close to $V$ in the sense:</span>
<span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a>||I^{(\epsilon)}-I|| &amp; =||\int V^{\epsilon}dB(t)-\int VdB(t)||=\int_{0}^{t}\mathbb{E}<span class="co">[</span><span class="ot">(V^{(\epsilon)}(t)-V(t))^{2}</span><span class="co">]</span>ds&lt;\epsilon</span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-sequence-of-simple-processes}</span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a>To prove the claim, we need to show that for $t\leq T$,</span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-278"><a href="#cb5-278" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-279"><a href="#cb5-279" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\left<span class="co">[</span><span class="ot">\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-\int_{0}^{t}(V(s))^{2}ds\right|\right</span><span class="co">]</span> &amp; \to0\quad\text{as }\quad n\to\infty</span>
<span id="cb5-280"><a href="#cb5-280" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-281"><a href="#cb5-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-282"><a href="#cb5-282" aria-hidden="true" tabindex="-1"></a>$L^{1}$-convergence implies convergence in probability of the sequence</span>
<span id="cb5-283"><a href="#cb5-283" aria-hidden="true" tabindex="-1"></a>$\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}$. We now introduce the</span>
<span id="cb5-284"><a href="#cb5-284" aria-hidden="true" tabindex="-1"></a>$V^{(\epsilon)}(t)$ approximation inside the absolute value as well as</span>
<span id="cb5-285"><a href="#cb5-285" aria-hidden="true" tabindex="-1"></a>its corresponding integral</span>
<span id="cb5-286"><a href="#cb5-286" aria-hidden="true" tabindex="-1"></a>$I^{(\epsilon)}(t)=\int_{0}^{t}V^{(\epsilon)}(s)ds$. By the triangle</span>
<span id="cb5-287"><a href="#cb5-287" aria-hidden="true" tabindex="-1"></a>inequality, we have:</span>
<span id="cb5-288"><a href="#cb5-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-289"><a href="#cb5-289" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-290"><a href="#cb5-290" aria-hidden="true" tabindex="-1"></a> &amp; \mathbb{E}\left<span class="co">[</span><span class="ot">\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-\int_{0}^{t}(V(s))^{2}ds\right|\right</span><span class="co">]</span>\nonumber <span class="sc">\\</span></span>
<span id="cb5-291"><a href="#cb5-291" aria-hidden="true" tabindex="-1"></a>= &amp; \mathbb{E}\left[\Biggl|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}+(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}-\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds\right.\nonumber <span class="sc">\\</span></span>
<span id="cb5-292"><a href="#cb5-292" aria-hidden="true" tabindex="-1"></a> &amp; +\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\Biggr]\nonumber <span class="sc">\\</span></span>
<span id="cb5-293"><a href="#cb5-293" aria-hidden="true" tabindex="-1"></a>\leq &amp; \mathbb{E}\left<span class="co">[</span><span class="ot">\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}\right|\right</span><span class="co">]</span>+\mathbb{E}\left<span class="co">[</span><span class="ot">\left|\sum_{j=0}^{n-1}(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}-\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds\right|\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-294"><a href="#cb5-294" aria-hidden="true" tabindex="-1"></a> &amp; +\mathbb{E}\left<span class="co">[</span><span class="ot">\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\right</span><span class="co">]</span>\nonumber </span>
<span id="cb5-295"><a href="#cb5-295" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-quadratic-variation-of-ito-process-i}</span>
<span id="cb5-296"><a href="#cb5-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-297"><a href="#cb5-297" aria-hidden="true" tabindex="-1"></a>We show that the first and third terms converge uniformly and that the second term goes to $0$ as $n\to\infty$.</span>
<span id="cb5-298"><a href="#cb5-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a>The second term goes to $0$ as $n\to\infty$ by the argument for simple</span>
<span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a>processes.</span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-302"><a href="#cb5-302" aria-hidden="true" tabindex="-1"></a>$&lt;I^{(\epsilon)},I^{(\epsilon)}&gt;_{t}=\int_{0}^{t}V^{(\epsilon)}(s)^{2}ds$.</span>
<span id="cb5-303"><a href="#cb5-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-304"><a href="#cb5-304" aria-hidden="true" tabindex="-1"></a>For the third term, the linearity of the integral and the Cauchy Schwarz inequality (applied to $\mathbb{E}\int_{0}^{t}$) imply that it is:</span>
<span id="cb5-305"><a href="#cb5-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-306"><a href="#cb5-306" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-307"><a href="#cb5-307" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\left<span class="co">[</span><span class="ot">\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\right</span><span class="co">]</span> &amp; \leq\mathbb{E}\left<span class="co">[</span><span class="ot">\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s)-V(s))^{2}ds\Biggr|\right</span><span class="co">]</span>^{1/2}\mathbb{E}\left<span class="co">[</span><span class="ot">\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s)+V(s))^{2}ds\Biggr|\right</span><span class="co">]</span>^{1/2}</span>
<span id="cb5-308"><a href="#cb5-308" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-309"><a href="#cb5-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-310"><a href="#cb5-310" aria-hidden="true" tabindex="-1"></a>The first factor is smaller than the square root of $\epsilon$ by @eq-sequence-of-simple-processes, whereas the second factor is bounded.</span>
<span id="cb5-311"><a href="#cb5-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-312"><a href="#cb5-312" aria-hidden="true" tabindex="-1"></a>The first term in equation @eq-quadratic-variation-of-ito-process-i is handled similarly. The linearity of the Ito integral and the Cauchy-Schwarz inequality applied to $\mathbb{E}\left<span class="co">[</span><span class="ot">\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}\cdot\right)\right</span><span class="co">]</span>$ give that the first term is:</span>
<span id="cb5-313"><a href="#cb5-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-314"><a href="#cb5-314" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-315"><a href="#cb5-315" aria-hidden="true" tabindex="-1"></a> &amp; \mathbb{E}\left<span class="co">[</span><span class="ot">\left|\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}(V(s))^{2}dB(s)-\int_{t_{j}}^{t_{j+1}}(V^{\epsilon}(s))^{2}dB(s)\right|\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-316"><a href="#cb5-316" aria-hidden="true" tabindex="-1"></a>= &amp; \mathbb{E}\left<span class="co">[</span><span class="ot">\left|\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\int_{t_{j}}^{t_{j+1}}(V(s)+V^{\epsilon}(s))dB(s)\right|\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-317"><a href="#cb5-317" aria-hidden="true" tabindex="-1"></a>\leq &amp; \mathbb{E}\left<span class="co">[</span><span class="ot">\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\right</span><span class="co">]</span>^{1/2}\mathbb{E}\left<span class="co">[</span><span class="ot">\Biggl|\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)+V^{\epsilon}(s))dB(s)\right)^{2}\Biggr|\right</span><span class="co">]</span>^{1/2}</span>
<span id="cb5-318"><a href="#cb5-318" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-319"><a href="#cb5-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-320"><a href="#cb5-320" aria-hidden="true" tabindex="-1"></a>By Ito isometry, the first factor in the above expression can be</span>
<span id="cb5-321"><a href="#cb5-321" aria-hidden="true" tabindex="-1"></a>simplified:</span>
<span id="cb5-322"><a href="#cb5-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-323"><a href="#cb5-323" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-324"><a href="#cb5-324" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\left<span class="co">[</span><span class="ot">\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\right</span><span class="co">]</span>^{1/2} &amp; =\sum_{j=0}^{n-1}\mathbb{E}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}<span class="sc">\\</span></span>
<span id="cb5-325"><a href="#cb5-325" aria-hidden="true" tabindex="-1"></a> &amp; =\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}\mathbb{E}<span class="co">[</span><span class="ot">(V(s)-V^{\epsilon}(s))^{2}</span><span class="co">]</span>ds</span>
<span id="cb5-326"><a href="#cb5-326" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-327"><a href="#cb5-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-328"><a href="#cb5-328" aria-hidden="true" tabindex="-1"></a>By @eq-sequence-of-simple-processes, this factor is smaller than $\epsilon$. The second factor equals</span>
<span id="cb5-329"><a href="#cb5-329" aria-hidden="true" tabindex="-1"></a>$\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}\mathbb{E}<span class="co">[</span><span class="ot">(V(s)+V^{\epsilon}(s))^{2}</span><span class="co">]</span>ds$ by Ito-isometry and is uniformly bounded. This concludes the proof of</span>
<span id="cb5-330"><a href="#cb5-330" aria-hidden="true" tabindex="-1"></a>the proposition. $\blacksquare$</span>
<span id="cb5-331"><a href="#cb5-331" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-332"><a href="#cb5-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-333"><a href="#cb5-333" aria-hidden="true" tabindex="-1"></a>Note that quadratic variation $&lt;I,I&gt;_{t}=\int(V(s))^{2}ds$ is computed</span>
<span id="cb5-334"><a href="#cb5-334" aria-hidden="true" tabindex="-1"></a>path-by-path and hence the result is random. On the other the variance</span>
<span id="cb5-335"><a href="#cb5-335" aria-hidden="true" tabindex="-1"></a>of the Ito integral $Var(I(t))=\mathbb{E}<span class="co">[</span><span class="ot">I_{t}^{2}</span><span class="co">]</span>=\int\mathbb{E}<span class="co">[</span><span class="ot">V_{s}^{2}</span><span class="co">]</span>ds$ is the</span>
<span id="cb5-336"><a href="#cb5-336" aria-hidden="true" tabindex="-1"></a>mean value of all possible paths of the quadratic variation and hence is</span>
<span id="cb5-337"><a href="#cb5-337" aria-hidden="true" tabindex="-1"></a>non-random. We are now ready to state Ito's formula for Ito processes.</span>
<span id="cb5-338"><a href="#cb5-338" aria-hidden="true" tabindex="-1"></a>We write the result in differential form for conciseness.</span>
<span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a>::: {#thm-ito-formula-for-ito-processes}</span>
<span id="cb5-341"><a href="#cb5-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-342"><a href="#cb5-342" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ito's formula for Ito processes </span></span>
<span id="cb5-343"><a href="#cb5-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-344"><a href="#cb5-344" aria-hidden="true" tabindex="-1"></a>Let $(B(t):t\geq0)$ be a standard brownian motion, and let $(X(t):t\geq0)$ be an Ito process of</span>
<span id="cb5-345"><a href="#cb5-345" aria-hidden="true" tabindex="-1"></a>the form $dX(t)=V(t)dB(t)+D(t)dt$. Consider a function</span>
<span id="cb5-346"><a href="#cb5-346" aria-hidden="true" tabindex="-1"></a>$f(t,x)\in\mathcal{C}^{1,2}(<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>\times\mathbf{R})$. Then we have with</span>
<span id="cb5-347"><a href="#cb5-347" aria-hidden="true" tabindex="-1"></a>probability one for all $t\leq T$:*</span>
<span id="cb5-348"><a href="#cb5-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-349"><a href="#cb5-349" aria-hidden="true" tabindex="-1"></a>*$$\begin{aligned}</span>
<span id="cb5-350"><a href="#cb5-350" aria-hidden="true" tabindex="-1"></a>df(t,X(t)) &amp; =\partial_{x}f(t,X(t))dX(t)+\partial_{t}f(t,X(t))dt+\frac{1}{2}\partial_{xx}f(t,X(t))d&lt;X,X&gt;_{t}</span>
<span id="cb5-351"><a href="#cb5-351" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$*</span>
<span id="cb5-352"><a href="#cb5-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-353"><a href="#cb5-353" aria-hidden="true" tabindex="-1"></a>*This can also be written as:*</span>
<span id="cb5-354"><a href="#cb5-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-355"><a href="#cb5-355" aria-hidden="true" tabindex="-1"></a>*$$\begin{aligned}</span>
<span id="cb5-356"><a href="#cb5-356" aria-hidden="true" tabindex="-1"></a>df(t,X(t))= &amp; \partial_{x}f(t,X(t))V(t)dB(t)+\left<span class="co">[</span><span class="ot">\partial_{x}f(t,X(t))D(t)+\partial_{t}f(t,X(t))+\frac{1}{2}(V(t))^{2}\partial_{xx}f(t,X(t))\right</span><span class="co">]</span>dt</span>
<span id="cb5-357"><a href="#cb5-357" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$*</span>
<span id="cb5-358"><a href="#cb5-358" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-359"><a href="#cb5-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-360"><a href="#cb5-360" aria-hidden="true" tabindex="-1"></a>The proof of the @thm-ito-formula-for-ito-processes is again a Taylor approximation with the form of the quadratic variation of the process.</span>
<span id="cb5-361"><a href="#cb5-361" aria-hidden="true" tabindex="-1"></a>We will omit it.</span>
<span id="cb5-362"><a href="#cb5-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-363"><a href="#cb5-363" aria-hidden="true" tabindex="-1"></a>::: {#exm-ornstein-uhlenbeck-process}</span>
<span id="cb5-364"><a href="#cb5-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a>(Ornstein-Uhlenbeck Process). Consider the Ornstein-Uhlenbeck process $(Y(t):t\geq0)$:</span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a>Y(t) &amp; =Y(0)e^{-t}+e^{-t}\int_{0}^{t}e^{s}dB(s)</span>
<span id="cb5-369"><a href="#cb5-369" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-370"><a href="#cb5-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-371"><a href="#cb5-371" aria-hidden="true" tabindex="-1"></a>Note that this process is an explicit function of $t$ and of the Ito</span>
<span id="cb5-372"><a href="#cb5-372" aria-hidden="true" tabindex="-1"></a>process $X(t)=Y(0)+\int_{0}^{t}e^{s}dB(s)$. Indeed, we have:</span>
<span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a>Y(t) &amp; =e^{-t}X(t)</span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a>Let $f(t,x)=e^{-t}x$. Then, $f_{x}(t,x)=e^{-t}$, $f_{xx}(t,x)=0$ and</span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a>$f_{t}(t,x)=-e^{-t}x$. So, by Ito's lemma,</span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a>df(t,x) &amp; =f_{t}(t,X(t))dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\nonumber <span class="sc">\\</span></span>
<span id="cb5-383"><a href="#cb5-383" aria-hidden="true" tabindex="-1"></a>dY(t) &amp; =-Y(t)dt+e^{-t}dX(t)\nonumber <span class="sc">\\</span></span>
<span id="cb5-384"><a href="#cb5-384" aria-hidden="true" tabindex="-1"></a>dY(t) &amp; =-Y(t)dt+e^{-t}(e^{t}dB(t))\nonumber <span class="sc">\\</span></span>
<span id="cb5-385"><a href="#cb5-385" aria-hidden="true" tabindex="-1"></a>dY(t) &amp; =-Y(t)dt+dB(t)</span>
<span id="cb5-386"><a href="#cb5-386" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-ornstein-uhlenbeck-sde}</span>
<span id="cb5-387"><a href="#cb5-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-388"><a href="#cb5-388" aria-hidden="true" tabindex="-1"></a>This is the SDE for the Ornstein Uhlenbeck process.</span>
<span id="cb5-389"><a href="#cb5-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-390"><a href="#cb5-390" aria-hidden="true" tabindex="-1"></a>The SDE has a very nice interpretation: The drift is positive if</span>
<span id="cb5-391"><a href="#cb5-391" aria-hidden="true" tabindex="-1"></a>$Y(t)&lt;0$ and negative if $Y(t)&gt;0$. Moreover, the drift is proportional</span>
<span id="cb5-392"><a href="#cb5-392" aria-hidden="true" tabindex="-1"></a>to the position (exactly like a spring pulling the process back to the</span>
<span id="cb5-393"><a href="#cb5-393" aria-hidden="true" tabindex="-1"></a>$x$-axis following the Hooke's law!). This is the mechanism that ensures</span>
<span id="cb5-394"><a href="#cb5-394" aria-hidden="true" tabindex="-1"></a>that the process does not venture too far from $0$ and is eventually</span>
<span id="cb5-395"><a href="#cb5-395" aria-hidden="true" tabindex="-1"></a>stationary.</span>
<span id="cb5-396"><a href="#cb5-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-397"><a href="#cb5-397" aria-hidden="true" tabindex="-1"></a>The SDE @eq-ornstein-uhlenbeck-sde is now easily generalized by adding two parameters for the volatility and the drift:</span>
<span id="cb5-398"><a href="#cb5-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-399"><a href="#cb5-399" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-400"><a href="#cb5-400" aria-hidden="true" tabindex="-1"></a>dY(t) &amp; =-kY(t)dt+\sigma dB(t),\quad k\in\mathbf{R},\sigma&gt;0</span>
<span id="cb5-401"><a href="#cb5-401" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-ornstein-uhlenbeck-sde-ii}</span>
<span id="cb5-402"><a href="#cb5-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-403"><a href="#cb5-403" aria-hidden="true" tabindex="-1"></a>It is not hard to check that the solution to the SDE is:</span>
<span id="cb5-404"><a href="#cb5-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-405"><a href="#cb5-405" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-406"><a href="#cb5-406" aria-hidden="true" tabindex="-1"></a>Y(t) &amp; =Y(0)e^{-kt}+e^{-kt}\int_{0}^{t}e^{ks}\sigma dB(s)</span>
<span id="cb5-407"><a href="#cb5-407" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-solution-to-the-ornstein-uhlenbeck-sde}</span>
<span id="cb5-408"><a href="#cb5-408" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-409"><a href="#cb5-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-410"><a href="#cb5-410" aria-hidden="true" tabindex="-1"></a>::: {#exr-the-ornstein-uhlenbeck-process-with-parameters}</span>
<span id="cb5-411"><a href="#cb5-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-412"><a href="#cb5-412" aria-hidden="true" tabindex="-1"></a>The Ornstein-Uhlenbeck process with parameters. Use the Ito's formula to show that the @eq-solution-to-the-ornstein-uhlenbeck-sde is the solution</span>
<span id="cb5-413"><a href="#cb5-413" aria-hidden="true" tabindex="-1"></a>to the Ornstein-Uhlenbeck SDE @eq-ornstein-uhlenbeck-sde-ii.</span>
<span id="cb5-414"><a href="#cb5-414" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a>*Solution.*</span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a>Let $X(t)=Y(0)+\int_{0}^{t}e^{ks}\sigma dB(s)$, so</span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a>$dX(t)=e^{kt}\sigma dB(t)$. Then, $Y(t)=e^{-kt}X(t)$. Let</span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a>$f(t,x)=e^{-kt}x$. Then, by Ito's formula:  </span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a>df(t,x) &amp; =-ke^{-kt}X(t)dt+e^{-kt}dX(t)<span class="sc">\\</span></span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a>dY(t) &amp; =-kY(t)dt+e^{-kt}e^{kt}\sigma dB(t)<span class="sc">\\</span></span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a>dY(t) &amp; =-kY(t)dt+\sigma dB(t)</span>
<span id="cb5-426"><a href="#cb5-426" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-427"><a href="#cb5-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-428"><a href="#cb5-428" aria-hidden="true" tabindex="-1"></a>The latest version of Ito's formula is another useful tool for producing</span>
<span id="cb5-429"><a href="#cb5-429" aria-hidden="true" tabindex="-1"></a>martingales from a function of an Ito process. We start with two</span>
<span id="cb5-430"><a href="#cb5-430" aria-hidden="true" tabindex="-1"></a>examples generalizing martingales for Brownian motion.</span>
<span id="cb5-431"><a href="#cb5-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-432"><a href="#cb5-432" aria-hidden="true" tabindex="-1"></a>::: {#exm-generalization-of-bt2-t}</span>
<span id="cb5-433"><a href="#cb5-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-434"><a href="#cb5-434" aria-hidden="true" tabindex="-1"></a>(A generalization of $(B(t))^{2}-t$). Let $(V(t):t\leq T)$ be a</span>
<span id="cb5-435"><a href="#cb5-435" aria-hidden="true" tabindex="-1"></a>process in $\mathcal{L}_{c}^{2}(T)$. Consider an Ito process</span>
<span id="cb5-436"><a href="#cb5-436" aria-hidden="true" tabindex="-1"></a>$(X(t):t\leq T)$ given by $dX(t)=V(t)dB(t)$. Note that</span>
<span id="cb5-437"><a href="#cb5-437" aria-hidden="true" tabindex="-1"></a>$((X(t))^{2}:t\leq T)$ is a submartingale by Jensen's inequality, since</span>
<span id="cb5-438"><a href="#cb5-438" aria-hidden="true" tabindex="-1"></a>$\mathbb{E}<span class="co">[</span><span class="ot">X^{2}(t)|\mathcal{F}_{s}</span><span class="co">]</span>\geq(\mathbb{E}[X(t)|\mathcal{F}_{s})^{2}=X^{2}(s)$.</span>
<span id="cb5-439"><a href="#cb5-439" aria-hidden="true" tabindex="-1"></a>We show that the compensated process</span>
<span id="cb5-440"><a href="#cb5-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-441"><a href="#cb5-441" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-442"><a href="#cb5-442" aria-hidden="true" tabindex="-1"></a>M(t) &amp; =X^{2}(t)-\int_{0}^{t}V^{2}(s)ds,\quad t\leq T</span>
<span id="cb5-443"><a href="#cb5-443" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-444"><a href="#cb5-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-445"><a href="#cb5-445" aria-hidden="true" tabindex="-1"></a>is a martingale for the Brownian filtration. (This is another instance</span>
<span id="cb5-446"><a href="#cb5-446" aria-hidden="true" tabindex="-1"></a>of the Doob-Meyer decomposition). By the Ito's formula for $f(x)=x^{2}$,</span>
<span id="cb5-447"><a href="#cb5-447" aria-hidden="true" tabindex="-1"></a>we have:</span>
<span id="cb5-448"><a href="#cb5-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-449"><a href="#cb5-449" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-450"><a href="#cb5-450" aria-hidden="true" tabindex="-1"></a>df(x) &amp; =f_{x}(X(t)dX(t)+\frac{1}{2}f_{xx}(X(t))d&lt;X,X&gt;_{t}<span class="sc">\\</span></span>
<span id="cb5-451"><a href="#cb5-451" aria-hidden="true" tabindex="-1"></a> &amp; =2X(t)dX(t)+(V(t))^{2}dt<span class="sc">\\</span></span>
<span id="cb5-452"><a href="#cb5-452" aria-hidden="true" tabindex="-1"></a>df(X(t)) &amp; =2X(t)V(t)dB(t)+(V(t))^{2}dt</span>
<span id="cb5-453"><a href="#cb5-453" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-454"><a href="#cb5-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-455"><a href="#cb5-455" aria-hidden="true" tabindex="-1"></a>In Integral form this implies:</span>
<span id="cb5-456"><a href="#cb5-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-457"><a href="#cb5-457" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-458"><a href="#cb5-458" aria-hidden="true" tabindex="-1"></a>(X(t))^{2} &amp; =(X(0))^{2}+2\int_{0}^{t}X(s)V(s)dB(s)+\int_{0}^{t}(V(s))^{2}ds<span class="sc">\\</span></span>
<span id="cb5-459"><a href="#cb5-459" aria-hidden="true" tabindex="-1"></a>M(t)=(X(t))^{2}-\int_{0}^{t}(V(s))^{2}ds &amp; =(X(0))^{2}+2\int_{0}^{t}X(s)V(s)dB(s)</span>
<span id="cb5-460"><a href="#cb5-460" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-461"><a href="#cb5-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-462"><a href="#cb5-462" aria-hidden="true" tabindex="-1"></a>We conclude that $(M(t):t\leq T)$ is a martingale, provided</span>
<span id="cb5-463"><a href="#cb5-463" aria-hidden="true" tabindex="-1"></a>$X(t)V(t)\in L_{c}^{2}(T)$.</span>
<span id="cb5-464"><a href="#cb5-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-465"><a href="#cb5-465" aria-hidden="true" tabindex="-1"></a>There is another more direct way to prove that $(M(t):t\leq T)$ is a</span>
<span id="cb5-466"><a href="#cb5-466" aria-hidden="true" tabindex="-1"></a>martingale whenever $(V(t):t\leq T)\in\mathcal{L}_{c}^{2}(T)$. This is</span>
<span id="cb5-467"><a href="#cb5-467" aria-hidden="true" tabindex="-1"></a>by using increments: for $t'&lt;t\leq T$,</span>
<span id="cb5-468"><a href="#cb5-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-469"><a href="#cb5-469" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-470"><a href="#cb5-470" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">X_{t'}^{2}|\mathcal{F}_{t}</span><span class="co">]</span> &amp; =\mathbb{E}<span class="co">[</span><span class="ot">(X_{t}+(X_{t'}-X_{t}))^{2}|\mathcal{F}_{t}</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-471"><a href="#cb5-471" aria-hidden="true" tabindex="-1"></a> &amp; =\mathbb{E}<span class="co">[</span><span class="ot">X_{t}^{2}+2X_{t}(X_{t'}-X_{t})+(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-472"><a href="#cb5-472" aria-hidden="true" tabindex="-1"></a> &amp; =X_{t}^{2}+2X_{t}\mathbb{E}<span class="co">[</span><span class="ot">X_{t'}-X_{t}|\mathcal{F}_{t}</span><span class="co">]</span>+\mathbb{E}<span class="co">[</span><span class="ot">(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}</span><span class="co">]</span></span>
<span id="cb5-473"><a href="#cb5-473" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-474"><a href="#cb5-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-475"><a href="#cb5-475" aria-hidden="true" tabindex="-1"></a>Since $(X_{t}:t\geq0)$ is a martingale,</span>
<span id="cb5-476"><a href="#cb5-476" aria-hidden="true" tabindex="-1"></a>$\mathbb{E}<span class="co">[</span><span class="ot">(X_{t'}-X_{t})|M_{t}</span><span class="co">]</span>=0$, so the middle term equals zero and</span>
<span id="cb5-477"><a href="#cb5-477" aria-hidden="true" tabindex="-1"></a>we are left with:</span>
<span id="cb5-478"><a href="#cb5-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-479"><a href="#cb5-479" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-480"><a href="#cb5-480" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">X_{t'}^{2}|\mathcal{F}_{t}</span><span class="co">]</span> &amp; =X_{t}^{2}+\mathbb{E}<span class="co">[</span><span class="ot">(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}</span><span class="co">]</span></span>
<span id="cb5-481"><a href="#cb5-481" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-482"><a href="#cb5-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-483"><a href="#cb5-483" aria-hidden="true" tabindex="-1"></a>By conditional Ito Isometry,</span>
<span id="cb5-484"><a href="#cb5-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-485"><a href="#cb5-485" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-486"><a href="#cb5-486" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}</span><span class="co">]</span> &amp; =\int_{0}^{t'}V_{s}^{2}ds-\int_{0}^{t}V_{s}^{2}ds=\int_{t}^{t'}V_{s}^{2}ds</span>
<span id="cb5-487"><a href="#cb5-487" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-488"><a href="#cb5-488" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-489"><a href="#cb5-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-490"><a href="#cb5-490" aria-hidden="true" tabindex="-1"></a>::: {#exm-generalization-of-gbm} </span>
<span id="cb5-491"><a href="#cb5-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-492"><a href="#cb5-492" aria-hidden="true" tabindex="-1"></a>(A generalization of the geometric Brownian motion). Let</span>
<span id="cb5-493"><a href="#cb5-493" aria-hidden="true" tabindex="-1"></a>$\sigma(t)$ be a continuous, deterministic function such that</span>
<span id="cb5-494"><a href="#cb5-494" aria-hidden="true" tabindex="-1"></a>$|\sigma(t)|\leq1$, $t\in<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$. The process</span>
<span id="cb5-495"><a href="#cb5-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-496"><a href="#cb5-496" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-497"><a href="#cb5-497" aria-hidden="true" tabindex="-1"></a>M(t) &amp; =\exp\left(\int_{0}^{t}\sigma(s)dB(s)-\frac{1}{2}\int_{0}^{t}\sigma^{2}(s)ds\right),\quad t\leq T</span>
<span id="cb5-498"><a href="#cb5-498" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-499"><a href="#cb5-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-500"><a href="#cb5-500" aria-hidden="true" tabindex="-1"></a>is a martingale for the Brownian filtration. To see this, note that we</span>
<span id="cb5-501"><a href="#cb5-501" aria-hidden="true" tabindex="-1"></a>can write $M(t)=f(t,X(t))$ where</span>
<span id="cb5-502"><a href="#cb5-502" aria-hidden="true" tabindex="-1"></a>$f(t,x)=\exp(x-\frac{1}{2}\int\sigma^{2}(s)ds)$ and</span>
<span id="cb5-503"><a href="#cb5-503" aria-hidden="true" tabindex="-1"></a>$X(t)=\int_{0}^{t}\sigma(s)dB(s)$, so $dX(t)=\sigma(t)dB(t)$. Ito's</span>
<span id="cb5-504"><a href="#cb5-504" aria-hidden="true" tabindex="-1"></a>formula gives:</span>
<span id="cb5-505"><a href="#cb5-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-506"><a href="#cb5-506" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-507"><a href="#cb5-507" aria-hidden="true" tabindex="-1"></a>df(t,x) &amp; =f_{t}(t,X(t)dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}<span class="sc">\\</span></span>
<span id="cb5-508"><a href="#cb5-508" aria-hidden="true" tabindex="-1"></a>dM(t) &amp; =-\frac{1}{2}\sigma^{2}(t)M(t)dt+M(t)\sigma(t)dB(t)+\frac{1}{2}M(t)\sigma^{2}(t)dt<span class="sc">\\</span></span>
<span id="cb5-509"><a href="#cb5-509" aria-hidden="true" tabindex="-1"></a> &amp; =M(t)\sigma(t)dB(t)<span class="sc">\\</span></span>
<span id="cb5-510"><a href="#cb5-510" aria-hidden="true" tabindex="-1"></a>M(t) &amp; =M(0)+\int_{0}^{t}M(s)\sigma(s)dB(s)</span>
<span id="cb5-511"><a href="#cb5-511" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-512"><a href="#cb5-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-513"><a href="#cb5-513" aria-hidden="true" tabindex="-1"></a>Observe also that:</span>
<span id="cb5-514"><a href="#cb5-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-515"><a href="#cb5-515" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-516"><a href="#cb5-516" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">M_{t}^{2}</span><span class="co">]</span> &amp; =e^{-\int_{0}^{t}\sigma^{2}(s)ds}\mathbb{E}<span class="co">[</span><span class="ot">e^{2\int_{0}^{t}\sigma(s)dB(s)}</span><span class="co">]</span>=e^{\int_{0}^{t}\sigma^{2}(s)ds}</span>
<span id="cb5-517"><a href="#cb5-517" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-518"><a href="#cb5-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-519"><a href="#cb5-519" aria-hidden="true" tabindex="-1"></a>since $\int_{0}^{t}\sigma(s)dB(s)$ is a Gaussian random variable with</span>
<span id="cb5-520"><a href="#cb5-520" aria-hidden="true" tabindex="-1"></a>mean $0$ and variance $\int_{0}^{t}\sigma^{2}(s)ds$.</span>
<span id="cb5-521"><a href="#cb5-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-522"><a href="#cb5-522" aria-hidden="true" tabindex="-1"></a>We conclude from the equation that $(M(t),t\geq0)$ is a martingale.</span>
<span id="cb5-523"><a href="#cb5-523" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-524"><a href="#cb5-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-525"><a href="#cb5-525" aria-hidden="true" tabindex="-1"></a>::: {#exm-martingales-of-gbm}</span>
<span id="cb5-526"><a href="#cb5-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-527"><a href="#cb5-527" aria-hidden="true" tabindex="-1"></a>(Martingales of Geometric Brownian Motion). Let</span>
<span id="cb5-528"><a href="#cb5-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-529"><a href="#cb5-529" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-530"><a href="#cb5-530" aria-hidden="true" tabindex="-1"></a>S(t) &amp; =S(0)\exp(\sigma B(t)-\sigma^{2}t/2)</span>
<span id="cb5-531"><a href="#cb5-531" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-532"><a href="#cb5-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-533"><a href="#cb5-533" aria-hidden="true" tabindex="-1"></a>be a geometric brownian motion. We find a PDE satisfied by $f(t,x)$ for</span>
<span id="cb5-534"><a href="#cb5-534" aria-hidden="true" tabindex="-1"></a>$f(t,S(t))$ to be a martingale. It suffices to apply Ito's formula of @thm-ito-formula-for-ito-processes. We get:</span>
<span id="cb5-535"><a href="#cb5-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-536"><a href="#cb5-536" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-537"><a href="#cb5-537" aria-hidden="true" tabindex="-1"></a>df(t,S(t)) &amp; =f_{t}(t,S(t))dt+f_{x}(t,S(t))dS(t)+\frac{1}{2}f_{xx}(t,S(t))dS(t)\cdot dS(t)</span>
<span id="cb5-538"><a href="#cb5-538" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-539"><a href="#cb5-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-540"><a href="#cb5-540" aria-hidden="true" tabindex="-1"></a>Now note from the earlier result that $dS(t)=S(t)\sigma dB(t)$. So,</span>
<span id="cb5-541"><a href="#cb5-541" aria-hidden="true" tabindex="-1"></a>$dS(t)\cdot dS(t)=\frac{1}{2}\sigma^{2}(S(t))^{2}dt$. So,</span>
<span id="cb5-542"><a href="#cb5-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-543"><a href="#cb5-543" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-544"><a href="#cb5-544" aria-hidden="true" tabindex="-1"></a>df(t,S(t)) &amp; =\left<span class="sc">\{</span> \frac{\partial f}{\partial t}+\frac{1}{2}\sigma^{2}(S(t))^{2}\frac{\partial^{2}f}{\partial x^{2}}\right<span class="sc">\}</span> dt+\sigma S(t)\frac{\partial f}{\partial x}dB(t)</span>
<span id="cb5-545"><a href="#cb5-545" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-546"><a href="#cb5-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-547"><a href="#cb5-547" aria-hidden="true" tabindex="-1"></a>Finally, the PDE for $f(t,x)$ is obtained by setting the factor in front</span>
<span id="cb5-548"><a href="#cb5-548" aria-hidden="true" tabindex="-1"></a>of $dt$ to $0$, because we want $f$ to be a martingale process. It is</span>
<span id="cb5-549"><a href="#cb5-549" aria-hidden="true" tabindex="-1"></a>important to keep in mind, that the PDE should always be written in</span>
<span id="cb5-550"><a href="#cb5-550" aria-hidden="true" tabindex="-1"></a>terms of the time variable $t$ and the space variable $x$. Therefore,</span>
<span id="cb5-551"><a href="#cb5-551" aria-hidden="true" tabindex="-1"></a>the PDE of $f$ as a function of time and space is:</span>
<span id="cb5-552"><a href="#cb5-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-553"><a href="#cb5-553" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-554"><a href="#cb5-554" aria-hidden="true" tabindex="-1"></a>\frac{1}{2}\sigma^{2}x^{2}\frac{\partial^{2}f}{\partial x^{2}}(t,x)+\frac{\partial f}{\partial t}(t,x) &amp; =0</span>
<span id="cb5-555"><a href="#cb5-555" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-556"><a href="#cb5-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-557"><a href="#cb5-557" aria-hidden="true" tabindex="-1"></a>No more randomness appears in the PDE!</span>
<span id="cb5-558"><a href="#cb5-558" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-559"><a href="#cb5-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-560"><a href="#cb5-560" aria-hidden="true" tabindex="-1"></a>Here is a specific case where we can apply the Ito's formula to</span>
<span id="cb5-561"><a href="#cb5-561" aria-hidden="true" tabindex="-1"></a>construct martingales of Ito processes.</span>
<span id="cb5-562"><a href="#cb5-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-563"><a href="#cb5-563" aria-hidden="true" tabindex="-1"></a>::: {#exm-martingale-1}</span>
<span id="cb5-564"><a href="#cb5-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-565"><a href="#cb5-565" aria-hidden="true" tabindex="-1"></a>Consider the process given by the SDE:</span>
<span id="cb5-566"><a href="#cb5-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-567"><a href="#cb5-567" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-568"><a href="#cb5-568" aria-hidden="true" tabindex="-1"></a>dX(t) &amp; =X(t)dB(t),\quad X(0)=2</span>
<span id="cb5-569"><a href="#cb5-569" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-570"><a href="#cb5-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-571"><a href="#cb5-571" aria-hidden="true" tabindex="-1"></a>Let's find a PDE for which $f(t,X(t))$ is a martingale for the Brownian</span>
<span id="cb5-572"><a href="#cb5-572" aria-hidden="true" tabindex="-1"></a>filtration. We have by Ito's formula that:</span>
<span id="cb5-573"><a href="#cb5-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-574"><a href="#cb5-574" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-575"><a href="#cb5-575" aria-hidden="true" tabindex="-1"></a>df(t,X(t)) &amp; =f_{t}(t,X(t))dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}<span class="sc">\\</span></span>
<span id="cb5-576"><a href="#cb5-576" aria-hidden="true" tabindex="-1"></a> &amp; =\left(\frac{\partial f}{\partial t}+\frac{1}{2}(X(t))^{2}\frac{\partial^{2}f}{\partial x^{2}}\right)dt+X(t)\frac{\partial f}{\partial x}dB(t)</span>
<span id="cb5-577"><a href="#cb5-577" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-578"><a href="#cb5-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-579"><a href="#cb5-579" aria-hidden="true" tabindex="-1"></a>Setting the drift term to $0$ gives the PDE:</span>
<span id="cb5-580"><a href="#cb5-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-581"><a href="#cb5-581" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-582"><a href="#cb5-582" aria-hidden="true" tabindex="-1"></a>\frac{\partial f}{\partial t}+\frac{1}{2}x^{2}\frac{\partial^{2}f}{\partial x^{2}} &amp; =0</span>
<span id="cb5-583"><a href="#cb5-583" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-584"><a href="#cb5-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-585"><a href="#cb5-585" aria-hidden="true" tabindex="-1"></a>It is then easy to check that $X(t)$ is a martingale and so is</span>
<span id="cb5-586"><a href="#cb5-586" aria-hidden="true" tabindex="-1"></a>$t+\log(X(t))^{2}$, since the functions $f(t,x)=x$ and</span>
<span id="cb5-587"><a href="#cb5-587" aria-hidden="true" tabindex="-1"></a>$f(t,x)=t+\log x^{2}$ satisfy the PDE. However, the process $tX(t)$ is</span>
<span id="cb5-588"><a href="#cb5-588" aria-hidden="true" tabindex="-1"></a>not, as the function $f(t,x)=xt$ is not a solution of the PDE.</span>
<span id="cb5-589"><a href="#cb5-589" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-590"><a href="#cb5-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-591"><a href="#cb5-591" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multivariate Extension.</span></span>
<span id="cb5-592"><a href="#cb5-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-593"><a href="#cb5-593" aria-hidden="true" tabindex="-1"></a>Ito's formula can be generalized to several Ito processes. Let's start</span>
<span id="cb5-594"><a href="#cb5-594" aria-hidden="true" tabindex="-1"></a>by stating an example of a function of two Ito processes. Such a</span>
<span id="cb5-595"><a href="#cb5-595" aria-hidden="true" tabindex="-1"></a>function $f(x_{1},x_{2})$ will be a function of two space variables. Not</span>
<span id="cb5-596"><a href="#cb5-596" aria-hidden="true" tabindex="-1"></a>surprisingly, it needs to have two derivatives in each variable and they</span>
<span id="cb5-597"><a href="#cb5-597" aria-hidden="true" tabindex="-1"></a>need to be a continuous function; we need</span>
<span id="cb5-598"><a href="#cb5-598" aria-hidden="true" tabindex="-1"></a>$f\in\mathcal{C}^{2\times2}(\mathbf{R}\times\mathbf{R})$.</span>
<span id="cb5-599"><a href="#cb5-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-600"><a href="#cb5-600" aria-hidden="true" tabindex="-1"></a>::: {#thm-ito-formula-for-many-ito-processes}</span>
<span id="cb5-601"><a href="#cb5-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-602"><a href="#cb5-602" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ito's formula for many Ito processes </span></span>
<span id="cb5-603"><a href="#cb5-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-604"><a href="#cb5-604" aria-hidden="true" tabindex="-1"></a>Let $(X(t):t\geq0)$ and (Y(t):t\geq0)$ be two Ito processes of the form:</span>
<span id="cb5-605"><a href="#cb5-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-606"><a href="#cb5-606" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-607"><a href="#cb5-607" aria-hidden="true" tabindex="-1"></a>dX(t) &amp; =V(t)dB(t)+D(t)dt\nonumber <span class="sc">\\</span></span>
<span id="cb5-608"><a href="#cb5-608" aria-hidden="true" tabindex="-1"></a>dY(t) &amp; =U(t)dB(t)+R(t)dt</span>
<span id="cb5-609"><a href="#cb5-609" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-two-ito-processes}</span>
<span id="cb5-610"><a href="#cb5-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-611"><a href="#cb5-611" aria-hidden="true" tabindex="-1"></a>where $(B(t):t\geq0)$ is a standard Brownian motion. Then, for</span>
<span id="cb5-612"><a href="#cb5-612" aria-hidden="true" tabindex="-1"></a>$f\in\mathcal{C}^{2\times2}(\mathbf{R}\times\mathbf{R})$, we have:</span>
<span id="cb5-613"><a href="#cb5-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-614"><a href="#cb5-614" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-615"><a href="#cb5-615" aria-hidden="true" tabindex="-1"></a>df(X(t),Y(t)) &amp; =f_{x}(X(t),Y(t))dX(t)+f_{y}(X(t),Y(t))dY(t)+\frac{1}{2}f_{xx}(X(t),Y(t))d&lt;X,X&gt;_{t}<span class="sc">\\</span></span>
<span id="cb5-616"><a href="#cb5-616" aria-hidden="true" tabindex="-1"></a> &amp; +f_{xy}(X(t),Y(t))d&lt;X,Y&gt;_{t}+\frac{1}{2}f_{yy}(X(t),Y(t))d&lt;Y,Y&gt;_{t}</span>
<span id="cb5-617"><a href="#cb5-617" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-618"><a href="#cb5-618" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-619"><a href="#cb5-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-620"><a href="#cb5-620" aria-hidden="true" tabindex="-1"></a>The idea of the proof is the same as in @thm-ito-formula-for-ito-processes : Taylor's expansion and</span>
<span id="cb5-621"><a href="#cb5-621" aria-hidden="true" tabindex="-1"></a>quadratic variation, together with the cross-variation of two processes.</span>
<span id="cb5-622"><a href="#cb5-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-623"><a href="#cb5-623" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-624"><a href="#cb5-624" aria-hidden="true" tabindex="-1"></a>dX(t)\cdot dY(t) &amp; =(V(t)dB(t)+D(t)dt)(U(t)dB(t)+R(t)dt)<span class="sc">\\</span></span>
<span id="cb5-625"><a href="#cb5-625" aria-hidden="true" tabindex="-1"></a> &amp; =U(t)V(t)dt</span>
<span id="cb5-626"><a href="#cb5-626" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-627"><a href="#cb5-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-628"><a href="#cb5-628" aria-hidden="true" tabindex="-1"></a>::: {#exm-product-rule}</span>
<span id="cb5-629"><a href="#cb5-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-630"><a href="#cb5-630" aria-hidden="true" tabindex="-1"></a>(Product Rule) An important example of this formula is Ito's</span>
<span id="cb5-631"><a href="#cb5-631" aria-hidden="true" tabindex="-1"></a>product rule. Let $X(t)$ and $Y(t)$ be as in @eq-two-ito-processes. Then:</span>
<span id="cb5-632"><a href="#cb5-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-633"><a href="#cb5-633" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-634"><a href="#cb5-634" aria-hidden="true" tabindex="-1"></a>d(X(t)Y(t)) &amp; =Y(t)dX(t)+X(t)dY(t)+dX(t)\cdot dY(t)</span>
<span id="cb5-635"><a href="#cb5-635" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-636"><a href="#cb5-636" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-637"><a href="#cb5-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-638"><a href="#cb5-638" aria-hidden="true" tabindex="-1"></a>::: {#exr-a-riemann-integral}</span>
<span id="cb5-639"><a href="#cb5-639" aria-hidden="true" tabindex="-1"></a>Let $(\Omega,\mathcal{F},\mathbb{P})$ be a probability space</span>
<span id="cb5-640"><a href="#cb5-640" aria-hidden="true" tabindex="-1"></a>and let $(B_{t}:t\geq0)$ be a standard brownian motion. Using</span>
<span id="cb5-641"><a href="#cb5-641" aria-hidden="true" tabindex="-1"></a>integration by parts, show that</span>
<span id="cb5-642"><a href="#cb5-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-643"><a href="#cb5-643" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-644"><a href="#cb5-644" aria-hidden="true" tabindex="-1"></a>\int_{0}^{t}B(s)ds &amp; =\int_{0}^{t}(t-s)dB(s)</span>
<span id="cb5-645"><a href="#cb5-645" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-646"><a href="#cb5-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-647"><a href="#cb5-647" aria-hidden="true" tabindex="-1"></a>and prove that $\int_{0}^{t}B(s)ds\sim\mathcal{N}(0,t^{3}/3)$.</span>
<span id="cb5-648"><a href="#cb5-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-649"><a href="#cb5-649" aria-hidden="true" tabindex="-1"></a>Is</span>
<span id="cb5-650"><a href="#cb5-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-651"><a href="#cb5-651" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-652"><a href="#cb5-652" aria-hidden="true" tabindex="-1"></a>X(t) &amp; =\begin{cases}</span>
<span id="cb5-653"><a href="#cb5-653" aria-hidden="true" tabindex="-1"></a>0 &amp; t=0<span class="sc">\\</span></span>
<span id="cb5-654"><a href="#cb5-654" aria-hidden="true" tabindex="-1"></a>\frac{\sqrt{3}}{t}\int_{0}^{t}B(s)ds &amp; t&gt;0</span>
<span id="cb5-655"><a href="#cb5-655" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb5-656"><a href="#cb5-656" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-657"><a href="#cb5-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-658"><a href="#cb5-658" aria-hidden="true" tabindex="-1"></a>a standard Wiener process?</span>
<span id="cb5-659"><a href="#cb5-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-660"><a href="#cb5-660" aria-hidden="true" tabindex="-1"></a>*Solution.*</span>
<span id="cb5-661"><a href="#cb5-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-662"><a href="#cb5-662" aria-hidden="true" tabindex="-1"></a>Clearly, $B(s,\omega)$ is a random variable and the Riemann integral $\int_0^t B(s,\omega)ds$ depends on the sample path $\omega$. So, $(\int_0^t B_s ds, t\leq T)$ is a stochastic process. Using integration by parts:</span>
<span id="cb5-663"><a href="#cb5-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-664"><a href="#cb5-664" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-665"><a href="#cb5-665" aria-hidden="true" tabindex="-1"></a>\int u\left(\frac{dv}{ds}\right)ds &amp; =uv-\int v\left(\frac{du}{ds}\right)ds</span>
<span id="cb5-666"><a href="#cb5-666" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-667"><a href="#cb5-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-668"><a href="#cb5-668" aria-hidden="true" tabindex="-1"></a>We set $u=B(s)$ and $dv/ds=1$. Then:</span>
<span id="cb5-669"><a href="#cb5-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-670"><a href="#cb5-670" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-671"><a href="#cb5-671" aria-hidden="true" tabindex="-1"></a>\int_{0}^{t}B(s)ds &amp; =sB(s)|_{0}^{t}-\int_{0}^{t}sdB(s)<span class="sc">\\</span></span>
<span id="cb5-672"><a href="#cb5-672" aria-hidden="true" tabindex="-1"></a> &amp; =tB(t)-\int_{0}^{t}sdB(s)<span class="sc">\\</span></span>
<span id="cb5-673"><a href="#cb5-673" aria-hidden="true" tabindex="-1"></a> &amp; =\int_{s=0}^{s=t}tdB(s)-\int_{0}^{t}sdB(s)<span class="sc">\\</span></span>
<span id="cb5-674"><a href="#cb5-674" aria-hidden="true" tabindex="-1"></a> &amp; =\int_{0}^{t}(t-s)dB(s)</span>
<span id="cb5-675"><a href="#cb5-675" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-676"><a href="#cb5-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-677"><a href="#cb5-677" aria-hidden="true" tabindex="-1"></a>Thus, $\int_{0}^{t}B(s)ds$ is a Gaussian random variable with:</span>
<span id="cb5-678"><a href="#cb5-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-679"><a href="#cb5-679" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-680"><a href="#cb5-680" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\left<span class="co">[</span><span class="ot">\int_{0}^{t}B(s)ds\right</span><span class="co">]</span> &amp; =\mathbb{E}\left<span class="co">[</span><span class="ot">\int_{0}^{t}(t-s)dB(s)\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-681"><a href="#cb5-681" aria-hidden="true" tabindex="-1"></a> &amp; =0</span>
<span id="cb5-682"><a href="#cb5-682" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-683"><a href="#cb5-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-684"><a href="#cb5-684" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb5-685"><a href="#cb5-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-686"><a href="#cb5-686" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-687"><a href="#cb5-687" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\left<span class="co">[</span><span class="ot">\left(\int_{0}^{t}B(s)ds\right)^{2}\right</span><span class="co">]</span> &amp; =\int_{0}^{t}(t-s)^{2}ds<span class="sc">\\</span></span>
<span id="cb5-688"><a href="#cb5-688" aria-hidden="true" tabindex="-1"></a> &amp; =\left.\frac{(t-s)^{3}}{-3}\right|_{0}^{t}<span class="sc">\\</span></span>
<span id="cb5-689"><a href="#cb5-689" aria-hidden="true" tabindex="-1"></a> &amp; =\frac{t^{3}}{3}</span>
<span id="cb5-690"><a href="#cb5-690" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-691"><a href="#cb5-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-692"><a href="#cb5-692" aria-hidden="true" tabindex="-1"></a>Thus, using the properties of Ito Integral,</span>
<span id="cb5-693"><a href="#cb5-693" aria-hidden="true" tabindex="-1"></a>$\int_{0}^{t}B(s)ds=\int_{0}^{t}(t-s)dB(s)$ is a martingale. Now the</span>
<span id="cb5-694"><a href="#cb5-694" aria-hidden="true" tabindex="-1"></a>quadratic variation $&lt;M,M&gt;_{t}=0$, and this can be a bit tricky.</span>
<span id="cb5-695"><a href="#cb5-695" aria-hidden="true" tabindex="-1"></a>Remember,</span>
<span id="cb5-696"><a href="#cb5-696" aria-hidden="true" tabindex="-1"></a>$\left\langle \int_{0}^{t}f(s,B_{s})dB(s),\int_{0}^{t}f(s,B_{s})dB(s)\right\rangle =\int_{0}^{t}f^{2}(s,B_{s})ds$</span>
<span id="cb5-697"><a href="#cb5-697" aria-hidden="true" tabindex="-1"></a>if and only if $f$ is a function of the time $s$ and the position of the</span>
<span id="cb5-698"><a href="#cb5-698" aria-hidden="true" tabindex="-1"></a>Brownian motion $B(s)$. Since, $f$ is a function of $t$ as well, this</span>
<span id="cb5-699"><a href="#cb5-699" aria-hidden="true" tabindex="-1"></a>rule cannot be applied.</span>
<span id="cb5-700"><a href="#cb5-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-701"><a href="#cb5-701" aria-hidden="true" tabindex="-1"></a>By first principles, we can show that, the quadratic variation is indeed</span>
<span id="cb5-702"><a href="#cb5-702" aria-hidden="true" tabindex="-1"></a>$0$: $$\begin{aligned}</span>
<span id="cb5-703"><a href="#cb5-703" aria-hidden="true" tabindex="-1"></a>\lim_{n\to\infty}\mathbb{E}\left<span class="co">[</span><span class="ot">\sum_{j=0}^{n-1}\left(I(t_{j+1})-I(t_{j})\right)^{2}\right</span><span class="co">]</span> &amp; =\lim_{n\to\infty}\mathbb{E}\left<span class="co">[</span><span class="ot">\sum_{j=0}^{n-1}B_{t_{j}}^{2}(t_{j+1}-t_{j})^{2}\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-704"><a href="#cb5-704" aria-hidden="true" tabindex="-1"></a> &amp; =\lim_{n\to\infty}\max_{1\leq j\leq n}|t_{j+1}-t_{j}|\cdot\mathbb{E}\left<span class="co">[</span><span class="ot">\sum_{j=0}^{n-1}B_{t_{j}}^{2}(t_{j+1}-t_{j})\right</span><span class="co">]</span></span>
<span id="cb5-705"><a href="#cb5-705" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-706"><a href="#cb5-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-707"><a href="#cb5-707" aria-hidden="true" tabindex="-1"></a>Since the paths of $B_{t}$ are continuous, so are the paths $B_{t}^{2}$</span>
<span id="cb5-708"><a href="#cb5-708" aria-hidden="true" tabindex="-1"></a>on the compact interval $<span class="co">[</span><span class="ot">0,t</span><span class="co">]</span>$. So, $(B_{s}^{2},s\in<span class="co">[</span><span class="ot">0,t</span><span class="co">]</span>)$ is</span>
<span id="cb5-709"><a href="#cb5-709" aria-hidden="true" tabindex="-1"></a>uniformly bounded. Thus, the expectation term is bounded. As</span>
<span id="cb5-710"><a href="#cb5-710" aria-hidden="true" tabindex="-1"></a>$n\to\infty$, the mesh size approaches zero, and consequently the</span>
<span id="cb5-711"><a href="#cb5-711" aria-hidden="true" tabindex="-1"></a>quadratic variation approaches zero.</span>
<span id="cb5-712"><a href="#cb5-712" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-713"><a href="#cb5-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-714"><a href="#cb5-714" aria-hidden="true" tabindex="-1"></a>::: {#exm-something-that-is-not-a-martingale}</span>
<span id="cb5-715"><a href="#cb5-715" aria-hidden="true" tabindex="-1"></a>Let $X_{t}=\int_{0}^{t}B_{s}dB_{s}$ and</span>
<span id="cb5-716"><a href="#cb5-716" aria-hidden="true" tabindex="-1"></a>$Y_{t}=\int_{0}^{t}B_{s}^{2}dB_{s}$. Is $(X_{t}Y_{t},t\geq0)$ a</span>
<span id="cb5-717"><a href="#cb5-717" aria-hidden="true" tabindex="-1"></a>martingale?</span>
<span id="cb5-718"><a href="#cb5-718" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-719"><a href="#cb5-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-720"><a href="#cb5-720" aria-hidden="true" tabindex="-1"></a>*Solution.*</span>
<span id="cb5-721"><a href="#cb5-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-722"><a href="#cb5-722" aria-hidden="true" tabindex="-1"></a>By Ito's product rule, we have:</span>
<span id="cb5-723"><a href="#cb5-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-724"><a href="#cb5-724" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-725"><a href="#cb5-725" aria-hidden="true" tabindex="-1"></a>d(X_{t}Y_{t}) &amp; =X_{t}dY_{t}+Y_{t}dX_{t}+dX_{t}\cdot dY_{t}<span class="sc">\\</span></span>
<span id="cb5-726"><a href="#cb5-726" aria-hidden="true" tabindex="-1"></a> &amp; =X_{t}B_{s}^{2}dB_{s}+Y_{t}B_{s}dB_{s}+(B_{s}dB_{s})\cdot(B_{s}^{2}dB_{s})<span class="sc">\\</span></span>
<span id="cb5-727"><a href="#cb5-727" aria-hidden="true" tabindex="-1"></a> &amp; =X_{t}B_{s}^{2}dB_{s}+Y_{t}B_{s}dB_{s}+B_{s}^{3}dt<span class="sc">\\</span></span>
<span id="cb5-728"><a href="#cb5-728" aria-hidden="true" tabindex="-1"></a>X_{t}Y_{t} &amp; =X_{0}Y_{0}+\int_{0}^{t}X_{t}B_{s}^{2}dB_{s}+\int_{0}^{t}Y_{t}B_{s}dB_{s}+\int_{0}^{t}B_{s}^{3}dt</span>
<span id="cb5-729"><a href="#cb5-729" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-730"><a href="#cb5-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-731"><a href="#cb5-731" aria-hidden="true" tabindex="-1"></a>The term in $dt$ is not zero, so the product cannot be a martingale.</span>
<span id="cb5-732"><a href="#cb5-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-733"><a href="#cb5-733" aria-hidden="true" tabindex="-1"></a>::: {#exm-generalization-of-gbm-ii}</span>
<span id="cb5-734"><a href="#cb5-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-735"><a href="#cb5-735" aria-hidden="true" tabindex="-1"></a>(A generalization of Geometric Brownian Motion). Consider $(\int_{0}^{t}V_{s}dB_{s},t\geq0)$ an Ito process. Define the positive</span>
<span id="cb5-736"><a href="#cb5-736" aria-hidden="true" tabindex="-1"></a>process:</span>
<span id="cb5-737"><a href="#cb5-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-738"><a href="#cb5-738" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-739"><a href="#cb5-739" aria-hidden="true" tabindex="-1"></a>M_{t} &amp; =\exp\left(\int_{0}^{t}V_{s}dB_{s}-\frac{1}{2}\int_{0}^{t}V_{s}^{2}ds\right),\quad t\geq0</span>
<span id="cb5-740"><a href="#cb5-740" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$ {#eq-generalization-of-gbm}</span>
<span id="cb5-741"><a href="#cb5-741" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-742"><a href="#cb5-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-743"><a href="#cb5-743" aria-hidden="true" tabindex="-1"></a>*Solution.*</span>
<span id="cb5-744"><a href="#cb5-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-745"><a href="#cb5-745" aria-hidden="true" tabindex="-1"></a>Ito's formula applied to the processes $X_{t}=\int_{0}^{t}V_{s}dB_{s}$</span>
<span id="cb5-746"><a href="#cb5-746" aria-hidden="true" tabindex="-1"></a>and $Y_{t}=\frac{1}{2}\int_{0}^{t}V_{s}^{2}ds$ with the function</span>
<span id="cb5-747"><a href="#cb5-747" aria-hidden="true" tabindex="-1"></a>$f(x,y)=e^{x-y}$ yields:</span>
<span id="cb5-748"><a href="#cb5-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-749"><a href="#cb5-749" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-750"><a href="#cb5-750" aria-hidden="true" tabindex="-1"></a>df(x,y) &amp; =f_{x}(X_{t},Y_{t})dX_{t}+f_{y}(X_{t},Y_{t})dY_{t}<span class="sc">\\</span></span>
<span id="cb5-751"><a href="#cb5-751" aria-hidden="true" tabindex="-1"></a> &amp; +\frac{1}{2}f_{xx}(X_{t},Y_{t})dX_{t}\cdot dX_{t}+\frac{1}{2}f_{yy}(X_{t},Y_{t})dY_{t}\cdot dY_{t}<span class="sc">\\</span></span>
<span id="cb5-752"><a href="#cb5-752" aria-hidden="true" tabindex="-1"></a> &amp; +f_{xy}(X_{t},Y_{t})dX_{t}\cdot dY_{t}</span>
<span id="cb5-753"><a href="#cb5-753" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-754"><a href="#cb5-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-755"><a href="#cb5-755" aria-hidden="true" tabindex="-1"></a>Now, all first and second order derivatives are</span>
<span id="cb5-756"><a href="#cb5-756" aria-hidden="true" tabindex="-1"></a>$\partial_{x}(e^{x-y})=M_{t}$, $\partial_{y}(e^{x-y})=-e^{x-y}=-M_{t}$, $\partial_{xx}(e^{x-y})=M_{t}$</span>
<span id="cb5-757"><a href="#cb5-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-758"><a href="#cb5-758" aria-hidden="true" tabindex="-1"></a>$dX_{t}=V_{t}dB_{t}$. $dY_{t}=\frac{1}{2}V_{t}^{2}dt$.</span>
<span id="cb5-759"><a href="#cb5-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-760"><a href="#cb5-760" aria-hidden="true" tabindex="-1"></a>$dX_{t}\cdot dX_{t}=V_{t}^{2}dt$, $dX_{t}\cdot dY_{t}=0$,</span>
<span id="cb5-761"><a href="#cb5-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-762"><a href="#cb5-762" aria-hidden="true" tabindex="-1"></a>$dY_{t}\cdot dY_{t}=0$. </span>
<span id="cb5-763"><a href="#cb5-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-764"><a href="#cb5-764" aria-hidden="true" tabindex="-1"></a>Consequently, we have:</span>
<span id="cb5-765"><a href="#cb5-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-766"><a href="#cb5-766" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-767"><a href="#cb5-767" aria-hidden="true" tabindex="-1"></a>dM_{t} &amp; =M_{t}V_{t}dB_{t}-\frac{1}{2}M_{t}V_{t}^{2}dt<span class="sc">\\</span></span>
<span id="cb5-768"><a href="#cb5-768" aria-hidden="true" tabindex="-1"></a> &amp; +\frac{1}{2}M_{t}V_{t}^{2}dt<span class="sc">\\</span></span>
<span id="cb5-769"><a href="#cb5-769" aria-hidden="true" tabindex="-1"></a> &amp; =M_{t}V_{t}dB_{t}</span>
<span id="cb5-770"><a href="#cb5-770" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-771"><a href="#cb5-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-772"><a href="#cb5-772" aria-hidden="true" tabindex="-1"></a>Thus, $(M_{t},t\geq0)$ is a martingale.</span>
<span id="cb5-773"><a href="#cb5-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-774"><a href="#cb5-774" aria-hidden="true" tabindex="-1"></a>::: {#exr-generalized-ito-integral}</span>
<span id="cb5-775"><a href="#cb5-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-776"><a href="#cb5-776" aria-hidden="true" tabindex="-1"></a>(Generalized Ito Integral). Let $(\Omega,\mathcal{F},\mathbb{P})$ be a probability space and let</span>
<span id="cb5-777"><a href="#cb5-777" aria-hidden="true" tabindex="-1"></a>$(B_{t}:t\geq0)$ be a standard brownian motion. Given that $f$ is a</span>
<span id="cb5-778"><a href="#cb5-778" aria-hidden="true" tabindex="-1"></a>simple process, show that:</span>
<span id="cb5-779"><a href="#cb5-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-780"><a href="#cb5-780" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-781"><a href="#cb5-781" aria-hidden="true" tabindex="-1"></a>\int_{0}^{t}f(s,B_{s})dB_{s} &amp; =B_{t}f(t,B_{t})-\int_{0}^{t}\left<span class="co">[</span><span class="ot">B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}B_{s}\frac{\partial^{2}f}{\partial x^{2}}\right</span><span class="co">]</span>ds<span class="sc">\\</span></span>
<span id="cb5-782"><a href="#cb5-782" aria-hidden="true" tabindex="-1"></a> &amp; -\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}</span>
<span id="cb5-783"><a href="#cb5-783" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-784"><a href="#cb5-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-785"><a href="#cb5-785" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb5-786"><a href="#cb5-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-787"><a href="#cb5-787" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-788"><a href="#cb5-788" aria-hidden="true" tabindex="-1"></a>\int_{0}^{t}f(s,B_{s})ds &amp; =tf(t,B_{t})-\int_{0}^{t}s\left<span class="co">[</span><span class="ot">\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right</span><span class="co">]</span>ds-\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}</span>
<span id="cb5-789"><a href="#cb5-789" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-790"><a href="#cb5-790" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-791"><a href="#cb5-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-792"><a href="#cb5-792" aria-hidden="true" tabindex="-1"></a>*Solution.*</span>
<span id="cb5-793"><a href="#cb5-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-794"><a href="#cb5-794" aria-hidden="true" tabindex="-1"></a>I suppress $(t,B_{t})$ for simplicity. Applying the product rule to</span>
<span id="cb5-795"><a href="#cb5-795" aria-hidden="true" tabindex="-1"></a>$B_{t}f$, we get:</span>
<span id="cb5-796"><a href="#cb5-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-797"><a href="#cb5-797" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-798"><a href="#cb5-798" aria-hidden="true" tabindex="-1"></a>d(B_{t}f) &amp; =fdB_{t}+B_{t}df+dB_{t}\cdot df<span class="sc">\\</span></span>
<span id="cb5-799"><a href="#cb5-799" aria-hidden="true" tabindex="-1"></a> &amp; =fdB_{t}+B_{t}\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)<span class="sc">\\</span></span>
<span id="cb5-800"><a href="#cb5-800" aria-hidden="true" tabindex="-1"></a> &amp; +dB_{t}\cdot\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)<span class="sc">\\</span></span>
<span id="cb5-801"><a href="#cb5-801" aria-hidden="true" tabindex="-1"></a> &amp; =fdB_{t}+\left(B_{t}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}B_{t}\right)dt+B_{t}\frac{\partial f}{\partial x}dB_{t}<span class="sc">\\</span></span>
<span id="cb5-802"><a href="#cb5-802" aria-hidden="true" tabindex="-1"></a>B_{t}f &amp; =\int_{0}^{t}fdB_{s}+\int_{0}^{t}\left(B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}B_{s}\right)ds+\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}<span class="sc">\\</span></span>
<span id="cb5-803"><a href="#cb5-803" aria-hidden="true" tabindex="-1"></a>\int_{0}^{t}fdB_{s} &amp; =B_{t}f-\int_{0}^{t}\left(B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}B_{s}\right)ds-\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}</span>
<span id="cb5-804"><a href="#cb5-804" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-805"><a href="#cb5-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-806"><a href="#cb5-806" aria-hidden="true" tabindex="-1"></a>Applying product rule to $tf(t,B_{t})$, we get:</span>
<span id="cb5-807"><a href="#cb5-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-808"><a href="#cb5-808" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb5-809"><a href="#cb5-809" aria-hidden="true" tabindex="-1"></a>d(tf) &amp; =fdt+tdf+dt\cdot df<span class="sc">\\</span></span>
<span id="cb5-810"><a href="#cb5-810" aria-hidden="true" tabindex="-1"></a> &amp; =fdt+t\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)<span class="sc">\\</span></span>
<span id="cb5-811"><a href="#cb5-811" aria-hidden="true" tabindex="-1"></a> &amp; +dt\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)<span class="sc">\\</span></span>
<span id="cb5-812"><a href="#cb5-812" aria-hidden="true" tabindex="-1"></a> &amp; =fdt+t\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)dt+t\frac{\partial f}{\partial x}dB_{t}<span class="sc">\\</span></span>
<span id="cb5-813"><a href="#cb5-813" aria-hidden="true" tabindex="-1"></a>tf &amp; =\int_{0}^{t}fds+\int_{0}^{t}s\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)ds+\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}<span class="sc">\\</span></span>
<span id="cb5-814"><a href="#cb5-814" aria-hidden="true" tabindex="-1"></a>\int_{0}^{t}fds &amp; =tf-\int_{0}^{t}s\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)ds-\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}</span>
<span id="cb5-815"><a href="#cb5-815" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb5-816"><a href="#cb5-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-817"><a href="#cb5-817" aria-hidden="true" tabindex="-1"></a>The following example will be important when we discuss the Girsanov theorem.</span>
<span id="cb5-818"><a href="#cb5-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-819"><a href="#cb5-819" aria-hidden="true" tabindex="-1"></a>::: {#thm-ito-formula-for-many-processes} </span>
<span id="cb5-820"><a href="#cb5-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-821"><a href="#cb5-821" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ito's formula for many Ito processes</span></span>
<span id="cb5-822"><a href="#cb5-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-823"><a href="#cb5-823" aria-hidden="true" tabindex="-1"></a>Let $X_t = (X_t^{(j)},j\leq d,j\in\mathbf{N})$ be Ito processes constructed on $(\Omega,\mathcal{F},\mathbb{P})$ and $f \in C^{1,2}(<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>\times \mathbb{R}^d)$. Then for $t \in <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$, we have:</span>
<span id="cb5-824"><a href="#cb5-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-825"><a href="#cb5-825" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-826"><a href="#cb5-826" aria-hidden="true" tabindex="-1"></a>df(t,X_t) = \partial_t f(t,X_t) dt + \sum_{j=1}^{d} \partial_{x_j} f(t,X_t) dX_t^{(j)} + \frac{1}{2}\sum_{j=1}^{d} \sum_{k=1}^d \partial_{x_j x_k}^2 f(t,X_t) dX_t^{(j)}\cdot dX_t^{(k)}</span>
<span id="cb5-827"><a href="#cb5-827" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-828"><a href="#cb5-828" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-829"><a href="#cb5-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-830"><a href="#cb5-830" aria-hidden="true" tabindex="-1"></a><span class="fu">## Numerical Simulation of SDEs</span></span>
<span id="cb5-831"><a href="#cb5-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-832"><a href="#cb5-832" aria-hidden="true" tabindex="-1"></a>The good news is that it is not too hard to implement iterative schemes to sample paths of a diffusion. Consider $(X_t,t\leq T)$ a solution to the SDE:</span>
<span id="cb5-833"><a href="#cb5-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-834"><a href="#cb5-834" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-835"><a href="#cb5-835" aria-hidden="true" tabindex="-1"></a>dX_t = \sigma(X_t) dB_t + \mu(X_t) dt</span>
<span id="cb5-836"><a href="#cb5-836" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-837"><a href="#cb5-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-838"><a href="#cb5-838" aria-hidden="true" tabindex="-1"></a>To keep the notation to a minimum, we consider a time-homogeonous diffusion. For a partition $(t_j,j\leq n)$ of $<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$ with $t_n = T$, consider the increment</span>
<span id="cb5-839"><a href="#cb5-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-840"><a href="#cb5-840" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-841"><a href="#cb5-841" aria-hidden="true" tabindex="-1"></a>X_{t_{j+1}} - X_{t_j} = \int_{t_j}^{t_{j+1}} \sigma(X_s) dB(s) + \int_{t_j}^{t_{j+1}} \mu(X_s) ds</span>
<span id="cb5-842"><a href="#cb5-842" aria-hidden="true" tabindex="-1"></a>$$ {#eq-increment-of-a-diffusion}</span>
<span id="cb5-843"><a href="#cb5-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-844"><a href="#cb5-844" aria-hidden="true" tabindex="-1"></a>Note that, if $\sigma$ and $\mu$ are smooth functions, we can apply Ito's formula to $\sigma(X_s)$ and $\mu(X_s)$ for $s\in (t_j,t_{j+1}]$! We get:</span>
<span id="cb5-845"><a href="#cb5-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-846"><a href="#cb5-846" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-847"><a href="#cb5-847" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-848"><a href="#cb5-848" aria-hidden="true" tabindex="-1"></a>\sigma(X_s) &amp;= \sigma(X_{t_j}) + \int_{t_j}^{s}\sigma'(X_u) dX_u + \frac{1}{2}\int_{t_j}^{s} \sigma''(X_u)(dX_u)^2<span class="sc">\\</span></span>
<span id="cb5-849"><a href="#cb5-849" aria-hidden="true" tabindex="-1"></a>\mu(X_s) &amp;= \mu(X_{t_j}) + \int_{t_j}^{s}\mu'(X_u) dX_u + \frac{1}{2}\int_{t_j}^{s} \mu''(X_u)(dX_u)^2</span>
<span id="cb5-850"><a href="#cb5-850" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-851"><a href="#cb5-851" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ito-taylor-expansion-of-mu-and-sigma}</span>
<span id="cb5-852"><a href="#cb5-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-853"><a href="#cb5-853" aria-hidden="true" tabindex="-1"></a>Now, we can approximate the increment in @eq-increment-of-a-diffusion at different levels of precision by considering a different estimate for @eq-ito-taylor-expansion-of-mu-and-sigma. </span>
<span id="cb5-854"><a href="#cb5-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-855"><a href="#cb5-855" aria-hidden="true" tabindex="-1"></a>::: {#exm-euler-maruyama-scheme}</span>
<span id="cb5-856"><a href="#cb5-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-857"><a href="#cb5-857" aria-hidden="true" tabindex="-1"></a>(Euler-Maruyama Scheme). This scheme consists of taking $\sigma(X_s) \approx \sigma(X_{t_j})$ and $\mu(X_s) \approx \mu(X_{t_j})$ for $s \in [t_j,t_{j+1})$ in @eq-ito-taylor-expansion-of-mu-and-sigma. Putting this back in @eq-increment-of-a-diffusion, we get:</span>
<span id="cb5-858"><a href="#cb5-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-859"><a href="#cb5-859" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-860"><a href="#cb5-860" aria-hidden="true" tabindex="-1"></a>X_{t_{j+1}} - X_{t_j} \approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j)</span>
<span id="cb5-861"><a href="#cb5-861" aria-hidden="true" tabindex="-1"></a>$$ {#eq-euler-maruyama}</span>
<span id="cb5-862"><a href="#cb5-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-863"><a href="#cb5-863" aria-hidden="true" tabindex="-1"></a>The process $X_t$ can then be constructed recursively on the discrete set $(t_j,j \leq n)$ as follows:</span>
<span id="cb5-864"><a href="#cb5-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-865"><a href="#cb5-865" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-866"><a href="#cb5-866" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-867"><a href="#cb5-867" aria-hidden="true" tabindex="-1"></a>X_0 &amp;= x<span class="sc">\\</span></span>
<span id="cb5-868"><a href="#cb5-868" aria-hidden="true" tabindex="-1"></a>X_{t_1} &amp;= (X_{t_1} - X_0) + X_0<span class="sc">\\</span></span>
<span id="cb5-869"><a href="#cb5-869" aria-hidden="true" tabindex="-1"></a>X_{t_2} &amp;= (X_{t_2} - X_{t_1}) + (X_{t_1} - X_0) + X_0<span class="sc">\\</span></span>
<span id="cb5-870"><a href="#cb5-870" aria-hidden="true" tabindex="-1"></a>\vdots<span class="sc">\\</span></span>
<span id="cb5-871"><a href="#cb5-871" aria-hidden="true" tabindex="-1"></a>X_{t_n} &amp;= \sum_{j=0}^{n-1}(X_{t_{j+1}} - X_{t_j}) + X_0</span>
<span id="cb5-872"><a href="#cb5-872" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-873"><a href="#cb5-873" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-874"><a href="#cb5-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-875"><a href="#cb5-875" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-876"><a href="#cb5-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-877"><a href="#cb5-877" aria-hidden="true" tabindex="-1"></a>::: {#exm-milstein-scheme}</span>
<span id="cb5-878"><a href="#cb5-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-879"><a href="#cb5-879" aria-hidden="true" tabindex="-1"></a>(Milstein Scheme). In this scheme, we go an order further for the approximation of the volatility in @eq-ito-taylor-expansion-of-mu-and-sigma and consider also the integral in $dX_u$. We take $dX_u = \sigma(X_{t_j})dB_u$. We then express $\sigma(X_s)$ in @eq-ito-taylor-expansion-of-mu-and-sigma as:</span>
<span id="cb5-880"><a href="#cb5-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-881"><a href="#cb5-881" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-882"><a href="#cb5-882" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-883"><a href="#cb5-883" aria-hidden="true" tabindex="-1"></a>\sigma(X_s) &amp;\approx \sigma(X_{t_j}) + \int_{t_j}^{s} \sigma'(X_{t_j}) (\sigma(X_{t_j})dB_u)<span class="sc">\\</span></span>
<span id="cb5-884"><a href="#cb5-884" aria-hidden="true" tabindex="-1"></a>&amp;= \sigma(X_{t_j}) + \sigma'(X_{t_j}) \sigma(X_{t_j}) \int_{t_j}^{s}  dB_u<span class="sc">\\</span></span>
<span id="cb5-885"><a href="#cb5-885" aria-hidden="true" tabindex="-1"></a>&amp;= \sigma(X_{t_j}) + \sigma'(X_{t_j}) \sigma(X_{t_j}) (B_s - B_{t_j})</span>
<span id="cb5-886"><a href="#cb5-886" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-887"><a href="#cb5-887" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-888"><a href="#cb5-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-889"><a href="#cb5-889" aria-hidden="true" tabindex="-1"></a>If we put this back in @eq-increment-of-a-diffusion, we get:</span>
<span id="cb5-890"><a href="#cb5-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-891"><a href="#cb5-891" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-892"><a href="#cb5-892" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-893"><a href="#cb5-893" aria-hidden="true" tabindex="-1"></a>X_{t_{j+1}} - X_{t_j} &amp;\approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) <span class="sc">\\</span></span>
<span id="cb5-894"><a href="#cb5-894" aria-hidden="true" tabindex="-1"></a>&amp;+ \sigma'(X_{t_j}) \sigma(X_{t_j}) \int_{t_j}^{t_{j+1}} (B(s) - B(t_j))dB(s)</span>
<span id="cb5-895"><a href="#cb5-895" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-896"><a href="#cb5-896" aria-hidden="true" tabindex="-1"></a>$$ {#eq-milstein-approx-step1}</span>
<span id="cb5-897"><a href="#cb5-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-898"><a href="#cb5-898" aria-hidden="true" tabindex="-1"></a>Now, consider the function $f(x)=x^2$. We have:</span>
<span id="cb5-899"><a href="#cb5-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-900"><a href="#cb5-900" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-901"><a href="#cb5-901" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-902"><a href="#cb5-902" aria-hidden="true" tabindex="-1"></a>f_x(x) &amp;= 2x<span class="sc">\\</span></span>
<span id="cb5-903"><a href="#cb5-903" aria-hidden="true" tabindex="-1"></a>f_{xx}(x) &amp;= 2</span>
<span id="cb5-904"><a href="#cb5-904" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-905"><a href="#cb5-905" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-906"><a href="#cb5-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-907"><a href="#cb5-907" aria-hidden="true" tabindex="-1"></a>So, we get:</span>
<span id="cb5-908"><a href="#cb5-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-909"><a href="#cb5-909" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-910"><a href="#cb5-910" aria-hidden="true" tabindex="-1"></a>B^2(t_{j+1}) - B^2(t_j) = 2 \int_{t_j}^{t_{j+1}} B(s) dB(s) + \frac{1}{2} \int_{t_j}^{t_{j+1}} (2) ds</span>
<span id="cb5-911"><a href="#cb5-911" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-912"><a href="#cb5-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-913"><a href="#cb5-913" aria-hidden="true" tabindex="-1"></a>Thus,</span>
<span id="cb5-914"><a href="#cb5-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-915"><a href="#cb5-915" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-916"><a href="#cb5-916" aria-hidden="true" tabindex="-1"></a>\int_{t_j}^{t_{j+1}} B(s) dB(s) = \frac{1}{2}<span class="co">[</span><span class="ot">(B_{t_{j+1}}^2 - B_{t_j}^2)-(t_{j+1}-t_j)</span><span class="co">]</span></span>
<span id="cb5-917"><a href="#cb5-917" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ito-integral-of-bm}</span>
<span id="cb5-918"><a href="#cb5-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-919"><a href="#cb5-919" aria-hidden="true" tabindex="-1"></a>Substituting @eq-ito-integral-of-bm into @eq-milstein-approx-step1, we get the Milstein approximation:</span>
<span id="cb5-920"><a href="#cb5-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-921"><a href="#cb5-921" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-922"><a href="#cb5-922" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-923"><a href="#cb5-923" aria-hidden="true" tabindex="-1"></a>X_{t_{j+1}} - X_{t_j} &amp;\approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) <span class="sc">\\</span></span>
<span id="cb5-924"><a href="#cb5-924" aria-hidden="true" tabindex="-1"></a>&amp;+\sigma'(X_{t_j}) \sigma(X_{t_j})  \left<span class="co">[</span><span class="ot">\frac{1}{2}((B_{t_{j+1}}^2 - B_{t_j}^2)-(t_{j+1}-t_j)) -  B_{t_j}(B_{t_{j+1}}-B_{t_j})\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-925"><a href="#cb5-925" aria-hidden="true" tabindex="-1"></a>&amp;= \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) <span class="sc">\\</span></span>
<span id="cb5-926"><a href="#cb5-926" aria-hidden="true" tabindex="-1"></a>&amp;+ \frac{\sigma'(X_{t_j}) \sigma(X_{t_j})}{2}  \left<span class="co">[</span><span class="ot">(B_{t_{j+1}}^2 - B_{t_j}^2)-(t_{j+1}-t_j) -  2B_{t_j}B_{t_{j+1}}+2B_{t_j}^2\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-927"><a href="#cb5-927" aria-hidden="true" tabindex="-1"></a>&amp;= \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) <span class="sc">\\</span></span>
<span id="cb5-928"><a href="#cb5-928" aria-hidden="true" tabindex="-1"></a>&amp;+ \frac{\sigma'(X_{t_j}) \sigma(X_{t_j})}{2}  \left<span class="co">[</span><span class="ot">(B_{t_{j+1}} - B_{t_j})^2-(t_{j+1}-t_j)\right</span><span class="co">]</span></span>
<span id="cb5-929"><a href="#cb5-929" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-930"><a href="#cb5-930" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-931"><a href="#cb5-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-932"><a href="#cb5-932" aria-hidden="true" tabindex="-1"></a>Thus, under the Milstein scheme</span>
<span id="cb5-933"><a href="#cb5-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-934"><a href="#cb5-934" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-935"><a href="#cb5-935" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-936"><a href="#cb5-936" aria-hidden="true" tabindex="-1"></a>X_{t_{j+1}} - X_{t_j} &amp;\approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) <span class="sc">\\</span></span>
<span id="cb5-937"><a href="#cb5-937" aria-hidden="true" tabindex="-1"></a>&amp;+ \frac{\sigma'(X_{t_j}) \sigma(X_{t_j})}{2}  \left<span class="co">[</span><span class="ot">(B_{t_{j+1}} - B_{t_j})^2-(t_{j+1}-t_j)\right</span><span class="co">]</span></span>
<span id="cb5-938"><a href="#cb5-938" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-939"><a href="#cb5-939" aria-hidden="true" tabindex="-1"></a>$$ {#eq-milstein}</span>
<span id="cb5-940"><a href="#cb5-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-941"><a href="#cb5-941" aria-hidden="true" tabindex="-1"></a>The recursive nature of these two schemes makes them easy to implement numerically. The Milstein scheme is not much more costly to implement as it contains only one more term than the Euler scheme.</span>
<span id="cb5-942"><a href="#cb5-942" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-943"><a href="#cb5-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-944"><a href="#cb5-944" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python implementation</span></span>
<span id="cb5-945"><a href="#cb5-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-946"><a href="#cb5-946" aria-hidden="true" tabindex="-1"></a>Let's code an <span class="in">`SIVP`</span> class and an abstract base class <span class="in">`Solver`</span>.</span>
<span id="cb5-947"><a href="#cb5-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-950"><a href="#cb5-950" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb5-951"><a href="#cb5-951" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb5-952"><a href="#cb5-952" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> abc <span class="im">import</span> ABC, abstractmethod</span>
<span id="cb5-953"><a href="#cb5-953" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Callable, Optional</span>
<span id="cb5-954"><a href="#cb5-954" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-955"><a href="#cb5-955" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-956"><a href="#cb5-956" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb5-957"><a href="#cb5-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-958"><a href="#cb5-958" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb5-959"><a href="#cb5-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-960"><a href="#cb5-960" aria-hidden="true" tabindex="-1"></a><span class="co"># More descriptive type hints</span></span>
<span id="cb5-961"><a href="#cb5-961" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.ndarray</span>
<span id="cb5-962"><a href="#cb5-962" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.ndarray</span>
<span id="cb5-963"><a href="#cb5-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-964"><a href="#cb5-964" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb5-965"><a href="#cb5-965" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SIVP:</span>
<span id="cb5-966"><a href="#cb5-966" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb5-967"><a href="#cb5-967" aria-hidden="true" tabindex="-1"></a><span class="co">    An abstraction for a stochastic initial value problem</span></span>
<span id="cb5-968"><a href="#cb5-968" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb5-969"><a href="#cb5-969" aria-hidden="true" tabindex="-1"></a>    t_start : <span class="bu">float</span></span>
<span id="cb5-970"><a href="#cb5-970" aria-hidden="true" tabindex="-1"></a>    t_end : <span class="bu">float</span></span>
<span id="cb5-971"><a href="#cb5-971" aria-hidden="true" tabindex="-1"></a>    initial_condition: <span class="bu">float</span></span>
<span id="cb5-972"><a href="#cb5-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-973"><a href="#cb5-973" aria-hidden="true" tabindex="-1"></a>    drift: Callable[[<span class="bu">float</span>, np.ndarray], np.ndarray]</span>
<span id="cb5-974"><a href="#cb5-974" aria-hidden="true" tabindex="-1"></a>    vol: Callable[[<span class="bu">float</span>, np.ndarray], np.ndarray]</span>
<span id="cb5-975"><a href="#cb5-975" aria-hidden="true" tabindex="-1"></a>    dvol_dx: Optional[Callable[[<span class="bu">float</span>, np.ndarray], np.ndarray]] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb5-976"><a href="#cb5-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-977"><a href="#cb5-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-978"><a href="#cb5-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-979"><a href="#cb5-979" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb5-980"><a href="#cb5-980" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Solver(ABC):</span>
<span id="cb5-981"><a href="#cb5-981" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb5-982"><a href="#cb5-982" aria-hidden="true" tabindex="-1"></a><span class="co">    An abstract base class for all numerical schemes</span></span>
<span id="cb5-983"><a href="#cb5-983" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb5-984"><a href="#cb5-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-985"><a href="#cb5-985" aria-hidden="true" tabindex="-1"></a>    num_steps: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb5-986"><a href="#cb5-986" aria-hidden="true" tabindex="-1"></a>    num_paths: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb5-987"><a href="#cb5-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-988"><a href="#cb5-988" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> __post_init__(<span class="va">self</span>):</span>
<span id="cb5-989"><a href="#cb5-989" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.<span class="bu">iter</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-990"><a href="#cb5-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-991"><a href="#cb5-991" aria-hidden="true" tabindex="-1"></a>        <span class="co"># x_values is a matrix of shape [num_paths,num_steps]</span></span>
<span id="cb5-992"><a href="#cb5-992" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x_values <span class="op">=</span> np.zeros((<span class="va">self</span>.num_paths, <span class="va">self</span>.num_steps <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb5-993"><a href="#cb5-993" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.step_size <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="va">self</span>.num_steps</span>
<span id="cb5-994"><a href="#cb5-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-995"><a href="#cb5-995" aria-hidden="true" tabindex="-1"></a>        <span class="co"># gaussian increments</span></span>
<span id="cb5-996"><a href="#cb5-996" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.brownian_increments <span class="op">=</span> np.sqrt(<span class="va">self</span>.step_size) <span class="op">*</span> np.random.standard_normal(</span>
<span id="cb5-997"><a href="#cb5-997" aria-hidden="true" tabindex="-1"></a>            size<span class="op">=</span>(<span class="va">self</span>.num_paths, <span class="va">self</span>.num_steps)</span>
<span id="cb5-998"><a href="#cb5-998" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-999"><a href="#cb5-999" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.brownian <span class="op">=</span> np.cumsum(<span class="va">self</span>.brownian_increments, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-1000"><a href="#cb5-1000" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.brownian <span class="op">=</span> np.concatenate(</span>
<span id="cb5-1001"><a href="#cb5-1001" aria-hidden="true" tabindex="-1"></a>            [np.zeros(shape<span class="op">=</span>(<span class="va">self</span>.num_paths, <span class="dv">1</span>)), <span class="va">self</span>.brownian], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb5-1002"><a href="#cb5-1002" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-1003"><a href="#cb5-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1004"><a href="#cb5-1004" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractmethod</span></span>
<span id="cb5-1005"><a href="#cb5-1005" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> iterate(<span class="va">self</span>, sivp: SIVP) <span class="op">-&gt;</span> X:</span>
<span id="cb5-1006"><a href="#cb5-1006" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb5-1007"><a href="#cb5-1007" aria-hidden="true" tabindex="-1"></a><span class="co">        Compute the next iterate X(n+1)</span></span>
<span id="cb5-1008"><a href="#cb5-1008" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb5-1009"><a href="#cb5-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1010"><a href="#cb5-1010" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> solve(<span class="va">self</span>, sivp: SIVP) <span class="op">-&gt;</span> (T, X):</span>
<span id="cb5-1011"><a href="#cb5-1011" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb5-1012"><a href="#cb5-1012" aria-hidden="true" tabindex="-1"></a><span class="co">        Solve the SIVP</span></span>
<span id="cb5-1013"><a href="#cb5-1013" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb5-1014"><a href="#cb5-1014" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x_values[:, <span class="dv">0</span>] <span class="op">=</span> np.full(</span>
<span id="cb5-1015"><a href="#cb5-1015" aria-hidden="true" tabindex="-1"></a>            shape<span class="op">=</span>(<span class="va">self</span>.num_paths,), fill_value<span class="op">=</span>sivp.initial_condition</span>
<span id="cb5-1016"><a href="#cb5-1016" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-1017"><a href="#cb5-1017" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">self</span>.<span class="bu">iter</span> <span class="op">&lt;</span> <span class="va">self</span>.num_steps:</span>
<span id="cb5-1018"><a href="#cb5-1018" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span> <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> <span class="va">self</span>.iterate(sivp)</span>
<span id="cb5-1019"><a href="#cb5-1019" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.<span class="bu">iter</span> <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-1020"><a href="#cb5-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1021"><a href="#cb5-1021" aria-hidden="true" tabindex="-1"></a>        times <span class="op">=</span> np.linspace(sivp.t_start, sivp.t_end, <span class="va">self</span>.num_steps <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb5-1022"><a href="#cb5-1022" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> times, <span class="va">self</span>.x_values</span>
<span id="cb5-1023"><a href="#cb5-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1024"><a href="#cb5-1024" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reset(<span class="va">self</span>):</span>
<span id="cb5-1025"><a href="#cb5-1025" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__post_init__()</span>
<span id="cb5-1026"><a href="#cb5-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1027"><a href="#cb5-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-1028"><a href="#cb5-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1029"><a href="#cb5-1029" aria-hidden="true" tabindex="-1"></a>The <span class="in">`EulerMaruyama`</span> and <span class="in">`Milstein`</span> methods will derive from the abstract base class <span class="in">`Solver`</span>.</span>
<span id="cb5-1030"><a href="#cb5-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1033"><a href="#cb5-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb5-1034"><a href="#cb5-1034" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb5-1035"><a href="#cb5-1035" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EulerMaruyama(Solver):</span>
<span id="cb5-1036"><a href="#cb5-1036" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb5-1037"><a href="#cb5-1037" aria-hidden="true" tabindex="-1"></a><span class="co">    Numerical solver for a stochastic differential equation(SDE) using</span></span>
<span id="cb5-1038"><a href="#cb5-1038" aria-hidden="true" tabindex="-1"></a><span class="co">    the Euler-Maruyama method.</span></span>
<span id="cb5-1039"><a href="#cb5-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1040"><a href="#cb5-1040" aria-hidden="true" tabindex="-1"></a><span class="co">    Consider an SDE of the form :</span></span>
<span id="cb5-1041"><a href="#cb5-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1042"><a href="#cb5-1042" aria-hidden="true" tabindex="-1"></a><span class="co">    dX_t = mu(t,X_t) dt + sigma(t,X_t) dB_t</span></span>
<span id="cb5-1043"><a href="#cb5-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1044"><a href="#cb5-1044" aria-hidden="true" tabindex="-1"></a><span class="co">    with initial condition X_0 = x_0</span></span>
<span id="cb5-1045"><a href="#cb5-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1046"><a href="#cb5-1046" aria-hidden="true" tabindex="-1"></a><span class="co">    The solution to the SDE can be computed using the increments</span></span>
<span id="cb5-1047"><a href="#cb5-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1048"><a href="#cb5-1048" aria-hidden="true" tabindex="-1"></a><span class="co">    X_{n+1} - X_n = mu(n,X_n)(t_{n+1}-t_n) + sigma(n,X_n)(B(n+1)-B(n))</span></span>
<span id="cb5-1049"><a href="#cb5-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1050"><a href="#cb5-1050" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb5-1051"><a href="#cb5-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1052"><a href="#cb5-1052" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> iterate(<span class="va">self</span>, sivp: SIVP) <span class="op">-&gt;</span> X:</span>
<span id="cb5-1053"><a href="#cb5-1053" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb5-1054"><a href="#cb5-1054" aria-hidden="true" tabindex="-1"></a><span class="co">        Generate the next iterate X(n+1)</span></span>
<span id="cb5-1055"><a href="#cb5-1055" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb5-1056"><a href="#cb5-1056" aria-hidden="true" tabindex="-1"></a>        current_time <span class="op">=</span> <span class="va">self</span>.<span class="bu">iter</span> <span class="op">*</span> <span class="va">self</span>.step_size</span>
<span id="cb5-1057"><a href="#cb5-1057" aria-hidden="true" tabindex="-1"></a>        mu_n <span class="op">=</span> sivp.drift(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb5-1058"><a href="#cb5-1058" aria-hidden="true" tabindex="-1"></a>        sigma_n <span class="op">=</span> sivp.vol(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb5-1059"><a href="#cb5-1059" aria-hidden="true" tabindex="-1"></a>        delta_x <span class="op">=</span> (</span>
<span id="cb5-1060"><a href="#cb5-1060" aria-hidden="true" tabindex="-1"></a>            mu_n <span class="op">*</span> <span class="va">self</span>.step_size <span class="op">+</span> sigma_n <span class="op">*</span> <span class="va">self</span>.brownian_increments[:, <span class="va">self</span>.<span class="bu">iter</span>]</span>
<span id="cb5-1061"><a href="#cb5-1061" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-1062"><a href="#cb5-1062" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>] <span class="op">+</span> delta_x</span>
<span id="cb5-1063"><a href="#cb5-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1064"><a href="#cb5-1064" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-1065"><a href="#cb5-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1068"><a href="#cb5-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb5-1069"><a href="#cb5-1069" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb5-1070"><a href="#cb5-1070" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Milstein(Solver):</span>
<span id="cb5-1071"><a href="#cb5-1071" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb5-1072"><a href="#cb5-1072" aria-hidden="true" tabindex="-1"></a><span class="co">    Numerical solver for a stochastic differential equation(SDE) using</span></span>
<span id="cb5-1073"><a href="#cb5-1073" aria-hidden="true" tabindex="-1"></a><span class="co">    the Euler-Maruyama method.</span></span>
<span id="cb5-1074"><a href="#cb5-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1075"><a href="#cb5-1075" aria-hidden="true" tabindex="-1"></a><span class="co">    Consider an SDE of the form :</span></span>
<span id="cb5-1076"><a href="#cb5-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1077"><a href="#cb5-1077" aria-hidden="true" tabindex="-1"></a><span class="co">    dX_t = mu(t,X_t) dt + sigma(t,X_t) dB_t</span></span>
<span id="cb5-1078"><a href="#cb5-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1079"><a href="#cb5-1079" aria-hidden="true" tabindex="-1"></a><span class="co">    with initial condition X_0 = x_0</span></span>
<span id="cb5-1080"><a href="#cb5-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1081"><a href="#cb5-1081" aria-hidden="true" tabindex="-1"></a><span class="co">    The solution to the SDE can be computed using the increments</span></span>
<span id="cb5-1082"><a href="#cb5-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1083"><a href="#cb5-1083" aria-hidden="true" tabindex="-1"></a><span class="co">    X_{n+1} - X_n = mu(n,X_n)(t_{n+1}-t_n) + sigma(n,X_n)(B(n+1)-B(n))</span></span>
<span id="cb5-1084"><a href="#cb5-1084" aria-hidden="true" tabindex="-1"></a><span class="co">    + 0.5 * sigma(n,X_n) * sigma'(n,X_n) * ((B(n+1) - B(n))**2 - (t_{n+1} - t_n))</span></span>
<span id="cb5-1085"><a href="#cb5-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1086"><a href="#cb5-1086" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb5-1087"><a href="#cb5-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1088"><a href="#cb5-1088" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> iterate(<span class="va">self</span>, sivp: SIVP):</span>
<span id="cb5-1089"><a href="#cb5-1089" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb5-1090"><a href="#cb5-1090" aria-hidden="true" tabindex="-1"></a><span class="co">        Generate the next iterate X(n+1)</span></span>
<span id="cb5-1091"><a href="#cb5-1091" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb5-1092"><a href="#cb5-1092" aria-hidden="true" tabindex="-1"></a>        current_time <span class="op">=</span> <span class="va">self</span>.<span class="bu">iter</span> <span class="op">*</span> <span class="va">self</span>.step_size</span>
<span id="cb5-1093"><a href="#cb5-1093" aria-hidden="true" tabindex="-1"></a>        mu_n <span class="op">=</span> sivp.drift(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb5-1094"><a href="#cb5-1094" aria-hidden="true" tabindex="-1"></a>        sigma_n <span class="op">=</span> sivp.vol(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb5-1095"><a href="#cb5-1095" aria-hidden="true" tabindex="-1"></a>        dvol_dx_n <span class="op">=</span> sivp.dvol_dx(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb5-1096"><a href="#cb5-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1097"><a href="#cb5-1097" aria-hidden="true" tabindex="-1"></a>        delta_x <span class="op">=</span> (</span>
<span id="cb5-1098"><a href="#cb5-1098" aria-hidden="true" tabindex="-1"></a>            mu_n <span class="op">*</span> <span class="va">self</span>.step_size</span>
<span id="cb5-1099"><a href="#cb5-1099" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> sigma_n <span class="op">*</span> <span class="va">self</span>.brownian_increments[:, <span class="va">self</span>.<span class="bu">iter</span>]</span>
<span id="cb5-1100"><a href="#cb5-1100" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> <span class="fl">0.5</span></span>
<span id="cb5-1101"><a href="#cb5-1101" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span> sigma_n</span>
<span id="cb5-1102"><a href="#cb5-1102" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span> dvol_dx_n</span>
<span id="cb5-1103"><a href="#cb5-1103" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span> (<span class="va">self</span>.brownian_increments[:, <span class="va">self</span>.<span class="bu">iter</span>] <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> <span class="va">self</span>.step_size)</span>
<span id="cb5-1104"><a href="#cb5-1104" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-1105"><a href="#cb5-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1106"><a href="#cb5-1106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>] <span class="op">+</span> delta_x</span>
<span id="cb5-1107"><a href="#cb5-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-1108"><a href="#cb5-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1109"><a href="#cb5-1109" aria-hidden="true" tabindex="-1"></a>::: {#exr-simulating-sdes}</span>
<span id="cb5-1110"><a href="#cb5-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1111"><a href="#cb5-1111" aria-hidden="true" tabindex="-1"></a>(Simulating SDEs) Simulate 100 paths for the following diffusions given by their SDEs on $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ using the Euler-Maruyama scheme and the Milstein scheme for a discretization of $0.01$.</span>
<span id="cb5-1112"><a href="#cb5-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1113"><a href="#cb5-1113" aria-hidden="true" tabindex="-1"></a>(a) Geometric Brownian Motion: </span>
<span id="cb5-1114"><a href="#cb5-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1115"><a href="#cb5-1115" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1116"><a href="#cb5-1116" aria-hidden="true" tabindex="-1"></a>dS_t = S_t dB_t + \left(\mu + \frac{\sigma^2}{2}\right)S_t dt, \quad S_0 = 1</span>
<span id="cb5-1117"><a href="#cb5-1117" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1118"><a href="#cb5-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1119"><a href="#cb5-1119" aria-hidden="true" tabindex="-1"></a>for $\mu=-1/2$, $\mu=-2$, and $\mu=0$</span>
<span id="cb5-1120"><a href="#cb5-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1121"><a href="#cb5-1121" aria-hidden="true" tabindex="-1"></a>(b) Ornstein-Uhlenbeck process:</span>
<span id="cb5-1122"><a href="#cb5-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1123"><a href="#cb5-1123" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1124"><a href="#cb5-1124" aria-hidden="true" tabindex="-1"></a>dX_t = -X_t dt + dB_t, \quad X_0 = 1</span>
<span id="cb5-1125"><a href="#cb5-1125" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1126"><a href="#cb5-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1127"><a href="#cb5-1127" aria-hidden="true" tabindex="-1"></a>(c) The diffusion:</span>
<span id="cb5-1128"><a href="#cb5-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1129"><a href="#cb5-1129" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1130"><a href="#cb5-1130" aria-hidden="true" tabindex="-1"></a>dX_t = \sqrt{1+X_t^2}dB_t + \sin X_t dt, \quad X_0 = 0</span>
<span id="cb5-1131"><a href="#cb5-1131" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1132"><a href="#cb5-1132" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-1133"><a href="#cb5-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1134"><a href="#cb5-1134" aria-hidden="true" tabindex="-1"></a>*Solution.*</span>
<span id="cb5-1135"><a href="#cb5-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1136"><a href="#cb5-1136" aria-hidden="true" tabindex="-1"></a>We can now use <span class="in">`EulerMaruyama`</span> and <span class="in">`Milstein`</span> solvers and generate some sample paths. </span>
<span id="cb5-1137"><a href="#cb5-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1140"><a href="#cb5-1140" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb5-1141"><a href="#cb5-1141" aria-hidden="true" tabindex="-1"></a><span class="co"># | code-fold: true</span></span>
<span id="cb5-1142"><a href="#cb5-1142" aria-hidden="true" tabindex="-1"></a><span class="co"># | code-summary: "Show the code"</span></span>
<span id="cb5-1143"><a href="#cb5-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1144"><a href="#cb5-1144" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_trajectories(ts, xs, title):</span>
<span id="cb5-1145"><a href="#cb5-1145" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="vs">r'Time $t$'</span>)</span>
<span id="cb5-1146"><a href="#cb5-1146" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="vs">r'$X(t)$'</span>)</span>
<span id="cb5-1147"><a href="#cb5-1147" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb5-1148"><a href="#cb5-1148" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb5-1149"><a href="#cb5-1149" aria-hidden="true" tabindex="-1"></a>    plt.plot(ts, xs.transpose())</span>
<span id="cb5-1150"><a href="#cb5-1150" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb5-1151"><a href="#cb5-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1152"><a href="#cb5-1152" aria-hidden="true" tabindex="-1"></a><span class="co"># mu = -0.5 case</span></span>
<span id="cb5-1153"><a href="#cb5-1153" aria-hidden="true" tabindex="-1"></a>euler <span class="op">=</span> EulerMaruyama(num_paths<span class="op">=</span><span class="dv">10</span>, num_steps<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb5-1154"><a href="#cb5-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1155"><a href="#cb5-1155" aria-hidden="true" tabindex="-1"></a>gbm_sde <span class="op">=</span> SIVP(</span>
<span id="cb5-1156"><a href="#cb5-1156" aria-hidden="true" tabindex="-1"></a>    t_start<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb5-1157"><a href="#cb5-1157" aria-hidden="true" tabindex="-1"></a>    t_end<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb5-1158"><a href="#cb5-1158" aria-hidden="true" tabindex="-1"></a>    initial_condition<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb5-1159"><a href="#cb5-1159" aria-hidden="true" tabindex="-1"></a>    drift<span class="op">=</span><span class="kw">lambda</span> t, s_t: np.zeros(<span class="dv">10</span>),</span>
<span id="cb5-1160"><a href="#cb5-1160" aria-hidden="true" tabindex="-1"></a>    vol<span class="op">=</span><span class="kw">lambda</span> t, s_t: s_t,</span>
<span id="cb5-1161"><a href="#cb5-1161" aria-hidden="true" tabindex="-1"></a>    dvol_dx<span class="op">=</span><span class="kw">lambda</span> t, s_t: np.ones(<span class="dv">10</span>),</span>
<span id="cb5-1162"><a href="#cb5-1162" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-1163"><a href="#cb5-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1164"><a href="#cb5-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1165"><a href="#cb5-1165" aria-hidden="true" tabindex="-1"></a>ts, xs <span class="op">=</span> euler.solve(gbm_sde)</span>
<span id="cb5-1166"><a href="#cb5-1166" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb5-1167"><a href="#cb5-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1168"><a href="#cb5-1168" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Geometric Brownian Motion, $\mu=-0.5$'</span>)</span>
<span id="cb5-1169"><a href="#cb5-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1170"><a href="#cb5-1170" aria-hidden="true" tabindex="-1"></a><span class="co"># mu = -2 case</span></span>
<span id="cb5-1171"><a href="#cb5-1171" aria-hidden="true" tabindex="-1"></a>gbm_sde.drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : <span class="op">-</span><span class="fl">1.5</span> <span class="op">*</span> s_t</span>
<span id="cb5-1172"><a href="#cb5-1172" aria-hidden="true" tabindex="-1"></a>ts, xs <span class="op">=</span> euler.solve(gbm_sde)</span>
<span id="cb5-1173"><a href="#cb5-1173" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb5-1174"><a href="#cb5-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1175"><a href="#cb5-1175" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Geometric Brownian Motion, $\mu=-2.0$'</span>)</span>
<span id="cb5-1176"><a href="#cb5-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1177"><a href="#cb5-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># mu = 0 case</span></span>
<span id="cb5-1178"><a href="#cb5-1178" aria-hidden="true" tabindex="-1"></a>gbm_sde.drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : <span class="fl">0.5</span> <span class="op">*</span> s_t</span>
<span id="cb5-1179"><a href="#cb5-1179" aria-hidden="true" tabindex="-1"></a>ts, xs <span class="op">=</span> euler.solve(gbm_sde)</span>
<span id="cb5-1180"><a href="#cb5-1180" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb5-1181"><a href="#cb5-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1182"><a href="#cb5-1182" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Geometric Brownian Motion, $\mu=0.0$'</span>)</span>
<span id="cb5-1183"><a href="#cb5-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1184"><a href="#cb5-1184" aria-hidden="true" tabindex="-1"></a><span class="co"># ornstein-uhlenbeck</span></span>
<span id="cb5-1185"><a href="#cb5-1185" aria-hidden="true" tabindex="-1"></a>ornstein_uhlenbeck_sde <span class="op">=</span> SIVP(</span>
<span id="cb5-1186"><a href="#cb5-1186" aria-hidden="true" tabindex="-1"></a>    t_start<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb5-1187"><a href="#cb5-1187" aria-hidden="true" tabindex="-1"></a>    t_end<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb5-1188"><a href="#cb5-1188" aria-hidden="true" tabindex="-1"></a>    initial_condition<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb5-1189"><a href="#cb5-1189" aria-hidden="true" tabindex="-1"></a>    drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : <span class="op">-</span>s_t,</span>
<span id="cb5-1190"><a href="#cb5-1190" aria-hidden="true" tabindex="-1"></a>    vol <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.ones(<span class="dv">10</span>),</span>
<span id="cb5-1191"><a href="#cb5-1191" aria-hidden="true" tabindex="-1"></a>    dvol_dx <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.zeros(<span class="dv">10</span>)</span>
<span id="cb5-1192"><a href="#cb5-1192" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-1193"><a href="#cb5-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1194"><a href="#cb5-1194" aria-hidden="true" tabindex="-1"></a>ts, xs <span class="op">=</span> euler.solve(ornstein_uhlenbeck_sde)</span>
<span id="cb5-1195"><a href="#cb5-1195" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb5-1196"><a href="#cb5-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1197"><a href="#cb5-1197" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Ornstein-Uhlenbeck'</span>)</span>
<span id="cb5-1198"><a href="#cb5-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1199"><a href="#cb5-1199" aria-hidden="true" tabindex="-1"></a><span class="co"># diffusion</span></span>
<span id="cb5-1200"><a href="#cb5-1200" aria-hidden="true" tabindex="-1"></a>diffusion_sde <span class="op">=</span> SIVP(</span>
<span id="cb5-1201"><a href="#cb5-1201" aria-hidden="true" tabindex="-1"></a>    t_start<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb5-1202"><a href="#cb5-1202" aria-hidden="true" tabindex="-1"></a>    t_end<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb5-1203"><a href="#cb5-1203" aria-hidden="true" tabindex="-1"></a>    initial_condition<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb5-1204"><a href="#cb5-1204" aria-hidden="true" tabindex="-1"></a>    drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.sin(s_t),</span>
<span id="cb5-1205"><a href="#cb5-1205" aria-hidden="true" tabindex="-1"></a>    vol <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.sqrt(<span class="dv">1</span><span class="op">+</span>s_t<span class="op">**</span><span class="dv">2</span>),</span>
<span id="cb5-1206"><a href="#cb5-1206" aria-hidden="true" tabindex="-1"></a>    dvol_dx <span class="op">=</span> <span class="kw">lambda</span> t, s_t : s_t <span class="op">/</span> np.sqrt(<span class="dv">1</span> <span class="op">+</span> s_t<span class="op">**</span><span class="dv">2</span>) </span>
<span id="cb5-1207"><a href="#cb5-1207" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-1208"><a href="#cb5-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1209"><a href="#cb5-1209" aria-hidden="true" tabindex="-1"></a>ts,xs <span class="op">=</span> euler.solve(diffusion_sde)</span>
<span id="cb5-1210"><a href="#cb5-1210" aria-hidden="true" tabindex="-1"></a>euler.reset()</span>
<span id="cb5-1211"><a href="#cb5-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1212"><a href="#cb5-1212" aria-hidden="true" tabindex="-1"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of the diffusion'</span>)</span>
<span id="cb5-1213"><a href="#cb5-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-1214"><a href="#cb5-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1215"><a href="#cb5-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">### Convergence</span></span>
<span id="cb5-1216"><a href="#cb5-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1217"><a href="#cb5-1217" aria-hidden="true" tabindex="-1"></a>It is of course possible go beyond the Milstein scheme to improve the approximation. However, it turns out that the above schemes already converge quite rapidly to the process itself. To see this, consider the mean absolute error between the approximation $X_T^{(n)}$ at time $T$ and $X_T$. Suppose that the approximation $X^{(n)}$ is obtained for a partition with discretization $t_{j+1}-t_j = 1/n$. It is possible to show that for the Euler scheme, we have:</span>
<span id="cb5-1218"><a href="#cb5-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1219"><a href="#cb5-1219" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1220"><a href="#cb5-1220" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1221"><a href="#cb5-1221" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">|X_T^{(n)} - X_T|</span><span class="co">]</span> \leq \frac{C}{\sqrt{n}}</span>
<span id="cb5-1222"><a href="#cb5-1222" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1223"><a href="#cb5-1223" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1224"><a href="#cb5-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1225"><a href="#cb5-1225" aria-hidden="true" tabindex="-1"></a>whereas for the Milstein scheme</span>
<span id="cb5-1226"><a href="#cb5-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1227"><a href="#cb5-1227" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1228"><a href="#cb5-1228" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1229"><a href="#cb5-1229" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">|X_T^{(n)} - X_T|</span><span class="co">]</span> \leq \frac{C'}{n}</span>
<span id="cb5-1230"><a href="#cb5-1230" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1231"><a href="#cb5-1231" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1232"><a href="#cb5-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1233"><a href="#cb5-1233" aria-hidden="true" tabindex="-1"></a>for some constants $C,C'&gt;0$. Note that the mean error between the two process must be the worst at the last point, since the errors add up. </span>
<span id="cb5-1234"><a href="#cb5-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1235"><a href="#cb5-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">## Existence and Uniqueness of SDEs</span></span>
<span id="cb5-1236"><a href="#cb5-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1237"><a href="#cb5-1237" aria-hidden="true" tabindex="-1"></a>As for the differential equations in standard calculus, SDEs play an important role in modelling stochastic phenomena. To model a trajectory $X_t, t\leq T$, it suffices to write down the variation due to the deterministic change $\mu(X_t)dt$ for some function $\mu(X_t)$ and the variation due to local fluctuations $\sigma(X_t)dB_t$ for some function $\sigma(X_t)$. Here, we assume that the local drift and volatility are time-homogenous for simplicity. This gives the SDE:</span>
<span id="cb5-1238"><a href="#cb5-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1239"><a href="#cb5-1239" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1240"><a href="#cb5-1240" aria-hidden="true" tabindex="-1"></a>dX_t = \mu(X_t) dt + \sigma(X_t) dB_t</span>
<span id="cb5-1241"><a href="#cb5-1241" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb5-1242"><a href="#cb5-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1243"><a href="#cb5-1243" aria-hidden="true" tabindex="-1"></a>Do we get one nice Ito process for any choice of functions $\sigma$ and $\mu$? The short answer is no. Here are sufficient conditions for the existence of a unique process. </span>
<span id="cb5-1244"><a href="#cb5-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1245"><a href="#cb5-1245" aria-hidden="true" tabindex="-1"></a>::: {#thm-existence-and-uniqueness-of-solutions-to-sde}</span>
<span id="cb5-1246"><a href="#cb5-1246" aria-hidden="true" tabindex="-1"></a><span class="fu">### Existence and Uniqueness of solutions to SDE</span></span>
<span id="cb5-1247"><a href="#cb5-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1248"><a href="#cb5-1248" aria-hidden="true" tabindex="-1"></a>Consider the SDE</span>
<span id="cb5-1249"><a href="#cb5-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1250"><a href="#cb5-1250" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1251"><a href="#cb5-1251" aria-hidden="true" tabindex="-1"></a>dX_t = \mu(X_t) dt  + \sigma(X_t)dB_t, \quad X_0 = x, \quad t\in <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span></span>
<span id="cb5-1252"><a href="#cb5-1252" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1253"><a href="#cb5-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1254"><a href="#cb5-1254" aria-hidden="true" tabindex="-1"></a>If the functions $\sigma$ and $\mu$ grow not faster than $Kx^2$ for some $K&gt;0$ and are differentiable with bounded derivatives on $\mathbb{R}^1$, then there exists a unique solution $(X_t,t\in<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>)$ to the SDE. In other words, there exists a continuous process $(X_t, t \leq T)$ adapted to the filtration of the Brownian motion given by:</span>
<span id="cb5-1255"><a href="#cb5-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1256"><a href="#cb5-1256" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1257"><a href="#cb5-1257" aria-hidden="true" tabindex="-1"></a>X_t = x + \int_0^t \mu(X_s) ds + \int_0^t \sigma(X_s) dB_s, \quad t\leq T</span>
<span id="cb5-1258"><a href="#cb5-1258" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1259"><a href="#cb5-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1260"><a href="#cb5-1260" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-1261"><a href="#cb5-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1262"><a href="#cb5-1262" aria-hidden="true" tabindex="-1"></a>::: {#exm-diffusion}</span>
<span id="cb5-1263"><a href="#cb5-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1264"><a href="#cb5-1264" aria-hidden="true" tabindex="-1"></a>Consider the SDE :</span>
<span id="cb5-1265"><a href="#cb5-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1266"><a href="#cb5-1266" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1267"><a href="#cb5-1267" aria-hidden="true" tabindex="-1"></a>dX_t = \sqrt{1 + X_t^2}dB_t + \sin X_t dt</span>
<span id="cb5-1268"><a href="#cb5-1268" aria-hidden="true" tabindex="-1"></a>$$ {#eq-a-diffusion}</span>
<span id="cb5-1269"><a href="#cb5-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1270"><a href="#cb5-1270" aria-hidden="true" tabindex="-1"></a>There exists a unique diffusion process $(X_t,t\geq 0)$ that is a solution of this SDE. To see this, we verify the conditions of the  @thm-existence-and-uniqueness-of-solutions-to-sde. We have:</span>
<span id="cb5-1271"><a href="#cb5-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1272"><a href="#cb5-1272" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1273"><a href="#cb5-1273" aria-hidden="true" tabindex="-1"></a>\sigma(x) = \sqrt{1 + x^2}, \quad \mu(x) = \sin x</span>
<span id="cb5-1274"><a href="#cb5-1274" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1275"><a href="#cb5-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1276"><a href="#cb5-1276" aria-hidden="true" tabindex="-1"></a>Clearly, these functions satisfy the growth condition since $\mu$ is bounded and $\sigma$ grows like $|x|$ for large $x$. As for the derivatives, we have $\sigma'(x)=\frac{x}{\sqrt{1+x^2}}$ and $\mu'(x)=\cos x$. The two derivatives are bounded. </span>
<span id="cb5-1277"><a href="#cb5-1277" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-1278"><a href="#cb5-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1279"><a href="#cb5-1279" aria-hidden="true" tabindex="-1"></a>The assumptions of @thm-existence-and-uniqueness-of-solutions-to-sde are not too surprising, since similar ones are found in the classical case of ODE. For example, if we have the ODE</span>
<span id="cb5-1280"><a href="#cb5-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1281"><a href="#cb5-1281" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1282"><a href="#cb5-1282" aria-hidden="true" tabindex="-1"></a>\frac{dX_t}{dt} = X_t^{1/2}, \quad X_0 = 0</span>
<span id="cb5-1283"><a href="#cb5-1283" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1284"><a href="#cb5-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1285"><a href="#cb5-1285" aria-hidden="true" tabindex="-1"></a>then clearly $X_t = 0$ for all $t$ is a solution. But, we also have by integrating that:</span>
<span id="cb5-1286"><a href="#cb5-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1287"><a href="#cb5-1287" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1288"><a href="#cb5-1288" aria-hidden="true" tabindex="-1"></a>X_t = \frac{t^2}{4}, t \geq 0</span>
<span id="cb5-1289"><a href="#cb5-1289" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1290"><a href="#cb5-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1291"><a href="#cb5-1291" aria-hidden="true" tabindex="-1"></a>Therefore, the uniqueness breaks down. Note, that the function $\mu(x)=\sqrt{x}$ does not have bounded derivatives at $0$. Similarly, consider the ODE:</span>
<span id="cb5-1292"><a href="#cb5-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1293"><a href="#cb5-1293" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1294"><a href="#cb5-1294" aria-hidden="true" tabindex="-1"></a>\frac{dX_t}{dt} = e^{X_t}, X_0 = 0</span>
<span id="cb5-1295"><a href="#cb5-1295" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1296"><a href="#cb5-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1297"><a href="#cb5-1297" aria-hidden="true" tabindex="-1"></a>Here, the function $\mu(x)$ grows much faster than $x^2$. The solution of the ODE is by integrating </span>
<span id="cb5-1298"><a href="#cb5-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1299"><a href="#cb5-1299" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1300"><a href="#cb5-1300" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1301"><a href="#cb5-1301" aria-hidden="true" tabindex="-1"></a>-(e^{-X_t} - 1) &amp;= t<span class="sc">\\</span></span>
<span id="cb5-1302"><a href="#cb5-1302" aria-hidden="true" tabindex="-1"></a>e^{-X_t} &amp;= (1 - t)<span class="sc">\\</span></span>
<span id="cb5-1303"><a href="#cb5-1303" aria-hidden="true" tabindex="-1"></a>-X_t &amp;= \log(1 - t)<span class="sc">\\</span></span>
<span id="cb5-1304"><a href="#cb5-1304" aria-hidden="true" tabindex="-1"></a>X_t &amp;= \log \left(\frac{1}{1-t}\right)</span>
<span id="cb5-1305"><a href="#cb5-1305" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1306"><a href="#cb5-1306" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1307"><a href="#cb5-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1308"><a href="#cb5-1308" aria-hidden="true" tabindex="-1"></a>The solution explodes at $t=1$. The same phenomenon may occur for SDE; that is the process will almost surely go $\infty$ in finite time. These times are called *explosion times*. Note that it is possible to consider the paths of the diffusion upto these explosion times. It is important to keep in mind that the conditions of  @thm-existence-and-uniqueness-of-solutions-to-sde are sufficient, but not necessary. In particular, it is sometimes possible to explicitly construct a diffusion whose local volatility and drift do not satisfy the conditions. Let's look at two important instances of such diffusions.</span>
<span id="cb5-1309"><a href="#cb5-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1310"><a href="#cb5-1310" aria-hidden="true" tabindex="-1"></a>::: {exm-bessel-process}</span>
<span id="cb5-1311"><a href="#cb5-1311" aria-hidden="true" tabindex="-1"></a>Let $B_t$ be a brownian motion in $\mathbb{R}^d$ for $d&gt;1$. Consider the process giving the distance at time $t$ of $B_t$ to the origin; that is:</span>
<span id="cb5-1312"><a href="#cb5-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1313"><a href="#cb5-1313" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1314"><a href="#cb5-1314" aria-hidden="true" tabindex="-1"></a>R_t = ||B_t|| = \left(\sum_{j=1}^d B_t^{(j)}\right)^2</span>
<span id="cb5-1315"><a href="#cb5-1315" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1316"><a href="#cb5-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1317"><a href="#cb5-1317" aria-hidden="true" tabindex="-1"></a>(For $d=1$, this is simply $|B_t|$. Ito's formula cannot be applied in this case, since the absolute value is not differentiable at the origin.) In higher dimensions, the function is smooth enough as long as we stay away from the origin. This is not a problem as long as $R_0 &gt; 0$. </span>
<span id="cb5-1318"><a href="#cb5-1318" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-1319"><a href="#cb5-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1320"><a href="#cb5-1320" aria-hidden="true" tabindex="-1"></a>Let's find out the SDE that this process satisfies. </span>
<span id="cb5-1321"><a href="#cb5-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1322"><a href="#cb5-1322" aria-hidden="true" tabindex="-1"></a>Let $r=f(x_1,x_2,\ldots,x_d)=\sqrt{\sum_{j=1}^d x_j^2}$. We have:</span>
<span id="cb5-1323"><a href="#cb5-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1324"><a href="#cb5-1324" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1325"><a href="#cb5-1325" aria-hidden="true" tabindex="-1"></a>\frac{\partial r}{\partial x_j} &amp;= \frac{x_j}{\sqrt{\sum_{j=1}^d x_j^2}}<span class="sc">\\</span></span>
<span id="cb5-1326"><a href="#cb5-1326" aria-hidden="true" tabindex="-1"></a>\frac{\partial^2 r}{\partial x_j^2} &amp;= \frac{||x|| - x_j \cdot \frac{x_j}{||x||}}{||x||^2}<span class="sc">\\</span></span>
<span id="cb5-1327"><a href="#cb5-1327" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{||x||^2 - x_j^2}{||x||^3}</span>
<span id="cb5-1328"><a href="#cb5-1328" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1329"><a href="#cb5-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1330"><a href="#cb5-1330" aria-hidden="true" tabindex="-1"></a>By Ito's formula,</span>
<span id="cb5-1331"><a href="#cb5-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1332"><a href="#cb5-1332" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1333"><a href="#cb5-1333" aria-hidden="true" tabindex="-1"></a>dR_t &amp;= \sum_{j=1}^{d} \frac{B_t^{j}}{R_t} dB_t^{(j)} + \frac{1}{2} \sum_{j=1}^{d} \frac{R_t^2 - (B_t^{(j)})^2}{R_t^3}<span class="sc">\\</span></span>
<span id="cb5-1334"><a href="#cb5-1334" aria-hidden="true" tabindex="-1"></a>&amp;= \sum_{j=1}^{d} \frac{B_t^{j}}{R_t} dB_t^{(j)} + \frac{1}{2} \frac{d R_t^2 - R_t^2}{R_t^3}<span class="sc">\\</span></span>
<span id="cb5-1335"><a href="#cb5-1335" aria-hidden="true" tabindex="-1"></a>&amp;= \sum_{j=1}^{d} \frac{B_t^{j}}{R_t} dB_t^{(j)} + \frac{1}{2} \frac{(d-1)}{R_t}</span>
<span id="cb5-1336"><a href="#cb5-1336" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1337"><a href="#cb5-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1338"><a href="#cb5-1338" aria-hidden="true" tabindex="-1"></a>We can define $dW_t = \sum_{j=1}^{d} \frac{B_t^{(j)}}{R_t} dB_t^{(j)}$. Then, $dR_t = dW_t + \frac{d-1}{2R_t}dt$</span>
<span id="cb5-1339"><a href="#cb5-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1340"><a href="#cb5-1340" aria-hidden="true" tabindex="-1"></a>It turns out that $(W_t,t \geq 0)$ is a standard Brownian motion by Levy's characterization theorem. This is the subject of the next section. The SDE shows that $dR_t$ is a diffusion. The SDE makes sense for any real number $d &gt; 1$, not only integers. Moreover, the SDE is well-defined since $R_t$ is never equal to $0$. However, the SDE does not satisfy the assumption of the existence and uniqueness of the solution of SDEs since $1/x$ diverges at $0$. The solution to the SDE still exists since we constructed it! We sample paths of this process in numerical project.</span>
<span id="cb5-1341"><a href="#cb5-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1342"><a href="#cb5-1342" aria-hidden="true" tabindex="-1"></a>::: {#exm-cox-ingersoll-ross-process}</span>
<span id="cb5-1343"><a href="#cb5-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1344"><a href="#cb5-1344" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Cox-Ingersoll-Ross (CIR) model.</span></span>
<span id="cb5-1345"><a href="#cb5-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1346"><a href="#cb5-1346" aria-hidden="true" tabindex="-1"></a>Consider the SDE:</span>
<span id="cb5-1347"><a href="#cb5-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1348"><a href="#cb5-1348" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1349"><a href="#cb5-1349" aria-hidden="true" tabindex="-1"></a>dS_t = \sigma \sqrt{S_t} dW_t + (a - bS_t)dt, \quad S_0 &gt; 0</span>
<span id="cb5-1350"><a href="#cb5-1350" aria-hidden="true" tabindex="-1"></a>$$ {#eq-cir-process}</span>
<span id="cb5-1351"><a href="#cb5-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1352"><a href="#cb5-1352" aria-hidden="true" tabindex="-1"></a>for some parameters $a,b &gt; 0$ where $(W_t,t \geq 0)$ is a standard Brownian motion. The local volatility $\sigma(x)=\sigma \sqrt{x}$ does not have a bounded derivative close to $0$, since $\sigma'(x)=\frac{\sigma}{2\sqrt{x}}$. We will nevertheless construct a diffusion that is a solution to the SDE. Consider independent Ornstein-Uhlenbeck processes $X_t^{(j)}, j \leq d$, with SDE:</span>
<span id="cb5-1353"><a href="#cb5-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1354"><a href="#cb5-1354" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1355"><a href="#cb5-1355" aria-hidden="true" tabindex="-1"></a>dX_t^{(j)} = \frac{-b}{2}X_t^{(j)}dt + \frac{\sigma}{2}dB_t^{(j)}, \quad X_0^{(j)} &gt; 0</span>
<span id="cb5-1356"><a href="#cb5-1356" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1357"><a href="#cb5-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1358"><a href="#cb5-1358" aria-hidden="true" tabindex="-1"></a>where $B_t = (B_t^{(j)},j\leq d)$ is a Brownian motion in $\mathbb{R}^d$. We consider the process </span>
<span id="cb5-1359"><a href="#cb5-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1360"><a href="#cb5-1360" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1361"><a href="#cb5-1361" aria-hidden="true" tabindex="-1"></a>S_t = \sum_{j \leq d} (X_t^{(j)})^2</span>
<span id="cb5-1362"><a href="#cb5-1362" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1363"><a href="#cb5-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1364"><a href="#cb5-1364" aria-hidden="true" tabindex="-1"></a>Clearly, $S_t$ is nongegative for all $t \geq 0$ by design, so $\sqrt{S_t}$ is well-defined. Let's compute the SDE of the process. By Ito's formula, we have:</span>
<span id="cb5-1365"><a href="#cb5-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1366"><a href="#cb5-1366" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1367"><a href="#cb5-1367" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1368"><a href="#cb5-1368" aria-hidden="true" tabindex="-1"></a>dS_t &amp;= 2\sum_{j=1}^{d}X_t^{(j)} dX_t^{(j)} + \frac{1}{2}\sum_{j=1}^{d} 2 (dX_t^{(j)})^2<span class="sc">\\</span></span>
<span id="cb5-1369"><a href="#cb5-1369" aria-hidden="true" tabindex="-1"></a>&amp;=2\sum_{j=1}^{d}X_t^{(j)} dX_t^{(j)} + \frac{\sigma^2}{4}\sum_{j=1}^{d} dt <span class="sc">\\</span></span>
<span id="cb5-1370"><a href="#cb5-1370" aria-hidden="true" tabindex="-1"></a>&amp;=2\sum_{j=1}^{d}X_t^{(j)} \left(\frac{-b}{2}X_t^{(j)}dt + \frac{\sigma}{2}dB_t^{(j)}\right) + \frac{d\sigma^2}{4} dt<span class="sc">\\</span></span>
<span id="cb5-1371"><a href="#cb5-1371" aria-hidden="true" tabindex="-1"></a>&amp;=\left<span class="co">[</span><span class="ot">\left(\sum_{j=1}^d (-b)(X_t^{(j)})^2\right) + \frac{d\sigma^2}{4}\right</span><span class="co">]</span> dt + \sigma \sum_{j=1}^{d} X_t^{(j)} dB_t^{(j)}<span class="sc">\\</span></span>
<span id="cb5-1372"><a href="#cb5-1372" aria-hidden="true" tabindex="-1"></a>&amp;=\sigma \sum_{j=1}^{d} X_t^{(j)} dB_t^{(j)} + \left<span class="co">[</span><span class="ot">\frac{d\sigma^2}{4} - b S_t\right</span><span class="co">]</span> dt <span class="sc">\\</span></span>
<span id="cb5-1373"><a href="#cb5-1373" aria-hidden="true" tabindex="-1"></a>&amp;= \sigma \sqrt{S_t} \sum_{j=1}^{d} \frac{X_t^{(j)}}{\sqrt{S_t}} dB_t^{(j)}  + \left<span class="co">[</span><span class="ot">\frac{d\sigma^2}{4} - b S_t\right</span><span class="co">]</span> dt <span class="sc">\\</span></span>
<span id="cb5-1374"><a href="#cb5-1374" aria-hidden="true" tabindex="-1"></a>&amp;= \sigma \sqrt{S_t} dW_t  + \left<span class="co">[</span><span class="ot">\frac{d\sigma^2}{4} - b S_t\right</span><span class="co">]</span> dt <span class="sc">\\</span></span>
<span id="cb5-1375"><a href="#cb5-1375" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1376"><a href="#cb5-1376" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1377"><a href="#cb5-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1378"><a href="#cb5-1378" aria-hidden="true" tabindex="-1"></a>where we have defined $dW_t = \sum_{j=1}^d \frac{X_t^{(j)}}{\sqrt{S_t}} dB_t^{(j)}$. It turns out that the process $(W_t,t\geq 0)$ is a standard brownian motion by Levy's characterization theorem. If we accept this for a moment, we have the SDE:</span>
<span id="cb5-1379"><a href="#cb5-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1380"><a href="#cb5-1380" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1381"><a href="#cb5-1381" aria-hidden="true" tabindex="-1"></a>dS_t = \sigma \sqrt{S_t} dW_t + \left(\frac{d \sigma^2}{4} - bS_t\right) dt, \quad S_0 &gt; 0</span>
<span id="cb5-1382"><a href="#cb5-1382" aria-hidden="true" tabindex="-1"></a>$$ {#eq-cir-process-2}</span>
<span id="cb5-1383"><a href="#cb5-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1384"><a href="#cb5-1384" aria-hidden="true" tabindex="-1"></a>This is a time-homogenous diffusion called the Cox-Ingersoll-Ross (CIR) process. Again, notice that there are no issues with square root, since $S_t$ is positive by construction! The SDE also makes sense if replace $d\sigma^2/4$ by a parameter $a$ in @eq-cir-process  as long as $a \geq \frac{d\sigma^2}{4}$. This process is important for interest rates and stochastic volatility models.</span>
<span id="cb5-1385"><a href="#cb5-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1386"><a href="#cb5-1386" aria-hidden="true" tabindex="-1"></a>Note that the local drift is $a - bS_t, a\ge \frac{d\sigma^2}{4}$. This can be written as:</span>
<span id="cb5-1387"><a href="#cb5-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1388"><a href="#cb5-1388" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1389"><a href="#cb5-1389" aria-hidden="true" tabindex="-1"></a>a - bS_t = b\left(\frac{b}{a} - S_t \right)</span>
<span id="cb5-1390"><a href="#cb5-1390" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1391"><a href="#cb5-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1392"><a href="#cb5-1392" aria-hidden="true" tabindex="-1"></a>This means that the local drift is negative if $S_t &gt; \frac{a}{b}$ and it is positive if $S_t &lt; \frac{a}{b}$. So, the SDE exhibits the same phenomenon as for the SDE of the Ornstein-Uhlenbeck process in @exm-ornstein-uhlenbeck-process. In particular we should expect that for $t$ large, the process should fluctuate around the mean value $\frac{a}{b}$. The CIR model is therefore an example of a mean-reverting process. More generally, this hints to the fact, that the process is stationary in the long run. </span>
<span id="cb5-1393"><a href="#cb5-1393" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-1394"><a href="#cb5-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1395"><a href="#cb5-1395" aria-hidden="true" tabindex="-1"></a><span class="fu">## Martingale Representation and Levy's Characterization</span></span>
<span id="cb5-1396"><a href="#cb5-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1397"><a href="#cb5-1397" aria-hidden="true" tabindex="-1"></a>We know very well by now, that an Ito integral is continuous martingale with respect to the Brownian filtration, whenever the integrand is in $\mathcal{L}_c^2(T)$. What can we say about the converse? In other words, if we have a martingale with respect to the Brownian filtration, can it be expressed as an Ito integral for some integrand $(V_t,t\leq T)$? Amazingly, the answer to this question is yes!</span>
<span id="cb5-1398"><a href="#cb5-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1399"><a href="#cb5-1399" aria-hidden="true" tabindex="-1"></a>::: {#thm-martingale-representation-theorem}</span>
<span id="cb5-1400"><a href="#cb5-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1401"><a href="#cb5-1401" aria-hidden="true" tabindex="-1"></a><span class="fu">### Martingale Representation Theorem.</span></span>
<span id="cb5-1402"><a href="#cb5-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1403"><a href="#cb5-1403" aria-hidden="true" tabindex="-1"></a>Let $(B_t,t \geq 0)$ be a Brownian motion with filtration $(\mathcal{F}_t,t\geq 0)$ on $(\Omega,\mathcal{F},\mathbb{P})$. Consider a martingale $(M_t,t\leq T)$ with respect to this filtration. Then, there exists an adapted process $(V_t,t \leq T)$ such that:</span>
<span id="cb5-1404"><a href="#cb5-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1405"><a href="#cb5-1405" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1406"><a href="#cb5-1406" aria-hidden="true" tabindex="-1"></a>M_t = M_0 + \int_0^t V_s dB_s, \quad t \leq T</span>
<span id="cb5-1407"><a href="#cb5-1407" aria-hidden="true" tabindex="-1"></a>$$ {#eq-martingale-representation-theorem}</span>
<span id="cb5-1408"><a href="#cb5-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1409"><a href="#cb5-1409" aria-hidden="true" tabindex="-1"></a>One striking fact of the result is that $(M_t,t\leq T)$ ought to be continuous. In other words, we cannot construct a process with a jump that is a martingale adapted to Brownian motion!</span>
<span id="cb5-1410"><a href="#cb5-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1411"><a href="#cb5-1411" aria-hidden="true" tabindex="-1"></a>Instead of the proving the theorem, we will see how the result is not too surprising with stronger assumptions. Instead of supposing that $M_t$ is $\mathcal{F}_t$ measurable, take that $M_t$ is $\sigma(B_t)$-measurable. In other words, $M_t=h(B_t)$ for some function $h$. In the case where $h$ is smooth, then it is clear by Ito's formula that the representation @eq-martingale-representation-theorem holds with $V_s = h'(B_s)$. </span>
<span id="cb5-1412"><a href="#cb5-1412" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-1413"><a href="#cb5-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1414"><a href="#cb5-1414" aria-hidden="true" tabindex="-1"></a>An important consequence of @thm-martingale-representation-theorem is a third definition of Brownian motion.</span>
<span id="cb5-1415"><a href="#cb5-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1416"><a href="#cb5-1416" aria-hidden="true" tabindex="-1"></a>::: {#thm-levy-characterization-theorem}</span>
<span id="cb5-1417"><a href="#cb5-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1418"><a href="#cb5-1418" aria-hidden="true" tabindex="-1"></a><span class="fu">### One-dimensional Levy's Characterization theorem</span></span>
<span id="cb5-1419"><a href="#cb5-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1420"><a href="#cb5-1420" aria-hidden="true" tabindex="-1"></a>Let $(M_t,t\in <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>)$ be a continuous martingale with respect to the filtration $(\mathcal{F}_t,t \leq T)$ with $M_0 = 0$ and with quadratic variation $&lt;M&gt;_t = t$. Then, $(M_t,t\leq T)$ is a standard brownian motion. </span>
<span id="cb5-1421"><a href="#cb5-1421" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-1422"><a href="#cb5-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1423"><a href="#cb5-1423" aria-hidden="true" tabindex="-1"></a>*Proof.*</span>
<span id="cb5-1424"><a href="#cb5-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1425"><a href="#cb5-1425" aria-hidden="true" tabindex="-1"></a>We first need to show that $M_t - M_s \sim \mathcal{N}(0,t - s)$ or using the characteristic function approach, we need to show that $f_{(M_t - M_s)}(\theta)=\mathbb{E}<span class="co">[</span><span class="ot">e^{\theta (M_t - M_s)}</span><span class="co">]</span> = e^{\frac{1}{2}\theta^2 (t-s)}$ for constant $\theta$.</span>
<span id="cb5-1426"><a href="#cb5-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1427"><a href="#cb5-1427" aria-hidden="true" tabindex="-1"></a>Let $f(t,x) = e^{\theta x - \frac{1}{2}\theta^2 t}$.</span>
<span id="cb5-1428"><a href="#cb5-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1429"><a href="#cb5-1429" aria-hidden="true" tabindex="-1"></a>By Ito's formula, we have:</span>
<span id="cb5-1430"><a href="#cb5-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1431"><a href="#cb5-1431" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1432"><a href="#cb5-1432" aria-hidden="true" tabindex="-1"></a>df(t,M_t) &amp;= \theta e^{\theta M_t - \frac{1}{2}\theta^2 t} dM_t + \left(-\frac{1}{2}\theta^2 + \frac{1}{2} \theta^2 \right)e^{\theta M_t - \frac{1}{2}\theta^2 t}dt<span class="sc">\\</span></span>
<span id="cb5-1433"><a href="#cb5-1433" aria-hidden="true" tabindex="-1"></a>&amp;= \theta f(t,M_t) dM_t</span>
<span id="cb5-1434"><a href="#cb5-1434" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1435"><a href="#cb5-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1436"><a href="#cb5-1436" aria-hidden="true" tabindex="-1"></a>Integrating on both sides, we get:</span>
<span id="cb5-1437"><a href="#cb5-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1438"><a href="#cb5-1438" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1439"><a href="#cb5-1439" aria-hidden="true" tabindex="-1"></a>f(t,M_t) - f(s,M_s) &amp;= \theta \int_0^t f(u,M_u) dM_u</span>
<span id="cb5-1440"><a href="#cb5-1440" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1441"><a href="#cb5-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1442"><a href="#cb5-1442" aria-hidden="true" tabindex="-1"></a>The ito integral $\int_0^t f(s,M_s) dM_s$ is well-defined and its expectation is $0$. Hence, applying expectation operator on both sides, we get:</span>
<span id="cb5-1443"><a href="#cb5-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1444"><a href="#cb5-1444" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1445"><a href="#cb5-1445" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">f(t,M_t) - f(s,M_s)</span><span class="co">]</span> &amp;= \theta \mathbb{E} \left<span class="co">[</span><span class="ot"> \int_0^t f(s,M_s) dM_s\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb5-1446"><a href="#cb5-1446" aria-hidden="true" tabindex="-1"></a>&amp;= 0 </span>
<span id="cb5-1447"><a href="#cb5-1447" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1448"><a href="#cb5-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1449"><a href="#cb5-1449" aria-hidden="true" tabindex="-1"></a>Since $e^{x} \neq 0$ for all $x$, dividing by $f(s,M_s)$, we get:</span>
<span id="cb5-1450"><a href="#cb5-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1451"><a href="#cb5-1451" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1452"><a href="#cb5-1452" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\left<span class="co">[</span><span class="ot">\frac{f(t,M_t)}{f(s,M_s)}\right</span><span class="co">]</span> &amp;= 1<span class="sc">\\</span></span>
<span id="cb5-1453"><a href="#cb5-1453" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\left<span class="co">[</span><span class="ot">\frac{e^{\theta M_t - \frac{1}{2}\theta^2 t}}{e^{\theta M_s - \frac{1}{2}\theta^2 s}}\right</span><span class="co">]</span> &amp;= 1<span class="sc">\\</span></span>
<span id="cb5-1454"><a href="#cb5-1454" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\left<span class="co">[</span><span class="ot">e^{\theta(M_t - M_s)}\right</span><span class="co">]</span> &amp;= e^{\frac{1}{2}\theta^2(t-s)}</span>
<span id="cb5-1455"><a href="#cb5-1455" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1456"><a href="#cb5-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1457"><a href="#cb5-1457" aria-hidden="true" tabindex="-1"></a>which is the moment generating function for the normal distribution with mean zero and variance $t-s$. So, $M_t - M_s \sim \mathcal{N}(0, t - s)$. </span>
<span id="cb5-1458"><a href="#cb5-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1459"><a href="#cb5-1459" aria-hidden="true" tabindex="-1"></a>Further, consider $t_1 \leq t_2 \leq t_3$. We have:</span>
<span id="cb5-1460"><a href="#cb5-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1461"><a href="#cb5-1461" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb5-1462"><a href="#cb5-1462" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">(M_{t_3} - M_{t_2})(M_{t_2} - M_{t_1})</span><span class="co">]</span> &amp;= \mathbb{E}<span class="co">[</span><span class="ot">\mathbb{E}[(M_{t_3} - M_{t_2})(M_{t_2} - M_{t_1})|\mathcal{F}_{t_2}]</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb5-1463"><a href="#cb5-1463" aria-hidden="true" tabindex="-1"></a>&amp;= \mathbb{E}<span class="co">[</span><span class="ot">(M_{t_2} - M_{t_1})\mathbb{E}[(M_{t_3} - M_{t_2})|\mathcal{F}_{t_2}]</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb5-1464"><a href="#cb5-1464" aria-hidden="true" tabindex="-1"></a>&amp;= \mathbb{E}<span class="co">[</span><span class="ot">(M_{t_2} - M_{t_1})(M_{t_2} - M_{t_2})</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb5-1465"><a href="#cb5-1465" aria-hidden="true" tabindex="-1"></a>&amp;= 0</span>
<span id="cb5-1466"><a href="#cb5-1466" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb5-1467"><a href="#cb5-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1468"><a href="#cb5-1468" aria-hidden="true" tabindex="-1"></a>where $\mathbb{E}<span class="co">[</span><span class="ot">M_{t_3} - M_{t_2}|\mathcal{F}_{t_2}</span><span class="co">]</span> = 0$ follows from the fact that $(M_t,t\geq 0)$ is a martingale. Consequently, $M_{t_3} - M_{t_2} \perp M_{t_2} - M_{t_1}$ and non-overlapping increments are independent.</span>
<span id="cb5-1469"><a href="#cb5-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1470"><a href="#cb5-1470" aria-hidden="true" tabindex="-1"></a>Moreover, $M(0) = 0$. So, $(M_t,t\geq 0)$ is a standard brownian motion. This closes the proof. $\blacksquare$</span>
<span id="cb5-1471"><a href="#cb5-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1472"><a href="#cb5-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1473"><a href="#cb5-1473" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise Problems</span></span>
<span id="cb5-1474"><a href="#cb5-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1475"><a href="#cb5-1475" aria-hidden="true" tabindex="-1"></a>::: {#exr-power-of-bm}</span>
<span id="cb5-1476"><a href="#cb5-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1477"><a href="#cb5-1477" aria-hidden="true" tabindex="-1"></a>Let $(\Omega,\mathcal{F},\mathbb{P})$ be a probability space and $(W_t,t\geq 0)$ be a standard Wiener process. Find the SDE for the random process $X_t = W_t^n, n \in \mathbb{Z}^{+}$.</span>
<span id="cb5-1478"><a href="#cb5-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1479"><a href="#cb5-1479" aria-hidden="true" tabindex="-1"></a>Show that</span>
<span id="cb5-1480"><a href="#cb5-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1481"><a href="#cb5-1481" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1482"><a href="#cb5-1482" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">W_t^n</span><span class="co">]</span> = \frac{1}{2}n(n-1) \int_0^t \mathbb{E}\left<span class="co">[</span><span class="ot">W_s^{(n-2)}\right</span><span class="co">]</span> ds</span>
<span id="cb5-1483"><a href="#cb5-1483" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1484"><a href="#cb5-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1485"><a href="#cb5-1485" aria-hidden="true" tabindex="-1"></a>and using mathematical induction prove that:</span>
<span id="cb5-1486"><a href="#cb5-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1487"><a href="#cb5-1487" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1488"><a href="#cb5-1488" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">W_t^n</span><span class="co">]</span> = \begin{cases}</span>
<span id="cb5-1489"><a href="#cb5-1489" aria-hidden="true" tabindex="-1"></a>\frac{n! t^{n/2}}{2^{n/2} \left(\frac{n}{2}\right)!}, &amp; n=2,4,6,\ldots<span class="sc">\\</span></span>
<span id="cb5-1490"><a href="#cb5-1490" aria-hidden="true" tabindex="-1"></a>0, &amp; n=1,3,5,\ldots</span>
<span id="cb5-1491"><a href="#cb5-1491" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb5-1492"><a href="#cb5-1492" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-1493"><a href="#cb5-1493" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-1494"><a href="#cb5-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1495"><a href="#cb5-1495" aria-hidden="true" tabindex="-1"></a>*Solution.*</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>