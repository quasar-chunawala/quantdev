<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quasar">
<meta name="dcterms.date" content="2024-07-08">

<title>quantdev.blog - Ito Processes and Stochastic Differential Equations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap')
</style>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9993009899870547" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../.././symbol.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quantdev.blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../sell_side_quant_critical_path.html" rel="" target="">
 <span class="menu-text">Sell-side Quant</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../roadmap.html" rel="" target="">
 <span class="menu-text">C++ Roadmap</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://patreon.com/u59411143?utm_medium=unknown&amp;utm_source=join_link&amp;utm_campaign=creatorshare_creator&amp;utm_content=copyLink" rel="" target=""><i class="bi bi-patreon" role="img">
</i> 
 <span class="menu-text">Become a patreon</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/quasar-chunawala" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://linkedin.com/in/quasar-chunawala" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Ito Processes and Stochastic Differential Equations</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Stochastic Calculus</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Quasar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 8, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ito-processes-and-stochastic-differential-equations." id="toc-ito-processes-and-stochastic-differential-equations." class="nav-link active" data-scroll-target="#ito-processes-and-stochastic-differential-equations.">Ito Processes and Stochastic Differential Equations.</a>
  <ul class="collapse">
  <li><a href="#itos-formula." id="toc-itos-formula." class="nav-link" data-scroll-target="#itos-formula.">Ito’s Formula.</a></li>
  <li><a href="#multivariate-extension." id="toc-multivariate-extension." class="nav-link" data-scroll-target="#multivariate-extension.">Multivariate Extension.</a></li>
  <li><a href="#numerical-simulation-of-sdes" id="toc-numerical-simulation-of-sdes" class="nav-link" data-scroll-target="#numerical-simulation-of-sdes">Numerical Simulation of SDEs</a>
  <ul class="collapse">
  <li><a href="#python-implementation" id="toc-python-implementation" class="nav-link" data-scroll-target="#python-implementation">Python implementation</a></li>
  <li><a href="#convergence" id="toc-convergence" class="nav-link" data-scroll-target="#convergence">Convergence</a></li>
  </ul></li>
  <li><a href="#existence-and-uniqueness-of-sdes" id="toc-existence-and-uniqueness-of-sdes" class="nav-link" data-scroll-target="#existence-and-uniqueness-of-sdes">Existence and Uniqueness of SDEs</a></li>
  <li><a href="#martingale-representation-and-levys-characterization" id="toc-martingale-representation-and-levys-characterization" class="nav-link" data-scroll-target="#martingale-representation-and-levys-characterization">Martingale Representation and Levy’s Characterization</a></li>
  <li><a href="#exercise-problems" id="toc-exercise-problems" class="nav-link" data-scroll-target="#exercise-problems">Exercise Problems</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="ito-processes-and-stochastic-differential-equations." class="level1">
<h1>Ito Processes and Stochastic Differential Equations.</h1>
<p>Let’s start with the definition of Ito processes.</p>
<div id="def-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Ito Process) </strong></span>Let <span class="math inline">\((B(t):t\geq0)\)</span> be a standard brownian motion defined on <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span>. An Ito process <span class="math inline">\((X(t):t\geq0)\)</span> is of the form:</p>
<p><span id="eq-ito-process"><span class="math display">\[\begin{aligned}
X(t) &amp; =X(0)+\int_{0}^{t}V(s)dB(s)+\int_{0}^{t}D(s)ds
\end{aligned} \tag{1}\]</span></span></p>
<p>where <span class="math inline">\((V(t),t\geq0)\)</span> and <span class="math inline">\((D(t),t\geq0)\)</span> are two adapted processes for which the integrals make sense in the sense of Ito and Riemann. We refer to <span class="math inline">\((V(t):t\geq0)\)</span> as the <em>local volatility</em> and to <span class="math inline">\((D(t):t\geq0)\)</span> as the <em>local drift</em>.</p>
</div>
<p>We will often denote an Ito process <span class="math inline">\((X(t):t\geq0)\)</span> in differential form as:</p>
<p><span id="eq-ito-process-differential-form"><span class="math display">\[\begin{aligned}
dX(t) &amp; =D(t)dt+V(t)dB(t)
\end{aligned} \tag{2}\]</span></span></p>
<p>This form makes no rigorous sense; when we write it, we mean <a href="#eq-ito-process">Equation&nbsp;1</a>. Nevertheless, the differential equation has two great advantages:</p>
<p>(1) It gives some intuition on what drives the variation of <span class="math inline">\(X(t)\)</span>. On one hand, there is a contribution of the Brownian increments which are modulated by the volatility <span class="math inline">\(V(t)\)</span>. On the other hand, there is a smoother contribution coming from the time variation which is modulated by the drift <span class="math inline">\(D(t)\)</span>.</p>
<p>(2) The differential notation has computational power. In particular, evaluating Ito’s formula is reduced to computing differentials, as in classical calculus, but by doing it upto the second order.</p>
<p>An important class of Ito processes is given by processes for which the volatility and the drift are simply functions of the position of the process.</p>
<div id="def-time-homogenous-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 </strong></span>Let <span class="math inline">\((B(t):t\geq0)\)</span> be a standard Brownian motion. An Ito process <span class="math inline">\((X(t):t\geq0)\)</span> of the form</p>
<p><span id="eq-time-homogenous-ito-process"><span class="math display">\[\begin{aligned}
dX(t) &amp; =\mu(X(t))dt+\sigma(X(t))dB(t),\quad X(0)=x
\end{aligned} \tag{3}\]</span></span></p>
<p>where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are functions from <span class="math inline">\(\mathbf{R}\)</span> to <span class="math inline">\(\mathbf{R}\)</span>, is called a time-homogenous diffusion.</p>
</div>
<div id="def-time-inhomogenous-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3 </strong></span>An Ito-process <span class="math inline">\((Y(t),t\geq0)\)</span> of the form:</p>
<p><span id="eq-time-inhomogenous-SDE"><span class="math display">\[\begin{aligned}
{1}
dY(t) &amp; =\mu(t,X(t))dt+\sigma(t,X(t))dB(t)\quad Y(0)=y
\end{aligned} \tag{4}\]</span></span></p>
<p>where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are now functions <span class="math inline">\([0,\infty)\times\mathbf{R}\to\mathbf{R}\)</span> is called a time-inhomogenous diffusion.</p>
</div>
<p>The equations above are called <em>stochastic differential equations</em> (SDE) of the respective process <span class="math inline">\((X(t))\)</span> and <span class="math inline">\((Y(t))\)</span>.</p>
<p>In other words, a diffusion <span class="math inline">\((X(t),t\geq 0)\)</span> is an Ito process whose local volatility <span class="math inline">\(V(t)\)</span> and local drift <span class="math inline">\(D(t)\)</span> at time <span class="math inline">\(t\)</span> depend only on the position of the process at time <span class="math inline">\(t\)</span> and possibly on the time <span class="math inline">\(t\)</span> itself. It cannot depend on the path of the process before time <span class="math inline">\(t\)</span> or on the explicit values of the driving Brownian motion at that time (which is not the process <span class="math inline">\(X(t)\)</span> itself). The class of diffusions, and of the Ito processes in general, constitutes a huge collection of stochastic processes for stochastic modelling.</p>
<p>Note that an SDE is a generalization of ordinary differential equations or ODEs. Indeed, if there were no randomness, that is, no Brownian motion, the SDE would be reduced to</p>
<p><span class="math display">\[\begin{aligned}
dX(t) &amp; =\mu(X(t))dt
\end{aligned}\]</span></p>
<p>This can be written for <span class="math inline">\(X(t)=f(t)\)</span> as:</p>
<p><span class="math display">\[\begin{aligned}
\frac{df}{dt} &amp; =\mu(f)
\end{aligned}\]</span></p>
<p>This is a first-order ordinary differential equation. It governs the deterministic evolution of the function <span class="math inline">\(X(t)=f(t)\)</span> in time. An SDE adds a random term to this evolution that is formally written as:</p>
<p><span class="math display">\[\begin{aligned}
\frac{dX}{dt} &amp; =\mu(X(t))+\sigma(X(t))\frac{dB(t)}{dt}
\end{aligned}\]</span></p>
<p>We know very well, that Brownian motion is not differentiable; hence the above is not well-defined. The ill-defined term <span class="math inline">\(dB(t)/dt\)</span> is sometimes called white noise. However, equation <a href="#eq-time-homogenous-ito-process">Equation&nbsp;3</a> is well-defined in the sense of the Ito process. These types of equations are well-suited to model phenomena with intrinsic randomness.</p>
<p>Here are some examples of diffusions:</p>
<div id="exm-brownian-motion-with-a-drift" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 </strong></span>(Brownian Motion with a drift). If we take <span class="math inline">\(X(t)=\sigma B(t)+\mu t\)</span> for some <span class="math inline">\(\sigma&gt;0\)</span> and <span class="math inline">\(\mu\in\mathbf{R}\)</span>, then we can write <span class="math inline">\(X(t)\)</span> as:</p>
<p><span class="math display">\[\begin{aligned}
X(t) &amp; =\int_{0}^{t}\sigma dB(t)+\int_{0}^{t}\mu dt,\quad X(0)=0
\end{aligned}\]</span></p>
<p>In the differential form this becomes</p>
<p><span class="math display">\[\begin{aligned}
dX(t) &amp; =\mu dt+\sigma dB(t)
\end{aligned}\]</span></p>
<p>In this case, the local drift and the local volatility are constant.</p>
</div>
<div id="exm-geometric-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 </strong></span>(Geometric Brownian Motion). We consider the process <span class="math inline">\(S(t)=\exp((\mu-\sigma^{2}/2)t+\sigma B(t))\)</span>. To find the stochastic differential equation, we apply the Ito’s Lemma to</p>
<p><span class="math display">\[\begin{aligned}
f(t,x) &amp; =\exp((\mu-\sigma^{2}/2)t+\sigma x)
\end{aligned}\]</span></p>
<p>We have:</p>
<p><span class="math display">\[\begin{aligned}
df(t,x) &amp; =\left((\mu-\sigma^{2}/2)+\frac{1}{2}\sigma^{2}\right)\exp((\mu-\sigma^{2}/2)t+\sigma x)dt+\sigma\exp((\mu-\sigma^{2}/2)t+\sigma x)dB(t)\\
&amp; =\mu S(t)dt+\sigma S(t)dB(t)
\end{aligned}\]</span></p>
<p>Note that the local drift and the local volatility are now proportional to the position. So, the higher <span class="math inline">\(S(t)\)</span>, the higher the volatility and drift.</p>
</div>
<div id="exm-smooth-function-of-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 3 </strong></span>(Any smooth function of Brownian motion). Ito’s formula gurarantees that any smooth function <span class="math inline">\(f(t,B(t))\)</span> of time and a Brownian motion is an Ito process with volatility <span class="math inline">\(V(t)=\partial_{t}f(t,B(t))\)</span> and drift <span class="math inline">\(D(t)=\partial_{x}f(t,B(t))+\frac{1}{2}\partial_{xx}f(t,B(t))\)</span>. We will see in further ahead, that, in general, any reasonable function of an Ito process remains an Ito process.</p>
</div>
<div id="exm-ito-process-that-is-not-a-diffusion" class="theorem example">
<p><span class="theorem-title"><strong>Example 4 </strong></span>(An Ito process that is not a diffusion) Consider the process</p>
<p><span class="math display">\[\begin{aligned}
X(t) &amp; =\int_{0}^{t}B^{2}(s)dB(s)
\end{aligned}\]</span></p>
<p>This is an Ito process with local volatility <span class="math inline">\(V(t)=B(t)^{2}\)</span> and local drift <span class="math inline">\(D(t)=0\)</span>. However, it is not a diffusion, because the local volatility is not an explicit function of <span class="math inline">\(X(t)\)</span>.</p>
<p>It turns out that the Brownian bridge is a time-inhomogenous diffusion and that the Ornstein-Uhlenbeck process is a time-homogenous diffusion. To understand these examples, we need to extend Ito’s formula to Ito processes.</p>
</div>
<section id="itos-formula." class="level2">
<h2 class="anchored" data-anchor-id="itos-formula.">Ito’s Formula.</h2>
<p>The first step towards a general Ito’s formula is the quadratic variation of an Ito process.</p>
<div id="prp-quadratic-variation-of-an-ito-process" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1 (Quadratic variation of an Ito process.) </strong></span>Let <span class="math inline">\((B(t),t\geq0)\)</span> be a standard Brownian motion and <span class="math inline">\((X(t):t\geq0)\)</span> be an Ito process of the form <span class="math inline">\(dX(t)=V(t)dB(t)+D(t)dt\)</span>. Then, the quadratic variation of the process <span class="math inline">\((X(t):t\geq0)\)</span> is:*</p>
<p><span id="eq-quadratic-variation-ito-process"><span class="math display">\[\begin{aligned}
&lt;X,X&gt;_{t} &amp; =\lim_{n\to\infty}\sum_{j=0}^{n-1}(X(t_{j+1})-X(t_{j}))^{2}=\int_{0}^{t}V(s)^{2}ds
\end{aligned} \tag{5}\]</span></span></p>
<p><em>for any partition <span class="math inline">\((t_{j},j\leq n)\)</span> of <span class="math inline">\([0,t]\)</span>, where the limit is in probability.</em></p>
</div>
<div id="rem-remark1">
<p>Note that the quadratic variation is increasing in <span class="math inline">\(t\)</span>, but it is not deterministic in general! <span class="math inline">\(V_t\)</span> is a random variable. The quadratic variation is a smooth stochastic process. (It is differentiable) Observe that we recover the quadratic variation for the Brownian motion for <span class="math inline">\(V(t)=1\)</span> as expected. We also notice that the formula follows easily from the rules of Ito Calculus, thereby showing the consistency of the theory. Indeed we have:</p>
<p><span class="math display">\[\begin{aligned}
d&lt;X,X&gt;_{t} &amp; =(dX(t))^{2}=(V(t)dB(t)+D(t)dt)^{2}\\
&amp; =V(t)^{2}(dB(t))^{2}+2V(t)D(t)dB(t)\cdot dt+D^{2}(t)(dt)^{2}\\
&amp; =V(t)^{2}dt
\end{aligned}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><em>Proof.</em> The proof is involved, but it reviews some important concepts of stochastic calculus. We prove the case when the process <span class="math inline">\(V\)</span> is in <span class="math inline">\(\mathcal{L}_{c}^{2}(T)\)</span> for some <span class="math inline">\(T&gt;0\)</span>. We write <span class="math inline">\(I(t)=\int_{0}^{t}V(s)dB(s)\)</span> and <span class="math inline">\(R(t)=\int_{0}^{t}D(s)ds\)</span>. We first show that only the Ito integral contributes to the quadratic variation and the Riemann integral does not contribute, so that:</p>
<p><span id="eq-quadratic-variation-ito-process-ii"><span class="math display">\[\begin{aligned}
&lt;X,X&gt;_{t} &amp; =&lt;I,I&gt;_{t}
\end{aligned} \tag{6}\]</span></span></p>
<p>We have that the increment square of <span class="math inline">\(X(t)\)</span> is:</p>
<p><span class="math display">\[\begin{aligned}
(X(t_{j+1})-X(t_{j}))^{2} &amp; =(I(t_{j+1})-I(t_{j}))^{2}+2(I(t_{j+1})-I(t_{j}))(R(t_{j+1})-R(t_{j}))+(R(t_{j+1})-R(t_{j}))^{2}
\end{aligned}\]</span></p>
<p>The Cauchy-Schwarz inequality implies :</p>
<p><span class="math display">\[\begin{aligned}
\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))(R(t_{j+1})-R(t_{j})) &amp; \leq\left(\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}\right)^{1/2}\left(\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2}\right)^{1/2}
\end{aligned}\]</span></p>
<p>Therefore, to prove equation <a href="#eq-quadratic-variation-ito-process">Equation&nbsp;5</a>, it suffices to show that <span class="math inline">\(\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2}\to 0\)</span> almost surely. Since <span class="math inline">\(D(s)\)</span> is an almost surely continuous process, the stochastic process <span class="math inline">\(R(t)=\int_{0}^{t}D(s)ds\)</span> has continuous paths with probability <span class="math inline">\(1\)</span>. Therefore:</p>
<p><span class="math display">\[\begin{aligned}
\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2} &amp; =\max_{1\leq j\leq n}|R(t_{j+1})-R(t_{j})|\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))
\end{aligned}\]</span></p>
<p>Since, <span class="math inline">\(R(t)\)</span> is continuous on the compact set <span class="math inline">\([0,t]\)</span>, it is uniformly continuous a.s. So, as <span class="math inline">\(|t_{j+1}-t_{j}|\to 0\)</span>, by uniform continuity it follows that <span class="math inline">\(\max|R(t_{j+1})-R(t_{j})|\to 0\)</span> a.s.</p>
<p>It remains to prove that <span class="math inline">\(&lt;I,I&gt;_{t}=\int_{0}^{t}V(s)^{2}ds\)</span>. We first prove the case when <span class="math inline">\(V\in\mathcal{S}(T)\)</span> is a simple adapted process. Consider a partition <span class="math inline">\((t_{j}:j\leq n)\)</span> of <span class="math inline">\([0,t]\)</span>. Without loss of generality, we can suppose that <span class="math inline">\(V\)</span> is constant on each <span class="math inline">\([t_{j},t_{j+1})\)</span> by refining the partition. We then have:</p>
<p><span class="math display">\[\begin{aligned}
\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2} &amp; =\sum_{j=0}^{n-1}V(t_{j})^{2}(B(t_{j+1})-B(t_{j}))^{2}
\end{aligned}\]</span></p>
<p>Now, we have seen in the proof of Ito’s formula that <span class="math inline">\(\mathbb{E}\left[\left\{ \sum_{j=0}^{n-1}V(t_{j})^{2}((B(t_{j+1})-B(t_{j}))^{2}-(t_{j+1}-t_{j})\right\} ^{2}\right]\to 0\)</span>, so <span class="math inline">\(\sum_{j=0}^{n-1}V(t_{j})^{2}(B(t_{j+1})-B(t_{j}))^{2}\)</span> approaches <span class="math inline">\(\sum_{j=0}^{n-1}V(t_{j})^{2}(t_{j+1}-t_{j})\)</span> in the mean square sense. As the mesh size becomes finer, the <span class="math inline">\(L^{2}\)</span>-limit is <span class="math inline">\(\int_{0}^{t}V(t)^{2}dt\)</span>.</p>
<p>The case <span class="math inline">\(V\in\mathcal{L}_{c}^{2}(T)\)</span> is proved by approximating <span class="math inline">\(V\)</span> by a simple process in <span class="math inline">\(\mathcal{S}(T)\)</span>. More precisely, we can find a simple process <span class="math inline">\(V^{(\epsilon)}(t)\)</span> that is <span class="math inline">\(\epsilon\)</span>-close to <span class="math inline">\(V\)</span> in the sense:</p>
<p><span id="eq-sequence-of-simple-processes"><span class="math display">\[\begin{aligned}
||I^{(\epsilon)}-I|| &amp; =||\int V^{\epsilon}dB(t)-\int VdB(t)||=\int_{0}^{t}\mathbb{E}[(V^{(\epsilon)}(t)-V(t))^{2}]ds&lt;\epsilon
\end{aligned} \tag{7}\]</span></span></p>
<p>To prove the claim, we need to show that for <span class="math inline">\(t\leq T\)</span>,</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-\int_{0}^{t}(V(s))^{2}ds\right|\right] &amp; \to0\quad\text{as }\quad n\to\infty
\end{aligned}\]</span></p>
<p><span class="math inline">\(L^{1}\)</span>-convergence implies convergence in probability of the sequence <span class="math inline">\(\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}\)</span>. We now introduce the <span class="math inline">\(V^{(\epsilon)}(t)\)</span> approximation inside the absolute value as well as its corresponding integral <span class="math inline">\(I^{(\epsilon)}(t)=\int_{0}^{t}V^{(\epsilon)}(s)ds\)</span>. By the triangle inequality, we have:</p>
<p><span id="eq-quadratic-variation-of-ito-process-i"><span class="math display">\[\begin{aligned}
&amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-\int_{0}^{t}(V(s))^{2}ds\right|\right]\nonumber \\
= &amp; \mathbb{E}\left[\Biggl|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}+(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}-\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds\right.\nonumber \\
&amp; +\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\Biggr]\nonumber \\
\leq &amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}\right|\right]+\mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}-\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds\right|\right]\\
&amp; +\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\right]\nonumber
\end{aligned} \tag{8}\]</span></span></p>
<p>We show that the first and third terms converge uniformly and that the second term goes to <span class="math inline">\(0\)</span> as <span class="math inline">\(n\to\infty\)</span>.</p>
<p>The second term goes to <span class="math inline">\(0\)</span> as <span class="math inline">\(n\to\infty\)</span> by the argument for simple processes.</p>
<p><span class="math inline">\(&lt;I^{(\epsilon)},I^{(\epsilon)}&gt;_{t}=\int_{0}^{t}V^{(\epsilon)}(s)^{2}ds\)</span>.</p>
<p>For the third term, the linearity of the integral and the Cauchy Schwarz inequality (applied to <span class="math inline">\(\mathbb{E}\int_{0}^{t}\)</span>) imply that it is:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\right] &amp; \leq\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s)-V(s))^{2}ds\Biggr|\right]^{1/2}\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s)+V(s))^{2}ds\Biggr|\right]^{1/2}
\end{aligned}\]</span></p>
<p>The first factor is smaller than the square root of <span class="math inline">\(\epsilon\)</span> by <a href="#eq-sequence-of-simple-processes">Equation&nbsp;7</a>, whereas the second factor is bounded.</p>
<p>The first term in equation <a href="#eq-quadratic-variation-of-ito-process-i">Equation&nbsp;8</a> is handled similarly. The linearity of the Ito integral and the Cauchy-Schwarz inequality applied to <span class="math inline">\(\mathbb{E}\left[\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}\cdot\right)\right]\)</span> give that the first term is:</p>
<p><span class="math display">\[\begin{aligned}
&amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}(V(s))^{2}dB(s)-\int_{t_{j}}^{t_{j+1}}(V^{\epsilon}(s))^{2}dB(s)\right|\right]\\
= &amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\int_{t_{j}}^{t_{j+1}}(V(s)+V^{\epsilon}(s))dB(s)\right|\right]\\
\leq &amp; \mathbb{E}\left[\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\right]^{1/2}\mathbb{E}\left[\Biggl|\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)+V^{\epsilon}(s))dB(s)\right)^{2}\Biggr|\right]^{1/2}
\end{aligned}\]</span></p>
<p>By Ito isometry, the first factor in the above expression can be simplified:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\right]^{1/2} &amp; =\sum_{j=0}^{n-1}\mathbb{E}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\\
&amp; =\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}\mathbb{E}[(V(s)-V^{\epsilon}(s))^{2}]ds
\end{aligned}\]</span></p>
<p>By <a href="#eq-sequence-of-simple-processes">Equation&nbsp;7</a>, this factor is smaller than <span class="math inline">\(\epsilon\)</span>. The second factor equals <span class="math inline">\(\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}\mathbb{E}[(V(s)+V^{\epsilon}(s))^{2}]ds\)</span> by Ito-isometry and is uniformly bounded. This concludes the proof of the proposition. <span class="math inline">\(\blacksquare\)</span></p>
</div>
<p>Note that quadratic variation <span class="math inline">\(&lt;I,I&gt;_{t}=\int(V(s))^{2}ds\)</span> is computed path-by-path and hence the result is random. On the other the variance of the Ito integral <span class="math inline">\(Var(I(t))=\mathbb{E}[I_{t}^{2}]=\int\mathbb{E}[V_{s}^{2}]ds\)</span> is the mean value of all possible paths of the quadratic variation and hence is non-random. We are now ready to state Ito’s formula for Ito processes. We write the result in differential form for conciseness.</p>
<div id="thm-ito-formula-for-ito-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Ito’s formula for Ito processes) </strong></span>Let <span class="math inline">\((B(t):t\geq0)\)</span> be a standard brownian motion, and let <span class="math inline">\((X(t):t\geq0)\)</span> be an Ito process of the form <span class="math inline">\(dX(t)=V(t)dB(t)+D(t)dt\)</span>. Consider a function <span class="math inline">\(f(t,x)\in\mathcal{C}^{1,2}([0,T]\times\mathbf{R})\)</span>. Then we have with probability one for all <span class="math inline">\(t\leq T\)</span>:*</p>
<p><em><span class="math display">\[\begin{aligned}
df(t,X(t)) &amp; =\partial_{x}f(t,X(t))dX(t)+\partial_{t}f(t,X(t))dt+\frac{1}{2}\partial_{xx}f(t,X(t))d&lt;X,X&gt;_{t}
\end{aligned}\]</span></em></p>
<p><em>This can also be written as:</em></p>
<p><em><span class="math display">\[\begin{aligned}
df(t,X(t))= &amp; \partial_{x}f(t,X(t))V(t)dB(t)+\left[\partial_{x}f(t,X(t))D(t)+\partial_{t}f(t,X(t))+\frac{1}{2}(V(t))^{2}\partial_{xx}f(t,X(t))\right]dt
\end{aligned}\]</span></em></p>
</div>
<p>The proof of the <a href="#thm-ito-formula-for-ito-processes">Theorem&nbsp;1</a> is again a Taylor approximation with the form of the quadratic variation of the process. We will omit it.</p>
<div id="exm-ornstein-uhlenbeck-process" class="theorem example">
<p><span class="theorem-title"><strong>Example 5 </strong></span>(Ornstein-Uhlenbeck Process). Consider the Ornstein-Uhlenbeck process <span class="math inline">\((Y(t):t\geq0)\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
Y(t) &amp; =Y(0)e^{-t}+e^{-t}\int_{0}^{t}e^{s}dB(s)
\end{aligned}\]</span></p>
<p>Note that this process is an explicit function of <span class="math inline">\(t\)</span> and of the Ito process <span class="math inline">\(X(t)=Y(0)+\int_{0}^{t}e^{s}dB(s)\)</span>. Indeed, we have:</p>
<p><span class="math display">\[\begin{aligned}
Y(t) &amp; =e^{-t}X(t)
\end{aligned}\]</span></p>
<p>Let <span class="math inline">\(f(t,x)=e^{-t}x\)</span>. Then, <span class="math inline">\(f_{x}(t,x)=e^{-t}\)</span>, <span class="math inline">\(f_{xx}(t,x)=0\)</span> and <span class="math inline">\(f_{t}(t,x)=-e^{-t}x\)</span>. So, by Ito’s lemma,</p>
<p><span id="eq-ornstein-uhlenbeck-sde"><span class="math display">\[\begin{aligned}
df(t,x) &amp; =f_{t}(t,X(t))dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\nonumber \\
dY(t) &amp; =-Y(t)dt+e^{-t}dX(t)\nonumber \\
dY(t) &amp; =-Y(t)dt+e^{-t}(e^{t}dB(t))\nonumber \\
dY(t) &amp; =-Y(t)dt+dB(t)
\end{aligned} \tag{9}\]</span></span></p>
<p>This is the SDE for the Ornstein Uhlenbeck process.</p>
<p>The SDE has a very nice interpretation: The drift is positive if <span class="math inline">\(Y(t)&lt;0\)</span> and negative if <span class="math inline">\(Y(t)&gt;0\)</span>. Moreover, the drift is proportional to the position (exactly like a spring pulling the process back to the <span class="math inline">\(x\)</span>-axis following the Hooke’s law!). This is the mechanism that ensures that the process does not venture too far from <span class="math inline">\(0\)</span> and is eventually stationary.</p>
<p>The SDE <a href="#eq-ornstein-uhlenbeck-sde">Equation&nbsp;9</a> is now easily generalized by adding two parameters for the volatility and the drift:</p>
<p><span id="eq-ornstein-uhlenbeck-sde-ii"><span class="math display">\[\begin{aligned}
dY(t) &amp; =-kY(t)dt+\sigma dB(t),\quad k\in\mathbf{R},\sigma&gt;0
\end{aligned} \tag{10}\]</span></span></p>
<p>It is not hard to check that the solution to the SDE is:</p>
<p><span id="eq-solution-to-the-ornstein-uhlenbeck-sde"><span class="math display">\[\begin{aligned}
Y(t) &amp; =Y(0)e^{-kt}+e^{-kt}\int_{0}^{t}e^{ks}\sigma dB(s)
\end{aligned} \tag{11}\]</span></span></p>
</div>
<div id="exr-the-ornstein-uhlenbeck-process-with-parameters" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1 </strong></span>The Ornstein-Uhlenbeck process with parameters. Use the Ito’s formula to show that the <a href="#eq-solution-to-the-ornstein-uhlenbeck-sde">Equation&nbsp;11</a> is the solution to the Ornstein-Uhlenbeck SDE <a href="#eq-ornstein-uhlenbeck-sde-ii">Equation&nbsp;10</a>.</p>
</div>
<p><em>Solution.</em></p>
<p>Let <span class="math inline">\(X(t)=Y(0)+\int_{0}^{t}e^{ks}\sigma dB(s)\)</span>, so <span class="math inline">\(dX(t)=e^{kt}\sigma dB(t)\)</span>. Then, <span class="math inline">\(Y(t)=e^{-kt}X(t)\)</span>. Let <span class="math inline">\(f(t,x)=e^{-kt}x\)</span>. Then, by Ito’s formula:</p>
<p><span class="math display">\[\begin{aligned}
df(t,x) &amp; =-ke^{-kt}X(t)dt+e^{-kt}dX(t)\\
dY(t) &amp; =-kY(t)dt+e^{-kt}e^{kt}\sigma dB(t)\\
dY(t) &amp; =-kY(t)dt+\sigma dB(t)
\end{aligned}\]</span></p>
<p>The latest version of Ito’s formula is another useful tool for producing martingales from a function of an Ito process. We start with two examples generalizing martingales for Brownian motion.</p>
<div id="exm-generalization-of-bt2-t" class="theorem example">
<p><span class="theorem-title"><strong>Example 6 </strong></span>(A generalization of <span class="math inline">\((B(t))^{2}-t\)</span>). Let <span class="math inline">\((V(t):t\leq T)\)</span> be a process in <span class="math inline">\(\mathcal{L}_{c}^{2}(T)\)</span>. Consider an Ito process <span class="math inline">\((X(t):t\leq T)\)</span> given by <span class="math inline">\(dX(t)=V(t)dB(t)\)</span>. Note that <span class="math inline">\(((X(t))^{2}:t\leq T)\)</span> is a submartingale by Jensen’s inequality, since <span class="math inline">\(\mathbb{E}[X^{2}(t)|\mathcal{F}_{s}]\geq(\mathbb{E}[X(t)|\mathcal{F}_{s})^{2}=X^{2}(s)\)</span>. We show that the compensated process</p>
<p><span class="math display">\[\begin{aligned}
M(t) &amp; =X^{2}(t)-\int_{0}^{t}V^{2}(s)ds,\quad t\leq T
\end{aligned}\]</span></p>
<p>is a martingale for the Brownian filtration. (This is another instance of the Doob-Meyer decomposition). By the Ito’s formula for <span class="math inline">\(f(x)=x^{2}\)</span>, we have:</p>
<p><span class="math display">\[\begin{aligned}
df(x) &amp; =f_{x}(X(t)dX(t)+\frac{1}{2}f_{xx}(X(t))d&lt;X,X&gt;_{t}\\
&amp; =2X(t)dX(t)+(V(t))^{2}dt\\
df(X(t)) &amp; =2X(t)V(t)dB(t)+(V(t))^{2}dt
\end{aligned}\]</span></p>
<p>In Integral form this implies:</p>
<p><span class="math display">\[\begin{aligned}
(X(t))^{2} &amp; =(X(0))^{2}+2\int_{0}^{t}X(s)V(s)dB(s)+\int_{0}^{t}(V(s))^{2}ds\\
M(t)=(X(t))^{2}-\int_{0}^{t}(V(s))^{2}ds &amp; =(X(0))^{2}+2\int_{0}^{t}X(s)V(s)dB(s)
\end{aligned}\]</span></p>
<p>We conclude that <span class="math inline">\((M(t):t\leq T)\)</span> is a martingale, provided <span class="math inline">\(X(t)V(t)\in L_{c}^{2}(T)\)</span>.</p>
<p>There is another more direct way to prove that <span class="math inline">\((M(t):t\leq T)\)</span> is a martingale whenever <span class="math inline">\((V(t):t\leq T)\in\mathcal{L}_{c}^{2}(T)\)</span>. This is by using increments: for <span class="math inline">\(t'&lt;t\leq T\)</span>,</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[X_{t'}^{2}|\mathcal{F}_{t}] &amp; =\mathbb{E}[(X_{t}+(X_{t'}-X_{t}))^{2}|\mathcal{F}_{t}]\\
&amp; =\mathbb{E}[X_{t}^{2}+2X_{t}(X_{t'}-X_{t})+(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}]\\
&amp; =X_{t}^{2}+2X_{t}\mathbb{E}[X_{t'}-X_{t}|\mathcal{F}_{t}]+\mathbb{E}[(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}]
\end{aligned}\]</span></p>
<p>Since <span class="math inline">\((X_{t}:t\geq0)\)</span> is a martingale, <span class="math inline">\(\mathbb{E}[(X_{t'}-X_{t})|M_{t}]=0\)</span>, so the middle term equals zero and we are left with:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[X_{t'}^{2}|\mathcal{F}_{t}] &amp; =X_{t}^{2}+\mathbb{E}[(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}]
\end{aligned}\]</span></p>
<p>By conditional Ito Isometry,</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}] &amp; =\int_{0}^{t'}V_{s}^{2}ds-\int_{0}^{t}V_{s}^{2}ds=\int_{t}^{t'}V_{s}^{2}ds
\end{aligned}\]</span></p>
</div>
<div id="exm-generalization-of-gbm" class="theorem example">
<p><span class="theorem-title"><strong>Example 7 </strong></span>(A generalization of the geometric Brownian motion). Let <span class="math inline">\(\sigma(t)\)</span> be a continuous, deterministic function such that <span class="math inline">\(|\sigma(t)|\leq1\)</span>, <span class="math inline">\(t\in[0,T]\)</span>. The process</p>
<p><span class="math display">\[\begin{aligned}
M(t) &amp; =\exp\left(\int_{0}^{t}\sigma(s)dB(s)-\frac{1}{2}\int_{0}^{t}\sigma^{2}(s)ds\right),\quad t\leq T
\end{aligned}\]</span></p>
<p>is a martingale for the Brownian filtration. To see this, note that we can write <span class="math inline">\(M(t)=f(t,X(t))\)</span> where <span class="math inline">\(f(t,x)=\exp(x-\frac{1}{2}\int\sigma^{2}(s)ds)\)</span> and <span class="math inline">\(X(t)=\int_{0}^{t}\sigma(s)dB(s)\)</span>, so <span class="math inline">\(dX(t)=\sigma(t)dB(t)\)</span>. Ito’s formula gives:</p>
<p><span class="math display">\[\begin{aligned}
df(t,x) &amp; =f_{t}(t,X(t)dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\\
dM(t) &amp; =-\frac{1}{2}\sigma^{2}(t)M(t)dt+M(t)\sigma(t)dB(t)+\frac{1}{2}M(t)\sigma^{2}(t)dt\\
&amp; =M(t)\sigma(t)dB(t)\\
M(t) &amp; =M(0)+\int_{0}^{t}M(s)\sigma(s)dB(s)
\end{aligned}\]</span></p>
<p>Observe also that:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[M_{t}^{2}] &amp; =e^{-\int_{0}^{t}\sigma^{2}(s)ds}\mathbb{E}[e^{2\int_{0}^{t}\sigma(s)dB(s)}]=e^{\int_{0}^{t}\sigma^{2}(s)ds}
\end{aligned}\]</span></p>
<p>since <span class="math inline">\(\int_{0}^{t}\sigma(s)dB(s)\)</span> is a Gaussian random variable with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\int_{0}^{t}\sigma^{2}(s)ds\)</span>.</p>
<p>We conclude from the equation that <span class="math inline">\((M(t),t\geq0)\)</span> is a martingale.</p>
</div>
<div id="exm-martingales-of-gbm" class="theorem example">
<p><span class="theorem-title"><strong>Example 8 </strong></span>(Martingales of Geometric Brownian Motion). Let</p>
<p><span class="math display">\[\begin{aligned}
S(t) &amp; =S(0)\exp(\sigma B(t)-\sigma^{2}t/2)
\end{aligned}\]</span></p>
<p>be a geometric brownian motion. We find a PDE satisfied by <span class="math inline">\(f(t,x)\)</span> for <span class="math inline">\(f(t,S(t))\)</span> to be a martingale. It suffices to apply Ito’s formula of <a href="#thm-ito-formula-for-ito-processes">Theorem&nbsp;1</a>. We get:</p>
<p><span class="math display">\[\begin{aligned}
df(t,S(t)) &amp; =f_{t}(t,S(t))dt+f_{x}(t,S(t))dS(t)+\frac{1}{2}f_{xx}(t,S(t))dS(t)\cdot dS(t)
\end{aligned}\]</span></p>
<p>Now note from the earlier result that <span class="math inline">\(dS(t)=S(t)\sigma dB(t)\)</span>. So, <span class="math inline">\(dS(t)\cdot dS(t)=\frac{1}{2}\sigma^{2}(S(t))^{2}dt\)</span>. So,</p>
<p><span class="math display">\[\begin{aligned}
df(t,S(t)) &amp; =\left\{ \frac{\partial f}{\partial t}+\frac{1}{2}\sigma^{2}(S(t))^{2}\frac{\partial^{2}f}{\partial x^{2}}\right\} dt+\sigma S(t)\frac{\partial f}{\partial x}dB(t)
\end{aligned}\]</span></p>
<p>Finally, the PDE for <span class="math inline">\(f(t,x)\)</span> is obtained by setting the factor in front of <span class="math inline">\(dt\)</span> to <span class="math inline">\(0\)</span>, because we want <span class="math inline">\(f\)</span> to be a martingale process. It is important to keep in mind, that the PDE should always be written in terms of the time variable <span class="math inline">\(t\)</span> and the space variable <span class="math inline">\(x\)</span>. Therefore, the PDE of <span class="math inline">\(f\)</span> as a function of time and space is:</p>
<p><span class="math display">\[\begin{aligned}
\frac{1}{2}\sigma^{2}x^{2}\frac{\partial^{2}f}{\partial x^{2}}(t,x)+\frac{\partial f}{\partial t}(t,x) &amp; =0
\end{aligned}\]</span></p>
<p>No more randomness appears in the PDE!</p>
</div>
<p>Here is a specific case where we can apply the Ito’s formula to construct martingales of Ito processes.</p>
<div id="exm-martingale-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 9 </strong></span>Consider the process given by the SDE:</p>
<p><span class="math display">\[\begin{aligned}
dX(t) &amp; =X(t)dB(t),\quad X(0)=2
\end{aligned}\]</span></p>
<p>Let’s find a PDE for which <span class="math inline">\(f(t,X(t))\)</span> is a martingale for the Brownian filtration. We have by Ito’s formula that:</p>
<p><span class="math display">\[\begin{aligned}
df(t,X(t)) &amp; =f_{t}(t,X(t))dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\\
&amp; =\left(\frac{\partial f}{\partial t}+\frac{1}{2}(X(t))^{2}\frac{\partial^{2}f}{\partial x^{2}}\right)dt+X(t)\frac{\partial f}{\partial x}dB(t)
\end{aligned}\]</span></p>
<p>Setting the drift term to <span class="math inline">\(0\)</span> gives the PDE:</p>
<p><span class="math display">\[\begin{aligned}
\frac{\partial f}{\partial t}+\frac{1}{2}x^{2}\frac{\partial^{2}f}{\partial x^{2}} &amp; =0
\end{aligned}\]</span></p>
<p>It is then easy to check that <span class="math inline">\(X(t)\)</span> is a martingale and so is <span class="math inline">\(t+\log(X(t))^{2}\)</span>, since the functions <span class="math inline">\(f(t,x)=x\)</span> and <span class="math inline">\(f(t,x)=t+\log x^{2}\)</span> satisfy the PDE. However, the process <span class="math inline">\(tX(t)\)</span> is not, as the function <span class="math inline">\(f(t,x)=xt\)</span> is not a solution of the PDE.</p>
</div>
</section>
<section id="multivariate-extension." class="level2">
<h2 class="anchored" data-anchor-id="multivariate-extension.">Multivariate Extension.</h2>
<p>Ito’s formula can be generalized to several Ito processes. Let’s start by stating an example of a function of two Ito processes. Such a function <span class="math inline">\(f(x_{1},x_{2})\)</span> will be a function of two space variables. Not surprisingly, it needs to have two derivatives in each variable and they need to be a continuous function; we need <span class="math inline">\(f\in\mathcal{C}^{2\times2}(\mathbf{R}\times\mathbf{R})\)</span>.</p>
<div id="thm-ito-formula-for-many-ito-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Ito’s formula for many Ito processes) </strong></span>Let <span class="math inline">\((X(t):t\geq0)\)</span> and (Y(t):t)$ be two Ito processes of the form:</p>
<p><span id="eq-two-ito-processes"><span class="math display">\[\begin{aligned}
dX(t) &amp; =V(t)dB(t)+D(t)dt\nonumber \\
dY(t) &amp; =U(t)dB(t)+R(t)dt
\end{aligned} \tag{12}\]</span></span></p>
<p>where <span class="math inline">\((B(t):t\geq0)\)</span> is a standard Brownian motion. Then, for <span class="math inline">\(f\in\mathcal{C}^{2\times2}(\mathbf{R}\times\mathbf{R})\)</span>, we have:</p>
<p><span class="math display">\[\begin{aligned}
df(X(t),Y(t)) &amp; =f_{x}(X(t),Y(t))dX(t)+f_{y}(X(t),Y(t))dY(t)+\frac{1}{2}f_{xx}(X(t),Y(t))d&lt;X,X&gt;_{t}\\
&amp; +f_{xy}(X(t),Y(t))d&lt;X,Y&gt;_{t}+\frac{1}{2}f_{yy}(X(t),Y(t))d&lt;Y,Y&gt;_{t}
\end{aligned}\]</span></p>
</div>
<p>The idea of the proof is the same as in <a href="#thm-ito-formula-for-ito-processes">Theorem&nbsp;1</a> : Taylor’s expansion and quadratic variation, together with the cross-variation of two processes.</p>
<p><span class="math display">\[\begin{aligned}
dX(t)\cdot dY(t) &amp; =(V(t)dB(t)+D(t)dt)(U(t)dB(t)+R(t)dt)\\
&amp; =U(t)V(t)dt
\end{aligned}\]</span></p>
<div id="exm-product-rule" class="theorem example">
<p><span class="theorem-title"><strong>Example 10 </strong></span>(Product Rule) An important example of this formula is Ito’s product rule. Let <span class="math inline">\(X(t)\)</span> and <span class="math inline">\(Y(t)\)</span> be as in <a href="#eq-two-ito-processes">Equation&nbsp;12</a>. Then:</p>
<p><span class="math display">\[\begin{aligned}
d(X(t)Y(t)) &amp; =Y(t)dX(t)+X(t)dY(t)+dX(t)\cdot dY(t)
\end{aligned}\]</span></p>
</div>
<div id="exr-a-riemann-integral" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2 </strong></span>Let <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> be a probability space and let <span class="math inline">\((B_{t}:t\geq0)\)</span> be a standard brownian motion. Using integration by parts, show that</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}B(s)ds &amp; =\int_{0}^{t}(t-s)dB(s)
\end{aligned}\]</span></p>
<p>and prove that <span class="math inline">\(\int_{0}^{t}B(s)ds\sim\mathcal{N}(0,t^{3}/3)\)</span>.</p>
<p>Is</p>
<p><span class="math display">\[\begin{aligned}
X(t) &amp; =\begin{cases}
0 &amp; t=0\\
\frac{\sqrt{3}}{t}\int_{0}^{t}B(s)ds &amp; t&gt;0
\end{cases}
\end{aligned}\]</span></p>
<p>a standard Wiener process?</p>
<p><em>Solution.</em></p>
<p>Clearly, <span class="math inline">\(B(s,\omega)\)</span> is a random variable and the Riemann integral <span class="math inline">\(\int_0^t B(s,\omega)ds\)</span> depends on the sample path <span class="math inline">\(\omega\)</span>. So, <span class="math inline">\((\int_0^t B_s ds, t\leq T)\)</span> is a stochastic process. Using integration by parts:</p>
<p><span class="math display">\[\begin{aligned}
\int u\left(\frac{dv}{ds}\right)ds &amp; =uv-\int v\left(\frac{du}{ds}\right)ds
\end{aligned}\]</span></p>
<p>We set <span class="math inline">\(u=B(s)\)</span> and <span class="math inline">\(dv/ds=1\)</span>. Then:</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}B(s)ds &amp; =sB(s)|_{0}^{t}-\int_{0}^{t}sdB(s)\\
&amp; =tB(t)-\int_{0}^{t}sdB(s)\\
&amp; =\int_{s=0}^{s=t}tdB(s)-\int_{0}^{t}sdB(s)\\
&amp; =\int_{0}^{t}(t-s)dB(s)
\end{aligned}\]</span></p>
<p>Thus, <span class="math inline">\(\int_{0}^{t}B(s)ds\)</span> is a Gaussian random variable with:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\int_{0}^{t}B(s)ds\right] &amp; =\mathbb{E}\left[\int_{0}^{t}(t-s)dB(s)\right]\\
&amp; =0
\end{aligned}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\left(\int_{0}^{t}B(s)ds\right)^{2}\right] &amp; =\int_{0}^{t}(t-s)^{2}ds\\
&amp; =\left.\frac{(t-s)^{3}}{-3}\right|_{0}^{t}\\
&amp; =\frac{t^{3}}{3}
\end{aligned}\]</span></p>
<p>Thus, using the properties of Ito Integral, <span class="math inline">\(\int_{0}^{t}B(s)ds=\int_{0}^{t}(t-s)dB(s)\)</span> is a martingale. Now the quadratic variation <span class="math inline">\(&lt;M,M&gt;_{t}=0\)</span>, and this can be a bit tricky. Remember, <span class="math inline">\(\left\langle \int_{0}^{t}f(s,B_{s})dB(s),\int_{0}^{t}f(s,B_{s})dB(s)\right\rangle =\int_{0}^{t}f^{2}(s,B_{s})ds\)</span> if and only if <span class="math inline">\(f\)</span> is a function of the time <span class="math inline">\(s\)</span> and the position of the Brownian motion <span class="math inline">\(B(s)\)</span>. Since, <span class="math inline">\(f\)</span> is a function of <span class="math inline">\(t\)</span> as well, this rule cannot be applied.</p>
<p>By first principles, we can show that, the quadratic variation is indeed <span class="math inline">\(0\)</span>: <span class="math display">\[\begin{aligned}
\lim_{n\to\infty}\mathbb{E}\left[\sum_{j=0}^{n-1}\left(I(t_{j+1})-I(t_{j})\right)^{2}\right] &amp; =\lim_{n\to\infty}\mathbb{E}\left[\sum_{j=0}^{n-1}B_{t_{j}}^{2}(t_{j+1}-t_{j})^{2}\right]\\
&amp; =\lim_{n\to\infty}\max_{1\leq j\leq n}|t_{j+1}-t_{j}|\cdot\mathbb{E}\left[\sum_{j=0}^{n-1}B_{t_{j}}^{2}(t_{j+1}-t_{j})\right]
\end{aligned}\]</span></p>
<p>Since the paths of <span class="math inline">\(B_{t}\)</span> are continuous, so are the paths <span class="math inline">\(B_{t}^{2}\)</span> on the compact interval <span class="math inline">\([0,t]\)</span>. So, <span class="math inline">\((B_{s}^{2},s\in[0,t])\)</span> is uniformly bounded. Thus, the expectation term is bounded. As <span class="math inline">\(n\to\infty\)</span>, the mesh size approaches zero, and consequently the quadratic variation approaches zero.</p>
</div>
<div id="exm-something-that-is-not-a-martingale" class="theorem example">
<p><span class="theorem-title"><strong>Example 11 </strong></span>Let <span class="math inline">\(X_{t}=\int_{0}^{t}B_{s}dB_{s}\)</span> and <span class="math inline">\(Y_{t}=\int_{0}^{t}B_{s}^{2}dB_{s}\)</span>. Is <span class="math inline">\((X_{t}Y_{t},t\geq0)\)</span> a martingale?</p>
</div>
<p><em>Solution.</em></p>
<p>By Ito’s product rule, we have:</p>
<p><span class="math display">\[\begin{aligned}
d(X_{t}Y_{t}) &amp; =X_{t}dY_{t}+Y_{t}dX_{t}+dX_{t}\cdot dY_{t}\\
&amp; =X_{t}B_{s}^{2}dB_{s}+Y_{t}B_{s}dB_{s}+(B_{s}dB_{s})\cdot(B_{s}^{2}dB_{s})\\
&amp; =X_{t}B_{s}^{2}dB_{s}+Y_{t}B_{s}dB_{s}+B_{s}^{3}dt\\
X_{t}Y_{t} &amp; =X_{0}Y_{0}+\int_{0}^{t}X_{t}B_{s}^{2}dB_{s}+\int_{0}^{t}Y_{t}B_{s}dB_{s}+\int_{0}^{t}B_{s}^{3}dt
\end{aligned}\]</span></p>
<p>The term in <span class="math inline">\(dt\)</span> is not zero, so the product cannot be a martingale.</p>
<div id="exm-generalization-of-gbm-ii" class="theorem example">
<p><span class="theorem-title"><strong>Example 12 </strong></span>(A generalization of Geometric Brownian Motion). Consider <span class="math inline">\((\int_{0}^{t}V_{s}dB_{s},t\geq0)\)</span> an Ito process. Define the positive process:</p>
<p><span id="eq-generalization-of-gbm"><span class="math display">\[\begin{aligned}
M_{t} &amp; =\exp\left(\int_{0}^{t}V_{s}dB_{s}-\frac{1}{2}\int_{0}^{t}V_{s}^{2}ds\right),\quad t\geq0
\end{aligned} \tag{13}\]</span></span></p>
</div>
<p><em>Solution.</em></p>
<p>Ito’s formula applied to the processes <span class="math inline">\(X_{t}=\int_{0}^{t}V_{s}dB_{s}\)</span> and <span class="math inline">\(Y_{t}=\frac{1}{2}\int_{0}^{t}V_{s}^{2}ds\)</span> with the function <span class="math inline">\(f(x,y)=e^{x-y}\)</span> yields:</p>
<p><span class="math display">\[\begin{aligned}
df(x,y) &amp; =f_{x}(X_{t},Y_{t})dX_{t}+f_{y}(X_{t},Y_{t})dY_{t}\\
&amp; +\frac{1}{2}f_{xx}(X_{t},Y_{t})dX_{t}\cdot dX_{t}+\frac{1}{2}f_{yy}(X_{t},Y_{t})dY_{t}\cdot dY_{t}\\
&amp; +f_{xy}(X_{t},Y_{t})dX_{t}\cdot dY_{t}
\end{aligned}\]</span></p>
<p>Now, all first and second order derivatives are <span class="math inline">\(\partial_{x}(e^{x-y})=M_{t}\)</span>, <span class="math inline">\(\partial_{y}(e^{x-y})=-e^{x-y}=-M_{t}\)</span>, <span class="math inline">\(\partial_{xx}(e^{x-y})=M_{t}\)</span></p>
<p><span class="math inline">\(dX_{t}=V_{t}dB_{t}\)</span>. <span class="math inline">\(dY_{t}=\frac{1}{2}V_{t}^{2}dt\)</span>.</p>
<p><span class="math inline">\(dX_{t}\cdot dX_{t}=V_{t}^{2}dt\)</span>, <span class="math inline">\(dX_{t}\cdot dY_{t}=0\)</span>,</p>
<p><span class="math inline">\(dY_{t}\cdot dY_{t}=0\)</span>.</p>
<p>Consequently, we have:</p>
<p><span class="math display">\[\begin{aligned}
dM_{t} &amp; =M_{t}V_{t}dB_{t}-\frac{1}{2}M_{t}V_{t}^{2}dt\\
&amp; +\frac{1}{2}M_{t}V_{t}^{2}dt\\
&amp; =M_{t}V_{t}dB_{t}
\end{aligned}\]</span></p>
<p>Thus, <span class="math inline">\((M_{t},t\geq0)\)</span> is a martingale.</p>
<div id="exr-generalized-ito-integral" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3 </strong></span>(Generalized Ito Integral). Let <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> be a probability space and let <span class="math inline">\((B_{t}:t\geq0)\)</span> be a standard brownian motion. Given that <span class="math inline">\(f\)</span> is a simple process, show that:</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}f(s,B_{s})dB_{s} &amp; =B_{t}f(t,B_{t})-\int_{0}^{t}\left[B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}B_{s}\frac{\partial^{2}f}{\partial x^{2}}\right]ds\\
&amp; -\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}f(s,B_{s})ds &amp; =tf(t,B_{t})-\int_{0}^{t}s\left[\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right]ds-\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
</div>
<p><em>Solution.</em></p>
<p>I suppress <span class="math inline">\((t,B_{t})\)</span> for simplicity. Applying the product rule to <span class="math inline">\(B_{t}f\)</span>, we get:</p>
<p><span class="math display">\[\begin{aligned}
d(B_{t}f) &amp; =fdB_{t}+B_{t}df+dB_{t}\cdot df\\
&amp; =fdB_{t}+B_{t}\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; +dB_{t}\cdot\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; =fdB_{t}+\left(B_{t}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}B_{t}\right)dt+B_{t}\frac{\partial f}{\partial x}dB_{t}\\
B_{t}f &amp; =\int_{0}^{t}fdB_{s}+\int_{0}^{t}\left(B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}B_{s}\right)ds+\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}\\
\int_{0}^{t}fdB_{s} &amp; =B_{t}f-\int_{0}^{t}\left(B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}B_{s}\right)ds-\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
<p>Applying product rule to <span class="math inline">\(tf(t,B_{t})\)</span>, we get:</p>
<p><span class="math display">\[\begin{aligned}
d(tf) &amp; =fdt+tdf+dt\cdot df\\
&amp; =fdt+t\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; +dt\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; =fdt+t\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)dt+t\frac{\partial f}{\partial x}dB_{t}\\
tf &amp; =\int_{0}^{t}fds+\int_{0}^{t}s\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)ds+\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}\\
\int_{0}^{t}fds &amp; =tf-\int_{0}^{t}s\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)ds-\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
<p>The following example will be important when we discuss the Girsanov theorem.</p>
<div id="thm-ito-formula-for-many-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Ito’s formula for many Ito processes) </strong></span>Let <span class="math inline">\(X_t = (X_t^{(j)},j\leq d,j\in\mathbf{N})\)</span> be Ito processes constructed on <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> and <span class="math inline">\(f \in C^{1,2}([0,T]\times \mathbb{R}^d)\)</span>. Then for <span class="math inline">\(t \in [0,T]\)</span>, we have:</p>
<p><span class="math display">\[
df(t,X_t) = \partial_t f(t,X_t) dt + \sum_{j=1}^{d} \partial_{x_j} f(t,X_t) dX_t^{(j)} + \frac{1}{2}\sum_{j=1}^{d} \sum_{k=1}^d \partial_{x_j x_k}^2 f(t,X_t) dX_t^{(j)}\cdot dX_t^{(k)}
\]</span></p>
</div>
</section>
<section id="numerical-simulation-of-sdes" class="level2">
<h2 class="anchored" data-anchor-id="numerical-simulation-of-sdes">Numerical Simulation of SDEs</h2>
<p>The good news is that it is not too hard to implement iterative schemes to sample paths of a diffusion. Consider <span class="math inline">\((X_t,t\leq T)\)</span> a solution to the SDE:</p>
<p><span class="math display">\[
dX_t = \sigma(X_t) dB_t + \mu(X_t) dt
\]</span></p>
<p>To keep the notation to a minimum, we consider a time-homogeonous diffusion. For a partition <span class="math inline">\((t_j,j\leq n)\)</span> of <span class="math inline">\([0,T]\)</span> with <span class="math inline">\(t_n = T\)</span>, consider the increment</p>
<p><span id="eq-increment-of-a-diffusion"><span class="math display">\[
X_{t_{j+1}} - X_{t_j} = \int_{t_j}^{t_{j+1}} \sigma(X_s) dB(s) + \int_{t_j}^{t_{j+1}} \mu(X_s) ds
\tag{14}\]</span></span></p>
<p>Note that, if <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\mu\)</span> are smooth functions, we can apply Ito’s formula to <span class="math inline">\(\sigma(X_s)\)</span> and <span class="math inline">\(\mu(X_s)\)</span> for <span class="math inline">\(s\in (t_j,t_{j+1}]\)</span>! We get:</p>
<p><span id="eq-ito-taylor-expansion-of-mu-and-sigma"><span class="math display">\[
\begin{align*}
\sigma(X_s) &amp;= \sigma(X_{t_j}) + \int_{t_j}^{s}\sigma'(X_u) dX_u + \frac{1}{2}\int_{t_j}^{s} \sigma''(X_u)(dX_u)^2\\
\mu(X_s) &amp;= \mu(X_{t_j}) + \int_{t_j}^{s}\mu'(X_u) dX_u + \frac{1}{2}\int_{t_j}^{s} \mu''(X_u)(dX_u)^2
\end{align*}
\tag{15}\]</span></span></p>
<p>Now, we can approximate the increment in <a href="#eq-increment-of-a-diffusion">Equation&nbsp;14</a> at different levels of precision by considering a different estimate for <a href="#eq-ito-taylor-expansion-of-mu-and-sigma">Equation&nbsp;15</a>.</p>
<div id="exm-euler-maruyama-scheme" class="theorem example">
<p><span class="theorem-title"><strong>Example 13 </strong></span>(Euler-Maruyama Scheme). This scheme consists of taking <span class="math inline">\(\sigma(X_s) \approx \sigma(X_{t_j})\)</span> and <span class="math inline">\(\mu(X_s) \approx \mu(X_{t_j})\)</span> for <span class="math inline">\(s \in [t_j,t_{j+1})\)</span> in <a href="#eq-ito-taylor-expansion-of-mu-and-sigma">Equation&nbsp;15</a>. Putting this back in <a href="#eq-increment-of-a-diffusion">Equation&nbsp;14</a>, we get:</p>
<p><span id="eq-euler-maruyama"><span class="math display">\[
X_{t_{j+1}} - X_{t_j} \approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j)
\tag{16}\]</span></span></p>
<p>The process <span class="math inline">\(X_t\)</span> can then be constructed recursively on the discrete set <span class="math inline">\((t_j,j \leq n)\)</span> as follows:</p>
<p><span class="math display">\[
\begin{align*}
X_0 &amp;= x\\
X_{t_1} &amp;= (X_{t_1} - X_0) + X_0\\
X_{t_2} &amp;= (X_{t_2} - X_{t_1}) + (X_{t_1} - X_0) + X_0\\
\vdots\\
X_{t_n} &amp;= \sum_{j=0}^{n-1}(X_{t_{j+1}} - X_{t_j}) + X_0
\end{align*}
\]</span></p>
</div>
<div id="exm-milstein-scheme" class="theorem example">
<p><span class="theorem-title"><strong>Example 14 </strong></span>(Milstein Scheme). In this scheme, we go an order further for the approximation of the volatility in <a href="#eq-ito-taylor-expansion-of-mu-and-sigma">Equation&nbsp;15</a> and consider also the integral in <span class="math inline">\(dX_u\)</span>. We take <span class="math inline">\(dX_u = \sigma(X_{t_j})dB_u\)</span>. We then express <span class="math inline">\(\sigma(X_s)\)</span> in <a href="#eq-ito-taylor-expansion-of-mu-and-sigma">Equation&nbsp;15</a> as:</p>
<p><span class="math display">\[
\begin{align*}
\sigma(X_s) &amp;\approx \sigma(X_{t_j}) + \int_{t_j}^{s} \sigma'(X_{t_j}) (\sigma(X_{t_j})dB_u)\\
&amp;= \sigma(X_{t_j}) + \sigma'(X_{t_j}) \sigma(X_{t_j}) \int_{t_j}^{s}  dB_u\\
&amp;= \sigma(X_{t_j}) + \sigma'(X_{t_j}) \sigma(X_{t_j}) (B_s - B_{t_j})
\end{align*}
\]</span></p>
<p>If we put this back in <a href="#eq-increment-of-a-diffusion">Equation&nbsp;14</a>, we get:</p>
<p><span id="eq-milstein-approx-step1"><span class="math display">\[
\begin{align*}
X_{t_{j+1}} - X_{t_j} &amp;\approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+ \sigma'(X_{t_j}) \sigma(X_{t_j}) \int_{t_j}^{t_{j+1}} (B(s) - B(t_j))dB(s)
\end{align*}
\tag{17}\]</span></span></p>
<p>Now, consider the function <span class="math inline">\(f(x)=x^2\)</span>. We have:</p>
<p><span class="math display">\[
\begin{align*}
f_x(x) &amp;= 2x\\
f_{xx}(x) &amp;= 2
\end{align*}
\]</span></p>
<p>So, we get:</p>
<p><span class="math display">\[
B^2(t_{j+1}) - B^2(t_j) = 2 \int_{t_j}^{t_{j+1}} B(s) dB(s) + \frac{1}{2} \int_{t_j}^{t_{j+1}} (2) ds
\]</span></p>
<p>Thus,</p>
<p><span id="eq-ito-integral-of-bm"><span class="math display">\[
\int_{t_j}^{t_{j+1}} B(s) dB(s) = \frac{1}{2}[(B_{t_{j+1}}^2 - B_{t_j}^2)-(t_{j+1}-t_j)]
\tag{18}\]</span></span></p>
<p>Substituting <a href="#eq-ito-integral-of-bm">Equation&nbsp;18</a> into <a href="#eq-milstein-approx-step1">Equation&nbsp;17</a>, we get the Milstein approximation:</p>
<p><span class="math display">\[
\begin{align*}
X_{t_{j+1}} - X_{t_j} &amp;\approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+\sigma'(X_{t_j}) \sigma(X_{t_j})  \left[\frac{1}{2}((B_{t_{j+1}}^2 - B_{t_j}^2)-(t_{j+1}-t_j)) -  B_{t_j}(B_{t_{j+1}}-B_{t_j})\right]\\
&amp;= \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+ \frac{\sigma'(X_{t_j}) \sigma(X_{t_j})}{2}  \left[(B_{t_{j+1}}^2 - B_{t_j}^2)-(t_{j+1}-t_j) -  2B_{t_j}B_{t_{j+1}}+2B_{t_j}^2\right]\\
&amp;= \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+ \frac{\sigma'(X_{t_j}) \sigma(X_{t_j})}{2}  \left[(B_{t_{j+1}} - B_{t_j})^2-(t_{j+1}-t_j)\right]
\end{align*}
\]</span></p>
<p>Thus, under the Milstein scheme</p>
<p><span id="eq-milstein"><span class="math display">\[
\begin{align*}
X_{t_{j+1}} - X_{t_j} &amp;\approx \sigma(X_{t_j})(B_{t_{j+1}}-B_{t_j}) + \mu(X_{t_j})(t_{j+1} - t_j) \\
&amp;+ \frac{\sigma'(X_{t_j}) \sigma(X_{t_j})}{2}  \left[(B_{t_{j+1}} - B_{t_j})^2-(t_{j+1}-t_j)\right]
\end{align*}
\tag{19}\]</span></span></p>
<p>The recursive nature of these two schemes makes them easy to implement numerically. The Milstein scheme is not much more costly to implement as it contains only one more term than the Euler scheme.</p>
</div>
<section id="python-implementation" class="level3">
<h3 class="anchored" data-anchor-id="python-implementation">Python implementation</h3>
<p>Let’s code an <code>SIVP</code> class and an abstract base class <code>Solver</code>.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">from</span> abc <span class="im">import</span> ABC, abstractmethod</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">from</span> typing <span class="im">import</span> Callable, Optional</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># More descriptive type hints</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>T <span class="op">=</span> np.ndarray</span>
<span id="cb1-12"><a href="#cb1-12"></a>X <span class="op">=</span> np.ndarray</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="at">@dataclass</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="kw">class</span> SIVP:</span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="co">"""</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">    An abstraction for a stochastic initial value problem</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">    """</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>    t_start : <span class="bu">float</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>    t_end : <span class="bu">float</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>    initial_condition: <span class="bu">float</span></span>
<span id="cb1-22"><a href="#cb1-22"></a></span>
<span id="cb1-23"><a href="#cb1-23"></a>    drift: Callable[[<span class="bu">float</span>, np.ndarray], np.ndarray]</span>
<span id="cb1-24"><a href="#cb1-24"></a>    vol: Callable[[<span class="bu">float</span>, np.ndarray], np.ndarray]</span>
<span id="cb1-25"><a href="#cb1-25"></a>    dvol_dx: Optional[Callable[[<span class="bu">float</span>, np.ndarray], np.ndarray]] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a></span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="at">@dataclass</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="kw">class</span> Solver(ABC):</span>
<span id="cb1-31"><a href="#cb1-31"></a>    <span class="co">"""</span></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="co">    An abstract base class for all numerical schemes</span></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="co">    """</span></span>
<span id="cb1-34"><a href="#cb1-34"></a></span>
<span id="cb1-35"><a href="#cb1-35"></a>    num_steps: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-36"><a href="#cb1-36"></a>    num_paths: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-37"><a href="#cb1-37"></a></span>
<span id="cb1-38"><a href="#cb1-38"></a>    <span class="kw">def</span> __post_init__(<span class="va">self</span>):</span>
<span id="cb1-39"><a href="#cb1-39"></a>        <span class="va">self</span>.<span class="bu">iter</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-40"><a href="#cb1-40"></a></span>
<span id="cb1-41"><a href="#cb1-41"></a>        <span class="co"># x_values is a matrix of shape [num_paths,num_steps]</span></span>
<span id="cb1-42"><a href="#cb1-42"></a>        <span class="va">self</span>.x_values <span class="op">=</span> np.zeros((<span class="va">self</span>.num_paths, <span class="va">self</span>.num_steps <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb1-43"><a href="#cb1-43"></a>        <span class="va">self</span>.step_size <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="va">self</span>.num_steps</span>
<span id="cb1-44"><a href="#cb1-44"></a></span>
<span id="cb1-45"><a href="#cb1-45"></a>        <span class="co"># gaussian increments</span></span>
<span id="cb1-46"><a href="#cb1-46"></a>        <span class="va">self</span>.brownian_increments <span class="op">=</span> np.sqrt(<span class="va">self</span>.step_size) <span class="op">*</span> np.random.standard_normal(</span>
<span id="cb1-47"><a href="#cb1-47"></a>            size<span class="op">=</span>(<span class="va">self</span>.num_paths, <span class="va">self</span>.num_steps)</span>
<span id="cb1-48"><a href="#cb1-48"></a>        )</span>
<span id="cb1-49"><a href="#cb1-49"></a>        <span class="va">self</span>.brownian <span class="op">=</span> np.cumsum(<span class="va">self</span>.brownian_increments, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-50"><a href="#cb1-50"></a>        <span class="va">self</span>.brownian <span class="op">=</span> np.concatenate(</span>
<span id="cb1-51"><a href="#cb1-51"></a>            [np.zeros(shape<span class="op">=</span>(<span class="va">self</span>.num_paths, <span class="dv">1</span>)), <span class="va">self</span>.brownian], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb1-52"><a href="#cb1-52"></a>        )</span>
<span id="cb1-53"><a href="#cb1-53"></a></span>
<span id="cb1-54"><a href="#cb1-54"></a>    <span class="at">@abstractmethod</span></span>
<span id="cb1-55"><a href="#cb1-55"></a>    <span class="kw">def</span> iterate(<span class="va">self</span>, sivp: SIVP) <span class="op">-&gt;</span> X:</span>
<span id="cb1-56"><a href="#cb1-56"></a>        <span class="co">"""</span></span>
<span id="cb1-57"><a href="#cb1-57"></a><span class="co">        Compute the next iterate X(n+1)</span></span>
<span id="cb1-58"><a href="#cb1-58"></a><span class="co">        """</span></span>
<span id="cb1-59"><a href="#cb1-59"></a></span>
<span id="cb1-60"><a href="#cb1-60"></a>    <span class="kw">def</span> solve(<span class="va">self</span>, sivp: SIVP) <span class="op">-&gt;</span> (T, X):</span>
<span id="cb1-61"><a href="#cb1-61"></a>        <span class="co">"""</span></span>
<span id="cb1-62"><a href="#cb1-62"></a><span class="co">        Solve the SIVP</span></span>
<span id="cb1-63"><a href="#cb1-63"></a><span class="co">        """</span></span>
<span id="cb1-64"><a href="#cb1-64"></a>        <span class="va">self</span>.x_values[:, <span class="dv">0</span>] <span class="op">=</span> np.full(</span>
<span id="cb1-65"><a href="#cb1-65"></a>            shape<span class="op">=</span>(<span class="va">self</span>.num_paths,), fill_value<span class="op">=</span>sivp.initial_condition</span>
<span id="cb1-66"><a href="#cb1-66"></a>        )</span>
<span id="cb1-67"><a href="#cb1-67"></a>        <span class="cf">while</span> <span class="va">self</span>.<span class="bu">iter</span> <span class="op">&lt;</span> <span class="va">self</span>.num_steps:</span>
<span id="cb1-68"><a href="#cb1-68"></a>            <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span> <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> <span class="va">self</span>.iterate(sivp)</span>
<span id="cb1-69"><a href="#cb1-69"></a>            <span class="va">self</span>.<span class="bu">iter</span> <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-70"><a href="#cb1-70"></a></span>
<span id="cb1-71"><a href="#cb1-71"></a>        times <span class="op">=</span> np.linspace(sivp.t_start, sivp.t_end, <span class="va">self</span>.num_steps <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb1-72"><a href="#cb1-72"></a>        <span class="cf">return</span> times, <span class="va">self</span>.x_values</span>
<span id="cb1-73"><a href="#cb1-73"></a></span>
<span id="cb1-74"><a href="#cb1-74"></a>    <span class="kw">def</span> reset(<span class="va">self</span>):</span>
<span id="cb1-75"><a href="#cb1-75"></a>        <span class="va">self</span>.__post_init__()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>EulerMaruyama</code> and <code>Milstein</code> methods will derive from the abstract base class <code>Solver</code>.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="at">@dataclass</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">class</span> EulerMaruyama(Solver):</span>
<span id="cb2-3"><a href="#cb2-3"></a>    <span class="co">"""</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">    Numerical solver for a stochastic differential equation(SDE) using</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">    the Euler-Maruyama method.</span></span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">    Consider an SDE of the form :</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">    dX_t = mu(t,X_t) dt + sigma(t,X_t) dB_t</span></span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">    with initial condition X_0 = x_0</span></span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">    The solution to the SDE can be computed using the increments</span></span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">    X_{n+1} - X_n = mu(n,X_n)(t_{n+1}-t_n) + sigma(n,X_n)(B(n+1)-B(n))</span></span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">    """</span></span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="kw">def</span> iterate(<span class="va">self</span>, sivp: SIVP) <span class="op">-&gt;</span> X:</span>
<span id="cb2-20"><a href="#cb2-20"></a>        <span class="co">"""</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">        Generate the next iterate X(n+1)</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">        """</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>        current_time <span class="op">=</span> <span class="va">self</span>.<span class="bu">iter</span> <span class="op">*</span> <span class="va">self</span>.step_size</span>
<span id="cb2-24"><a href="#cb2-24"></a>        mu_n <span class="op">=</span> sivp.drift(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb2-25"><a href="#cb2-25"></a>        sigma_n <span class="op">=</span> sivp.vol(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb2-26"><a href="#cb2-26"></a>        delta_x <span class="op">=</span> (</span>
<span id="cb2-27"><a href="#cb2-27"></a>            mu_n <span class="op">*</span> <span class="va">self</span>.step_size <span class="op">+</span> sigma_n <span class="op">*</span> <span class="va">self</span>.brownian_increments[:, <span class="va">self</span>.<span class="bu">iter</span>]</span>
<span id="cb2-28"><a href="#cb2-28"></a>        )</span>
<span id="cb2-29"><a href="#cb2-29"></a>        <span class="cf">return</span> <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>] <span class="op">+</span> delta_x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="at">@dataclass</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">class</span> Milstein(Solver):</span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="co">"""</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">    Numerical solver for a stochastic differential equation(SDE) using</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">    the Euler-Maruyama method.</span></span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">    Consider an SDE of the form :</span></span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">    dX_t = mu(t,X_t) dt + sigma(t,X_t) dB_t</span></span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">    with initial condition X_0 = x_0</span></span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">    The solution to the SDE can be computed using the increments</span></span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">    X_{n+1} - X_n = mu(n,X_n)(t_{n+1}-t_n) + sigma(n,X_n)(B(n+1)-B(n))</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">    + 0.5 * sigma(n,X_n) * sigma'(n,X_n) * ((B(n+1) - B(n))**2 - (t_{n+1} - t_n))</span></span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">    """</span></span>
<span id="cb3-19"><a href="#cb3-19"></a></span>
<span id="cb3-20"><a href="#cb3-20"></a>    <span class="kw">def</span> iterate(<span class="va">self</span>, sivp: SIVP):</span>
<span id="cb3-21"><a href="#cb3-21"></a>        <span class="co">"""</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">        Generate the next iterate X(n+1)</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">        """</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>        current_time <span class="op">=</span> <span class="va">self</span>.<span class="bu">iter</span> <span class="op">*</span> <span class="va">self</span>.step_size</span>
<span id="cb3-25"><a href="#cb3-25"></a>        mu_n <span class="op">=</span> sivp.drift(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb3-26"><a href="#cb3-26"></a>        sigma_n <span class="op">=</span> sivp.vol(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb3-27"><a href="#cb3-27"></a>        dvol_dx_n <span class="op">=</span> sivp.dvol_dx(current_time, <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>])</span>
<span id="cb3-28"><a href="#cb3-28"></a></span>
<span id="cb3-29"><a href="#cb3-29"></a>        delta_x <span class="op">=</span> (</span>
<span id="cb3-30"><a href="#cb3-30"></a>            mu_n <span class="op">*</span> <span class="va">self</span>.step_size</span>
<span id="cb3-31"><a href="#cb3-31"></a>            <span class="op">+</span> sigma_n <span class="op">*</span> <span class="va">self</span>.brownian_increments[:, <span class="va">self</span>.<span class="bu">iter</span>]</span>
<span id="cb3-32"><a href="#cb3-32"></a>            <span class="op">+</span> <span class="fl">0.5</span></span>
<span id="cb3-33"><a href="#cb3-33"></a>            <span class="op">*</span> sigma_n</span>
<span id="cb3-34"><a href="#cb3-34"></a>            <span class="op">*</span> dvol_dx_n</span>
<span id="cb3-35"><a href="#cb3-35"></a>            <span class="op">*</span> (<span class="va">self</span>.brownian_increments[:, <span class="va">self</span>.<span class="bu">iter</span>] <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> <span class="va">self</span>.step_size)</span>
<span id="cb3-36"><a href="#cb3-36"></a>        )</span>
<span id="cb3-37"><a href="#cb3-37"></a></span>
<span id="cb3-38"><a href="#cb3-38"></a>        <span class="cf">return</span> <span class="va">self</span>.x_values[:, <span class="va">self</span>.<span class="bu">iter</span>] <span class="op">+</span> delta_x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="exr-simulating-sdes" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4 </strong></span>(Simulating SDEs) Simulate 100 paths for the following diffusions given by their SDEs on <span class="math inline">\([0,1]\)</span> using the Euler-Maruyama scheme and the Milstein scheme for a discretization of <span class="math inline">\(0.01\)</span>.</p>
<ol type="a">
<li>Geometric Brownian Motion:</li>
</ol>
<p><span class="math display">\[
dS_t = S_t dB_t + \left(\mu + \frac{\sigma^2}{2}\right)S_t dt, \quad S_0 = 1
\]</span></p>
<p>for <span class="math inline">\(\mu=-1/2\)</span>, <span class="math inline">\(\mu=-2\)</span>, and <span class="math inline">\(\mu=0\)</span></p>
<ol start="2" type="a">
<li>Ornstein-Uhlenbeck process:</li>
</ol>
<p><span class="math display">\[
dX_t = -X_t dt + dB_t, \quad X_0 = 1
\]</span></p>
<ol start="3" type="a">
<li>The diffusion:</li>
</ol>
<p><span class="math display">\[
dX_t = \sqrt{1+X_t^2}dB_t + \sin X_t dt, \quad X_0 = 0
\]</span></p>
</div>
<p><em>Solution.</em></p>
<p>We can now use <code>EulerMaruyama</code> and <code>Milstein</code> solvers and generate some sample paths.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">def</span> plot_trajectories(ts, xs, title):</span>
<span id="cb4-2"><a href="#cb4-2"></a>    plt.xlabel(<span class="vs">r'Time $t$'</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>    plt.ylabel(<span class="vs">r'$X(t)$'</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>    plt.title(title)</span>
<span id="cb4-5"><a href="#cb4-5"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a>    plt.plot(ts, xs.transpose())</span>
<span id="cb4-7"><a href="#cb4-7"></a>    plt.show()</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># mu = -0.5 case</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>euler <span class="op">=</span> EulerMaruyama(num_paths<span class="op">=</span><span class="dv">10</span>, num_steps<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a>gbm_sde <span class="op">=</span> SIVP(</span>
<span id="cb4-13"><a href="#cb4-13"></a>    t_start<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb4-14"><a href="#cb4-14"></a>    t_end<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-15"><a href="#cb4-15"></a>    initial_condition<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-16"><a href="#cb4-16"></a>    drift<span class="op">=</span><span class="kw">lambda</span> t, s_t: np.zeros(<span class="dv">10</span>),</span>
<span id="cb4-17"><a href="#cb4-17"></a>    vol<span class="op">=</span><span class="kw">lambda</span> t, s_t: s_t,</span>
<span id="cb4-18"><a href="#cb4-18"></a>    dvol_dx<span class="op">=</span><span class="kw">lambda</span> t, s_t: np.ones(<span class="dv">10</span>),</span>
<span id="cb4-19"><a href="#cb4-19"></a>)</span>
<span id="cb4-20"><a href="#cb4-20"></a></span>
<span id="cb4-21"><a href="#cb4-21"></a></span>
<span id="cb4-22"><a href="#cb4-22"></a>ts, xs <span class="op">=</span> euler.solve(gbm_sde)</span>
<span id="cb4-23"><a href="#cb4-23"></a>euler.reset()</span>
<span id="cb4-24"><a href="#cb4-24"></a></span>
<span id="cb4-25"><a href="#cb4-25"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Geometric Brownian Motion, $\mu=-0.5$'</span>)</span>
<span id="cb4-26"><a href="#cb4-26"></a></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="co"># mu = -2 case</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>gbm_sde.drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : <span class="op">-</span><span class="fl">1.5</span> <span class="op">*</span> s_t</span>
<span id="cb4-29"><a href="#cb4-29"></a>ts, xs <span class="op">=</span> euler.solve(gbm_sde)</span>
<span id="cb4-30"><a href="#cb4-30"></a>euler.reset()</span>
<span id="cb4-31"><a href="#cb4-31"></a></span>
<span id="cb4-32"><a href="#cb4-32"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Geometric Brownian Motion, $\mu=-2.0$'</span>)</span>
<span id="cb4-33"><a href="#cb4-33"></a></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="co"># mu = 0 case</span></span>
<span id="cb4-35"><a href="#cb4-35"></a>gbm_sde.drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : <span class="fl">0.5</span> <span class="op">*</span> s_t</span>
<span id="cb4-36"><a href="#cb4-36"></a>ts, xs <span class="op">=</span> euler.solve(gbm_sde)</span>
<span id="cb4-37"><a href="#cb4-37"></a>euler.reset()</span>
<span id="cb4-38"><a href="#cb4-38"></a></span>
<span id="cb4-39"><a href="#cb4-39"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Geometric Brownian Motion, $\mu=0.0$'</span>)</span>
<span id="cb4-40"><a href="#cb4-40"></a></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="co"># ornstein-uhlenbeck</span></span>
<span id="cb4-42"><a href="#cb4-42"></a>ornstein_uhlenbeck_sde <span class="op">=</span> SIVP(</span>
<span id="cb4-43"><a href="#cb4-43"></a>    t_start<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb4-44"><a href="#cb4-44"></a>    t_end<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-45"><a href="#cb4-45"></a>    initial_condition<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-46"><a href="#cb4-46"></a>    drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : <span class="op">-</span>s_t,</span>
<span id="cb4-47"><a href="#cb4-47"></a>    vol <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.ones(<span class="dv">10</span>),</span>
<span id="cb4-48"><a href="#cb4-48"></a>    dvol_dx <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.zeros(<span class="dv">10</span>)</span>
<span id="cb4-49"><a href="#cb4-49"></a>)</span>
<span id="cb4-50"><a href="#cb4-50"></a></span>
<span id="cb4-51"><a href="#cb4-51"></a>ts, xs <span class="op">=</span> euler.solve(ornstein_uhlenbeck_sde)</span>
<span id="cb4-52"><a href="#cb4-52"></a>euler.reset()</span>
<span id="cb4-53"><a href="#cb4-53"></a></span>
<span id="cb4-54"><a href="#cb4-54"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of Ornstein-Uhlenbeck'</span>)</span>
<span id="cb4-55"><a href="#cb4-55"></a></span>
<span id="cb4-56"><a href="#cb4-56"></a><span class="co"># diffusion</span></span>
<span id="cb4-57"><a href="#cb4-57"></a>diffusion_sde <span class="op">=</span> SIVP(</span>
<span id="cb4-58"><a href="#cb4-58"></a>    t_start<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb4-59"><a href="#cb4-59"></a>    t_end<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb4-60"><a href="#cb4-60"></a>    initial_condition<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb4-61"><a href="#cb4-61"></a>    drift <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.sin(s_t),</span>
<span id="cb4-62"><a href="#cb4-62"></a>    vol <span class="op">=</span> <span class="kw">lambda</span> t, s_t : np.sqrt(<span class="dv">1</span><span class="op">+</span>s_t<span class="op">**</span><span class="dv">2</span>),</span>
<span id="cb4-63"><a href="#cb4-63"></a>    dvol_dx <span class="op">=</span> <span class="kw">lambda</span> t, s_t : s_t <span class="op">/</span> np.sqrt(<span class="dv">1</span> <span class="op">+</span> s_t<span class="op">**</span><span class="dv">2</span>) </span>
<span id="cb4-64"><a href="#cb4-64"></a>)</span>
<span id="cb4-65"><a href="#cb4-65"></a></span>
<span id="cb4-66"><a href="#cb4-66"></a>ts,xs <span class="op">=</span> euler.solve(diffusion_sde)</span>
<span id="cb4-67"><a href="#cb4-67"></a>euler.reset()</span>
<span id="cb4-68"><a href="#cb4-68"></a></span>
<span id="cb4-69"><a href="#cb4-69"></a>plot_trajectories(ts, xs, <span class="vs">r'10 sample paths of the diffusion'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-5-output-1.png" width="576" height="448"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-5-output-2.png" width="595" height="448"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-5-output-3.png" width="576" height="448"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-5-output-4.png" width="595" height="447"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-5-output-5.png" width="591" height="447"></p>
</div>
</div>
</section>
<section id="convergence" class="level3">
<h3 class="anchored" data-anchor-id="convergence">Convergence</h3>
<p>It is of course possible go beyond the Milstein scheme to improve the approximation. However, it turns out that the above schemes already converge quite rapidly to the process itself. To see this, consider the mean absolute error between the approximation <span class="math inline">\(X_T^{(n)}\)</span> at time <span class="math inline">\(T\)</span> and <span class="math inline">\(X_T\)</span>. Suppose that the approximation <span class="math inline">\(X^{(n)}\)</span> is obtained for a partition with discretization <span class="math inline">\(t_{j+1}-t_j = 1/n\)</span>. It is possible to show that for the Euler scheme, we have:</p>
<p><span class="math display">\[
\begin{align*}
\mathbb{E}[|X_T^{(n)} - X_T|] \leq \frac{C}{\sqrt{n}}
\end{align*}
\]</span></p>
<p>whereas for the Milstein scheme</p>
<p><span class="math display">\[
\begin{align*}
\mathbb{E}[|X_T^{(n)} - X_T|] \leq \frac{C'}{n}
\end{align*}
\]</span></p>
<p>for some constants <span class="math inline">\(C,C'&gt;0\)</span>. Note that the mean error between the two process must be the worst at the last point, since the errors add up.</p>
</section>
</section>
<section id="existence-and-uniqueness-of-sdes" class="level2">
<h2 class="anchored" data-anchor-id="existence-and-uniqueness-of-sdes">Existence and Uniqueness of SDEs</h2>
<p>As for the differential equations in standard calculus, SDEs play an important role in modelling stochastic phenomena. To model a trajectory <span class="math inline">\(X_t, t\leq T\)</span>, it suffices to write down the variation due to the deterministic change <span class="math inline">\(\mu(X_t)dt\)</span> for some function <span class="math inline">\(\mu(X_t)\)</span> and the variation due to local fluctuations <span class="math inline">\(\sigma(X_t)dB_t\)</span> for some function <span class="math inline">\(\sigma(X_t)\)</span>. Here, we assume that the local drift and volatility are time-homogenous for simplicity. This gives the SDE:</p>
<p><span class="math display">\[
dX_t = \mu(X_t) dt + \sigma(X_t) dB_t
\]</span></p>
<p>Do we get one nice Ito process for any choice of functions <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\mu\)</span>? The short answer is no. Here are sufficient conditions for the existence of a unique process.</p>
<div id="thm-existence-and-uniqueness-of-solutions-to-sde" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4 (Existence and Uniqueness of solutions to SDE) </strong></span>Consider the SDE</p>
<p><span class="math display">\[
dX_t = \mu(X_t) dt  + \sigma(X_t)dB_t, \quad X_0 = x, \quad t\in [0,T]
\]</span></p>
<p>If the functions <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\mu\)</span> grow not faster than <span class="math inline">\(Kx^2\)</span> for some <span class="math inline">\(K&gt;0\)</span> and are differentiable with bounded derivatives on <span class="math inline">\(\mathbb{R}^1\)</span>, then there exists a unique solution <span class="math inline">\((X_t,t\in[0,T])\)</span> to the SDE. In other words, there exists a continuous process <span class="math inline">\((X_t, t \leq T)\)</span> adapted to the filtration of the Brownian motion given by:</p>
<p><span class="math display">\[
X_t = x + \int_0^t \mu(X_s) ds + \int_0^t \sigma(X_s) dB_s, \quad t\leq T
\]</span></p>
</div>
<div id="exm-diffusion" class="theorem example">
<p><span class="theorem-title"><strong>Example 15 </strong></span>Consider the SDE :</p>
<p><span id="eq-a-diffusion"><span class="math display">\[
dX_t = \sqrt{1 + X_t^2}dB_t + \sin X_t dt
\tag{20}\]</span></span></p>
<p>There exists a unique diffusion process <span class="math inline">\((X_t,t\geq 0)\)</span> that is a solution of this SDE. To see this, we verify the conditions of the <a href="#thm-existence-and-uniqueness-of-solutions-to-sde">Theorem&nbsp;4</a>. We have:</p>
<p><span class="math display">\[
\sigma(x) = \sqrt{1 + x^2}, \quad \mu(x) = \sin x
\]</span></p>
<p>Clearly, these functions satisfy the growth condition since <span class="math inline">\(\mu\)</span> is bounded and <span class="math inline">\(\sigma\)</span> grows like <span class="math inline">\(|x|\)</span> for large <span class="math inline">\(x\)</span>. As for the derivatives, we have <span class="math inline">\(\sigma'(x)=\frac{x}{\sqrt{1+x^2}}\)</span> and <span class="math inline">\(\mu'(x)=\cos x\)</span>. The two derivatives are bounded.</p>
</div>
<p>The assumptions of <a href="#thm-existence-and-uniqueness-of-solutions-to-sde">Theorem&nbsp;4</a> are not too surprising, since similar ones are found in the classical case of ODE. For example, if we have the ODE</p>
<p><span class="math display">\[
\frac{dX_t}{dt} = X_t^{1/2}, \quad X_0 = 0
\]</span></p>
<p>then clearly <span class="math inline">\(X_t = 0\)</span> for all <span class="math inline">\(t\)</span> is a solution. But, we also have by integrating that:</p>
<p><span class="math display">\[
X_t = \frac{t^2}{4}, t \geq 0
\]</span></p>
<p>Therefore, the uniqueness breaks down. Note, that the function <span class="math inline">\(\mu(x)=\sqrt{x}\)</span> does not have bounded derivatives at <span class="math inline">\(0\)</span>. Similarly, consider the ODE:</p>
<p><span class="math display">\[
\frac{dX_t}{dt} = e^{X_t}, X_0 = 0
\]</span></p>
<p>Here, the function <span class="math inline">\(\mu(x)\)</span> grows much faster than <span class="math inline">\(x^2\)</span>. The solution of the ODE is by integrating</p>
<p><span class="math display">\[
\begin{align*}
-(e^{-X_t} - 1) &amp;= t\\
e^{-X_t} &amp;= (1 - t)\\
-X_t &amp;= \log(1 - t)\\
X_t &amp;= \log \left(\frac{1}{1-t}\right)
\end{align*}
\]</span></p>
<p>The solution explodes at <span class="math inline">\(t=1\)</span>. The same phenomenon may occur for SDE; that is the process will almost surely go <span class="math inline">\(\infty\)</span> in finite time. These times are called <em>explosion times</em>. Note that it is possible to consider the paths of the diffusion upto these explosion times. It is important to keep in mind that the conditions of <a href="#thm-existence-and-uniqueness-of-solutions-to-sde">Theorem&nbsp;4</a> are sufficient, but not necessary. In particular, it is sometimes possible to explicitly construct a diffusion whose local volatility and drift do not satisfy the conditions. Let’s look at two important instances of such diffusions.</p>
<div class="{exm-bessel-process}">
<p>Let <span class="math inline">\(B_t\)</span> be a brownian motion in <span class="math inline">\(\mathbb{R}^d\)</span> for <span class="math inline">\(d&gt;1\)</span>. Consider the process giving the distance at time <span class="math inline">\(t\)</span> of <span class="math inline">\(B_t\)</span> to the origin; that is:</p>
<p><span class="math display">\[
R_t = ||B_t|| = \left(\sum_{j=1}^d B_t^{(j)}\right)^2
\]</span></p>
<p>(For <span class="math inline">\(d=1\)</span>, this is simply <span class="math inline">\(|B_t|\)</span>. Ito’s formula cannot be applied in this case, since the absolute value is not differentiable at the origin.) In higher dimensions, the function is smooth enough as long as we stay away from the origin. This is not a problem as long as <span class="math inline">\(R_0 &gt; 0\)</span>.</p>
</div>
<p>Let’s find out the SDE that this process satisfies.</p>
<p>Let <span class="math inline">\(r=f(x_1,x_2,\ldots,x_d)=\sqrt{\sum_{j=1}^d x_j^2}\)</span>. We have:</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial r}{\partial x_j} &amp;= \frac{x_j}{\sqrt{\sum_{j=1}^d x_j^2}}\\
\frac{\partial^2 r}{\partial x_j^2} &amp;= \frac{||x|| - x_j \cdot \frac{x_j}{||x||}}{||x||^2}\\
&amp;= \frac{||x||^2 - x_j^2}{||x||^3}
\end{align*}\]</span></p>
<p>By Ito’s formula,</p>
<p><span class="math display">\[\begin{align*}
dR_t &amp;= \sum_{j=1}^{d} \frac{B_t^{j}}{R_t} dB_t^{(j)} + \frac{1}{2} \sum_{j=1}^{d} \frac{R_t^2 - (B_t^{(j)})^2}{R_t^3}\\
&amp;= \sum_{j=1}^{d} \frac{B_t^{j}}{R_t} dB_t^{(j)} + \frac{1}{2} \frac{d R_t^2 - R_t^2}{R_t^3}\\
&amp;= \sum_{j=1}^{d} \frac{B_t^{j}}{R_t} dB_t^{(j)} + \frac{1}{2} \frac{(d-1)}{R_t}
\end{align*}\]</span></p>
<p>We can define <span class="math inline">\(dW_t = \sum_{j=1}^{d} \frac{B_t^{(j)}}{R_t} dB_t^{(j)}\)</span>. Then, <span class="math inline">\(dR_t = dW_t + \frac{d-1}{2R_t}dt\)</span></p>
<p>It turns out that <span class="math inline">\((W_t,t \geq 0)\)</span> is a standard Brownian motion by Levy’s characterization theorem. This is the subject of the next section. The SDE shows that <span class="math inline">\(dR_t\)</span> is a diffusion. The SDE makes sense for any real number <span class="math inline">\(d &gt; 1\)</span>, not only integers. Moreover, the SDE is well-defined since <span class="math inline">\(R_t\)</span> is never equal to <span class="math inline">\(0\)</span>. However, the SDE does not satisfy the assumption of the existence and uniqueness of the solution of SDEs since <span class="math inline">\(1/x\)</span> diverges at <span class="math inline">\(0\)</span>. The solution to the SDE still exists since we constructed it! We sample paths of this process in numerical project.</p>
<div id="exm-cox-ingersoll-ross-process" class="theorem example">
<p><span class="theorem-title"><strong>Example 16 (The Cox-Ingersoll-Ross (CIR) model.) </strong></span>Consider the SDE:</p>
<p><span id="eq-cir-process"><span class="math display">\[
dS_t = \sigma \sqrt{S_t} dW_t + (a - bS_t)dt, \quad S_0 &gt; 0
\tag{21}\]</span></span></p>
<p>for some parameters <span class="math inline">\(a,b &gt; 0\)</span> where <span class="math inline">\((W_t,t \geq 0)\)</span> is a standard Brownian motion. The local volatility <span class="math inline">\(\sigma(x)=\sigma \sqrt{x}\)</span> does not have a bounded derivative close to <span class="math inline">\(0\)</span>, since <span class="math inline">\(\sigma'(x)=\frac{\sigma}{2\sqrt{x}}\)</span>. We will nevertheless construct a diffusion that is a solution to the SDE. Consider independent Ornstein-Uhlenbeck processes <span class="math inline">\(X_t^{(j)}, j \leq d\)</span>, with SDE:</p>
<p><span class="math display">\[
dX_t^{(j)} = \frac{-b}{2}X_t^{(j)}dt + \frac{\sigma}{2}dB_t^{(j)}, \quad X_0^{(j)} &gt; 0
\]</span></p>
<p>where <span class="math inline">\(B_t = (B_t^{(j)},j\leq d)\)</span> is a Brownian motion in <span class="math inline">\(\mathbb{R}^d\)</span>. We consider the process</p>
<p><span class="math display">\[
S_t = \sum_{j \leq d} (X_t^{(j)})^2
\]</span></p>
<p>Clearly, <span class="math inline">\(S_t\)</span> is nongegative for all <span class="math inline">\(t \geq 0\)</span> by design, so <span class="math inline">\(\sqrt{S_t}\)</span> is well-defined. Let’s compute the SDE of the process. By Ito’s formula, we have:</p>
<p><span class="math display">\[
\begin{align*}
dS_t &amp;= 2\sum_{j=1}^{d}X_t^{(j)} dX_t^{(j)} + \frac{1}{2}\sum_{j=1}^{d} 2 (dX_t^{(j)})^2\\
&amp;=2\sum_{j=1}^{d}X_t^{(j)} dX_t^{(j)} + \frac{\sigma^2}{4}\sum_{j=1}^{d} dt \\
&amp;=2\sum_{j=1}^{d}X_t^{(j)} \left(\frac{-b}{2}X_t^{(j)}dt + \frac{\sigma}{2}dB_t^{(j)}\right) + \frac{d\sigma^2}{4} dt\\
&amp;=\left[\left(\sum_{j=1}^d (-b)(X_t^{(j)})^2\right) + \frac{d\sigma^2}{4}\right] dt + \sigma \sum_{j=1}^{d} X_t^{(j)} dB_t^{(j)}\\
&amp;=\sigma \sum_{j=1}^{d} X_t^{(j)} dB_t^{(j)} + \left[\frac{d\sigma^2}{4} - b S_t\right] dt \\
&amp;= \sigma \sqrt{S_t} \sum_{j=1}^{d} \frac{X_t^{(j)}}{\sqrt{S_t}} dB_t^{(j)}  + \left[\frac{d\sigma^2}{4} - b S_t\right] dt \\
&amp;= \sigma \sqrt{S_t} dW_t  + \left[\frac{d\sigma^2}{4} - b S_t\right] dt \\
\end{align*}
\]</span></p>
<p>where we have defined <span class="math inline">\(dW_t = \sum_{j=1}^d \frac{X_t^{(j)}}{\sqrt{S_t}} dB_t^{(j)}\)</span>. It turns out that the process <span class="math inline">\((W_t,t\geq 0)\)</span> is a standard brownian motion by Levy’s characterization theorem. If we accept this for a moment, we have the SDE:</p>
<p><span id="eq-cir-process-2"><span class="math display">\[
dS_t = \sigma \sqrt{S_t} dW_t + \left(\frac{d \sigma^2}{4} - bS_t\right) dt, \quad S_0 &gt; 0
\tag{22}\]</span></span></p>
<p>This is a time-homogenous diffusion called the Cox-Ingersoll-Ross (CIR) process. Again, notice that there are no issues with square root, since <span class="math inline">\(S_t\)</span> is positive by construction! The SDE also makes sense if replace <span class="math inline">\(d\sigma^2/4\)</span> by a parameter <span class="math inline">\(a\)</span> in <a href="#eq-cir-process">Equation&nbsp;21</a> as long as <span class="math inline">\(a \geq \frac{d\sigma^2}{4}\)</span>. This process is important for interest rates and stochastic volatility models.</p>
<p>Note that the local drift is <span class="math inline">\(a - bS_t, a\ge \frac{d\sigma^2}{4}\)</span>. This can be written as:</p>
<p><span class="math display">\[\begin{align*}
a - bS_t = b\left(\frac{b}{a} - S_t \right)
\end{align*}\]</span></p>
<p>This means that the local drift is negative if <span class="math inline">\(S_t &gt; \frac{a}{b}\)</span> and it is positive if <span class="math inline">\(S_t &lt; \frac{a}{b}\)</span>. So, the SDE exhibits the same phenomenon as for the SDE of the Ornstein-Uhlenbeck process in <a href="#exm-ornstein-uhlenbeck-process">Example&nbsp;5</a>. In particular we should expect that for <span class="math inline">\(t\)</span> large, the process should fluctuate around the mean value <span class="math inline">\(\frac{a}{b}\)</span>. The CIR model is therefore an example of a mean-reverting process. More generally, this hints to the fact, that the process is stationary in the long run.</p>
</div>
</section>
<section id="martingale-representation-and-levys-characterization" class="level2">
<h2 class="anchored" data-anchor-id="martingale-representation-and-levys-characterization">Martingale Representation and Levy’s Characterization</h2>
<p>We know very well by now, that an Ito integral is continuous martingale with respect to the Brownian filtration, whenever the integrand is in <span class="math inline">\(\mathcal{L}_c^2(T)\)</span>. What can we say about the converse? In other words, if we have a martingale with respect to the Brownian filtration, can it be expressed as an Ito integral for some integrand <span class="math inline">\((V_t,t\leq T)\)</span>? Amazingly, the answer to this question is yes!</p>
<div id="thm-martingale-representation-theorem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5 (Martingale Representation Theorem.) </strong></span>Let <span class="math inline">\((B_t,t \geq 0)\)</span> be a Brownian motion with filtration <span class="math inline">\((\mathcal{F}_t,t\geq 0)\)</span> on <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span>. Consider a martingale <span class="math inline">\((M_t,t\leq T)\)</span> with respect to this filtration. Then, there exists an adapted process <span class="math inline">\((V_t,t \leq T)\)</span> such that:</p>
<p><span id="eq-martingale-representation-theorem"><span class="math display">\[
M_t = M_0 + \int_0^t V_s dB_s, \quad t \leq T
\tag{23}\]</span></span></p>
<p>One striking fact of the result is that <span class="math inline">\((M_t,t\leq T)\)</span> ought to be continuous. In other words, we cannot construct a process with a jump that is a martingale adapted to Brownian motion!</p>
<p>Instead of the proving the theorem, we will see how the result is not too surprising with stronger assumptions. Instead of supposing that <span class="math inline">\(M_t\)</span> is <span class="math inline">\(\mathcal{F}_t\)</span> measurable, take that <span class="math inline">\(M_t\)</span> is <span class="math inline">\(\sigma(B_t)\)</span>-measurable. In other words, <span class="math inline">\(M_t=h(B_t)\)</span> for some function <span class="math inline">\(h\)</span>. In the case where <span class="math inline">\(h\)</span> is smooth, then it is clear by Ito’s formula that the representation <a href="#eq-martingale-representation-theorem">Equation&nbsp;23</a> holds with <span class="math inline">\(V_s = h'(B_s)\)</span>.</p>
</div>
<p>An important consequence of <a href="#thm-martingale-representation-theorem">Theorem&nbsp;5</a> is a third definition of Brownian motion.</p>
<div id="thm-levy-characterization-theorem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6 (One-dimensional Levy’s Characterization theorem) </strong></span>Let <span class="math inline">\((M_t,t\in [0,T])\)</span> be a continuous martingale with respect to the filtration <span class="math inline">\((\mathcal{F}_t,t \leq T)\)</span> with <span class="math inline">\(M_0 = 0\)</span> and with quadratic variation <span class="math inline">\(&lt;M&gt;_t = t\)</span>. Then, <span class="math inline">\((M_t,t\leq T)\)</span> is a standard brownian motion.</p>
</div>
<p><em>Proof.</em></p>
<p>We first need to show that <span class="math inline">\(M_t - M_s \sim \mathcal{N}(0,t - s)\)</span> or using the characteristic function approach, we need to show that <span class="math inline">\(f_{(M_t - M_s)}(\theta)=\mathbb{E}[e^{\theta (M_t - M_s)}] = e^{\frac{1}{2}\theta^2 (t-s)}\)</span> for constant <span class="math inline">\(\theta\)</span>.</p>
<p>Let <span class="math inline">\(f(t,x) = e^{\theta x - \frac{1}{2}\theta^2 t}\)</span>.</p>
<p>By Ito’s formula, we have:</p>
<p><span class="math display">\[\begin{align*}
df(t,M_t) &amp;= \theta e^{\theta M_t - \frac{1}{2}\theta^2 t} dM_t + \left(-\frac{1}{2}\theta^2 + \frac{1}{2} \theta^2 \right)e^{\theta M_t - \frac{1}{2}\theta^2 t}dt\\
&amp;= \theta f(t,M_t) dM_t
\end{align*}\]</span></p>
<p>Integrating on both sides, we get:</p>
<p><span class="math display">\[\begin{align*}
f(t,M_t) - f(s,M_s) &amp;= \theta \int_0^t f(u,M_u) dM_u
\end{align*}\]</span></p>
<p>The ito integral <span class="math inline">\(\int_0^t f(s,M_s) dM_s\)</span> is well-defined and its expectation is <span class="math inline">\(0\)</span>. Hence, applying expectation operator on both sides, we get:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}[f(t,M_t) - f(s,M_s)] &amp;= \theta \mathbb{E} \left[ \int_0^t f(s,M_s) dM_s\right]\\
&amp;= 0
\end{align*}\]</span></p>
<p>Since <span class="math inline">\(e^{x} \neq 0\)</span> for all <span class="math inline">\(x\)</span>, dividing by <span class="math inline">\(f(s,M_s)\)</span>, we get:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}\left[\frac{f(t,M_t)}{f(s,M_s)}\right] &amp;= 1\\
\mathbb{E}\left[\frac{e^{\theta M_t - \frac{1}{2}\theta^2 t}}{e^{\theta M_s - \frac{1}{2}\theta^2 s}}\right] &amp;= 1\\
\mathbb{E}\left[e^{\theta(M_t - M_s)}\right] &amp;= e^{\frac{1}{2}\theta^2(t-s)}
\end{align*}\]</span></p>
<p>which is the moment generating function for the normal distribution with mean zero and variance <span class="math inline">\(t-s\)</span>. So, <span class="math inline">\(M_t - M_s \sim \mathcal{N}(0, t - s)\)</span>.</p>
<p>Further, consider <span class="math inline">\(t_1 \leq t_2 \leq t_3\)</span>. We have:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}[(M_{t_3} - M_{t_2})(M_{t_2} - M_{t_1})] &amp;= \mathbb{E}[\mathbb{E}[(M_{t_3} - M_{t_2})(M_{t_2} - M_{t_1})|\mathcal{F}_{t_2}]] \\
&amp;= \mathbb{E}[(M_{t_2} - M_{t_1})\mathbb{E}[(M_{t_3} - M_{t_2})|\mathcal{F}_{t_2}]] \\
&amp;= \mathbb{E}[(M_{t_2} - M_{t_1})(M_{t_2} - M_{t_2})] \\
&amp;= 0
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\mathbb{E}[M_{t_3} - M_{t_2}|\mathcal{F}_{t_2}] = 0\)</span> follows from the fact that <span class="math inline">\((M_t,t\geq 0)\)</span> is a martingale. Consequently, <span class="math inline">\(M_{t_3} - M_{t_2} \perp M_{t_2} - M_{t_1}\)</span> and non-overlapping increments are independent.</p>
<p>Moreover, <span class="math inline">\(M(0) = 0\)</span>. So, <span class="math inline">\((M_t,t\geq 0)\)</span> is a standard brownian motion. This closes the proof. <span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="exercise-problems" class="level2">
<h2 class="anchored" data-anchor-id="exercise-problems">Exercise Problems</h2>
<div id="exr-power-of-bm" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 5 </strong></span>Let <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> be a probability space and <span class="math inline">\((W_t,t\geq 0)\)</span> be a standard Wiener process. Find the SDE for the random process <span class="math inline">\(X_t = W_t^n, n \in \mathbb{Z}^{+}\)</span>.</p>
<p>Show that</p>
<p><span class="math display">\[
\mathbb{E}[W_t^n] = \frac{1}{2}n(n-1) \int_0^t \mathbb{E}\left[W_s^{(n-2)}\right] ds
\]</span></p>
<p>and using mathematical induction prove that:</p>
<p><span class="math display">\[
\mathbb{E}[W_t^n] = \begin{cases}
\frac{n! t^{n/2}}{2^{n/2} \left(\frac{n}{2}\right)!}, &amp; n=2,4,6,\ldots\\
0, &amp; n=1,3,5,\ldots
\end{cases}
\]</span></p>
</div>
<p><em>Solution.</em></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="quasar-chunawala/quantdev" data-repo-id="R_kgDOL2t5-A" data-category="General" data-category-id="DIC_kwDOL2t5-M4ClndQ" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>