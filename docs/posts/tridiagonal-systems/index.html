<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quasar">
<meta name="dcterms.date" content="2024-11-15">

<title>Tridiagonal Systems – quantdev.blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-f2a1071e85750ec973bbb8a8f120da0f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-e2cfcb35d2364ed86e6f554fe2526fa3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap');
</style>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9993009899870547" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quantdev.blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Tridiagonal Systems</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">Numerical Methods</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Quasar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 15, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#thomas-algorithm" id="toc-thomas-algorithm" class="nav-link" data-scroll-target="#thomas-algorithm">Thomas Algorithm</a>
  <ul class="collapse">
  <li><a href="#stage-1" id="toc-stage-1" class="nav-link" data-scroll-target="#stage-1">Stage 1</a></li>
  <li><a href="#stage-2" id="toc-stage-2" class="nav-link" data-scroll-target="#stage-2">Stage 2</a></li>
  </ul></li>
  <li><a href="#computational-solution" id="toc-computational-solution" class="nav-link" data-scroll-target="#computational-solution">Computational Solution</a></li>
  <li><a href="#deriving-the-one-dimensional-heat-equation" id="toc-deriving-the-one-dimensional-heat-equation" class="nav-link" data-scroll-target="#deriving-the-one-dimensional-heat-equation">Deriving the one-dimensional Heat equation</a></li>
  <li><a href="#the-crank-nicolson-and-theta-methods" id="toc-the-crank-nicolson-and-theta-methods" class="nav-link" data-scroll-target="#the-crank-nicolson-and-theta-methods">The Crank-Nicolson and Theta methods</a>
  <ul class="collapse">
  <li><a href="#computational-solution-1" id="toc-computational-solution-1" class="nav-link" data-scroll-target="#computational-solution-1">Computational Solution</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The special case of a system of linear equations that is <em>tridiagonal</em>, that is, has non-zero elements only on the diagonal plus or minus one column, is one that occurs frequently. Also common are systems that are <em>band-diagonal</em>, with non-zero elements only along a few diagonal lines adjacent to the main diagonal (above and below).</p>
<p>For triadiagonal sets, the procedures <span class="math inline">\(LU\)</span>-decomposition, forward- and back- substitution each take only <span class="math inline">\(O(n)\)</span> operations and the whole solution can be coded very concisely. In this blog post, I am going to explore solving triadiagonal matrix systems. I closely follow Daniel Duffy’s exposition in <em>Chapter 13</em> of his excellent book <a href="https://www.amazon.co.uk/Financial-Instrument-Pricing-Using-Finance-ebook/dp/B07H51DPQP/ref=sr_1_1?crid=35L1ITLEUA1S&amp;dib=eyJ2IjoiMSJ9.FeGDbbRPp2NQKdDQycirWzCkF5j0TlM92l9p6jCKk-U.9ZQRlCNBa5pshnZTad_fcM8KxN4SyD60z1tCbwwwE-g&amp;dib_tag=se&amp;keywords=Financial+Instrument+Pricing+Using+C%2B%2B&amp;nsdOptOutParam=true&amp;qid=1731655789&amp;sprefix=financial+instrument+pricing+using+c%2B%2B%2Caps%2C177&amp;sr=8-1">Financial Instrument Pricing using C++</a>.</p>
<p>Let <span class="math inline">\(A\)</span> be a <span class="math inline">\(m \times n\)</span> general banded matrix with <span class="math inline">\(kl\)</span> subdiagonals and <span class="math inline">\(ku\)</span> superdiagonals. Then, <span class="math inline">\(a_{ij}=0\)</span>, when <span class="math inline">\(|i - j| &gt; kl + ku  + 1\)</span>. All non-zero elements are positioned on the main diagonal, <span class="math inline">\(kl\)</span> subdiagonals below it and <span class="math inline">\(ku\)</span> superdiagonals above it.</p>
<ul>
<li><p>A <em>diagonal</em> matrix is a <span class="math inline">\(n \times n\)</span> band matrix with <span class="math inline">\(kl = ku = 0\)</span>.</p></li>
<li><p>A <em>Toeplitz</em> matrix is a <span class="math inline">\(n \times n\)</span> band matrix <span class="math inline">\(T_n=[t_{k,j};k,j=0,1,\ldots,n-1]\)</span> where <span class="math inline">\(t_{k,j}=t_{k-j}\)</span>. That is, a matrix of the form: <span class="math display">\[
T_n = \begin{bmatrix}
t_0 &amp; t_{-1} &amp; t_{-2} &amp; \ldots &amp; t_{-(n-1)}\\
t_1 &amp; t_0 &amp; t_{-1} &amp; \ldots &amp; t_{-(n-2)}\\
t_2 &amp; t_1 &amp; t_{0} &amp; \ldots &amp; t_{-(n-3)}\\
\vdots &amp; &amp; &amp; \ddots &amp; \\
t_{n-1} &amp; t_{n-2} &amp; t_{n-3} &amp; \ldots &amp; t_{0}
\end{bmatrix}
\]</span></p></li>
<li><p>A <em>tridiagonal</em> (Jacobi) matrix is a <span class="math inline">\(n \times n\)</span> band matrix of width three <span class="math inline">\(kl = ku = 1\)</span>. <span class="math display">\[
\begin{bmatrix}
b_0 &amp; c_0 &amp; 0 &amp; \ldots \\
a_1 &amp; b_1 &amp; c_1 &amp; \ldots \\
0 &amp; a_2 &amp; b_2 &amp; \ldots \\
&amp; &amp; &amp; \ldots \\
&amp; &amp; &amp; \ldots &amp; a_{n-2} &amp; b_{n-2} &amp; c_{n-2}\\
&amp; &amp; &amp; \ldots &amp; 0 &amp; a_{n-1} &amp; b_{n-1}
\end{bmatrix}
\]</span></p></li>
</ul>
<p>Consider a two-point boundary value problem on the interval <span class="math inline">\((0,1)\)</span> with Dirichlet boundary conditions:</p>
<p><span id="eq-two-point-bvp"><span class="math display">\[
\begin{align*}
\frac{d^2 u}{d x^2} &amp;= f(x), \quad 0 &lt; x &lt; 1\\
u(0) &amp;= \phi, \\
u(1) &amp;= \psi
\end{align*}
\tag{1}\]</span></span></p>
<p>We approximate the solution <span class="math inline">\(u\)</span> by creating a <em>discrete mesh of points</em> defined by <span class="math inline">\(\{x_j\}\)</span>, <span class="math inline">\(j=0,\ldots,N\)</span> where <span class="math inline">\(N\)</span> is a positive integer. At each interior mesh point the second derivative in the <a href="#eq-two-point-bvp" class="quarto-xref">Equation&nbsp;1</a> can be approximated by a second-order divided difference. The corresponding discrete scheme is:</p>
<p><span class="math display">\[
\begin{matrix}
U_0 &amp;- 2U_1 &amp;+ U_2 &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp;= h^2 f_1 \\
&amp; U_1 &amp;- 2U_2 &amp;+ U_3  &amp; &amp; &amp; &amp; &amp; &amp; &amp;= h^2 f_2 \\
&amp; &amp; U_2 &amp;- 2U_3 &amp;+ U_4 &amp; &amp; &amp; &amp; &amp; &amp;= h^2 f_3 \\
&amp; &amp;     &amp;       &amp;      &amp; \ldots &amp; &amp; &amp; &amp; &amp; \vdots \\
&amp; &amp;     &amp;       &amp;      &amp; \ldots &amp; U_{N-3} &amp;- 2U_{N-2} &amp;+ U_{N-1} &amp;  &amp;= h^2 f_{N-2}\\
&amp; &amp;     &amp;       &amp;      &amp; \ldots &amp;  &amp; U_{N-2} &amp;-2 U_{N-1} &amp;+ U_N &amp;= h^2 f_{N-1}\\
\end{matrix}
\]</span></p>
<p>Since <span class="math inline">\(U_0 = \phi\)</span> and <span class="math inline">\(U_N = \psi\)</span>, we have <span class="math inline">\(N-1\)</span> equations in <span class="math inline">\({N-1}\)</span> unknowns. These can be arranged in the matrix form as:</p>
<p><span class="math display">\[
\begin{bmatrix}
-2 &amp; 1\\
1  &amp;-2 &amp; 1  &amp;   &amp; \ldots &amp;   &amp;    &amp;  \\
   &amp; 1 &amp;-2  &amp; 1 &amp; \ldots &amp;   &amp;    &amp;  \\
   &amp;   &amp;    &amp;   &amp; \ldots &amp;   &amp;    &amp;  \\
   &amp;   &amp;    &amp;   &amp; \ldots &amp; 1 &amp; -2 &amp; 1 \\
   &amp;   &amp;    &amp;   &amp; \ldots &amp;   &amp;  1 &amp; -2
\end{bmatrix}\begin{bmatrix}
U_1 \\
U_2 \\
\vdots\\
U_{N-2} \\
U_{N-1}
\end{bmatrix} = \begin{bmatrix}
h^2 f_1 - \phi\\
h^2 f_2 \\
\vdots\\
h^2 f_{N-2} \\
h^2 f_{N-1} - \psi
\end{bmatrix}
\]</span></p>
<p>or in matrix form <span class="math inline">\(AU=F\)</span>.</p>
</section>
<section id="thomas-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="thomas-algorithm">Thomas Algorithm</h2>
<p>The Thomas algorithm is an efficient way of solving tridiagonal matrix systems. It is based on <span class="math inline">\(LU\)</span>-decomposition in which the matrix system <span class="math inline">\(Ax=r\)</span> is written as <span class="math inline">\(LUx=r\)</span>, where <span class="math inline">\(L\)</span> is a lower-triangular matrix and <span class="math inline">\(U\)</span> is an upper triangular matrix. The system can be efficiently solved by setting <span class="math inline">\(Ux=\rho\)</span> and then solving first <span class="math inline">\(L\rho=r\)</span> and then <span class="math inline">\(Ux=\rho\)</span> for <span class="math inline">\(x\)</span>. The Thomas algorithm consists of two steps. In step 1, decomposing the matrix <span class="math inline">\(M = LU\)</span> and solving <span class="math inline">\(L\rho=r\)</span> are accomplished in a single downwards sweep, taking us straight from <span class="math inline">\(Ax=r\)</span> to <span class="math inline">\(Ux=\rho\)</span>. In step 2, the equation <span class="math inline">\(Ux = \rho\)</span> is solved for <span class="math inline">\(x\)</span> in an upward sweep.</p>
<section id="stage-1" class="level3">
<h3 class="anchored" data-anchor-id="stage-1">Stage 1</h3>
<p>In the first stage, the matrix equation <span class="math inline">\(Ax=r\)</span> is converted to the form <span class="math inline">\(Ux=\rho\)</span>. Initially, the matrix equation looks like this:</p>
<p><span class="math display">\[
\begin{bmatrix}
{\color{blue}b_1} &amp; {\color{blue}c_1} &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
{\color{blue}a_2} &amp; {\color{blue}b_2} &amp; {\color{blue}c_2} &amp; 0 &amp; 0 &amp; 0\\
0 &amp; {\color{blue}a_3} &amp; {\color{blue}b_3} &amp; {\color{blue}c_3} &amp; 0 &amp; 0\\
0 &amp; 0 &amp; {\color{blue}a_4} &amp; {\color{blue}b_4} &amp; {\color{blue}c_4} &amp; 0\\
0 &amp; 0 &amp; 0 &amp; {\color{blue}a_5} &amp; {\color{blue}b_5} &amp; {\color{blue}c_5}\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; a_6 &amp; b_6
\end{bmatrix} \begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5 \\
x_6
\end{bmatrix} =
\begin{bmatrix}
{\color{blue}r_1} \\
{\color{blue}r_2} \\
{\color{blue}r_3} \\
{\color{blue}r_4} \\
{\color{blue}r_5} \\
{\color{blue}r_6}
\end{bmatrix}
\]</span></p>
<p>Row <span class="math inline">\(1\)</span>:</p>
<p><span class="math display">\[
{\color{blue}b_1} x_1 + {\color{blue}c_1} x_2 = {\color{blue}r_1}
\]</span></p>
<p>Dividing throughout by <span class="math inline">\(\color{blue}b_1\)</span>,</p>
<p><span class="math display">\[
x_1 + {\color{blue}\frac{c_1}{b_1}} x_2 = {\color{blue}\frac{r_1}{b_1}}
\]</span></p>
<p>Rewrite:</p>
<p><span class="math display">\[
x_1 + {\color{red}\gamma_1} x_2 = {\color{red}\rho_1}, \quad {\color{red}\gamma_1} = {\color{blue}\frac{c_1}{b_1}}, \quad {\color{red}\rho_1} = {\color{blue}\frac{r_1}{b_1}}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
{\color{red}1} &amp; {\color{red}\gamma_1} &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
{\color{blue}a_2} &amp; {\color{blue}b_2} &amp; {\color{blue}c_2} &amp; 0 &amp; 0 &amp; 0\\
0 &amp; {\color{blue}a_3} &amp; {\color{blue}b_3} &amp; {\color{blue}c_3} &amp; 0 &amp; 0\\
0 &amp; 0 &amp; {\color{blue}a_4} &amp; {\color{blue}b_4} &amp; {\color{blue}c_4} &amp; 0\\
0 &amp; 0 &amp; 0 &amp; {\color{blue}a_5} &amp; {\color{blue}b_5} &amp; {\color{blue}c_5}\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; a_6 &amp; b_6
\end{bmatrix} \begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5 \\
x_6
\end{bmatrix} =
\begin{bmatrix}
{\color{red}\rho_1} \\
{\color{blue}r_2} \\
{\color{blue}r_3} \\
{\color{blue}r_4} \\
{\color{blue}r_5} \\
{\color{blue}r_6}
\end{bmatrix}
\]</span></p>
<p>Row <span class="math inline">\(2\)</span>:</p>
<p><span class="math display">\[
{\color{blue}a_2} x_1 + {\color{blue}b_2} x_2 + {\color{blue}c_2} x_3 = {\color{blue}r_2}
\]</span></p>
<p>Use <span class="math inline">\(a_2\)</span> times row <span class="math inline">\(1\)</span> of the matrix to eliminate the first term</p>
<p><span class="math display">\[
a_2(x_1 + {\color{red}\gamma_1}x_2 = {\color{red}\rho_1})
\]</span></p>
<p><span class="math display">\[
\begin{array}{c|cccc}
\text{Row 2} &amp; a_2 x_1 &amp;+ b_2 x_2 &amp;+ c_2 x_3 &amp;= r_2\\
a_2 \times \text{Row 1} &amp; a_2 x_1 &amp;+ a_2 \gamma_1 x_2 &amp; &amp;= a_2\rho_1\\
\hline
\text{New Row 2} &amp; &amp; (b_2 - a_2 \gamma_1) x_2 &amp;+ c_2 x_3  &amp;= r_2 - a_2 \rho_1
\end{array}
\]</span></p>
<p>Dividing throughout by <span class="math inline">\((b_2 - a_2 \gamma_1)\)</span>, we get:</p>
<p><span class="math display">\[
x_2 + \frac{c_2}{b_2 - a_2 \gamma_1}x_3 = \frac{(r_2 - a_2 \rho_1)}{(b_2 - a_2 \gamma_1)}
\]</span></p>
<p>We can rewrite this as:</p>
<p><span class="math display">\[
x_2 + \gamma_2 x_3 = \rho_2, \quad \gamma_2 = \frac{c_2}{b_2 - a_2 \gamma_1}, \quad \rho_2 = \frac{(r_2 - a_2 \rho_1)}{(b_2 - a_2 \gamma_1)}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; \gamma_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; \gamma_2 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; a_3 &amp; b_3 &amp; c_3 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; a_4 &amp; b_4 &amp; c_4 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; a_5 &amp; b_5 &amp; c_5\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; a_6 &amp; b_6
\end{bmatrix} \begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5 \\
x_6
\end{bmatrix} =
\begin{bmatrix}
\rho_1 \\
\rho_2 \\
r_3 \\
r_4 \\
r_5 \\
r_6
\end{bmatrix}
\]</span></p>
<p>Row <span class="math inline">\(3\)</span>:</p>
<p><span class="math display">\[
a_3 x_2 + b_3 x_3 + c_3 x_4 = r_3
\]</span></p>
<p>Use <span class="math inline">\(a_3\)</span> times row <span class="math inline">\(2\)</span> of the matrix to eliminate the first term:</p>
<p><span class="math display">\[
\begin{array}{c|cccc}
\text{Row 3} &amp; a_3 x_2 &amp;+ b_3 x_3 &amp;+ c_3 x_4 &amp;= r_3\\
a_3 \times \text{Row 2} &amp; a_3 x_2 &amp;+ a_3 \gamma_2 x_3 &amp; &amp;= a_3\rho_2\\
\hline
\text{New Row 3} &amp; &amp; (b_3 - a_3 \gamma_2) x_3 &amp;+ c_3 x_4  &amp;= r_3 - a_3 \rho_2
\end{array}
\]</span></p>
<p>Dividing throughout by <span class="math inline">\((b_3 - a_3 \gamma_2)\)</span>, we have:</p>
<p><span class="math display">\[
x_3 + \frac{c_3}{b_3 - a_3 \gamma_2} x_4 = \frac{r_3 - a_3\rho_2}{b_3 - a_3 \gamma_2}
\]</span></p>
<p>We can rewrite this as:</p>
<p><span class="math display">\[
x_3 + \gamma_3 x_4 = \rho_3, \quad  \gamma_3 = \frac{c_3}{b_3 - a_3 \gamma_2}, \quad \rho_3=\frac{r_3 - a_3 \rho_2}{b_3 - a_3 \gamma_2}
\]</span></p>
<p>Continuing in this fashion, we get:</p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; \gamma_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; \gamma_2 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 1 &amp; \gamma_3 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_4 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_5\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; a_6 &amp; b_6
\end{bmatrix} \begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5 \\
x_6
\end{bmatrix} =
\begin{bmatrix}
\rho_1 \\
\rho_2 \\
\rho_3 \\
\rho_4 \\
\rho_5 \\
r_6
\end{bmatrix}
\]</span></p>
<p>Row <span class="math inline">\(6\)</span>:</p>
<p><span class="math display">\[
a_6 x_5 + a_6 x_6 = r_6
\]</span></p>
<p>Use <span class="math inline">\(a_6\)</span> times row 5 of the matrix:</p>
<p><span class="math display">\[a_6(x_5 + \gamma_5 x_6 = \rho_5)\]</span></p>
<p><span class="math display">\[
\begin{array}{c|cccc}
\text{Row 6} &amp; a_6 x_5 &amp;+ b_6 x_6 &amp;= r_6\\
a_6 \times \text{Row 5} &amp; a_6 x_5 &amp;+ a_6 \gamma_5 x_6  &amp;= a_6\rho_5\\
\hline
\text{New Row 3} &amp; &amp; (b_6 - a_6 \gamma_5) x_6  &amp;= r_6 - a_6 \rho_5
\end{array}
\]</span></p>
<p>Dividing throughout by <span class="math inline">\((b_6 - a_6 \gamma_5)\)</span>, we can rewrite:</p>
<p><span class="math display">\[
x_6 = \rho_6, \quad \rho_6 = \frac{r_6 - a_6 \rho_5}{b_6 - a_6 \gamma_5}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; \gamma_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; \gamma_2 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 1 &amp; \gamma_3 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_4 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_5\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix} \begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5 \\
x_6
\end{bmatrix} =
\begin{bmatrix}
\rho_1 \\
\rho_2 \\
\rho_3 \\
\rho_4 \\
\rho_5 \\
\rho_6
\end{bmatrix}
\]</span></p>
<p>These steps may be summarized as compute the following sequences:</p>
<p><span class="math display">\[
\gamma_1 = \frac{c_1}{b_1}, \quad \rho_1 = \frac{r_1}{b_1}
\]</span></p>
<p>And <span class="math display">\[\gamma_j = \frac{c_j}{b_j - a_j \gamma_{j-1}}, \quad \rho_j = \frac{r_j - a_j \rho_{j-1}}{b_j - a_j \gamma_{j-1}}\]</span></p>
<p>for <span class="math inline">\(j=2:6\)</span>.</p>
<p>At this point, the matrix has been reduced to the upper diagonal form, so our equations are of the form <span class="math inline">\(Ux = \rho\)</span>.</p>
</section>
<section id="stage-2" class="level3">
<h3 class="anchored" data-anchor-id="stage-2">Stage 2</h3>
<p>The matrix is now in a form which is trivial to solve for <span class="math inline">\(x\)</span>. We start with the last row and work our way up. The final equation is already solved.</p>
<p><span class="math display">\[
x_6 = \rho_6
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; \gamma_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; \gamma_2 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 1 &amp; \gamma_3 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_4 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_5\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix} \begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5 \\
x_6
\end{bmatrix} =
\begin{bmatrix}
\rho_1 \\
\rho_2 \\
\rho_3 \\
\rho_4 \\
\rho_5 \\
\rho_6
\end{bmatrix}
\]</span></p>
<p>Row <span class="math inline">\(5\)</span>: <span class="math display">\[
x_5 + \gamma_5 x_6 = \rho_5
\]</span></p>
<p>Rearrange to get:</p>
<p><span class="math display">\[
x_5 = \rho_5 - \gamma_5 x_6
\]</span></p>
<p>Row <span class="math inline">\(4\)</span>:</p>
<p><span class="math display">\[
x_4 + \gamma_4 x_5 = \rho_4
\]</span></p>
<p>Rearrange to get:</p>
<p><span class="math display">\[
x_4 = \rho_4 - \gamma_4 x_5
\]</span></p>
<p>Continuing in this fashion, we find that, <span class="math inline">\(x_6 = \rho_6\)</span> and</p>
<p><span class="math display">\[
x_j = \rho_j - \gamma_j x_{j+1}
\]</span></p>
<p>for all <span class="math inline">\(j=1:5\)</span>.</p>
</section>
</section>
<section id="computational-solution" class="level2">
<h2 class="anchored" data-anchor-id="computational-solution">Computational Solution</h2>
<p>Let’s quickly code up the algorithm in Julia.</p>
<div id="00559260" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">thomasAlgorithm</span>(a, b, c, r)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="fu">size</span>(a)[<span class="fl">1</span>]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stage 1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    γ <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Float64,1}</span>(<span class="cn">undef</span>,N)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    ρ <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Float64,1}</span>(<span class="cn">undef</span>,N)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Float64,1}</span>(<span class="cn">undef</span>,N)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    γ[<span class="fl">1</span>] <span class="op">=</span> c[<span class="fl">1</span>]<span class="op">/</span>b[<span class="fl">1</span>]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    ρ[<span class="fl">1</span>] <span class="op">=</span> r[<span class="fl">1</span>]<span class="op">/</span>b[<span class="fl">1</span>]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j<span class="op">=</span><span class="fl">2</span><span class="op">:</span>N</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        γ[j] <span class="op">=</span> c[j]<span class="op">/</span>(b[j] <span class="op">-</span> a[j] <span class="op">*</span> γ[j<span class="op">-</span><span class="fl">1</span>])</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        ρ[j] <span class="op">=</span> (r[j] <span class="op">-</span> a[j] <span class="op">*</span> ρ[j<span class="op">-</span><span class="fl">1</span>])<span class="op">/</span>(b[j] <span class="op">-</span> a[j] <span class="op">*</span> γ[j<span class="op">-</span><span class="fl">1</span>])</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stage 2</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    u[N] <span class="op">=</span>  ρ[N]</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j<span class="op">=</span><span class="fu">reverse</span>(<span class="fl">1</span><span class="op">:</span>N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        u[j] <span class="op">=</span> ρ[j] <span class="op">-</span> γ[j] <span class="op">*</span> u[j<span class="op">+</span><span class="fl">1</span>]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> u</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Case</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Float64,1}</span>([<span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>])</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Float64,1}</span>([<span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>])</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Float64,1}</span>([<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span>])</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Float64,1}</span>([<span class="fl">12</span>, <span class="fl">17</span>, <span class="fl">14</span>, <span class="fl">7</span>])</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="fu">thomasAlgorithm</span>(a, b, c, r)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(u)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[2.0, 3.0, 1.9999999999999996, 1.0000000000000004]</code></pre>
</div>
</div>
<p>Here is an implementation in modern C++:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;memory&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;functional&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;concepts&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="kw">concept</span> Real <span class="op">=</span> <span class="bu">std::</span>integral<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">||</span> <span class="bu">std::</span>floating_point<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">requires</span> Real<span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Function <span class="op">=</span> <span class="bu">std::</span>function<span class="op">&lt;</span><span class="dt">void</span><span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;&amp;)&gt;;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="kw">requires</span> Real<span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> thomasAlgorithm<span class="op">(</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> a</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> b</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> c</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> r</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;&amp;</span>x </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">){</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Stage-1</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N <span class="op">=</span> a<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> gamma<span class="op">(</span>N<span class="op">);</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> rho<span class="op">(</span>N<span class="op">);</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;(</span>N<span class="op">);</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    gamma<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> c<span class="op">[</span><span class="dv">0</span><span class="op">]/</span>b<span class="op">[</span><span class="dv">0</span><span class="op">];</span> </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    rho<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> r<span class="op">[</span><span class="dv">0</span><span class="op">]/</span>b<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">{</span><span class="dv">1</span><span class="op">};</span> j <span class="op">&lt;</span> N<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        gamma<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> c<span class="op">[</span>j<span class="op">]/(</span>b<span class="op">[</span>j<span class="op">]</span> <span class="op">-</span> a<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> gamma<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        rho<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>r<span class="op">[</span>j<span class="op">]</span> <span class="op">-</span> a<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> rho<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])/(</span>b<span class="op">[</span>j<span class="op">]</span> <span class="op">-</span> a<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> gamma<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Stage-2</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    x<span class="op">[</span>N<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> rho<span class="op">[</span>N<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">{</span>N<span class="op">-</span><span class="dv">2</span><span class="op">};</span> j <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> j<span class="op">--)</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> rho<span class="op">[</span>j<span class="op">]</span> <span class="op">-</span> gamma<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> x<span class="op">[</span>j<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="kw">requires</span> Real<span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LUTridiagonalSolver<span class="op">{</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_a</span><span class="op">;</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_b</span><span class="op">;</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_c</span><span class="op">;</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_r</span><span class="op">;</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_x</span><span class="op">;</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        Function<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_LUTridiagonalSolverStrategy</span><span class="op">;</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>        LUTridiagonalSolver<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        LUTridiagonalSolver<span class="op">(</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>              <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> a</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> b</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> c</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> r</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> Function<span class="op">&lt;</span>T<span class="op">&gt;</span> solver<span class="op">)</span> </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">m_a</span> <span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>a<span class="op">)}</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="va">m_b</span> <span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>b<span class="op">)}</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="va">m_c</span> <span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>c<span class="op">)}</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="va">m_r</span> <span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>r<span class="op">)}</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="va">m_LUTridiagonalSolverStrategy</span> <span class="op">{</span>solver<span class="op">}</span> </span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>            <span class="op">{}</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> solve<span class="op">(){</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>            <span class="va">m_LUTridiagonalSolverStrategy</span><span class="op">(</span><span class="va">m_a</span><span class="op">,</span> <span class="va">m_b</span><span class="op">,</span> <span class="va">m_c</span><span class="op">,</span> <span class="va">m_r</span><span class="op">,</span> <span class="va">m_x</span><span class="op">);</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">m_x</span><span class="op">;</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        LUTridiagonalSolver<span class="op">(</span><span class="at">const</span> LUTridiagonalSolver<span class="op">&amp;</span> <span class="op">)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>        LUTridiagonalSolver <span class="kw">operator</span><span class="op">=(</span>LUTridiagonalSolver<span class="op">&amp;</span> <span class="op">)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>LUTridiagonalSolver<span class="op">(){}</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> a<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> b<span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> c<span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">};</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> r<span class="op">{</span><span class="dv">12</span><span class="op">,</span> <span class="dv">17</span><span class="op">,</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">7</span><span class="op">};</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>    LUTridiagonalSolver<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> solver<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> r<span class="op">,</span> thomasAlgorithm<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;);</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> u <span class="op">=</span> solver<span class="op">.</span>solve<span class="op">();</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="https://godbolt.org/z/T7846WY8v">Compiler Explorer</a></p>
</section>
<section id="deriving-the-one-dimensional-heat-equation" class="level2">
<h2 class="anchored" data-anchor-id="deriving-the-one-dimensional-heat-equation">Deriving the one-dimensional Heat equation</h2>
<p>Consider a slender homogenous rod, lying along the <span class="math inline">\(x\)</span>-axis and insulated, so that no heat can escape across its longitudinal surface. In addition, we make the simplifying assumption that the temperature in the rod is constant on each cross-section perpendicular to the <span class="math inline">\(x\)</span>-axis, and thus that the flow of heat in the rod takes place only in the <span class="math inline">\(x\)</span>-direction.</p>
<p>Consider a small segment of the rod at position <span class="math inline">\(x\)</span> of length <span class="math inline">\(\Delta x\)</span>.</p>
<p>The thermal energy in this segment at time <span class="math inline">\(t\)</span> is:</p>
<p><span class="math display">\[
E(x,x+\Delta x, t) \approx u(x,t) s \rho \Delta x
\]</span></p>
<p>where <span class="math inline">\(s\)</span> is the constant of specific heat i.e.&nbsp;amount of heat required to raise one unit of mass by one unit of temperature, <span class="math inline">\(\rho\)</span> is the mass density.</p>
<p>Fourier’s law of heat conduction quantifies the idea that heat flows from warmer to colder regions and states that the (rightward) heat flux density <span class="math inline">\(\phi(x,t)\)</span> (the flow of heat energy per unit area per unit time, SI units <span class="math inline">\(J/s/m^2\)</span>) at any point is:</p>
<p><span class="math display">\[
\phi(x,t) = -K_0 u_x (x, t)
\]</span></p>
<p>where <span class="math inline">\(K_0\)</span> is the thermal conductivity of the rod. The negative sign shows that the heat flows from higher temperature regions to colder temperature regions.</p>
<p>Appealing to the law of conservation of energy:</p>
<p><span id="eq-heat-content"><span class="math display">\[
\begin{align*}
\underbrace{\frac{\partial}{\partial t}(u(x,t) s \rho \Delta x)}_{\text{Heat flux through segment}} = \underbrace{(-K_0 u_x(x, t))}_{\text{Flux in}} - \underbrace{(- K_0 u_x(x + \Delta x,t))}_{\text{Flux out}}
\end{align*}
\tag{2}\]</span></span></p>
<p>Dividing throughout by <span class="math inline">\(\Delta x\)</span> we have:</p>
<p><span class="math display">\[
\begin{align*}
u_t(x,t) \approx \frac{K_0}{s \rho } \frac{u_x(x+\Delta x, t) - u_x(x,t)}{\Delta x}
\end{align*}
\]</span></p>
<p>Letting <span class="math inline">\(\Delta x \to 0\)</span> improves the approximation and leads to the heat equation:</p>
<p><span class="math display">\[
u_t=c^2 u_{xx}
\]</span></p>
<p>where <span class="math inline">\(c^2 = \frac{K_0}{\rho s}\)</span> is called the <em>thermal diffusivity</em>.</p>
</section>
<section id="the-crank-nicolson-and-theta-methods" class="level2">
<h2 class="anchored" data-anchor-id="the-crank-nicolson-and-theta-methods">The Crank-Nicolson and Theta methods</h2>
<p>Consider the initial boundary value problem for the <span class="math inline">\(1\)</span>d-heat equation:</p>
<p><span class="math display">\[
\begin{align*}
u_t &amp;= a^2 u_{xx}, \quad &amp; 0 &lt; x &lt; L, t&gt;0\\
u(x,0) &amp;= f(x), \quad 0 \leq x \leq L \\
u(0,t) &amp;= A, \\
u(L,t) &amp;= B
\end{align*}
\]</span></p>
<p>In this case, we can assume without the loss of generality that <span class="math inline">\(L = 1\)</span>. Here, <span class="math inline">\(a\)</span>, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are constants.</p>
<p>We find a solution to this system in the case when <span class="math inline">\(A = B = 0\)</span> and <span class="math inline">\(a = 1\)</span> by the <em>method of the separation of variables</em>. In this case, the analytical solution is:</p>
<p><span class="math display">\[
u(x,t) = \frac{8}{\pi^2}\sum_{n=1}^{\infty}\frac{1}{n^2}\sin\left(\frac{n\pi}{2}\right)\sin(n\pi x)\exp(-n^2 \pi^2 t)
\]</span></p>
<p>and we are going to use this solution as a benchmark against which the numerical solutions can be compared.</p>
<p>We can discretize a parabolic PDE in the space dimension (using centered difference schemes) while keeping the time variable continuous. We examine the following initial boundary value problem for the <span class="math inline">\(1\)</span>d-heat equation on the unit interval with zero Dirichlet boundary conditions.</p>
<p>The problem is:</p>
<p><span id="eq-IBVP"><span class="math display">\[
\begin{align*}
u_t &amp;= u_{xx}, \quad &amp; 0 &lt; x &lt; 1, t&gt;0\\
u(x,0) &amp;= f(x), \quad 0 \leq x \leq 1 \\
u(0,t) &amp;= u(1,t) = 0
\end{align*}
\tag{3}\]</span></span></p>
<p>We partition the space interval <span class="math inline">\((0,1)\)</span> into <span class="math inline">\(J\)</span> subintervals and we approximate <a href="#eq-IBVP" class="quarto-xref">Equation&nbsp;3</a> by the <em>semi-discrete</em> scheme:</p>
<p><span class="math display">\[
\begin{align*}
\frac{dU_j}{dt} &amp;= \frac{1}{h^2}(U_{j+1} - 2U_j + U_{j-1}), \quad 1 \leq j \leq J-1 \\
U_0(t) &amp;= U_J(t) = 0, \quad t &gt; 0 \\
U_j(0) &amp;= f(x_j)
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(h = 1/J\)</span> is the constant mesh size. The <span class="math inline">\(U_j\)</span>’s are functions of time <span class="math inline">\(t\)</span>. So, we define the following vectors:</p>
<p><span class="math display">\[
\begin{align*}
U(t) &amp;= (U_1(t),U_2(t),\ldots,U_J(t))^T \\
U^0 &amp;= (f(x_1),f(x_2),\ldots,f(x_{J-1}))^T
\end{align*}
\]</span></p>
<p>Then, we can rewrite the system <a href="#eq-IBVP" class="quarto-xref">Equation&nbsp;3</a> as a system of ordinary differential equations:</p>
<p><span id="eq-heat-eq-1"><span class="math display">\[
\begin{align*}
\frac{dU}{dt} &amp;= AU\\
U(0) &amp;= U^0
\end{align*}
\tag{4}\]</span></span></p>
<p>where the matrix <span class="math inline">\(A\)</span> is given by:</p>
<p><span class="math display">\[
A = \frac{1}{h^2}\begin{bmatrix}
-2 &amp; 1 &amp; 0 &amp; \ldots \\
1  &amp;-2 &amp; 1 &amp; \ldots \\
0  &amp; 1 &amp; -2 &amp; \ldots \\
   &amp;   &amp;    &amp; \ldots \\
      &amp;   &amp;    &amp; \ldots &amp; 1 &amp; -2 &amp; 1\\
      &amp;   &amp;    &amp; \ldots &amp; 0 &amp; 1  &amp; -2\\
\end{bmatrix}
\]</span></p>
<p>There are many discretization schemes. I plan to explore various finite difference schemes and their application to derivatives pricing in future posts. For now, I will concentrate on the one-step explicit and implicit methods to discretise the system of ODEs(<a href="#eq-heat-eq-1" class="quarto-xref">Equation&nbsp;4</a>) as:</p>
<p><span id="eq-heat-eq-2"><span class="math display">\[
\begin{align*}
\frac{U^{n+1 - U^n}}{\Delta t} &amp;= \theta AU^{n+1} + (1-\theta)AU^{n}, \quad 0 \leq n \leq N-1, 0 \leq \theta \leq 1 \\
U^{0} &amp;= U(0)
\end{align*}
\tag{5}\]</span></span></p>
<p>In this case, <span class="math inline">\(\Delta t\)</span> is the constant mesh size in time.</p>
<p>We can rewrite <a href="#eq-heat-eq-2" class="quarto-xref">Equation&nbsp;5</a> in the equivalent form:</p>
<p><span id="eq-heat-eq-3"><span class="math display">\[
\begin{align*}
U^{n+1} - U^{n} &amp;= \theta \Delta t A U^{n+1} + \Delta t (I- \theta)AU^{n} \\
[I - \Delta t A]U^{n+1} &amp;= (\Delta t (1 - \theta) + 1)AU^n
\end{align*}
\tag{6}\]</span></span></p>
<p>or formally as:</p>
<p><span id="eq-heat-eq-4"><span class="math display">\[
\begin{align*}
U^{n+1} = [1-\Delta t \theta A]^{-1} (I + \Delta t(I - \theta)) A U^n
\end{align*}
\tag{7}\]</span></span></p>
<p>where <span class="math inline">\(I\)</span> is the identity matrix.</p>
<p>Some special cases of <span class="math inline">\(\theta\)</span> are:</p>
<p><span id="eq-heat-eq-5"><span class="math display">\[
\begin{align*}
\theta &amp;= 1, \quad \text{Implicit Euler Scheme}\\
\theta &amp;= 0, \quad \text{Explicit Euler Scheme}\\
\theta &amp;= 1/2,\quad \text{Crank-Nicolson Scheme}
\end{align*}
\tag{8}\]</span></span></p>
<p>When the schemes are implicit, we can solve the system of equations (<a href="#eq-heat-eq-2" class="quarto-xref">Equation&nbsp;5</a>) at each time level <span class="math inline">\(n+1\)</span> using the Thomas algorithm. No matrix inversion is needed in the case of explicit schemes. The formulation (<a href="#eq-heat-eq-1" class="quarto-xref">Equation&nbsp;4</a>) is called the <em>method of lines</em> and it corresponds to semi-discretization of the PDE in the space direction while keeping the time variable continuous (I will explore MOL in future posts).</p>
<p>We can write the scheme (<a href="#eq-heat-eq-3" class="quarto-xref">Equation&nbsp;6</a> - <a href="#eq-heat-eq-5" class="quarto-xref">Equation&nbsp;8</a>) in the component form:</p>
<p><span id="eq-component-form"><span class="math display">\[
\begin{align*}
\frac{U^{n+1}j - U^{n}j}{\Delta t} = \theta(U^{n+1}_{j+1}-2U^{n+1}_j + U^{n+1}_{j-1})/h^2 + (1-\theta)(U^{n}_{j+1}-2U^{n}_j + U^{n}_{j-1})/h^2
\end{align*}
\tag{9}\]</span></span></p>
<p>or equivalently:</p>
<p><span class="math display">\[
\begin{align*}
{U^{n+1}j - U^{n}_j} &amp;= \lambda\theta(U^{n+1}_{j+1}-2U^{n+1}_j + U^{n+1}_{j-1})/h^2 \\&amp;+ (1-\theta)(U^{n}_{j+1}-2U^{n}_j + U^{n}_{j-1})
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\lambda = \Delta t/h^2\)</span>.</p>
<p>Finally:</p>
<p><span id="eq-finite-difference-scheme"><span class="math display">\[
\begin{align*}
-\lambda \theta U^{n+1}_{j+1} + (1+2\lambda \theta)U_j^{n+1} - \lambda \theta U^{n+1}_{j-1} \\= \lambda (1-\theta)U^{n}_{j+1}+(1-2\lambda(1-\theta))U^{n}_j + \lambda(1-\theta)U^{n}_{j-1}
\end{align*}
\tag{10}\]</span></span></p>
<p>The system (<a href="#eq-finite-difference-scheme" class="quarto-xref">Equation&nbsp;10</a>) is tridiagonal and we can apply the Thomas algorithm to solve it. In the case of the explicit Euler scheme <span class="math inline">\((\theta = 0)\)</span>, these algorithms are not needed, because the solution at time level <span class="math inline">\(n+1\)</span> can be explicitly computed:</p>
<p><span id="eq-explicit-euler"><span class="math display">\[
\begin{align*}
U^{n+1}_j = \lambda U^{n}_{j+1} + (1-2\lambda)U^{n}_j +\lambda U^{n}_{j-1}
\end{align*}
\tag{11}\]</span></span></p>
<section id="computational-solution-1" class="level3">
<h3 class="anchored" data-anchor-id="computational-solution-1">Computational Solution</h3>
<p>I implemented the algorithm in <a href="#eq-finite-difference-scheme" class="quarto-xref">Equation&nbsp;10</a>. This is a one-step marching scheme called BTCS(Backward in Time, Centered in Space) that computes the solution at time level <span class="math inline">\(n+1\)</span> in terms of the solution at time <span class="math inline">\(n\)</span>. Since there are three unknowns to be computed at each time level <span class="math inline">\(n+1\)</span>, we need to use the Thomas algorithm. The main steps in the algorithm are:</p>
<ul>
<li>Choose input parameters and generate meshes</li>
<li>Define the initial solution and the boundary conditions</li>
<li>Compute the solution at each time upto and including expiration.</li>
</ul>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="quasar-chunawala/quantdev" data-repo-id="R_kgDOL2t5-A" data-category="General" data-category-id="DIC_kwDOL2t5-M4ClndQ" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb4" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Tridiagonal Systems"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Quasar"</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-11-15"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Numerical Methods]      </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "image.jpg"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 3</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">    html:</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">        code-tools: true</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">        code-block-border-left: true</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">        code-annotations: below</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">        highlight-style: pygments</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>The special case of a system of linear equations that is *tridiagonal*, that is, has non-zero elements only on the diagonal plus or minus one column, is one that occurs frequently. Also common are systems that are *band-diagonal*, with non-zero elements only along a few diagonal lines adjacent to the main diagonal (above and below).</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>For triadiagonal sets, the procedures $LU$-decomposition, forward- and back- substitution each take only $O(n)$ operations and the whole solution can be coded very concisely. In this blog post, I am going to explore solving triadiagonal matrix systems. I closely follow Daniel Duffy's exposition in *Chapter 13* of his excellent book <span class="co">[</span><span class="ot">Financial Instrument Pricing using C++</span><span class="co">](https://www.amazon.co.uk/Financial-Instrument-Pricing-Using-Finance-ebook/dp/B07H51DPQP/ref=sr_1_1?crid=35L1ITLEUA1S&amp;dib=eyJ2IjoiMSJ9.FeGDbbRPp2NQKdDQycirWzCkF5j0TlM92l9p6jCKk-U.9ZQRlCNBa5pshnZTad_fcM8KxN4SyD60z1tCbwwwE-g&amp;dib_tag=se&amp;keywords=Financial+Instrument+Pricing+Using+C%2B%2B&amp;nsdOptOutParam=true&amp;qid=1731655789&amp;sprefix=financial+instrument+pricing+using+c%2B%2B%2Caps%2C177&amp;sr=8-1)</span>.</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>Let $A$ be a $m \times n$ general banded matrix with $kl$ subdiagonals and $ku$ superdiagonals. Then, $a_{ij}=0$, when $|i - j| &gt; kl + ku  + 1$. All non-zero elements are positioned on the main diagonal, $kl$ subdiagonals below it and $ku$ superdiagonals above it. </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A *diagonal* matrix is a $n \times n$ band matrix with $kl = ku = 0$.</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A *Toeplitz* matrix is a $n \times n$ band matrix $T_n=[t_{k,j};k,j=0,1,\ldots,n-1]$ where $t_{k,j}=t_{k-j}$. That is, a matrix of the form:</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>T_n = \begin{bmatrix}</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>t_0 &amp; t_{-1} &amp; t_{-2} &amp; \ldots &amp; t_{-(n-1)}<span class="sc">\\</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>t_1 &amp; t_0 &amp; t_{-1} &amp; \ldots &amp; t_{-(n-2)}<span class="sc">\\</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>t_2 &amp; t_1 &amp; t_{0} &amp; \ldots &amp; t_{-(n-3)}<span class="sc">\\</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>\vdots &amp; &amp; &amp; \ddots &amp; <span class="sc">\\</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>t_{n-1} &amp; t_{n-2} &amp; t_{n-3} &amp; \ldots &amp; t_{0}</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A *tridiagonal* (Jacobi) matrix is a $n \times n$ band matrix of width three $kl = ku = 1$. </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>b_0 &amp; c_0 &amp; 0 &amp; \ldots <span class="sc">\\</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>a_1 &amp; b_1 &amp; c_1 &amp; \ldots <span class="sc">\\</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>0 &amp; a_2 &amp; b_2 &amp; \ldots <span class="sc">\\</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>&amp; &amp; &amp; \ldots <span class="sc">\\</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>&amp; &amp; &amp; \ldots &amp; a_{n-2} &amp; b_{n-2} &amp; c_{n-2}<span class="sc">\\</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>&amp; &amp; &amp; \ldots &amp; 0 &amp; a_{n-1} &amp; b_{n-1}</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>Consider a two-point boundary value problem on the interval $(0,1)$ with Dirichlet boundary conditions:</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>\frac{d^2 u}{d x^2} &amp;= f(x), \quad 0 &lt; x &lt; 1<span class="sc">\\</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>u(0) &amp;= \phi, <span class="sc">\\</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>u(1) &amp;= \psi </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>$$ {#eq-two-point-bvp}</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>We approximate the solution $u$ by creating a *discrete mesh of points* defined by $<span class="sc">\{</span>x_j<span class="sc">\}</span>$, $j=0,\ldots,N$ where $N$ is a positive integer. At each interior mesh point the second derivative in the @eq-two-point-bvp can be approximated by a second-order divided difference. The corresponding discrete scheme is:</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>\begin{matrix}</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>U_0 &amp;- 2U_1 &amp;+ U_2 &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp;= h^2 f_1 <span class="sc">\\</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>&amp; U_1 &amp;- 2U_2 &amp;+ U_3  &amp; &amp; &amp; &amp; &amp; &amp; &amp;= h^2 f_2 <span class="sc">\\</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>&amp; &amp; U_2 &amp;- 2U_3 &amp;+ U_4 &amp; &amp; &amp; &amp; &amp; &amp;= h^2 f_3 <span class="sc">\\</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>&amp; &amp;     &amp;       &amp;      &amp; \ldots &amp; &amp; &amp; &amp; &amp; \vdots <span class="sc">\\</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>&amp; &amp;     &amp;       &amp;      &amp; \ldots &amp; U_{N-3} &amp;- 2U_{N-2} &amp;+ U_{N-1} &amp;  &amp;= h^2 f_{N-2}<span class="sc">\\</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>&amp; &amp;     &amp;       &amp;      &amp; \ldots &amp;  &amp; U_{N-2} &amp;-2 U_{N-1} &amp;+ U_N &amp;= h^2 f_{N-1}<span class="sc">\\</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>\end{matrix}</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>Since $U_0 = \phi$ and $U_N = \psi$, we have $N-1$ equations in ${N-1}$ unknowns. These can be arranged in the matrix form as:</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>-2 &amp; 1<span class="sc">\\</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>1  &amp;-2 &amp; 1  &amp;   &amp; \ldots &amp;   &amp;    &amp;  <span class="sc">\\</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>   &amp; 1 &amp;-2  &amp; 1 &amp; \ldots &amp;   &amp;    &amp;  <span class="sc">\\</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>   &amp;   &amp;    &amp;   &amp; \ldots &amp;   &amp;    &amp;  <span class="sc">\\</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>   &amp;   &amp;    &amp;   &amp; \ldots &amp; 1 &amp; -2 &amp; 1 <span class="sc">\\</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>   &amp;   &amp;    &amp;   &amp; \ldots &amp;   &amp;  1 &amp; -2</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}\begin{bmatrix}</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>U_1 <span class="sc">\\</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>U_2 <span class="sc">\\</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>\vdots<span class="sc">\\</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>U_{N-2} <span class="sc">\\</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>U_{N-1}</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} = \begin{bmatrix}</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>h^2 f_1 - \phi<span class="sc">\\</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>h^2 f_2 <span class="sc">\\</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>\vdots<span class="sc">\\</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>h^2 f_{N-2} <span class="sc">\\</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>h^2 f_{N-1} - \psi</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>or in matrix form $AU=F$.</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## Thomas Algorithm</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>The Thomas algorithm is an efficient way of solving tridiagonal matrix systems. It is based on $LU$-decomposition in which the matrix system $Ax=r$ is written as $LUx=r$, where $L$ is a lower-triangular matrix and $U$ is an upper triangular matrix. The system can be efficiently solved by setting $Ux=\rho$ and then solving first $L\rho=r$ and then $Ux=\rho$ for $x$. The Thomas algorithm consists of two steps. In step 1, decomposing the matrix $M = LU$ and solving $L\rho=r$ are accomplished in a single downwards sweep, taking us straight from $Ax=r$ to $Ux=\rho$. In step 2, the equation $Ux = \rho$ is solved for $x$ in an upward sweep.</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stage 1</span></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>In the first stage, the matrix equation $Ax=r$ is converted to the form $Ux=\rho$. Initially, the matrix equation looks like this:</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>{\color{blue}b_1} &amp; {\color{blue}c_1} &amp; 0 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>{\color{blue}a_2} &amp; {\color{blue}b_2} &amp; {\color{blue}c_2} &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>0 &amp; {\color{blue}a_3} &amp; {\color{blue}b_3} &amp; {\color{blue}c_3} &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; {\color{blue}a_4} &amp; {\color{blue}b_4} &amp; {\color{blue}c_4} &amp; 0<span class="sc">\\</span></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; {\color{blue}a_5} &amp; {\color{blue}b_5} &amp; {\color{blue}c_5}<span class="sc">\\</span></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 0 &amp; a_6 &amp; b_6</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} \begin{bmatrix}</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>x_1 <span class="sc">\\</span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>x_2 <span class="sc">\\</span></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>x_3 <span class="sc">\\</span></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>x_4 <span class="sc">\\</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>x_5 <span class="sc">\\</span></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>x_6</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} =</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_1} <span class="sc">\\</span></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_2} <span class="sc">\\</span></span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_3} <span class="sc">\\</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_4} <span class="sc">\\</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_5} <span class="sc">\\</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_6}</span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>Row $1$:</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>{\color{blue}b_1} x_1 + {\color{blue}c_1} x_2 = {\color{blue}r_1}</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>Dividing throughout by $\color{blue}b_1$,</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>x_1 + {\color{blue}\frac{c_1}{b_1}} x_2 = {\color{blue}\frac{r_1}{b_1}}</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>Rewrite:</span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>x_1 + {\color{red}\gamma_1} x_2 = {\color{red}\rho_1}, \quad {\color{red}\gamma_1} = {\color{blue}\frac{c_1}{b_1}}, \quad {\color{red}\rho_1} = {\color{blue}\frac{r_1}{b_1}}</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>{\color{red}1} &amp; {\color{red}\gamma_1} &amp; 0 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>{\color{blue}a_2} &amp; {\color{blue}b_2} &amp; {\color{blue}c_2} &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>0 &amp; {\color{blue}a_3} &amp; {\color{blue}b_3} &amp; {\color{blue}c_3} &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; {\color{blue}a_4} &amp; {\color{blue}b_4} &amp; {\color{blue}c_4} &amp; 0<span class="sc">\\</span></span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; {\color{blue}a_5} &amp; {\color{blue}b_5} &amp; {\color{blue}c_5}<span class="sc">\\</span></span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 0 &amp; a_6 &amp; b_6</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} \begin{bmatrix}</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>x_1 <span class="sc">\\</span></span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>x_2 <span class="sc">\\</span></span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>x_3 <span class="sc">\\</span></span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>x_4 <span class="sc">\\</span></span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>x_5 <span class="sc">\\</span></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>x_6</span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} =</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>{\color{red}\rho_1} <span class="sc">\\</span></span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_2} <span class="sc">\\</span></span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_3} <span class="sc">\\</span></span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_4} <span class="sc">\\</span></span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_5} <span class="sc">\\</span></span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>{\color{blue}r_6}</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>Row $2$:</span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a>{\color{blue}a_2} x_1 + {\color{blue}b_2} x_2 + {\color{blue}c_2} x_3 = {\color{blue}r_2}</span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>Use $a_2$ times row $1$ of the matrix to eliminate the first term</span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>a_2(x_1 + {\color{red}\gamma_1}x_2 = {\color{red}\rho_1})</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>\begin{array}{c|cccc}</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>\text{Row 2} &amp; a_2 x_1 &amp;+ b_2 x_2 &amp;+ c_2 x_3 &amp;= r_2<span class="sc">\\</span></span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>a_2 \times \text{Row 1} &amp; a_2 x_1 &amp;+ a_2 \gamma_1 x_2 &amp; &amp;= a_2\rho_1<span class="sc">\\</span></span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>\hline</span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>\text{New Row 2} &amp; &amp; (b_2 - a_2 \gamma_1) x_2 &amp;+ c_2 x_3  &amp;= r_2 - a_2 \rho_1</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>\end{array}</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>Dividing throughout by $(b_2 - a_2 \gamma_1)$, we get:</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>x_2 + \frac{c_2}{b_2 - a_2 \gamma_1}x_3 = \frac{(r_2 - a_2 \rho_1)}{(b_2 - a_2 \gamma_1)}</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>We can rewrite this as:</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>x_2 + \gamma_2 x_3 = \rho_2, \quad \gamma_2 = \frac{c_2}{b_2 - a_2 \gamma_1}, \quad \rho_2 = \frac{(r_2 - a_2 \rho_1)}{(b_2 - a_2 \gamma_1)}</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>1 &amp; \gamma_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; \gamma_2 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>0 &amp; a_3 &amp; b_3 &amp; c_3 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; a_4 &amp; b_4 &amp; c_4 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; a_5 &amp; b_5 &amp; c_5<span class="sc">\\</span></span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 0 &amp; a_6 &amp; b_6</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} \begin{bmatrix}</span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>x_1 <span class="sc">\\</span></span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>x_2 <span class="sc">\\</span></span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>x_3 <span class="sc">\\</span></span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>x_4 <span class="sc">\\</span></span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>x_5 <span class="sc">\\</span></span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>x_6</span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} =</span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>\rho_1 <span class="sc">\\</span></span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>\rho_2 <span class="sc">\\</span></span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>r_3 <span class="sc">\\</span></span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>r_4 <span class="sc">\\</span></span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a>r_5 <span class="sc">\\</span></span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>r_6</span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a>Row $3$:</span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>a_3 x_2 + b_3 x_3 + c_3 x_4 = r_3</span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a>Use $a_3$ times row $2$ of the matrix to eliminate the first term:</span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a>\begin{array}{c|cccc}</span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a>\text{Row 3} &amp; a_3 x_2 &amp;+ b_3 x_3 &amp;+ c_3 x_4 &amp;= r_3<span class="sc">\\</span></span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a>a_3 \times \text{Row 2} &amp; a_3 x_2 &amp;+ a_3 \gamma_2 x_3 &amp; &amp;= a_3\rho_2<span class="sc">\\</span></span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a>\hline</span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a>\text{New Row 3} &amp; &amp; (b_3 - a_3 \gamma_2) x_3 &amp;+ c_3 x_4  &amp;= r_3 - a_3 \rho_2</span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>\end{array}</span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true" tabindex="-1"></a>Dividing throughout by $(b_3 - a_3 \gamma_2)$, we have:</span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true" tabindex="-1"></a>x_3 + \frac{c_3}{b_3 - a_3 \gamma_2} x_4 = \frac{r_3 - a_3\rho_2}{b_3 - a_3 \gamma_2}</span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true" tabindex="-1"></a>We can rewrite this as:</span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true" tabindex="-1"></a>x_3 + \gamma_3 x_4 = \rho_3, \quad  \gamma_3 = \frac{c_3}{b_3 - a_3 \gamma_2}, \quad \rho_3=\frac{r_3 - a_3 \rho_2}{b_3 - a_3 \gamma_2}</span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true" tabindex="-1"></a>Continuing in this fashion, we get:</span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true" tabindex="-1"></a>1 &amp; \gamma_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; \gamma_2 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; 1 &amp; \gamma_3 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_4 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_5<span class="sc">\\</span></span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 0 &amp; a_6 &amp; b_6</span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} \begin{bmatrix}</span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true" tabindex="-1"></a>x_1 <span class="sc">\\</span></span>
<span id="cb4-278"><a href="#cb4-278" aria-hidden="true" tabindex="-1"></a>x_2 <span class="sc">\\</span></span>
<span id="cb4-279"><a href="#cb4-279" aria-hidden="true" tabindex="-1"></a>x_3 <span class="sc">\\</span></span>
<span id="cb4-280"><a href="#cb4-280" aria-hidden="true" tabindex="-1"></a>x_4 <span class="sc">\\</span></span>
<span id="cb4-281"><a href="#cb4-281" aria-hidden="true" tabindex="-1"></a>x_5 <span class="sc">\\</span></span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true" tabindex="-1"></a>x_6</span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} =</span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true" tabindex="-1"></a>\rho_1 <span class="sc">\\</span></span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true" tabindex="-1"></a>\rho_2 <span class="sc">\\</span></span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true" tabindex="-1"></a>\rho_3 <span class="sc">\\</span></span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true" tabindex="-1"></a>\rho_4 <span class="sc">\\</span></span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true" tabindex="-1"></a>\rho_5 <span class="sc">\\</span></span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true" tabindex="-1"></a>r_6</span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-293"><a href="#cb4-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-294"><a href="#cb4-294" aria-hidden="true" tabindex="-1"></a>Row $6$:</span>
<span id="cb4-295"><a href="#cb4-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-297"><a href="#cb4-297" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-298"><a href="#cb4-298" aria-hidden="true" tabindex="-1"></a>a_6 x_5 + a_6 x_6 = r_6</span>
<span id="cb4-299"><a href="#cb4-299" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-300"><a href="#cb4-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-301"><a href="#cb4-301" aria-hidden="true" tabindex="-1"></a>Use $a_6$ times row 5 of the matrix:</span>
<span id="cb4-302"><a href="#cb4-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-303"><a href="#cb4-303" aria-hidden="true" tabindex="-1"></a>$$a_6(x_5 + \gamma_5 x_6 = \rho_5)$$</span>
<span id="cb4-304"><a href="#cb4-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-305"><a href="#cb4-305" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-306"><a href="#cb4-306" aria-hidden="true" tabindex="-1"></a>\begin{array}{c|cccc}</span>
<span id="cb4-307"><a href="#cb4-307" aria-hidden="true" tabindex="-1"></a>\text{Row 6} &amp; a_6 x_5 &amp;+ b_6 x_6 &amp;= r_6<span class="sc">\\</span></span>
<span id="cb4-308"><a href="#cb4-308" aria-hidden="true" tabindex="-1"></a>a_6 \times \text{Row 5} &amp; a_6 x_5 &amp;+ a_6 \gamma_5 x_6  &amp;= a_6\rho_5<span class="sc">\\</span></span>
<span id="cb4-309"><a href="#cb4-309" aria-hidden="true" tabindex="-1"></a>\hline</span>
<span id="cb4-310"><a href="#cb4-310" aria-hidden="true" tabindex="-1"></a>\text{New Row 3} &amp; &amp; (b_6 - a_6 \gamma_5) x_6  &amp;= r_6 - a_6 \rho_5</span>
<span id="cb4-311"><a href="#cb4-311" aria-hidden="true" tabindex="-1"></a>\end{array}</span>
<span id="cb4-312"><a href="#cb4-312" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-313"><a href="#cb4-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-314"><a href="#cb4-314" aria-hidden="true" tabindex="-1"></a>Dividing throughout by $(b_6 - a_6 \gamma_5)$, we can rewrite:</span>
<span id="cb4-315"><a href="#cb4-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-316"><a href="#cb4-316" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-317"><a href="#cb4-317" aria-hidden="true" tabindex="-1"></a>x_6 = \rho_6, \quad \rho_6 = \frac{r_6 - a_6 \rho_5}{b_6 - a_6 \gamma_5}</span>
<span id="cb4-318"><a href="#cb4-318" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-319"><a href="#cb4-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-320"><a href="#cb4-320" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-321"><a href="#cb4-321" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-322"><a href="#cb4-322" aria-hidden="true" tabindex="-1"></a>1 &amp; \gamma_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-323"><a href="#cb4-323" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; \gamma_2 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-324"><a href="#cb4-324" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; 1 &amp; \gamma_3 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-325"><a href="#cb4-325" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_4 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-326"><a href="#cb4-326" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_5<span class="sc">\\</span></span>
<span id="cb4-327"><a href="#cb4-327" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1</span>
<span id="cb4-328"><a href="#cb4-328" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} \begin{bmatrix}</span>
<span id="cb4-329"><a href="#cb4-329" aria-hidden="true" tabindex="-1"></a>x_1 <span class="sc">\\</span></span>
<span id="cb4-330"><a href="#cb4-330" aria-hidden="true" tabindex="-1"></a>x_2 <span class="sc">\\</span></span>
<span id="cb4-331"><a href="#cb4-331" aria-hidden="true" tabindex="-1"></a>x_3 <span class="sc">\\</span></span>
<span id="cb4-332"><a href="#cb4-332" aria-hidden="true" tabindex="-1"></a>x_4 <span class="sc">\\</span></span>
<span id="cb4-333"><a href="#cb4-333" aria-hidden="true" tabindex="-1"></a>x_5 <span class="sc">\\</span></span>
<span id="cb4-334"><a href="#cb4-334" aria-hidden="true" tabindex="-1"></a>x_6</span>
<span id="cb4-335"><a href="#cb4-335" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} =</span>
<span id="cb4-336"><a href="#cb4-336" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-337"><a href="#cb4-337" aria-hidden="true" tabindex="-1"></a>\rho_1 <span class="sc">\\</span></span>
<span id="cb4-338"><a href="#cb4-338" aria-hidden="true" tabindex="-1"></a>\rho_2 <span class="sc">\\</span></span>
<span id="cb4-339"><a href="#cb4-339" aria-hidden="true" tabindex="-1"></a>\rho_3 <span class="sc">\\</span></span>
<span id="cb4-340"><a href="#cb4-340" aria-hidden="true" tabindex="-1"></a>\rho_4 <span class="sc">\\</span></span>
<span id="cb4-341"><a href="#cb4-341" aria-hidden="true" tabindex="-1"></a>\rho_5 <span class="sc">\\</span></span>
<span id="cb4-342"><a href="#cb4-342" aria-hidden="true" tabindex="-1"></a>\rho_6</span>
<span id="cb4-343"><a href="#cb4-343" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-344"><a href="#cb4-344" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-345"><a href="#cb4-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-346"><a href="#cb4-346" aria-hidden="true" tabindex="-1"></a>These steps may be summarized as compute the following sequences:</span>
<span id="cb4-347"><a href="#cb4-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-348"><a href="#cb4-348" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-349"><a href="#cb4-349" aria-hidden="true" tabindex="-1"></a>\gamma_1 = \frac{c_1}{b_1}, \quad \rho_1 = \frac{r_1}{b_1}</span>
<span id="cb4-350"><a href="#cb4-350" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-351"><a href="#cb4-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-352"><a href="#cb4-352" aria-hidden="true" tabindex="-1"></a>And </span>
<span id="cb4-353"><a href="#cb4-353" aria-hidden="true" tabindex="-1"></a>$$\gamma_j = \frac{c_j}{b_j - a_j \gamma_{j-1}}, \quad \rho_j = \frac{r_j - a_j \rho_{j-1}}{b_j - a_j \gamma_{j-1}}$$ </span>
<span id="cb4-354"><a href="#cb4-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-355"><a href="#cb4-355" aria-hidden="true" tabindex="-1"></a>for $j=2:6$.</span>
<span id="cb4-356"><a href="#cb4-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-357"><a href="#cb4-357" aria-hidden="true" tabindex="-1"></a>At this point, the matrix has been reduced to the upper diagonal form, so our equations are of the form $Ux = \rho$. </span>
<span id="cb4-358"><a href="#cb4-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-359"><a href="#cb4-359" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stage 2</span></span>
<span id="cb4-360"><a href="#cb4-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-361"><a href="#cb4-361" aria-hidden="true" tabindex="-1"></a>The matrix is now in a form which is trivial to solve for $x$. We start with the last row and work our way up. The final equation is already solved.</span>
<span id="cb4-362"><a href="#cb4-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-363"><a href="#cb4-363" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-364"><a href="#cb4-364" aria-hidden="true" tabindex="-1"></a>x_6 = \rho_6</span>
<span id="cb4-365"><a href="#cb4-365" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-366"><a href="#cb4-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-367"><a href="#cb4-367" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-368"><a href="#cb4-368" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-369"><a href="#cb4-369" aria-hidden="true" tabindex="-1"></a>1 &amp; \gamma_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-370"><a href="#cb4-370" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; \gamma_2 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-371"><a href="#cb4-371" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; 1 &amp; \gamma_3 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-372"><a href="#cb4-372" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_4 &amp; 0<span class="sc">\\</span></span>
<span id="cb4-373"><a href="#cb4-373" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; \gamma_5<span class="sc">\\</span></span>
<span id="cb4-374"><a href="#cb4-374" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1</span>
<span id="cb4-375"><a href="#cb4-375" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} \begin{bmatrix}</span>
<span id="cb4-376"><a href="#cb4-376" aria-hidden="true" tabindex="-1"></a>x_1 <span class="sc">\\</span></span>
<span id="cb4-377"><a href="#cb4-377" aria-hidden="true" tabindex="-1"></a>x_2 <span class="sc">\\</span></span>
<span id="cb4-378"><a href="#cb4-378" aria-hidden="true" tabindex="-1"></a>x_3 <span class="sc">\\</span></span>
<span id="cb4-379"><a href="#cb4-379" aria-hidden="true" tabindex="-1"></a>x_4 <span class="sc">\\</span></span>
<span id="cb4-380"><a href="#cb4-380" aria-hidden="true" tabindex="-1"></a>x_5 <span class="sc">\\</span></span>
<span id="cb4-381"><a href="#cb4-381" aria-hidden="true" tabindex="-1"></a>x_6</span>
<span id="cb4-382"><a href="#cb4-382" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} =</span>
<span id="cb4-383"><a href="#cb4-383" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb4-384"><a href="#cb4-384" aria-hidden="true" tabindex="-1"></a>\rho_1 <span class="sc">\\</span></span>
<span id="cb4-385"><a href="#cb4-385" aria-hidden="true" tabindex="-1"></a>\rho_2 <span class="sc">\\</span></span>
<span id="cb4-386"><a href="#cb4-386" aria-hidden="true" tabindex="-1"></a>\rho_3 <span class="sc">\\</span></span>
<span id="cb4-387"><a href="#cb4-387" aria-hidden="true" tabindex="-1"></a>\rho_4 <span class="sc">\\</span></span>
<span id="cb4-388"><a href="#cb4-388" aria-hidden="true" tabindex="-1"></a>\rho_5 <span class="sc">\\</span></span>
<span id="cb4-389"><a href="#cb4-389" aria-hidden="true" tabindex="-1"></a>\rho_6</span>
<span id="cb4-390"><a href="#cb4-390" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-391"><a href="#cb4-391" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-392"><a href="#cb4-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-393"><a href="#cb4-393" aria-hidden="true" tabindex="-1"></a>Row $5$:</span>
<span id="cb4-394"><a href="#cb4-394" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-395"><a href="#cb4-395" aria-hidden="true" tabindex="-1"></a>x_5 + \gamma_5 x_6 = \rho_5</span>
<span id="cb4-396"><a href="#cb4-396" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-397"><a href="#cb4-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-398"><a href="#cb4-398" aria-hidden="true" tabindex="-1"></a>Rearrange to get:</span>
<span id="cb4-399"><a href="#cb4-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-400"><a href="#cb4-400" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-401"><a href="#cb4-401" aria-hidden="true" tabindex="-1"></a>x_5 = \rho_5 - \gamma_5 x_6</span>
<span id="cb4-402"><a href="#cb4-402" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-403"><a href="#cb4-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-404"><a href="#cb4-404" aria-hidden="true" tabindex="-1"></a>Row $4$:</span>
<span id="cb4-405"><a href="#cb4-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-406"><a href="#cb4-406" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-407"><a href="#cb4-407" aria-hidden="true" tabindex="-1"></a>x_4 + \gamma_4 x_5 = \rho_4</span>
<span id="cb4-408"><a href="#cb4-408" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-409"><a href="#cb4-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-410"><a href="#cb4-410" aria-hidden="true" tabindex="-1"></a>Rearrange to get:</span>
<span id="cb4-411"><a href="#cb4-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-412"><a href="#cb4-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-413"><a href="#cb4-413" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-414"><a href="#cb4-414" aria-hidden="true" tabindex="-1"></a>x_4 = \rho_4 - \gamma_4 x_5</span>
<span id="cb4-415"><a href="#cb4-415" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-416"><a href="#cb4-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-417"><a href="#cb4-417" aria-hidden="true" tabindex="-1"></a>Continuing in this fashion, we find that, $x_6 = \rho_6$ and</span>
<span id="cb4-418"><a href="#cb4-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-419"><a href="#cb4-419" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-420"><a href="#cb4-420" aria-hidden="true" tabindex="-1"></a>x_j = \rho_j - \gamma_j x_{j+1}</span>
<span id="cb4-421"><a href="#cb4-421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-422"><a href="#cb4-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-423"><a href="#cb4-423" aria-hidden="true" tabindex="-1"></a>for all $j=1:5$. </span>
<span id="cb4-424"><a href="#cb4-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-425"><a href="#cb4-425" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computational Solution</span></span>
<span id="cb4-426"><a href="#cb4-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-427"><a href="#cb4-427" aria-hidden="true" tabindex="-1"></a>Let's quickly code up the algorithm in Julia.</span>
<span id="cb4-428"><a href="#cb4-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-431"><a href="#cb4-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb4-432"><a href="#cb4-432" aria-hidden="true" tabindex="-1"></a><span class="in">function thomasAlgorithm(a, b, c, r)</span></span>
<span id="cb4-433"><a href="#cb4-433" aria-hidden="true" tabindex="-1"></a><span class="in">    N = size(a)[1]</span></span>
<span id="cb4-434"><a href="#cb4-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-435"><a href="#cb4-435" aria-hidden="true" tabindex="-1"></a><span class="in">    # Stage 1</span></span>
<span id="cb4-436"><a href="#cb4-436" aria-hidden="true" tabindex="-1"></a><span class="in">    γ = Array{Float64,1}(undef,N)</span></span>
<span id="cb4-437"><a href="#cb4-437" aria-hidden="true" tabindex="-1"></a><span class="in">    ρ = Array{Float64,1}(undef,N)</span></span>
<span id="cb4-438"><a href="#cb4-438" aria-hidden="true" tabindex="-1"></a><span class="in">    u = Array{Float64,1}(undef,N)</span></span>
<span id="cb4-439"><a href="#cb4-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-440"><a href="#cb4-440" aria-hidden="true" tabindex="-1"></a><span class="in">    γ[1] = c[1]/b[1]</span></span>
<span id="cb4-441"><a href="#cb4-441" aria-hidden="true" tabindex="-1"></a><span class="in">    ρ[1] = r[1]/b[1]</span></span>
<span id="cb4-442"><a href="#cb4-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-443"><a href="#cb4-443" aria-hidden="true" tabindex="-1"></a><span class="in">    for j=2:N</span></span>
<span id="cb4-444"><a href="#cb4-444" aria-hidden="true" tabindex="-1"></a><span class="in">        γ[j] = c[j]/(b[j] - a[j] * γ[j-1])</span></span>
<span id="cb4-445"><a href="#cb4-445" aria-hidden="true" tabindex="-1"></a><span class="in">        ρ[j] = (r[j] - a[j] * ρ[j-1])/(b[j] - a[j] * γ[j-1])</span></span>
<span id="cb4-446"><a href="#cb4-446" aria-hidden="true" tabindex="-1"></a><span class="in">    end</span></span>
<span id="cb4-447"><a href="#cb4-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-448"><a href="#cb4-448" aria-hidden="true" tabindex="-1"></a><span class="in">    # Stage 2</span></span>
<span id="cb4-449"><a href="#cb4-449" aria-hidden="true" tabindex="-1"></a><span class="in">    u[N] =  ρ[N]</span></span>
<span id="cb4-450"><a href="#cb4-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-451"><a href="#cb4-451" aria-hidden="true" tabindex="-1"></a><span class="in">    for j=reverse(1:N-1)</span></span>
<span id="cb4-452"><a href="#cb4-452" aria-hidden="true" tabindex="-1"></a><span class="in">        u[j] = ρ[j] - γ[j] * u[j+1]</span></span>
<span id="cb4-453"><a href="#cb4-453" aria-hidden="true" tabindex="-1"></a><span class="in">    end</span></span>
<span id="cb4-454"><a href="#cb4-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-455"><a href="#cb4-455" aria-hidden="true" tabindex="-1"></a><span class="in">    return u</span></span>
<span id="cb4-456"><a href="#cb4-456" aria-hidden="true" tabindex="-1"></a><span class="in">end</span></span>
<span id="cb4-457"><a href="#cb4-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-458"><a href="#cb4-458" aria-hidden="true" tabindex="-1"></a><span class="in"># Test Case</span></span>
<span id="cb4-459"><a href="#cb4-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-460"><a href="#cb4-460" aria-hidden="true" tabindex="-1"></a><span class="in">a = Array{Float64,1}([0, 2, 2, 2])</span></span>
<span id="cb4-461"><a href="#cb4-461" aria-hidden="true" tabindex="-1"></a><span class="in">b = Array{Float64,1}([3, 3, 3, 3])</span></span>
<span id="cb4-462"><a href="#cb4-462" aria-hidden="true" tabindex="-1"></a><span class="in">c = Array{Float64,1}([2, 2, 2, 0])</span></span>
<span id="cb4-463"><a href="#cb4-463" aria-hidden="true" tabindex="-1"></a><span class="in">r = Array{Float64,1}([12, 17, 14, 7])</span></span>
<span id="cb4-464"><a href="#cb4-464" aria-hidden="true" tabindex="-1"></a><span class="in">u = thomasAlgorithm(a, b, c, r)</span></span>
<span id="cb4-465"><a href="#cb4-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-466"><a href="#cb4-466" aria-hidden="true" tabindex="-1"></a><span class="in">print(u)</span></span>
<span id="cb4-467"><a href="#cb4-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-468"><a href="#cb4-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-469"><a href="#cb4-469" aria-hidden="true" tabindex="-1"></a>Here is an implementation in modern C++:</span>
<span id="cb4-470"><a href="#cb4-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-471"><a href="#cb4-471" aria-hidden="true" tabindex="-1"></a><span class="in">```cpp</span></span>
<span id="cb4-472"><a href="#cb4-472" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb4-473"><a href="#cb4-473" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;memory&gt;</span></span>
<span id="cb4-474"><a href="#cb4-474" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;functional&gt;</span></span>
<span id="cb4-475"><a href="#cb4-475" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;concepts&gt;</span></span>
<span id="cb4-476"><a href="#cb4-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-477"><a href="#cb4-477" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb4-478"><a href="#cb4-478" aria-hidden="true" tabindex="-1"></a><span class="kw">concept</span> Real <span class="op">=</span> <span class="bu">std::</span>integral<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">||</span> <span class="bu">std::</span>floating_point<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb4-479"><a href="#cb4-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-480"><a href="#cb4-480" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb4-481"><a href="#cb4-481" aria-hidden="true" tabindex="-1"></a><span class="kw">requires</span> Real<span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="cb4-482"><a href="#cb4-482" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Function <span class="op">=</span> <span class="bu">std::</span>function<span class="op">&lt;</span><span class="dt">void</span><span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;&amp;)&gt;;</span></span>
<span id="cb4-483"><a href="#cb4-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-484"><a href="#cb4-484" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb4-485"><a href="#cb4-485" aria-hidden="true" tabindex="-1"></a><span class="kw">requires</span> Real<span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="cb4-486"><a href="#cb4-486" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> thomasAlgorithm<span class="op">(</span></span>
<span id="cb4-487"><a href="#cb4-487" aria-hidden="true" tabindex="-1"></a>      <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> a</span>
<span id="cb4-488"><a href="#cb4-488" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> b</span>
<span id="cb4-489"><a href="#cb4-489" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> c</span>
<span id="cb4-490"><a href="#cb4-490" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> r</span>
<span id="cb4-491"><a href="#cb4-491" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;&amp;</span>x </span>
<span id="cb4-492"><a href="#cb4-492" aria-hidden="true" tabindex="-1"></a>    <span class="op">){</span></span>
<span id="cb4-493"><a href="#cb4-493" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Stage-1</span></span>
<span id="cb4-494"><a href="#cb4-494" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N <span class="op">=</span> a<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb4-495"><a href="#cb4-495" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> gamma<span class="op">(</span>N<span class="op">);</span></span>
<span id="cb4-496"><a href="#cb4-496" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> rho<span class="op">(</span>N<span class="op">);</span></span>
<span id="cb4-497"><a href="#cb4-497" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;(</span>N<span class="op">);</span></span>
<span id="cb4-498"><a href="#cb4-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-499"><a href="#cb4-499" aria-hidden="true" tabindex="-1"></a>    gamma<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> c<span class="op">[</span><span class="dv">0</span><span class="op">]/</span>b<span class="op">[</span><span class="dv">0</span><span class="op">];</span> </span>
<span id="cb4-500"><a href="#cb4-500" aria-hidden="true" tabindex="-1"></a>    rho<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> r<span class="op">[</span><span class="dv">0</span><span class="op">]/</span>b<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb4-501"><a href="#cb4-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-502"><a href="#cb4-502" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">{</span><span class="dv">1</span><span class="op">};</span> j <span class="op">&lt;</span> N<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span></span>
<span id="cb4-503"><a href="#cb4-503" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb4-504"><a href="#cb4-504" aria-hidden="true" tabindex="-1"></a>        gamma<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> c<span class="op">[</span>j<span class="op">]/(</span>b<span class="op">[</span>j<span class="op">]</span> <span class="op">-</span> a<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> gamma<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb4-505"><a href="#cb4-505" aria-hidden="true" tabindex="-1"></a>        rho<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>r<span class="op">[</span>j<span class="op">]</span> <span class="op">-</span> a<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> rho<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])/(</span>b<span class="op">[</span>j<span class="op">]</span> <span class="op">-</span> a<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> gamma<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb4-506"><a href="#cb4-506" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-507"><a href="#cb4-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-508"><a href="#cb4-508" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Stage-2</span></span>
<span id="cb4-509"><a href="#cb4-509" aria-hidden="true" tabindex="-1"></a>    x<span class="op">[</span>N<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> rho<span class="op">[</span>N<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-510"><a href="#cb4-510" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">{</span>N<span class="op">-</span><span class="dv">2</span><span class="op">};</span> j <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> j<span class="op">--)</span></span>
<span id="cb4-511"><a href="#cb4-511" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb4-512"><a href="#cb4-512" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> rho<span class="op">[</span>j<span class="op">]</span> <span class="op">-</span> gamma<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> x<span class="op">[</span>j<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-513"><a href="#cb4-513" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-514"><a href="#cb4-514" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-515"><a href="#cb4-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-516"><a href="#cb4-516" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb4-517"><a href="#cb4-517" aria-hidden="true" tabindex="-1"></a><span class="kw">requires</span> Real<span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="cb4-518"><a href="#cb4-518" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LUTridiagonalSolver<span class="op">{</span></span>
<span id="cb4-519"><a href="#cb4-519" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb4-520"><a href="#cb4-520" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_a</span><span class="op">;</span></span>
<span id="cb4-521"><a href="#cb4-521" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_b</span><span class="op">;</span></span>
<span id="cb4-522"><a href="#cb4-522" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_c</span><span class="op">;</span></span>
<span id="cb4-523"><a href="#cb4-523" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_r</span><span class="op">;</span></span>
<span id="cb4-524"><a href="#cb4-524" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_x</span><span class="op">;</span></span>
<span id="cb4-525"><a href="#cb4-525" aria-hidden="true" tabindex="-1"></a>        Function<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="va">m_LUTridiagonalSolverStrategy</span><span class="op">;</span></span>
<span id="cb4-526"><a href="#cb4-526" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-527"><a href="#cb4-527" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb4-528"><a href="#cb4-528" aria-hidden="true" tabindex="-1"></a>        LUTridiagonalSolver<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb4-529"><a href="#cb4-529" aria-hidden="true" tabindex="-1"></a>        LUTridiagonalSolver<span class="op">(</span></span>
<span id="cb4-530"><a href="#cb4-530" aria-hidden="true" tabindex="-1"></a>              <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> a</span>
<span id="cb4-531"><a href="#cb4-531" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> b</span>
<span id="cb4-532"><a href="#cb4-532" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> c</span>
<span id="cb4-533"><a href="#cb4-533" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> r</span>
<span id="cb4-534"><a href="#cb4-534" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> Function<span class="op">&lt;</span>T<span class="op">&gt;</span> solver<span class="op">)</span> </span>
<span id="cb4-535"><a href="#cb4-535" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">m_a</span> <span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>a<span class="op">)}</span></span>
<span id="cb4-536"><a href="#cb4-536" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="va">m_b</span> <span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>b<span class="op">)}</span></span>
<span id="cb4-537"><a href="#cb4-537" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="va">m_c</span> <span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>c<span class="op">)}</span></span>
<span id="cb4-538"><a href="#cb4-538" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="va">m_r</span> <span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>r<span class="op">)}</span></span>
<span id="cb4-539"><a href="#cb4-539" aria-hidden="true" tabindex="-1"></a>            <span class="op">,</span> <span class="va">m_LUTridiagonalSolverStrategy</span> <span class="op">{</span>solver<span class="op">}</span> </span>
<span id="cb4-540"><a href="#cb4-540" aria-hidden="true" tabindex="-1"></a>            <span class="op">{}</span></span>
<span id="cb4-541"><a href="#cb4-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-542"><a href="#cb4-542" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> solve<span class="op">(){</span></span>
<span id="cb4-543"><a href="#cb4-543" aria-hidden="true" tabindex="-1"></a>            <span class="va">m_LUTridiagonalSolverStrategy</span><span class="op">(</span><span class="va">m_a</span><span class="op">,</span> <span class="va">m_b</span><span class="op">,</span> <span class="va">m_c</span><span class="op">,</span> <span class="va">m_r</span><span class="op">,</span> <span class="va">m_x</span><span class="op">);</span></span>
<span id="cb4-544"><a href="#cb4-544" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">m_x</span><span class="op">;</span></span>
<span id="cb4-545"><a href="#cb4-545" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-546"><a href="#cb4-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-547"><a href="#cb4-547" aria-hidden="true" tabindex="-1"></a>        LUTridiagonalSolver<span class="op">(</span><span class="at">const</span> LUTridiagonalSolver<span class="op">&amp;</span> <span class="op">)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb4-548"><a href="#cb4-548" aria-hidden="true" tabindex="-1"></a>        LUTridiagonalSolver <span class="kw">operator</span><span class="op">=(</span>LUTridiagonalSolver<span class="op">&amp;</span> <span class="op">)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb4-549"><a href="#cb4-549" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>LUTridiagonalSolver<span class="op">(){}</span></span>
<span id="cb4-550"><a href="#cb4-550" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb4-551"><a href="#cb4-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-552"><a href="#cb4-552" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb4-553"><a href="#cb4-553" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb4-554"><a href="#cb4-554" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> a<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb4-555"><a href="#cb4-555" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> b<span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb4-556"><a href="#cb4-556" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> c<span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">};</span></span>
<span id="cb4-557"><a href="#cb4-557" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> r<span class="op">{</span><span class="dv">12</span><span class="op">,</span> <span class="dv">17</span><span class="op">,</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">7</span><span class="op">};</span></span>
<span id="cb4-558"><a href="#cb4-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-559"><a href="#cb4-559" aria-hidden="true" tabindex="-1"></a>    LUTridiagonalSolver<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> solver<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> r<span class="op">,</span> thomasAlgorithm<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;);</span></span>
<span id="cb4-560"><a href="#cb4-560" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> u <span class="op">=</span> solver<span class="op">.</span>solve<span class="op">();</span></span>
<span id="cb4-561"><a href="#cb4-561" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-562"><a href="#cb4-562" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-563"><a href="#cb4-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-564"><a href="#cb4-564" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Compiler Explorer</span><span class="co">](https://godbolt.org/z/T7846WY8v)</span></span>
<span id="cb4-565"><a href="#cb4-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-566"><a href="#cb4-566" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deriving the one-dimensional Heat equation</span></span>
<span id="cb4-567"><a href="#cb4-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-568"><a href="#cb4-568" aria-hidden="true" tabindex="-1"></a>Consider a slender homogenous rod, lying along the $x$-axis and insulated, so that no heat can escape across its longitudinal surface. In addition, we make the simplifying assumption that the temperature in the rod is constant on each cross-section perpendicular to the $x$-axis, and thus that the flow of heat in the rod takes place only in the $x$-direction.</span>
<span id="cb4-569"><a href="#cb4-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-570"><a href="#cb4-570" aria-hidden="true" tabindex="-1"></a>Consider a small segment of the rod at position $x$ of length $\Delta x$.</span>
<span id="cb4-571"><a href="#cb4-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-572"><a href="#cb4-572" aria-hidden="true" tabindex="-1"></a>The thermal energy in this segment at time $t$ is:</span>
<span id="cb4-573"><a href="#cb4-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-574"><a href="#cb4-574" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-575"><a href="#cb4-575" aria-hidden="true" tabindex="-1"></a>E(x,x+\Delta x, t) \approx u(x,t) s \rho \Delta x</span>
<span id="cb4-576"><a href="#cb4-576" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-577"><a href="#cb4-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-578"><a href="#cb4-578" aria-hidden="true" tabindex="-1"></a>where $s$ is the constant of specific heat i.e. amount of heat required to raise one unit of mass by one unit of temperature, $\rho$ is the mass density. </span>
<span id="cb4-579"><a href="#cb4-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-580"><a href="#cb4-580" aria-hidden="true" tabindex="-1"></a>Fourier's law of heat conduction quantifies the idea that heat flows from warmer to colder regions and states that the (rightward) heat flux density $\phi(x,t)$ (the flow of heat energy per unit area per unit time, SI units $J/s/m^2$) at any point is:</span>
<span id="cb4-581"><a href="#cb4-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-582"><a href="#cb4-582" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-583"><a href="#cb4-583" aria-hidden="true" tabindex="-1"></a>\phi(x,t) = -K_0 u_x (x, t)</span>
<span id="cb4-584"><a href="#cb4-584" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-585"><a href="#cb4-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-586"><a href="#cb4-586" aria-hidden="true" tabindex="-1"></a>where $K_0$ is the thermal conductivity of the rod. The negative sign shows that the heat flows from higher temperature regions to colder temperature regions.</span>
<span id="cb4-587"><a href="#cb4-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-588"><a href="#cb4-588" aria-hidden="true" tabindex="-1"></a>Appealing to the law of conservation of energy:</span>
<span id="cb4-589"><a href="#cb4-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-590"><a href="#cb4-590" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-591"><a href="#cb4-591" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-592"><a href="#cb4-592" aria-hidden="true" tabindex="-1"></a>\underbrace{\frac{\partial}{\partial t}(u(x,t) s \rho \Delta x)}_{\text{Heat flux through segment}} = \underbrace{(-K_0 u_x(x, t))}_{\text{Flux in}} - \underbrace{(- K_0 u_x(x + \Delta x,t))}_{\text{Flux out}}</span>
<span id="cb4-593"><a href="#cb4-593" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-594"><a href="#cb4-594" aria-hidden="true" tabindex="-1"></a>$$ {#eq-heat-content}</span>
<span id="cb4-595"><a href="#cb4-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-596"><a href="#cb4-596" aria-hidden="true" tabindex="-1"></a>Dividing throughout by $\Delta x$ we have:</span>
<span id="cb4-597"><a href="#cb4-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-598"><a href="#cb4-598" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-599"><a href="#cb4-599" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-600"><a href="#cb4-600" aria-hidden="true" tabindex="-1"></a>u_t(x,t) \approx \frac{K_0}{s \rho } \frac{u_x(x+\Delta x, t) - u_x(x,t)}{\Delta x}</span>
<span id="cb4-601"><a href="#cb4-601" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-602"><a href="#cb4-602" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-603"><a href="#cb4-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-604"><a href="#cb4-604" aria-hidden="true" tabindex="-1"></a>Letting $\Delta x \to 0$ improves the approximation and leads to the heat equation:</span>
<span id="cb4-605"><a href="#cb4-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-606"><a href="#cb4-606" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-607"><a href="#cb4-607" aria-hidden="true" tabindex="-1"></a>u_t=c^2 u_{xx}</span>
<span id="cb4-608"><a href="#cb4-608" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-609"><a href="#cb4-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-610"><a href="#cb4-610" aria-hidden="true" tabindex="-1"></a>where $c^2 = \frac{K_0}{\rho s}$ is called the *thermal diffusivity*. </span>
<span id="cb4-611"><a href="#cb4-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-612"><a href="#cb4-612" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Crank-Nicolson and Theta methods</span></span>
<span id="cb4-613"><a href="#cb4-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-614"><a href="#cb4-614" aria-hidden="true" tabindex="-1"></a>Consider the initial boundary value problem for the $1$d-heat equation:</span>
<span id="cb4-615"><a href="#cb4-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-616"><a href="#cb4-616" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-617"><a href="#cb4-617" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-618"><a href="#cb4-618" aria-hidden="true" tabindex="-1"></a>u_t &amp;= a^2 u_{xx}, \quad &amp; 0 &lt; x &lt; L, t&gt;0<span class="sc">\\</span></span>
<span id="cb4-619"><a href="#cb4-619" aria-hidden="true" tabindex="-1"></a>u(x,0) &amp;= f(x), \quad 0 \leq x \leq L <span class="sc">\\</span></span>
<span id="cb4-620"><a href="#cb4-620" aria-hidden="true" tabindex="-1"></a>u(0,t) &amp;= A, <span class="sc">\\</span></span>
<span id="cb4-621"><a href="#cb4-621" aria-hidden="true" tabindex="-1"></a>u(L,t) &amp;= B</span>
<span id="cb4-622"><a href="#cb4-622" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-623"><a href="#cb4-623" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-624"><a href="#cb4-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-625"><a href="#cb4-625" aria-hidden="true" tabindex="-1"></a>In this case, we can assume without the loss of generality that $L = 1$. Here, $a$, $A$ and $B$ are constants.</span>
<span id="cb4-626"><a href="#cb4-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-627"><a href="#cb4-627" aria-hidden="true" tabindex="-1"></a>We find a solution to this system in the case when $A = B = 0$ and $a = 1$ by the *method of the separation of variables*. In this case, the analytical solution is:</span>
<span id="cb4-628"><a href="#cb4-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-629"><a href="#cb4-629" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-630"><a href="#cb4-630" aria-hidden="true" tabindex="-1"></a>u(x,t) = \frac{8}{\pi^2}\sum_{n=1}^{\infty}\frac{1}{n^2}\sin\left(\frac{n\pi}{2}\right)\sin(n\pi x)\exp(-n^2 \pi^2 t)</span>
<span id="cb4-631"><a href="#cb4-631" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-632"><a href="#cb4-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-633"><a href="#cb4-633" aria-hidden="true" tabindex="-1"></a>and we are going to use this solution as a benchmark against which the numerical solutions can be compared.</span>
<span id="cb4-634"><a href="#cb4-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-635"><a href="#cb4-635" aria-hidden="true" tabindex="-1"></a>We can discretize a parabolic PDE in the space dimension (using centered difference schemes) while keeping the time variable continuous. We examine the following initial boundary value problem for the $1$d-heat equation on the unit interval with zero Dirichlet boundary conditions. </span>
<span id="cb4-636"><a href="#cb4-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-637"><a href="#cb4-637" aria-hidden="true" tabindex="-1"></a>The problem is:</span>
<span id="cb4-638"><a href="#cb4-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-639"><a href="#cb4-639" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-640"><a href="#cb4-640" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-641"><a href="#cb4-641" aria-hidden="true" tabindex="-1"></a>u_t &amp;= u_{xx}, \quad &amp; 0 &lt; x &lt; 1, t&gt;0<span class="sc">\\</span></span>
<span id="cb4-642"><a href="#cb4-642" aria-hidden="true" tabindex="-1"></a>u(x,0) &amp;= f(x), \quad 0 \leq x \leq 1 <span class="sc">\\</span></span>
<span id="cb4-643"><a href="#cb4-643" aria-hidden="true" tabindex="-1"></a>u(0,t) &amp;= u(1,t) = 0</span>
<span id="cb4-644"><a href="#cb4-644" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-645"><a href="#cb4-645" aria-hidden="true" tabindex="-1"></a>$$ {#eq-IBVP}</span>
<span id="cb4-646"><a href="#cb4-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-647"><a href="#cb4-647" aria-hidden="true" tabindex="-1"></a>We partition the space interval $(0,1)$ into $J$ subintervals and we approximate @eq-IBVP by the *semi-discrete* scheme:</span>
<span id="cb4-648"><a href="#cb4-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-649"><a href="#cb4-649" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-650"><a href="#cb4-650" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-651"><a href="#cb4-651" aria-hidden="true" tabindex="-1"></a>\frac{dU_j}{dt} &amp;= \frac{1}{h^2}(U_{j+1} - 2U_j + U_{j-1}), \quad 1 \leq j \leq J-1 <span class="sc">\\</span></span>
<span id="cb4-652"><a href="#cb4-652" aria-hidden="true" tabindex="-1"></a>U_0(t) &amp;= U_J(t) = 0, \quad t &gt; 0 <span class="sc">\\</span> </span>
<span id="cb4-653"><a href="#cb4-653" aria-hidden="true" tabindex="-1"></a>U_j(0) &amp;= f(x_j)</span>
<span id="cb4-654"><a href="#cb4-654" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-655"><a href="#cb4-655" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-656"><a href="#cb4-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-657"><a href="#cb4-657" aria-hidden="true" tabindex="-1"></a>where $h = 1/J$ is the constant mesh size. The $U_j$'s are functions of time $t$. So, we define the following vectors:</span>
<span id="cb4-658"><a href="#cb4-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-659"><a href="#cb4-659" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-660"><a href="#cb4-660" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-661"><a href="#cb4-661" aria-hidden="true" tabindex="-1"></a>U(t) &amp;= (U_1(t),U_2(t),\ldots,U_J(t))^T <span class="sc">\\</span></span>
<span id="cb4-662"><a href="#cb4-662" aria-hidden="true" tabindex="-1"></a>U^0 &amp;= (f(x_1),f(x_2),\ldots,f(x_{J-1}))^T</span>
<span id="cb4-663"><a href="#cb4-663" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-664"><a href="#cb4-664" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-665"><a href="#cb4-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-666"><a href="#cb4-666" aria-hidden="true" tabindex="-1"></a>Then, we can rewrite the system @eq-IBVP as a system of ordinary differential equations:</span>
<span id="cb4-667"><a href="#cb4-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-668"><a href="#cb4-668" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-669"><a href="#cb4-669" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-670"><a href="#cb4-670" aria-hidden="true" tabindex="-1"></a>\frac{dU}{dt} &amp;= AU<span class="sc">\\</span></span>
<span id="cb4-671"><a href="#cb4-671" aria-hidden="true" tabindex="-1"></a>U(0) &amp;= U^0</span>
<span id="cb4-672"><a href="#cb4-672" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-673"><a href="#cb4-673" aria-hidden="true" tabindex="-1"></a>$$ {#eq-heat-eq-1}</span>
<span id="cb4-674"><a href="#cb4-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-675"><a href="#cb4-675" aria-hidden="true" tabindex="-1"></a>where the matrix $A$ is given by:</span>
<span id="cb4-676"><a href="#cb4-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-677"><a href="#cb4-677" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-678"><a href="#cb4-678" aria-hidden="true" tabindex="-1"></a>A = \frac{1}{h^2}\begin{bmatrix}</span>
<span id="cb4-679"><a href="#cb4-679" aria-hidden="true" tabindex="-1"></a>-2 &amp; 1 &amp; 0 &amp; \ldots <span class="sc">\\</span></span>
<span id="cb4-680"><a href="#cb4-680" aria-hidden="true" tabindex="-1"></a>1  &amp;-2 &amp; 1 &amp; \ldots <span class="sc">\\</span></span>
<span id="cb4-681"><a href="#cb4-681" aria-hidden="true" tabindex="-1"></a>0  &amp; 1 &amp; -2 &amp; \ldots <span class="sc">\\</span></span>
<span id="cb4-682"><a href="#cb4-682" aria-hidden="true" tabindex="-1"></a>   &amp;   &amp;    &amp; \ldots <span class="sc">\\</span></span>
<span id="cb4-683"><a href="#cb4-683" aria-hidden="true" tabindex="-1"></a>      &amp;   &amp;    &amp; \ldots &amp; 1 &amp; -2 &amp; 1<span class="sc">\\</span></span>
<span id="cb4-684"><a href="#cb4-684" aria-hidden="true" tabindex="-1"></a>      &amp;   &amp;    &amp; \ldots &amp; 0 &amp; 1  &amp; -2<span class="sc">\\</span></span>
<span id="cb4-685"><a href="#cb4-685" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb4-686"><a href="#cb4-686" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb4-687"><a href="#cb4-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-688"><a href="#cb4-688" aria-hidden="true" tabindex="-1"></a>There are many discretization schemes. I plan to explore various finite difference schemes and their application to derivatives pricing in future posts. For now, I will concentrate on the one-step explicit and implicit methods to discretise the system  of ODEs(@eq-heat-eq-1) as:</span>
<span id="cb4-689"><a href="#cb4-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-690"><a href="#cb4-690" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-691"><a href="#cb4-691" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-692"><a href="#cb4-692" aria-hidden="true" tabindex="-1"></a>\frac{U^{n+1 - U^n}}{\Delta t} &amp;= \theta AU^{n+1} + (1-\theta)AU^{n}, \quad 0 \leq n \leq N-1, 0 \leq \theta \leq 1 <span class="sc">\\</span></span>
<span id="cb4-693"><a href="#cb4-693" aria-hidden="true" tabindex="-1"></a>U^{0} &amp;= U(0)</span>
<span id="cb4-694"><a href="#cb4-694" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-695"><a href="#cb4-695" aria-hidden="true" tabindex="-1"></a>$$ {#eq-heat-eq-2}</span>
<span id="cb4-696"><a href="#cb4-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-697"><a href="#cb4-697" aria-hidden="true" tabindex="-1"></a>In this case, $\Delta t$ is the constant mesh size in time.</span>
<span id="cb4-698"><a href="#cb4-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-699"><a href="#cb4-699" aria-hidden="true" tabindex="-1"></a>We can rewrite @eq-heat-eq-2 in the equivalent form:</span>
<span id="cb4-700"><a href="#cb4-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-701"><a href="#cb4-701" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-702"><a href="#cb4-702" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-703"><a href="#cb4-703" aria-hidden="true" tabindex="-1"></a>U^{n+1} - U^{n} &amp;= \theta \Delta t A U^{n+1} + \Delta t (I- \theta)AU^{n} <span class="sc">\\</span></span>
<span id="cb4-704"><a href="#cb4-704" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">I - \Delta t A</span><span class="co">]</span>U^{n+1} &amp;= (\Delta t (1 - \theta) + 1)AU^n</span>
<span id="cb4-705"><a href="#cb4-705" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-706"><a href="#cb4-706" aria-hidden="true" tabindex="-1"></a>$$ {#eq-heat-eq-3}</span>
<span id="cb4-707"><a href="#cb4-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-708"><a href="#cb4-708" aria-hidden="true" tabindex="-1"></a>or formally as:</span>
<span id="cb4-709"><a href="#cb4-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-710"><a href="#cb4-710" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-711"><a href="#cb4-711" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-712"><a href="#cb4-712" aria-hidden="true" tabindex="-1"></a>U^{n+1} = <span class="co">[</span><span class="ot">1-\Delta t \theta A</span><span class="co">]</span>^{-1} (I + \Delta t(I - \theta)) A U^n</span>
<span id="cb4-713"><a href="#cb4-713" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-714"><a href="#cb4-714" aria-hidden="true" tabindex="-1"></a>$$ {#eq-heat-eq-4}</span>
<span id="cb4-715"><a href="#cb4-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-716"><a href="#cb4-716" aria-hidden="true" tabindex="-1"></a>where $I$ is the identity matrix.</span>
<span id="cb4-717"><a href="#cb4-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-718"><a href="#cb4-718" aria-hidden="true" tabindex="-1"></a>Some special cases of $\theta$ are:</span>
<span id="cb4-719"><a href="#cb4-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-720"><a href="#cb4-720" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-721"><a href="#cb4-721" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-722"><a href="#cb4-722" aria-hidden="true" tabindex="-1"></a>\theta &amp;= 1, \quad \text{Implicit Euler Scheme}<span class="sc">\\</span></span>
<span id="cb4-723"><a href="#cb4-723" aria-hidden="true" tabindex="-1"></a>\theta &amp;= 0, \quad \text{Explicit Euler Scheme}<span class="sc">\\</span></span>
<span id="cb4-724"><a href="#cb4-724" aria-hidden="true" tabindex="-1"></a>\theta &amp;= 1/2,\quad \text{Crank-Nicolson Scheme}</span>
<span id="cb4-725"><a href="#cb4-725" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-726"><a href="#cb4-726" aria-hidden="true" tabindex="-1"></a>$$ {#eq-heat-eq-5}</span>
<span id="cb4-727"><a href="#cb4-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-728"><a href="#cb4-728" aria-hidden="true" tabindex="-1"></a>When the schemes are implicit, we can solve the system of equations (@eq-heat-eq-2) at each time level $n+1$ using the Thomas algorithm. No matrix inversion is needed in the case of explicit schemes. The formulation (@eq-heat-eq-1) is called the *method of lines* and it corresponds to semi-discretization of the PDE in the space direction while keeping the time variable continuous (I will explore MOL in future posts). </span>
<span id="cb4-729"><a href="#cb4-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-730"><a href="#cb4-730" aria-hidden="true" tabindex="-1"></a>We can write the scheme (@eq-heat-eq-3 - @eq-heat-eq-5) in the component form:</span>
<span id="cb4-731"><a href="#cb4-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-732"><a href="#cb4-732" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-733"><a href="#cb4-733" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-734"><a href="#cb4-734" aria-hidden="true" tabindex="-1"></a>\frac{U^{n+1}j - U^{n}j}{\Delta t} = \theta(U^{n+1}_{j+1}-2U^{n+1}_j + U^{n+1}_{j-1})/h^2 + (1-\theta)(U^{n}_{j+1}-2U^{n}_j + U^{n}_{j-1})/h^2</span>
<span id="cb4-735"><a href="#cb4-735" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-736"><a href="#cb4-736" aria-hidden="true" tabindex="-1"></a>$${#eq-component-form}</span>
<span id="cb4-737"><a href="#cb4-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-738"><a href="#cb4-738" aria-hidden="true" tabindex="-1"></a>or equivalently:</span>
<span id="cb4-739"><a href="#cb4-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-740"><a href="#cb4-740" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-741"><a href="#cb4-741" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-742"><a href="#cb4-742" aria-hidden="true" tabindex="-1"></a>{U^{n+1}j - U^{n}_j} &amp;= \lambda\theta(U^{n+1}_{j+1}-2U^{n+1}_j + U^{n+1}_{j-1})/h^2 \\&amp;+ (1-\theta)(U^{n}_{j+1}-2U^{n}_j + U^{n}_{j-1})</span>
<span id="cb4-743"><a href="#cb4-743" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-744"><a href="#cb4-744" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-745"><a href="#cb4-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-746"><a href="#cb4-746" aria-hidden="true" tabindex="-1"></a>where $\lambda = \Delta t/h^2$. </span>
<span id="cb4-747"><a href="#cb4-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-748"><a href="#cb4-748" aria-hidden="true" tabindex="-1"></a>Finally:</span>
<span id="cb4-749"><a href="#cb4-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-750"><a href="#cb4-750" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-751"><a href="#cb4-751" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-752"><a href="#cb4-752" aria-hidden="true" tabindex="-1"></a>-\lambda \theta U^{n+1}_{j+1} + (1+2\lambda \theta)U_j^{n+1} - \lambda \theta U^{n+1}_{j-1} \\= \lambda (1-\theta)U^{n}_{j+1}+(1-2\lambda(1-\theta))U^{n}_j + \lambda(1-\theta)U^{n}_{j-1}</span>
<span id="cb4-753"><a href="#cb4-753" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-754"><a href="#cb4-754" aria-hidden="true" tabindex="-1"></a>$$ {#eq-finite-difference-scheme}</span>
<span id="cb4-755"><a href="#cb4-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-756"><a href="#cb4-756" aria-hidden="true" tabindex="-1"></a>The system (@eq-finite-difference-scheme) is tridiagonal and we can apply the Thomas algorithm to solve it. In the case of the explicit Euler scheme $(\theta = 0)$, these algorithms are not needed, because the solution at time level $n+1$ can be explicitly computed:</span>
<span id="cb4-757"><a href="#cb4-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-758"><a href="#cb4-758" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-759"><a href="#cb4-759" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb4-760"><a href="#cb4-760" aria-hidden="true" tabindex="-1"></a>U^{n+1}_j = \lambda U^{n}_{j+1} + (1-2\lambda)U^{n}_j +\lambda U^{n}_{j-1}</span>
<span id="cb4-761"><a href="#cb4-761" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb4-762"><a href="#cb4-762" aria-hidden="true" tabindex="-1"></a>$${#eq-explicit-euler}</span>
<span id="cb4-763"><a href="#cb4-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-764"><a href="#cb4-764" aria-hidden="true" tabindex="-1"></a><span class="fu">### Computational Solution</span></span>
<span id="cb4-765"><a href="#cb4-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-766"><a href="#cb4-766" aria-hidden="true" tabindex="-1"></a>I implemented the algorithm in @eq-finite-difference-scheme. This is a one-step marching scheme called BTCS(Backward in Time, Centered in Space) that computes the solution at time level $n+1$ in terms of the solution at time $n$. Since there are three unknowns to be computed at each time level $n+1$, we need to use the Thomas algorithm. The main steps in the algorithm are:</span>
<span id="cb4-767"><a href="#cb4-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-768"><a href="#cb4-768" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Choose input parameters and generate meshes</span>
<span id="cb4-769"><a href="#cb4-769" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Define the initial solution and the boundary conditions</span>
<span id="cb4-770"><a href="#cb4-770" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compute the solution at each time upto and including expiration.</span>
<span id="cb4-771"><a href="#cb4-771" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>